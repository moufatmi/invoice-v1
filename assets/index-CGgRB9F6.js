(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var b_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ky(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var f1={exports:{}},c0={},h1={exports:{}},Zr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kv;function __(){if(Kv)return Zr;Kv=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),g=Symbol.iterator;function x(pe){return pe===null||typeof pe!="object"?null:(pe=g&&pe[g]||pe["@@iterator"],typeof pe=="function"?pe:null)}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,b={};function E(pe,C,M){this.props=pe,this.context=C,this.refs=b,this.updater=M||m}E.prototype.isReactComponent={},E.prototype.setState=function(pe,C){if(typeof pe!="object"&&typeof pe!="function"&&pe!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,pe,C,"setState")},E.prototype.forceUpdate=function(pe){this.updater.enqueueForceUpdate(this,pe,"forceUpdate")};function N(){}N.prototype=E.prototype;function O(pe,C,M){this.props=pe,this.context=C,this.refs=b,this.updater=M||m}var F=O.prototype=new N;F.constructor=O,k(F,E.prototype),F.isPureReactComponent=!0;var K=Array.isArray,te=Object.prototype.hasOwnProperty,re={current:null},B={key:!0,ref:!0,__self:!0,__source:!0};function V(pe,C,M){var z,H={},ie=null,xe=null;if(C!=null)for(z in C.ref!==void 0&&(xe=C.ref),C.key!==void 0&&(ie=""+C.key),C)te.call(C,z)&&!B.hasOwnProperty(z)&&(H[z]=C[z]);var Ae=arguments.length-2;if(Ae===1)H.children=M;else if(1<Ae){for(var de=Array(Ae),Me=0;Me<Ae;Me++)de[Me]=arguments[Me+2];H.children=de}if(pe&&pe.defaultProps)for(z in Ae=pe.defaultProps,Ae)H[z]===void 0&&(H[z]=Ae[z]);return{$$typeof:e,type:pe,key:ie,ref:xe,props:H,_owner:re.current}}function Y(pe,C){return{$$typeof:e,type:pe.type,key:C,ref:pe.ref,props:pe.props,_owner:pe._owner}}function ye(pe){return typeof pe=="object"&&pe!==null&&pe.$$typeof===e}function U(pe){var C={"=":"=0",":":"=2"};return"$"+pe.replace(/[=:]/g,function(M){return C[M]})}var D=/\/+/g;function le(pe,C){return typeof pe=="object"&&pe!==null&&pe.key!=null?U(""+pe.key):C.toString(36)}function ue(pe,C,M,z,H){var ie=typeof pe;(ie==="undefined"||ie==="boolean")&&(pe=null);var xe=!1;if(pe===null)xe=!0;else switch(ie){case"string":case"number":xe=!0;break;case"object":switch(pe.$$typeof){case e:case t:xe=!0}}if(xe)return xe=pe,H=H(xe),pe=z===""?"."+le(xe,0):z,K(H)?(M="",pe!=null&&(M=pe.replace(D,"$&/")+"/"),ue(H,C,M,"",function(Me){return Me})):H!=null&&(ye(H)&&(H=Y(H,M+(!H.key||xe&&xe.key===H.key?"":(""+H.key).replace(D,"$&/")+"/")+pe)),C.push(H)),1;if(xe=0,z=z===""?".":z+":",K(pe))for(var Ae=0;Ae<pe.length;Ae++){ie=pe[Ae];var de=z+le(ie,Ae);xe+=ue(ie,C,M,de,H)}else if(de=x(pe),typeof de=="function")for(pe=de.call(pe),Ae=0;!(ie=pe.next()).done;)ie=ie.value,de=z+le(ie,Ae++),xe+=ue(ie,C,M,de,H);else if(ie==="object")throw C=String(pe),Error("Objects are not valid as a React child (found: "+(C==="[object Object]"?"object with keys {"+Object.keys(pe).join(", ")+"}":C)+"). If you meant to render a collection of children, use an array instead.");return xe}function Te(pe,C,M){if(pe==null)return pe;var z=[],H=0;return ue(pe,z,"","",function(ie){return C.call(M,ie,H++)}),z}function Fe(pe){if(pe._status===-1){var C=pe._result;C=C(),C.then(function(M){(pe._status===0||pe._status===-1)&&(pe._status=1,pe._result=M)},function(M){(pe._status===0||pe._status===-1)&&(pe._status=2,pe._result=M)}),pe._status===-1&&(pe._status=0,pe._result=C)}if(pe._status===1)return pe._result.default;throw pe._result}var Le={current:null},me={transition:null},ne={ReactCurrentDispatcher:Le,ReactCurrentBatchConfig:me,ReactCurrentOwner:re};function Ee(){throw Error("act(...) is not supported in production builds of React.")}return Zr.Children={map:Te,forEach:function(pe,C,M){Te(pe,function(){C.apply(this,arguments)},M)},count:function(pe){var C=0;return Te(pe,function(){C++}),C},toArray:function(pe){return Te(pe,function(C){return C})||[]},only:function(pe){if(!ye(pe))throw Error("React.Children.only expected to receive a single React element child.");return pe}},Zr.Component=E,Zr.Fragment=r,Zr.Profiler=a,Zr.PureComponent=O,Zr.StrictMode=n,Zr.Suspense=u,Zr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ne,Zr.act=Ee,Zr.cloneElement=function(pe,C,M){if(pe==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+pe+".");var z=k({},pe.props),H=pe.key,ie=pe.ref,xe=pe._owner;if(C!=null){if(C.ref!==void 0&&(ie=C.ref,xe=re.current),C.key!==void 0&&(H=""+C.key),pe.type&&pe.type.defaultProps)var Ae=pe.type.defaultProps;for(de in C)te.call(C,de)&&!B.hasOwnProperty(de)&&(z[de]=C[de]===void 0&&Ae!==void 0?Ae[de]:C[de])}var de=arguments.length-2;if(de===1)z.children=M;else if(1<de){Ae=Array(de);for(var Me=0;Me<de;Me++)Ae[Me]=arguments[Me+2];z.children=Ae}return{$$typeof:e,type:pe.type,key:H,ref:ie,props:z,_owner:xe}},Zr.createContext=function(pe){return pe={$$typeof:o,_currentValue:pe,_currentValue2:pe,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},pe.Provider={$$typeof:i,_context:pe},pe.Consumer=pe},Zr.createElement=V,Zr.createFactory=function(pe){var C=V.bind(null,pe);return C.type=pe,C},Zr.createRef=function(){return{current:null}},Zr.forwardRef=function(pe){return{$$typeof:l,render:pe}},Zr.isValidElement=ye,Zr.lazy=function(pe){return{$$typeof:h,_payload:{_status:-1,_result:pe},_init:Fe}},Zr.memo=function(pe,C){return{$$typeof:f,type:pe,compare:C===void 0?null:C}},Zr.startTransition=function(pe){var C=me.transition;me.transition={};try{pe()}finally{me.transition=C}},Zr.unstable_act=Ee,Zr.useCallback=function(pe,C){return Le.current.useCallback(pe,C)},Zr.useContext=function(pe){return Le.current.useContext(pe)},Zr.useDebugValue=function(){},Zr.useDeferredValue=function(pe){return Le.current.useDeferredValue(pe)},Zr.useEffect=function(pe,C){return Le.current.useEffect(pe,C)},Zr.useId=function(){return Le.current.useId()},Zr.useImperativeHandle=function(pe,C,M){return Le.current.useImperativeHandle(pe,C,M)},Zr.useInsertionEffect=function(pe,C){return Le.current.useInsertionEffect(pe,C)},Zr.useLayoutEffect=function(pe,C){return Le.current.useLayoutEffect(pe,C)},Zr.useMemo=function(pe,C){return Le.current.useMemo(pe,C)},Zr.useReducer=function(pe,C,M){return Le.current.useReducer(pe,C,M)},Zr.useRef=function(pe){return Le.current.useRef(pe)},Zr.useState=function(pe){return Le.current.useState(pe)},Zr.useSyncExternalStore=function(pe,C,M){return Le.current.useSyncExternalStore(pe,C,M)},Zr.useTransition=function(){return Le.current.useTransition()},Zr.version="18.3.1",Zr}var Gv;function qg(){return Gv||(Gv=1,h1.exports=__()),h1.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yv;function k_(){if(Yv)return c0;Yv=1;var e=qg(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function o(l,u,f){var h,g={},x=null,m=null;f!==void 0&&(x=""+f),u.key!==void 0&&(x=""+u.key),u.ref!==void 0&&(m=u.ref);for(h in u)n.call(u,h)&&!i.hasOwnProperty(h)&&(g[h]=u[h]);if(l&&l.defaultProps)for(h in u=l.defaultProps,u)g[h]===void 0&&(g[h]=u[h]);return{$$typeof:t,type:l,key:x,ref:m,props:g,_owner:a.current}}return c0.Fragment=r,c0.jsx=o,c0.jsxs=o,c0}var Xv;function S_(){return Xv||(Xv=1,f1.exports=k_()),f1.exports}var A=S_(),ce=qg();const ra=ky(ce);var Zh={},d1={exports:{}},Rs={},p1={exports:{}},g1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jv;function E_(){return Jv||(Jv=1,function(e){function t(me,ne){var Ee=me.length;me.push(ne);e:for(;0<Ee;){var pe=Ee-1>>>1,C=me[pe];if(0<a(C,ne))me[pe]=ne,me[Ee]=C,Ee=pe;else break e}}function r(me){return me.length===0?null:me[0]}function n(me){if(me.length===0)return null;var ne=me[0],Ee=me.pop();if(Ee!==ne){me[0]=Ee;e:for(var pe=0,C=me.length,M=C>>>1;pe<M;){var z=2*(pe+1)-1,H=me[z],ie=z+1,xe=me[ie];if(0>a(H,Ee))ie<C&&0>a(xe,H)?(me[pe]=xe,me[ie]=Ee,pe=ie):(me[pe]=H,me[z]=Ee,pe=z);else if(ie<C&&0>a(xe,Ee))me[pe]=xe,me[ie]=Ee,pe=ie;else break e}}return ne}function a(me,ne){var Ee=me.sortIndex-ne.sortIndex;return Ee!==0?Ee:me.id-ne.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var u=[],f=[],h=1,g=null,x=3,m=!1,k=!1,b=!1,E=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function F(me){for(var ne=r(f);ne!==null;){if(ne.callback===null)n(f);else if(ne.startTime<=me)n(f),ne.sortIndex=ne.expirationTime,t(u,ne);else break;ne=r(f)}}function K(me){if(b=!1,F(me),!k)if(r(u)!==null)k=!0,Fe(te);else{var ne=r(f);ne!==null&&Le(K,ne.startTime-me)}}function te(me,ne){k=!1,b&&(b=!1,N(V),V=-1),m=!0;var Ee=x;try{for(F(ne),g=r(u);g!==null&&(!(g.expirationTime>ne)||me&&!U());){var pe=g.callback;if(typeof pe=="function"){g.callback=null,x=g.priorityLevel;var C=pe(g.expirationTime<=ne);ne=e.unstable_now(),typeof C=="function"?g.callback=C:g===r(u)&&n(u),F(ne)}else n(u);g=r(u)}if(g!==null)var M=!0;else{var z=r(f);z!==null&&Le(K,z.startTime-ne),M=!1}return M}finally{g=null,x=Ee,m=!1}}var re=!1,B=null,V=-1,Y=5,ye=-1;function U(){return!(e.unstable_now()-ye<Y)}function D(){if(B!==null){var me=e.unstable_now();ye=me;var ne=!0;try{ne=B(!0,me)}finally{ne?le():(re=!1,B=null)}}else re=!1}var le;if(typeof O=="function")le=function(){O(D)};else if(typeof MessageChannel<"u"){var ue=new MessageChannel,Te=ue.port2;ue.port1.onmessage=D,le=function(){Te.postMessage(null)}}else le=function(){E(D,0)};function Fe(me){B=me,re||(re=!0,le())}function Le(me,ne){V=E(function(){me(e.unstable_now())},ne)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(me){me.callback=null},e.unstable_continueExecution=function(){k||m||(k=!0,Fe(te))},e.unstable_forceFrameRate=function(me){0>me||125<me?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Y=0<me?Math.floor(1e3/me):5},e.unstable_getCurrentPriorityLevel=function(){return x},e.unstable_getFirstCallbackNode=function(){return r(u)},e.unstable_next=function(me){switch(x){case 1:case 2:case 3:var ne=3;break;default:ne=x}var Ee=x;x=ne;try{return me()}finally{x=Ee}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(me,ne){switch(me){case 1:case 2:case 3:case 4:case 5:break;default:me=3}var Ee=x;x=me;try{return ne()}finally{x=Ee}},e.unstable_scheduleCallback=function(me,ne,Ee){var pe=e.unstable_now();switch(typeof Ee=="object"&&Ee!==null?(Ee=Ee.delay,Ee=typeof Ee=="number"&&0<Ee?pe+Ee:pe):Ee=pe,me){case 1:var C=-1;break;case 2:C=250;break;case 5:C=1073741823;break;case 4:C=1e4;break;default:C=5e3}return C=Ee+C,me={id:h++,callback:ne,priorityLevel:me,startTime:Ee,expirationTime:C,sortIndex:-1},Ee>pe?(me.sortIndex=Ee,t(f,me),r(u)===null&&me===r(f)&&(b?(N(V),V=-1):b=!0,Le(K,Ee-pe))):(me.sortIndex=C,t(u,me),k||m||(k=!0,Fe(te))),me},e.unstable_shouldYield=U,e.unstable_wrapCallback=function(me){var ne=x;return function(){var Ee=x;x=ne;try{return me.apply(this,arguments)}finally{x=Ee}}}}(g1)),g1}var Qv;function A_(){return Qv||(Qv=1,p1.exports=E_()),p1.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zv;function N_(){if(Zv)return Rs;Zv=1;var e=qg(),t=A_();function r(s){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+s,d=1;d<arguments.length;d++)c+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+s+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,a={};function i(s,c){o(s,c),o(s+"Capture",c)}function o(s,c){for(a[s]=c,s=0;s<c.length;s++)n.add(c[s])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},g={};function x(s){return u.call(g,s)?!0:u.call(h,s)?!1:f.test(s)?g[s]=!0:(h[s]=!0,!1)}function m(s,c,d,y){if(d!==null&&d.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return y?!1:d!==null?!d.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function k(s,c,d,y){if(c===null||typeof c>"u"||m(s,c,d,y))return!0;if(y)return!1;if(d!==null)switch(d.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function b(s,c,d,y,T,I,Q){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=y,this.attributeNamespace=T,this.mustUseProperty=d,this.propertyName=s,this.type=c,this.sanitizeURL=I,this.removeEmptyString=Q}var E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){E[s]=new b(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var c=s[0];E[c]=new b(c,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){E[s]=new b(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){E[s]=new b(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){E[s]=new b(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){E[s]=new b(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){E[s]=new b(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){E[s]=new b(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){E[s]=new b(s,5,!1,s.toLowerCase(),null,!1,!1)});var N=/[\-:]([a-z])/g;function O(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var c=s.replace(N,O);E[c]=new b(c,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var c=s.replace(N,O);E[c]=new b(c,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var c=s.replace(N,O);E[c]=new b(c,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){E[s]=new b(s,1,!1,s.toLowerCase(),null,!1,!1)}),E.xlinkHref=new b("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){E[s]=new b(s,1,!1,s.toLowerCase(),null,!0,!0)});function F(s,c,d,y){var T=E.hasOwnProperty(c)?E[c]:null;(T!==null?T.type!==0:y||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(k(c,d,T,y)&&(d=null),y||T===null?x(c)&&(d===null?s.removeAttribute(c):s.setAttribute(c,""+d)):T.mustUseProperty?s[T.propertyName]=d===null?T.type===3?!1:"":d:(c=T.attributeName,y=T.attributeNamespace,d===null?s.removeAttribute(c):(T=T.type,d=T===3||T===4&&d===!0?"":""+d,y?s.setAttributeNS(y,c,d):s.setAttribute(c,d))))}var K=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,te=Symbol.for("react.element"),re=Symbol.for("react.portal"),B=Symbol.for("react.fragment"),V=Symbol.for("react.strict_mode"),Y=Symbol.for("react.profiler"),ye=Symbol.for("react.provider"),U=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),le=Symbol.for("react.suspense"),ue=Symbol.for("react.suspense_list"),Te=Symbol.for("react.memo"),Fe=Symbol.for("react.lazy"),Le=Symbol.for("react.offscreen"),me=Symbol.iterator;function ne(s){return s===null||typeof s!="object"?null:(s=me&&s[me]||s["@@iterator"],typeof s=="function"?s:null)}var Ee=Object.assign,pe;function C(s){if(pe===void 0)try{throw Error()}catch(d){var c=d.stack.trim().match(/\n( *(at )?)/);pe=c&&c[1]||""}return`
`+pe+s}var M=!1;function z(s,c){if(!s||M)return"";M=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(lt){var y=lt}Reflect.construct(s,[],c)}else{try{c.call()}catch(lt){y=lt}s.call(c.prototype)}else{try{throw Error()}catch(lt){y=lt}s()}}catch(lt){if(lt&&y&&typeof lt.stack=="string"){for(var T=lt.stack.split(`
`),I=y.stack.split(`
`),Q=T.length-1,Pe=I.length-1;1<=Q&&0<=Pe&&T[Q]!==I[Pe];)Pe--;for(;1<=Q&&0<=Pe;Q--,Pe--)if(T[Q]!==I[Pe]){if(Q!==1||Pe!==1)do if(Q--,Pe--,0>Pe||T[Q]!==I[Pe]){var je=`
`+T[Q].replace(" at new "," at ");return s.displayName&&je.includes("<anonymous>")&&(je=je.replace("<anonymous>",s.displayName)),je}while(1<=Q&&0<=Pe);break}}}finally{M=!1,Error.prepareStackTrace=d}return(s=s?s.displayName||s.name:"")?C(s):""}function H(s){switch(s.tag){case 5:return C(s.type);case 16:return C("Lazy");case 13:return C("Suspense");case 19:return C("SuspenseList");case 0:case 2:case 15:return s=z(s.type,!1),s;case 11:return s=z(s.type.render,!1),s;case 1:return s=z(s.type,!0),s;default:return""}}function ie(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case B:return"Fragment";case re:return"Portal";case Y:return"Profiler";case V:return"StrictMode";case le:return"Suspense";case ue:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case U:return(s.displayName||"Context")+".Consumer";case ye:return(s._context.displayName||"Context")+".Provider";case D:var c=s.render;return s=s.displayName,s||(s=c.displayName||c.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case Te:return c=s.displayName||null,c!==null?c:ie(s.type)||"Memo";case Fe:c=s._payload,s=s._init;try{return ie(s(c))}catch{}}return null}function xe(s){var c=s.type;switch(s.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=c.render,s=s.displayName||s.name||"",c.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ie(c);case 8:return c===V?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function Ae(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function de(s){var c=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function Me(s){var c=de(s)?"checked":"value",d=Object.getOwnPropertyDescriptor(s.constructor.prototype,c),y=""+s[c];if(!s.hasOwnProperty(c)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var T=d.get,I=d.set;return Object.defineProperty(s,c,{configurable:!0,get:function(){return T.call(this)},set:function(Q){y=""+Q,I.call(this,Q)}}),Object.defineProperty(s,c,{enumerable:d.enumerable}),{getValue:function(){return y},setValue:function(Q){y=""+Q},stopTracking:function(){s._valueTracker=null,delete s[c]}}}}function ct(s){s._valueTracker||(s._valueTracker=Me(s))}function se(s){if(!s)return!1;var c=s._valueTracker;if(!c)return!0;var d=c.getValue(),y="";return s&&(y=de(s)?s.checked?"true":"false":s.value),s=y,s!==d?(c.setValue(s),!0):!1}function bt(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function Dt(s,c){var d=c.checked;return Ee({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??s._wrapperState.initialChecked})}function Je(s,c){var d=c.defaultValue==null?"":c.defaultValue,y=c.checked!=null?c.checked:c.defaultChecked;d=Ae(c.value!=null?c.value:d),s._wrapperState={initialChecked:y,initialValue:d,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function we(s,c){c=c.checked,c!=null&&F(s,"checked",c,!1)}function mt(s,c){we(s,c);var d=Ae(c.value),y=c.type;if(d!=null)y==="number"?(d===0&&s.value===""||s.value!=d)&&(s.value=""+d):s.value!==""+d&&(s.value=""+d);else if(y==="submit"||y==="reset"){s.removeAttribute("value");return}c.hasOwnProperty("value")?xt(s,c.type,d):c.hasOwnProperty("defaultValue")&&xt(s,c.type,Ae(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(s.defaultChecked=!!c.defaultChecked)}function qt(s,c,d){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var y=c.type;if(!(y!=="submit"&&y!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+s._wrapperState.initialValue,d||c===s.value||(s.value=c),s.defaultValue=c}d=s.name,d!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,d!==""&&(s.name=d)}function xt(s,c,d){(c!=="number"||bt(s.ownerDocument)!==s)&&(d==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+d&&(s.defaultValue=""+d))}var _t=Array.isArray;function Et(s,c,d,y){if(s=s.options,c){c={};for(var T=0;T<d.length;T++)c["$"+d[T]]=!0;for(d=0;d<s.length;d++)T=c.hasOwnProperty("$"+s[d].value),s[d].selected!==T&&(s[d].selected=T),T&&y&&(s[d].defaultSelected=!0)}else{for(d=""+Ae(d),c=null,T=0;T<s.length;T++){if(s[T].value===d){s[T].selected=!0,y&&(s[T].defaultSelected=!0);return}c!==null||s[T].disabled||(c=s[T])}c!==null&&(c.selected=!0)}}function Bt(s,c){if(c.dangerouslySetInnerHTML!=null)throw Error(r(91));return Ee({},c,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function Jt(s,c){var d=c.value;if(d==null){if(d=c.children,c=c.defaultValue,d!=null){if(c!=null)throw Error(r(92));if(_t(d)){if(1<d.length)throw Error(r(93));d=d[0]}c=d}c==null&&(c=""),d=c}s._wrapperState={initialValue:Ae(d)}}function nr(s,c){var d=Ae(c.value),y=Ae(c.defaultValue);d!=null&&(d=""+d,d!==s.value&&(s.value=d),c.defaultValue==null&&s.defaultValue!==d&&(s.defaultValue=d)),y!=null&&(s.defaultValue=""+y)}function cr(s){var c=s.textContent;c===s._wrapperState.initialValue&&c!==""&&c!==null&&(s.value=c)}function gr(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function yr(s,c){return s==null||s==="http://www.w3.org/1999/xhtml"?gr(c):s==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var mr,Qt=function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,d,y,T){MSApp.execUnsafeLocalFunction(function(){return s(c,d,y,T)})}:s}(function(s,c){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=c;else{for(mr=mr||document.createElement("div"),mr.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=mr.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;c.firstChild;)s.appendChild(c.firstChild)}});function $t(s,c){if(c){var d=s.firstChild;if(d&&d===s.lastChild&&d.nodeType===3){d.nodeValue=c;return}}s.textContent=c}var wt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Vr=["Webkit","ms","Moz","O"];Object.keys(wt).forEach(function(s){Vr.forEach(function(c){c=c+s.charAt(0).toUpperCase()+s.substring(1),wt[c]=wt[s]})});function ur(s,c,d){return c==null||typeof c=="boolean"||c===""?"":d||typeof c!="number"||c===0||wt.hasOwnProperty(s)&&wt[s]?(""+c).trim():c+"px"}function Tn(s,c){s=s.style;for(var d in c)if(c.hasOwnProperty(d)){var y=d.indexOf("--")===0,T=ur(d,c[d],y);d==="float"&&(d="cssFloat"),y?s.setProperty(d,T):s[d]=T}}var Ur=Ee({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ut(s,c){if(c){if(Ur[s]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(r(137,s));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(r(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(r(61))}if(c.style!=null&&typeof c.style!="object")throw Error(r(62))}}function Zn(s,c){if(s.indexOf("-")===-1)return typeof c.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Lr=null;function ga(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var At=null,Bn=null,Xr=null;function Fr(s){if(s=yc(s)){if(typeof At!="function")throw Error(r(280));var c=s.stateNode;c&&(c=iu(c),At(s.stateNode,s.type,c))}}function ar(s){Bn?Xr?Xr.push(s):Xr=[s]:Bn=s}function Or(){if(Bn){var s=Bn,c=Xr;if(Xr=Bn=null,Fr(s),c)for(s=0;s<c.length;s++)Fr(c[s])}}function Ln(s,c){return s(c)}function Jr(){}var ln=!1;function Sn(s,c,d){if(ln)return s(c,d);ln=!0;try{return Ln(s,c,d)}finally{ln=!1,(Bn!==null||Xr!==null)&&(Jr(),Or())}}function Gt(s,c){var d=s.stateNode;if(d===null)return null;var y=iu(d);if(y===null)return null;d=y[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(s=s.type,y=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!y;break e;default:s=!1}if(s)return null;if(d&&typeof d!="function")throw Error(r(231,c,typeof d));return d}var yn=!1;if(l)try{var wr={};Object.defineProperty(wr,"passive",{get:function(){yn=!0}}),window.addEventListener("test",wr,wr),window.removeEventListener("test",wr,wr)}catch{yn=!1}function Dr(s,c,d,y,T,I,Q,Pe,je){var lt=Array.prototype.slice.call(arguments,3);try{c.apply(d,lt)}catch(Ot){this.onError(Ot)}}var nn=!1,Qr=null,X=!1,be=null,fe={onError:function(s){nn=!0,Qr=s}};function he(s,c,d,y,T,I,Q,Pe,je){nn=!1,Qr=null,Dr.apply(fe,arguments)}function _e(s,c,d,y,T,I,Q,Pe,je){if(he.apply(this,arguments),nn){if(nn){var lt=Qr;nn=!1,Qr=null}else throw Error(r(198));X||(X=!0,be=lt)}}function ke(s){var c=s,d=s;if(s.alternate)for(;c.return;)c=c.return;else{s=c;do c=s,(c.flags&4098)!==0&&(d=c.return),s=c.return;while(s)}return c.tag===3?d:null}function Qe(s){if(s.tag===13){var c=s.memoizedState;if(c===null&&(s=s.alternate,s!==null&&(c=s.memoizedState)),c!==null)return c.dehydrated}return null}function ut(s){if(ke(s)!==s)throw Error(r(188))}function Xe(s){var c=s.alternate;if(!c){if(c=ke(s),c===null)throw Error(r(188));return c!==s?null:s}for(var d=s,y=c;;){var T=d.return;if(T===null)break;var I=T.alternate;if(I===null){if(y=T.return,y!==null){d=y;continue}break}if(T.child===I.child){for(I=T.child;I;){if(I===d)return ut(T),s;if(I===y)return ut(T),c;I=I.sibling}throw Error(r(188))}if(d.return!==y.return)d=T,y=I;else{for(var Q=!1,Pe=T.child;Pe;){if(Pe===d){Q=!0,d=T,y=I;break}if(Pe===y){Q=!0,y=T,d=I;break}Pe=Pe.sibling}if(!Q){for(Pe=I.child;Pe;){if(Pe===d){Q=!0,d=I,y=T;break}if(Pe===y){Q=!0,y=I,d=T;break}Pe=Pe.sibling}if(!Q)throw Error(r(189))}}if(d.alternate!==y)throw Error(r(190))}if(d.tag!==3)throw Error(r(188));return d.stateNode.current===d?s:c}function rt(s){return s=Xe(s),s!==null?nt(s):null}function nt(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var c=nt(s);if(c!==null)return c;s=s.sibling}return null}var St=t.unstable_scheduleCallback,zt=t.unstable_cancelCallback,It=t.unstable_shouldYield,Lt=t.unstable_requestPaint,kt=t.unstable_now,kr=t.unstable_getCurrentPriorityLevel,Kr=t.unstable_ImmediatePriority,en=t.unstable_UserBlockingPriority,En=t.unstable_NormalPriority,ci=t.unstable_LowPriority,Ca=t.unstable_IdlePriority,Ga=null,Fn=null;function Ji(s){if(Fn&&typeof Fn.onCommitFiberRoot=="function")try{Fn.onCommitFiberRoot(Ga,s,void 0,(s.current.flags&128)===128)}catch{}}var pr=Math.clz32?Math.clz32:Bl,Un=Math.log,Ml=Math.LN2;function Bl(s){return s>>>=0,s===0?32:31-(Un(s)/Ml|0)|0}var an=64,_i=4194304;function Qi(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function aa(s,c){var d=s.pendingLanes;if(d===0)return 0;var y=0,T=s.suspendedLanes,I=s.pingedLanes,Q=d&268435455;if(Q!==0){var Pe=Q&~T;Pe!==0?y=Qi(Pe):(I&=Q,I!==0&&(y=Qi(I)))}else Q=d&~T,Q!==0?y=Qi(Q):I!==0&&(y=Qi(I));if(y===0)return 0;if(c!==0&&c!==y&&(c&T)===0&&(T=y&-y,I=c&-c,T>=I||T===16&&(I&4194240)!==0))return c;if((y&4)!==0&&(y|=d&16),c=s.entangledLanes,c!==0)for(s=s.entanglements,c&=y;0<c;)d=31-pr(c),T=1<<d,y|=s[d],c&=~T;return y}function io(s,c){switch(s){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Pa(s,c){for(var d=s.suspendedLanes,y=s.pingedLanes,T=s.expirationTimes,I=s.pendingLanes;0<I;){var Q=31-pr(I),Pe=1<<Q,je=T[Q];je===-1?((Pe&d)===0||(Pe&y)!==0)&&(T[Q]=io(Pe,c)):je<=c&&(s.expiredLanes|=Pe),I&=~Pe}}function ws(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function hl(){var s=an;return an<<=1,(an&4194240)===0&&(an=64),s}function so(s){for(var c=[],d=0;31>d;d++)c.push(s);return c}function Ms(s,c,d){s.pendingLanes|=c,c!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,c=31-pr(c),s[c]=d}function Co(s,c){var d=s.pendingLanes&~c;s.pendingLanes=c,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=c,s.mutableReadLanes&=c,s.entangledLanes&=c,c=s.entanglements;var y=s.eventTimes;for(s=s.expirationTimes;0<d;){var T=31-pr(d),I=1<<T;c[T]=0,y[T]=-1,s[T]=-1,d&=~I}}function Po(s,c){var d=s.entangledLanes|=c;for(s=s.entanglements;d;){var y=31-pr(d),T=1<<y;T&c|s[y]&c&&(s[y]|=c),d&=~T}}var sn=0;function Gr(s){return s&=-s,1<s?4<s?(s&268435455)!==0?16:536870912:4:1}var dl,Ul,pc,zn,ki,Zi=!1,Ya=[],Cn=null,es=null,gn=null,fr=new Map,ts=new Map,Xa=[],Si="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ei(s,c){switch(s){case"focusin":case"focusout":Cn=null;break;case"dragenter":case"dragleave":es=null;break;case"mouseover":case"mouseout":gn=null;break;case"pointerover":case"pointerout":fr.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":ts.delete(c.pointerId)}}function oo(s,c,d,y,T,I){return s===null||s.nativeEvent!==I?(s={blockedOn:c,domEventName:d,eventSystemFlags:y,nativeEvent:I,targetContainers:[T]},c!==null&&(c=yc(c),c!==null&&Ul(c)),s):(s.eventSystemFlags|=y,c=s.targetContainers,T!==null&&c.indexOf(T)===-1&&c.push(T),s)}function ja(s,c,d,y,T){switch(c){case"focusin":return Cn=oo(Cn,s,c,d,y,T),!0;case"dragenter":return es=oo(es,s,c,d,y,T),!0;case"mouseover":return gn=oo(gn,s,c,d,y,T),!0;case"pointerover":var I=T.pointerId;return fr.set(I,oo(fr.get(I)||null,s,c,d,y,T)),!0;case"gotpointercapture":return I=T.pointerId,ts.set(I,oo(ts.get(I)||null,s,c,d,y,T)),!0}return!1}function lo(s){var c=_l(s.target);if(c!==null){var d=ke(c);if(d!==null){if(c=d.tag,c===13){if(c=Qe(d),c!==null){s.blockedOn=c,ki(s.priority,function(){pc(d)});return}}else if(c===3&&d.stateNode.current.memoizedState.isDehydrated){s.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Lo(s){if(s.blockedOn!==null)return!1;for(var c=s.targetContainers;0<c.length;){var d=co(s.domEventName,s.eventSystemFlags,c[0],s.nativeEvent);if(d===null){d=s.nativeEvent;var y=new d.constructor(d.type,d);Lr=y,d.target.dispatchEvent(y),Lr=null}else return c=yc(d),c!==null&&Ul(c),s.blockedOn=d,!1;c.shift()}return!0}function pl(s,c,d){Lo(s)&&d.delete(c)}function Fo(){Zi=!1,Cn!==null&&Lo(Cn)&&(Cn=null),es!==null&&Lo(es)&&(es=null),gn!==null&&Lo(gn)&&(gn=null),fr.forEach(pl),ts.forEach(pl)}function rs(s,c){s.blockedOn===c&&(s.blockedOn=null,Zi||(Zi=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Fo)))}function Ai(s){function c(T){return rs(T,s)}if(0<Ya.length){rs(Ya[0],s);for(var d=1;d<Ya.length;d++){var y=Ya[d];y.blockedOn===s&&(y.blockedOn=null)}}for(Cn!==null&&rs(Cn,s),es!==null&&rs(es,s),gn!==null&&rs(gn,s),fr.forEach(c),ts.forEach(c),d=0;d<Xa.length;d++)y=Xa[d],y.blockedOn===s&&(y.blockedOn=null);for(;0<Xa.length&&(d=Xa[0],d.blockedOn===null);)lo(d),d.blockedOn===null&&Xa.shift()}var ui=K.ReactCurrentBatchConfig,bs=!0;function Oo(s,c,d,y){var T=sn,I=ui.transition;ui.transition=null;try{sn=1,ns(s,c,d,y)}finally{sn=T,ui.transition=I}}function zl(s,c,d,y){var T=sn,I=ui.transition;ui.transition=null;try{sn=4,ns(s,c,d,y)}finally{sn=T,ui.transition=I}}function ns(s,c,d,y){if(bs){var T=co(s,c,d,y);if(T===null)ru(s,c,y,_s,d),Ei(s,y);else if(ja(T,s,c,d,y))y.stopPropagation();else if(Ei(s,y),c&4&&-1<Si.indexOf(s)){for(;T!==null;){var I=yc(T);if(I!==null&&dl(I),I=co(s,c,d,y),I===null&&ru(s,c,y,_s,d),I===T)break;T=I}T!==null&&y.stopPropagation()}else ru(s,c,y,null,d)}}var _s=null;function co(s,c,d,y){if(_s=null,s=ga(y),s=_l(s),s!==null)if(c=ke(s),c===null)s=null;else if(d=c.tag,d===13){if(s=Qe(c),s!==null)return s;s=null}else if(d===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;s=null}else c!==s&&(s=null);return _s=s,null}function ql(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(kr()){case Kr:return 1;case en:return 4;case En:case ci:return 16;case Ca:return 536870912;default:return 16}default:return 16}}var as=null,Ni=null,Ja=null;function gl(){if(Ja)return Ja;var s,c=Ni,d=c.length,y,T="value"in as?as.value:as.textContent,I=T.length;for(s=0;s<d&&c[s]===T[s];s++);var Q=d-s;for(y=1;y<=Q&&c[d-y]===T[I-y];y++);return Ja=T.slice(s,1<y?1-y:void 0)}function Ti(s){var c=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&c===13&&(s=13)):s=c,s===10&&(s=13),32<=s||s===13?s:0}function ma(){return!0}function Bs(){return!1}function qn(s){function c(d,y,T,I,Q){this._reactName=d,this._targetInst=T,this.type=y,this.nativeEvent=I,this.target=Q,this.currentTarget=null;for(var Pe in s)s.hasOwnProperty(Pe)&&(d=s[Pe],this[Pe]=d?d(I):I[Pe]);return this.isDefaultPrevented=(I.defaultPrevented!=null?I.defaultPrevented:I.returnValue===!1)?ma:Bs,this.isPropagationStopped=Bs,this}return Ee(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=ma)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=ma)},persist:function(){},isPersistent:ma}),c}var Us={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},uo=qn(Us),ks=Ee({},Us,{view:0,detail:0}),Io=qn(ks),zs,fo,Ci,On=Ee({},ks,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xt,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Ci&&(Ci&&s.type==="mousemove"?(zs=s.screenX-Ci.screenX,fo=s.screenY-Ci.screenY):fo=zs=0,Ci=s),zs)},movementY:function(s){return"movementY"in s?s.movementY:fo}}),Ss=qn(On),ho=Ee({},On,{dataTransfer:0}),gc=qn(ho),qs=Ee({},ks,{relatedTarget:0}),Es=qn(qs),ml=Ee({},Us,{animationName:0,elapsedTime:0,pseudoElement:0}),is=qn(ml),Ro=Ee({},Us,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),S=qn(Ro),G=Ee({},Us,{data:0}),Se=qn(G),Oe={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ye={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},dt={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Nt(s){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(s):(s=dt[s])?!!c[s]:!1}function Xt(){return Nt}var hr=Ee({},ks,{key:function(s){if(s.key){var c=Oe[s.key]||s.key;if(c!=="Unidentified")return c}return s.type==="keypress"?(s=Ti(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Ye[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xt,charCode:function(s){return s.type==="keypress"?Ti(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Ti(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),jr=qn(hr),Ar=Ee({},On,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Yr=qn(Ar),In=Ee({},ks,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xt}),Rn=qn(In),ea=Ee({},Us,{propertyName:0,elapsedTime:0,pseudoElement:0}),va=qn(ea),ia=Ee({},On,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),ss=qn(ia),Qa=[9,13,27,32],Za=l&&"CompositionEvent"in window,$s=null;l&&"documentMode"in document&&($s=document.documentMode);var vl=l&&"TextEvent"in window&&!$s,xl=l&&(!Za||$s&&8<$s&&11>=$s),Do=" ",yl=!1;function Hs(s,c){switch(s){case"keyup":return Qa.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ma(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Br=!1;function Vs(s,c){switch(s){case"compositionend":return Ma(c);case"keypress":return c.which!==32?null:(yl=!0,Do);case"textInput":return s=c.data,s===Do&&yl?null:s;default:return null}}function xa(s,c){if(Br)return s==="compositionend"||!Za&&Hs(s,c)?(s=gl(),Ja=Ni=as=null,Br=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return xl&&c.locale!=="ko"?null:c.data;default:return null}}var wl={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function po(s){var c=s&&s.nodeName&&s.nodeName.toLowerCase();return c==="input"?!!wl[s.type]:c==="textarea"}function La(s,c,d,y){ar(y),c=zu(c,"onChange"),0<c.length&&(d=new uo("onChange","change",null,d,y),s.push({event:d,listeners:c}))}var fi=null,os=null;function Ws(s){eu(s,0)}function $n(s){var c=Wl(s);if(se(c))return s}function jo(s,c){if(s==="change")return c}var v=!1;if(l){var _;if(l){var L="oninput"in document;if(!L){var j=document.createElement("div");j.setAttribute("oninput","return;"),L=typeof j.oninput=="function"}_=L}else _=!1;v=_&&(!document.documentMode||9<document.documentMode)}function q(){fi&&(fi.detachEvent("onpropertychange",Z),os=fi=null)}function Z(s){if(s.propertyName==="value"&&$n(os)){var c=[];La(c,os,s,ga(s)),Sn(Ws,c)}}function ve(s,c,d){s==="focusin"?(q(),fi=c,os=d,fi.attachEvent("onpropertychange",Z)):s==="focusout"&&q()}function Ce(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return $n(os)}function De(s,c){if(s==="click")return $n(c)}function ze(s,c){if(s==="input"||s==="change")return $n(c)}function Ve(s,c){return s===c&&(s!==0||1/s===1/c)||s!==s&&c!==c}var Ne=typeof Object.is=="function"?Object.is:Ve;function Ke(s,c){if(Ne(s,c))return!0;if(typeof s!="object"||s===null||typeof c!="object"||c===null)return!1;var d=Object.keys(s),y=Object.keys(c);if(d.length!==y.length)return!1;for(y=0;y<d.length;y++){var T=d[y];if(!u.call(c,T)||!Ne(s[T],c[T]))return!1}return!0}function Ie(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function qe(s,c){var d=Ie(s);s=0;for(var y;d;){if(d.nodeType===3){if(y=s+d.textContent.length,s<=c&&y>=c)return{node:d,offset:c-s};s=y}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=Ie(d)}}function Ge(s,c){return s&&c?s===c?!0:s&&s.nodeType===3?!1:c&&c.nodeType===3?Ge(s,c.parentNode):"contains"in s?s.contains(c):s.compareDocumentPosition?!!(s.compareDocumentPosition(c)&16):!1:!1}function $e(){for(var s=window,c=bt();c instanceof s.HTMLIFrameElement;){try{var d=typeof c.contentWindow.location.href=="string"}catch{d=!1}if(d)s=c.contentWindow;else break;c=bt(s.document)}return c}function at(s){var c=s&&s.nodeName&&s.nodeName.toLowerCase();return c&&(c==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||c==="textarea"||s.contentEditable==="true")}function st(s){var c=$e(),d=s.focusedElem,y=s.selectionRange;if(c!==d&&d&&d.ownerDocument&&Ge(d.ownerDocument.documentElement,d)){if(y!==null&&at(d)){if(c=y.start,s=y.end,s===void 0&&(s=c),"selectionStart"in d)d.selectionStart=c,d.selectionEnd=Math.min(s,d.value.length);else if(s=(c=d.ownerDocument||document)&&c.defaultView||window,s.getSelection){s=s.getSelection();var T=d.textContent.length,I=Math.min(y.start,T);y=y.end===void 0?I:Math.min(y.end,T),!s.extend&&I>y&&(T=y,y=I,I=T),T=qe(d,I);var Q=qe(d,y);T&&Q&&(s.rangeCount!==1||s.anchorNode!==T.node||s.anchorOffset!==T.offset||s.focusNode!==Q.node||s.focusOffset!==Q.offset)&&(c=c.createRange(),c.setStart(T.node,T.offset),s.removeAllRanges(),I>y?(s.addRange(c),s.extend(Q.node,Q.offset)):(c.setEnd(Q.node,Q.offset),s.addRange(c)))}}for(c=[],s=d;s=s.parentNode;)s.nodeType===1&&c.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<c.length;d++)s=c[d],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var ot=l&&"documentMode"in document&&11>=document.documentMode,ht=null,Tt=null,Mt=null,Ct=!1;function Rt(s,c,d){var y=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Ct||ht==null||ht!==bt(y)||(y=ht,"selectionStart"in y&&at(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),Mt&&Ke(Mt,y)||(Mt=y,y=zu(Tt,"onSelect"),0<y.length&&(c=new uo("onSelect","select",null,c,d),s.push({event:c,listeners:y}),c.target=ht)))}function Vt(s,c){var d={};return d[s.toLowerCase()]=c.toLowerCase(),d["Webkit"+s]="webkit"+c,d["Moz"+s]="moz"+c,d}var Ft={animationend:Vt("Animation","AnimationEnd"),animationiteration:Vt("Animation","AnimationIteration"),animationstart:Vt("Animation","AnimationStart"),transitionend:Vt("Transition","TransitionEnd")},Wt={},er={};l&&(er=document.createElement("div").style,"AnimationEvent"in window||(delete Ft.animationend.animation,delete Ft.animationiteration.animation,delete Ft.animationstart.animation),"TransitionEvent"in window||delete Ft.transitionend.transition);function tr(s){if(Wt[s])return Wt[s];if(!Ft[s])return s;var c=Ft[s],d;for(d in c)if(c.hasOwnProperty(d)&&d in er)return Wt[s]=c[d];return s}var lr=tr("animationend"),tn=tr("animationiteration"),br=tr("animationstart"),Gn=tr("transitionend"),Hn=new Map,go="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pn(s,c){Hn.set(s,c),i(c,[s])}for(var Pi=0;Pi<go.length;Pi++){var ya=go[Pi],As=ya.toLowerCase(),Bu=ya[0].toUpperCase()+ya.slice(1);Pn(As,"on"+Bu)}Pn(lr,"onAnimationEnd"),Pn(tn,"onAnimationIteration"),Pn(br,"onAnimationStart"),Pn("dblclick","onDoubleClick"),Pn("focusin","onFocus"),Pn("focusout","onBlur"),Pn(Gn,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var bl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),yh=new Set("cancel close invalid load scroll toggle".split(" ").concat(bl));function Zc(s,c,d){var y=s.type||"unknown-event";s.currentTarget=d,_e(y,c,void 0,s),s.currentTarget=null}function eu(s,c){c=(c&4)!==0;for(var d=0;d<s.length;d++){var y=s[d],T=y.event;y=y.listeners;e:{var I=void 0;if(c)for(var Q=y.length-1;0<=Q;Q--){var Pe=y[Q],je=Pe.instance,lt=Pe.currentTarget;if(Pe=Pe.listener,je!==I&&T.isPropagationStopped())break e;Zc(T,Pe,lt),I=je}else for(Q=0;Q<y.length;Q++){if(Pe=y[Q],je=Pe.instance,lt=Pe.currentTarget,Pe=Pe.listener,je!==I&&T.isPropagationStopped())break e;Zc(T,Pe,lt),I=je}}}if(X)throw s=be,X=!1,be=null,s}function An(s,c){var d=c[Fi];d===void 0&&(d=c[Fi]=new Set);var y=s+"__bubble";d.has(y)||(tu(c,s,2,!1),d.add(y))}function Uu(s,c,d){var y=0;c&&(y|=4),tu(d,s,y,c)}var mc="_reactListening"+Math.random().toString(36).slice(2);function $l(s){if(!s[mc]){s[mc]=!0,n.forEach(function(d){d!=="selectionchange"&&(yh.has(d)||Uu(d,!1,s),Uu(d,!0,s))});var c=s.nodeType===9?s:s.ownerDocument;c===null||c[mc]||(c[mc]=!0,Uu("selectionchange",!1,c))}}function tu(s,c,d,y){switch(ql(c)){case 1:var T=Oo;break;case 4:T=zl;break;default:T=ns}d=T.bind(null,c,d,s),T=void 0,!yn||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(T=!0),y?T!==void 0?s.addEventListener(c,d,{capture:!0,passive:T}):s.addEventListener(c,d,!0):T!==void 0?s.addEventListener(c,d,{passive:T}):s.addEventListener(c,d,!1)}function ru(s,c,d,y,T){var I=y;if((c&1)===0&&(c&2)===0&&y!==null)e:for(;;){if(y===null)return;var Q=y.tag;if(Q===3||Q===4){var Pe=y.stateNode.containerInfo;if(Pe===T||Pe.nodeType===8&&Pe.parentNode===T)break;if(Q===4)for(Q=y.return;Q!==null;){var je=Q.tag;if((je===3||je===4)&&(je=Q.stateNode.containerInfo,je===T||je.nodeType===8&&je.parentNode===T))return;Q=Q.return}for(;Pe!==null;){if(Q=_l(Pe),Q===null)return;if(je=Q.tag,je===5||je===6){y=I=Q;continue e}Pe=Pe.parentNode}}y=y.return}Sn(function(){var lt=I,Ot=ga(d),jt=[];e:{var Pt=Hn.get(s);if(Pt!==void 0){var rr=uo,sr=s;switch(s){case"keypress":if(Ti(d)===0)break e;case"keydown":case"keyup":rr=jr;break;case"focusin":sr="focus",rr=Es;break;case"focusout":sr="blur",rr=Es;break;case"beforeblur":case"afterblur":rr=Es;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":rr=Ss;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":rr=gc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":rr=Rn;break;case lr:case tn:case br:rr=is;break;case Gn:rr=va;break;case"scroll":rr=Io;break;case"wheel":rr=ss;break;case"copy":case"cut":case"paste":rr=S;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":rr=Yr}var dr=(c&4)!==0,ka=!dr&&s==="scroll",tt=dr?Pt!==null?Pt+"Capture":null:Pt;dr=[];for(var He=lt,it;He!==null;){it=He;var Ht=it.stateNode;if(it.tag===5&&Ht!==null&&(it=Ht,tt!==null&&(Ht=Gt(He,tt),Ht!=null&&dr.push(nu(He,Ht,it)))),ka)break;He=He.return}0<dr.length&&(Pt=new rr(Pt,sr,null,d,Ot),jt.push({event:Pt,listeners:dr}))}}if((c&7)===0){e:{if(Pt=s==="mouseover"||s==="pointerover",rr=s==="mouseout"||s==="pointerout",Pt&&d!==Lr&&(sr=d.relatedTarget||d.fromElement)&&(_l(sr)||sr[ei]))break e;if((rr||Pt)&&(Pt=Ot.window===Ot?Ot:(Pt=Ot.ownerDocument)?Pt.defaultView||Pt.parentWindow:window,rr?(sr=d.relatedTarget||d.toElement,rr=lt,sr=sr?_l(sr):null,sr!==null&&(ka=ke(sr),sr!==ka||sr.tag!==5&&sr.tag!==6)&&(sr=null)):(rr=null,sr=lt),rr!==sr)){if(dr=Ss,Ht="onMouseLeave",tt="onMouseEnter",He="mouse",(s==="pointerout"||s==="pointerover")&&(dr=Yr,Ht="onPointerLeave",tt="onPointerEnter",He="pointer"),ka=rr==null?Pt:Wl(rr),it=sr==null?Pt:Wl(sr),Pt=new dr(Ht,He+"leave",rr,d,Ot),Pt.target=ka,Pt.relatedTarget=it,Ht=null,_l(Ot)===lt&&(dr=new dr(tt,He+"enter",sr,d,Ot),dr.target=it,dr.relatedTarget=ka,Ht=dr),ka=Ht,rr&&sr)t:{for(dr=rr,tt=sr,He=0,it=dr;it;it=Hl(it))He++;for(it=0,Ht=tt;Ht;Ht=Hl(Ht))it++;for(;0<He-it;)dr=Hl(dr),He--;for(;0<it-He;)tt=Hl(tt),it--;for(;He--;){if(dr===tt||tt!==null&&dr===tt.alternate)break t;dr=Hl(dr),tt=Hl(tt)}dr=null}else dr=null;rr!==null&&wh(jt,Pt,rr,dr,!1),sr!==null&&ka!==null&&wh(jt,ka,sr,dr,!0)}}e:{if(Pt=lt?Wl(lt):window,rr=Pt.nodeName&&Pt.nodeName.toLowerCase(),rr==="select"||rr==="input"&&Pt.type==="file")var vr=jo;else if(po(Pt))if(v)vr=ze;else{vr=Ce;var Sr=ve}else(rr=Pt.nodeName)&&rr.toLowerCase()==="input"&&(Pt.type==="checkbox"||Pt.type==="radio")&&(vr=De);if(vr&&(vr=vr(s,lt))){La(jt,vr,d,Ot);break e}Sr&&Sr(s,Pt,lt),s==="focusout"&&(Sr=Pt._wrapperState)&&Sr.controlled&&Pt.type==="number"&&xt(Pt,"number",Pt.value)}switch(Sr=lt?Wl(lt):window,s){case"focusin":(po(Sr)||Sr.contentEditable==="true")&&(ht=Sr,Tt=lt,Mt=null);break;case"focusout":Mt=Tt=ht=null;break;case"mousedown":Ct=!0;break;case"contextmenu":case"mouseup":case"dragend":Ct=!1,Rt(jt,d,Ot);break;case"selectionchange":if(ot)break;case"keydown":case"keyup":Rt(jt,d,Ot)}var Er;if(Za)e:{switch(s){case"compositionstart":var Mr="onCompositionStart";break e;case"compositionend":Mr="onCompositionEnd";break e;case"compositionupdate":Mr="onCompositionUpdate";break e}Mr=void 0}else Br?Hs(s,d)&&(Mr="onCompositionEnd"):s==="keydown"&&d.keyCode===229&&(Mr="onCompositionStart");Mr&&(xl&&d.locale!=="ko"&&(Br||Mr!=="onCompositionStart"?Mr==="onCompositionEnd"&&Br&&(Er=gl()):(as=Ot,Ni="value"in as?as.value:as.textContent,Br=!0)),Sr=zu(lt,Mr),0<Sr.length&&(Mr=new Se(Mr,s,null,d,Ot),jt.push({event:Mr,listeners:Sr}),Er?Mr.data=Er:(Er=Ma(d),Er!==null&&(Mr.data=Er)))),(Er=vl?Vs(s,d):xa(s,d))&&(lt=zu(lt,"onBeforeInput"),0<lt.length&&(Ot=new Se("onBeforeInput","beforeinput",null,d,Ot),jt.push({event:Ot,listeners:lt}),Ot.data=Er))}eu(jt,c)})}function nu(s,c,d){return{instance:s,listener:c,currentTarget:d}}function zu(s,c){for(var d=c+"Capture",y=[];s!==null;){var T=s,I=T.stateNode;T.tag===5&&I!==null&&(T=I,I=Gt(s,d),I!=null&&y.unshift(nu(s,I,T)),I=Gt(s,c),I!=null&&y.push(nu(s,I,T))),s=s.return}return y}function Hl(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function wh(s,c,d,y,T){for(var I=c._reactName,Q=[];d!==null&&d!==y;){var Pe=d,je=Pe.alternate,lt=Pe.stateNode;if(je!==null&&je===y)break;Pe.tag===5&&lt!==null&&(Pe=lt,T?(je=Gt(d,I),je!=null&&Q.unshift(nu(d,je,Pe))):T||(je=Gt(d,I),je!=null&&Q.push(nu(d,je,Pe)))),d=d.return}Q.length!==0&&s.push({event:c,listeners:Q})}var Ep=/\r\n?/g,Ap=/\u0000|\uFFFD/g;function bh(s){return(typeof s=="string"?s:""+s).replace(Ep,`
`).replace(Ap,"")}function qu(s,c,d){if(c=bh(c),bh(s)!==c&&d)throw Error(r(425))}function vc(){}var au=null,Vl=null;function Wf(s,c){return s==="textarea"||s==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var Kf=typeof setTimeout=="function"?setTimeout:void 0,_h=typeof clearTimeout=="function"?clearTimeout:void 0,kh=typeof Promise=="function"?Promise:void 0,Np=typeof queueMicrotask=="function"?queueMicrotask:typeof kh<"u"?function(s){return kh.resolve(null).then(s).catch(Tp)}:Kf;function Tp(s){setTimeout(function(){throw s})}function Gf(s,c){var d=c,y=0;do{var T=d.nextSibling;if(s.removeChild(d),T&&T.nodeType===8)if(d=T.data,d==="/$"){if(y===0){s.removeChild(T),Ai(c);return}y--}else d!=="$"&&d!=="$?"&&d!=="$!"||y++;d=T}while(d);Ai(c)}function hi(s){for(;s!=null;s=s.nextSibling){var c=s.nodeType;if(c===1||c===3)break;if(c===8){if(c=s.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return s}function Ns(s){s=s.previousSibling;for(var c=0;s;){if(s.nodeType===8){var d=s.data;if(d==="$"||d==="$!"||d==="$?"){if(c===0)return s;c--}else d==="/$"&&c++}s=s.previousSibling}return null}var Li=Math.random().toString(36).slice(2),mo="__reactFiber$"+Li,xc="__reactProps$"+Li,ei="__reactContainer$"+Li,Fi="__reactEvents$"+Li,Cp="__reactListeners$"+Li,Pp="__reactHandles$"+Li;function _l(s){var c=s[mo];if(c)return c;for(var d=s.parentNode;d;){if(c=d[ei]||d[mo]){if(d=c.alternate,c.child!==null||d!==null&&d.child!==null)for(s=Ns(s);s!==null;){if(d=s[mo])return d;s=Ns(s)}return c}s=d,d=s.parentNode}return null}function yc(s){return s=s[mo]||s[ei],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function Wl(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(r(33))}function iu(s){return s[xc]||null}var Yf=[],Mo=-1;function Ks(s){return{current:s}}function wn(s){0>Mo||(s.current=Yf[Mo],Yf[Mo]=null,Mo--)}function _n(s,c){Mo++,Yf[Mo]=s.current,s.current=c}var kl={},Ba=Ks(kl),Oi=Ks(!1),Kl=kl;function wc(s,c){var d=s.type.contextTypes;if(!d)return kl;var y=s.stateNode;if(y&&y.__reactInternalMemoizedUnmaskedChildContext===c)return y.__reactInternalMemoizedMaskedChildContext;var T={},I;for(I in d)T[I]=c[I];return y&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=c,s.__reactInternalMemoizedMaskedChildContext=T),T}function Ii(s){return s=s.childContextTypes,s!=null}function $u(){wn(Oi),wn(Ba)}function Sh(s,c,d){if(Ba.current!==kl)throw Error(r(168));_n(Ba,c),_n(Oi,d)}function Xf(s,c,d){var y=s.stateNode;if(c=c.childContextTypes,typeof y.getChildContext!="function")return d;y=y.getChildContext();for(var T in y)if(!(T in c))throw Error(r(108,xe(s)||"Unknown",T));return Ee({},d,y)}function Gl(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||kl,Kl=Ba.current,_n(Ba,s),_n(Oi,Oi.current),!0}function Eh(s,c,d){var y=s.stateNode;if(!y)throw Error(r(169));d?(s=Xf(s,c,Kl),y.__reactInternalMemoizedMergedChildContext=s,wn(Oi),wn(Ba),_n(Ba,s)):wn(Oi),_n(Oi,d)}var Bo=null,su=!1,p=!1;function w(s){Bo===null?Bo=[s]:Bo.push(s)}function P(s){su=!0,w(s)}function R(){if(!p&&Bo!==null){p=!0;var s=0,c=sn;try{var d=Bo;for(sn=1;s<d.length;s++){var y=d[s];do y=y(!0);while(y!==null)}Bo=null,su=!1}catch(T){throw Bo!==null&&(Bo=Bo.slice(s+1)),St(Kr,R),T}finally{sn=c,p=!1}}return null}var W=[],J=0,ee=null,ae=0,oe=[],ge=0,Re=null,Ze=1,et="";function We(s,c){W[J++]=ae,W[J++]=ee,ee=s,ae=c}function yt(s,c,d){oe[ge++]=Ze,oe[ge++]=et,oe[ge++]=Re,Re=s;var y=Ze;s=et;var T=32-pr(y)-1;y&=~(1<<T),d+=1;var I=32-pr(c)+T;if(30<I){var Q=T-T%5;I=(y&(1<<Q)-1).toString(32),y>>=Q,T-=Q,Ze=1<<32-pr(c)+T|d<<T|y,et=I+s}else Ze=1<<I|d<<T|y,et=s}function ft(s){s.return!==null&&(We(s,1),yt(s,1,0))}function Be(s){for(;s===ee;)ee=W[--J],W[J]=null,ae=W[--J],W[J]=null;for(;s===Re;)Re=oe[--ge],oe[ge]=null,et=oe[--ge],oe[ge]=null,Ze=oe[--ge],oe[ge]=null}var Ue=null,gt=null,pt=!1,vt=null;function Zt(s,c){var d=_o(5,null,null,0);d.elementType="DELETED",d.stateNode=c,d.return=s,c=s.deletions,c===null?(s.deletions=[d],s.flags|=16):c.push(d)}function Kt(s,c){switch(s.tag){case 5:var d=s.type;return c=c.nodeType!==1||d.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(s.stateNode=c,Ue=s,gt=hi(c.firstChild),!0):!1;case 6:return c=s.pendingProps===""||c.nodeType!==3?null:c,c!==null?(s.stateNode=c,Ue=s,gt=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(d=Re!==null?{id:Ze,overflow:et}:null,s.memoizedState={dehydrated:c,treeContext:d,retryLane:1073741824},d=_o(18,null,null,0),d.stateNode=c,d.return=s,s.child=d,Ue=s,gt=null,!0):!1;default:return!1}}function _r(s){return(s.mode&1)!==0&&(s.flags&128)===0}function Yt(s){if(pt){var c=gt;if(c){var d=c;if(!Kt(s,c)){if(_r(s))throw Error(r(418));c=hi(d.nextSibling);var y=Ue;c&&Kt(s,c)?Zt(y,d):(s.flags=s.flags&-4097|2,pt=!1,Ue=s)}}else{if(_r(s))throw Error(r(418));s.flags=s.flags&-4097|2,pt=!1,Ue=s}}}function cn(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;Ue=s}function un(s){if(s!==Ue)return!1;if(!pt)return cn(s),pt=!0,!1;var c;if((c=s.tag!==3)&&!(c=s.tag!==5)&&(c=s.type,c=c!=="head"&&c!=="body"&&!Wf(s.type,s.memoizedProps)),c&&(c=gt)){if(_r(s))throw rn(),Error(r(418));for(;c;)Zt(s,c),c=hi(c.nextSibling)}if(cn(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));e:{for(s=s.nextSibling,c=0;s;){if(s.nodeType===8){var d=s.data;if(d==="/$"){if(c===0){gt=hi(s.nextSibling);break e}c--}else d!=="$"&&d!=="$!"&&d!=="$?"||c++}s=s.nextSibling}gt=null}}else gt=Ue?hi(s.stateNode.nextSibling):null;return!0}function rn(){for(var s=gt;s;)s=hi(s.nextSibling)}function Hr(){gt=Ue=null,pt=!1}function bn(s){vt===null?vt=[s]:vt.push(s)}var kn=K.ReactCurrentBatchConfig;function Ir(s,c,d){if(s=d.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(r(309));var y=d.stateNode}if(!y)throw Error(r(147,s));var T=y,I=""+s;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===I?c.ref:(c=function(Q){var Pe=T.refs;Q===null?delete Pe[I]:Pe[I]=Q},c._stringRef=I,c)}if(typeof s!="string")throw Error(r(284));if(!d._owner)throw Error(r(290,s))}return s}function Yn(s,c){throw s=Object.prototype.toString.call(c),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":s))}function di(s){var c=s._init;return c(s._payload)}function sa(s){function c(tt,He){if(s){var it=tt.deletions;it===null?(tt.deletions=[He],tt.flags|=16):it.push(He)}}function d(tt,He){if(!s)return null;for(;He!==null;)c(tt,He),He=He.sibling;return null}function y(tt,He){for(tt=new Map;He!==null;)He.key!==null?tt.set(He.key,He):tt.set(He.index,He),He=He.sibling;return tt}function T(tt,He){return tt=Fc(tt,He),tt.index=0,tt.sibling=null,tt}function I(tt,He,it){return tt.index=it,s?(it=tt.alternate,it!==null?(it=it.index,it<He?(tt.flags|=2,He):it):(tt.flags|=2,He)):(tt.flags|=1048576,He)}function Q(tt){return s&&tt.alternate===null&&(tt.flags|=2),tt}function Pe(tt,He,it,Ht){return He===null||He.tag!==6?(He=i1(it,tt.mode,Ht),He.return=tt,He):(He=T(He,it),He.return=tt,He)}function je(tt,He,it,Ht){var vr=it.type;return vr===B?Ot(tt,He,it.props.children,Ht,it.key):He!==null&&(He.elementType===vr||typeof vr=="object"&&vr!==null&&vr.$$typeof===Fe&&di(vr)===He.type)?(Ht=T(He,it.props),Ht.ref=Ir(tt,He,it),Ht.return=tt,Ht):(Ht=Vh(it.type,it.key,it.props,null,tt.mode,Ht),Ht.ref=Ir(tt,He,it),Ht.return=tt,Ht)}function lt(tt,He,it,Ht){return He===null||He.tag!==4||He.stateNode.containerInfo!==it.containerInfo||He.stateNode.implementation!==it.implementation?(He=s1(it,tt.mode,Ht),He.return=tt,He):(He=T(He,it.children||[]),He.return=tt,He)}function Ot(tt,He,it,Ht,vr){return He===null||He.tag!==7?(He=pu(it,tt.mode,Ht,vr),He.return=tt,He):(He=T(He,it),He.return=tt,He)}function jt(tt,He,it){if(typeof He=="string"&&He!==""||typeof He=="number")return He=i1(""+He,tt.mode,it),He.return=tt,He;if(typeof He=="object"&&He!==null){switch(He.$$typeof){case te:return it=Vh(He.type,He.key,He.props,null,tt.mode,it),it.ref=Ir(tt,null,He),it.return=tt,it;case re:return He=s1(He,tt.mode,it),He.return=tt,He;case Fe:var Ht=He._init;return jt(tt,Ht(He._payload),it)}if(_t(He)||ne(He))return He=pu(He,tt.mode,it,null),He.return=tt,He;Yn(tt,He)}return null}function Pt(tt,He,it,Ht){var vr=He!==null?He.key:null;if(typeof it=="string"&&it!==""||typeof it=="number")return vr!==null?null:Pe(tt,He,""+it,Ht);if(typeof it=="object"&&it!==null){switch(it.$$typeof){case te:return it.key===vr?je(tt,He,it,Ht):null;case re:return it.key===vr?lt(tt,He,it,Ht):null;case Fe:return vr=it._init,Pt(tt,He,vr(it._payload),Ht)}if(_t(it)||ne(it))return vr!==null?null:Ot(tt,He,it,Ht,null);Yn(tt,it)}return null}function rr(tt,He,it,Ht,vr){if(typeof Ht=="string"&&Ht!==""||typeof Ht=="number")return tt=tt.get(it)||null,Pe(He,tt,""+Ht,vr);if(typeof Ht=="object"&&Ht!==null){switch(Ht.$$typeof){case te:return tt=tt.get(Ht.key===null?it:Ht.key)||null,je(He,tt,Ht,vr);case re:return tt=tt.get(Ht.key===null?it:Ht.key)||null,lt(He,tt,Ht,vr);case Fe:var Sr=Ht._init;return rr(tt,He,it,Sr(Ht._payload),vr)}if(_t(Ht)||ne(Ht))return tt=tt.get(it)||null,Ot(He,tt,Ht,vr,null);Yn(He,Ht)}return null}function sr(tt,He,it,Ht){for(var vr=null,Sr=null,Er=He,Mr=He=0,ai=null;Er!==null&&Mr<it.length;Mr++){Er.index>Mr?(ai=Er,Er=null):ai=Er.sibling;var xn=Pt(tt,Er,it[Mr],Ht);if(xn===null){Er===null&&(Er=ai);break}s&&Er&&xn.alternate===null&&c(tt,Er),He=I(xn,He,Mr),Sr===null?vr=xn:Sr.sibling=xn,Sr=xn,Er=ai}if(Mr===it.length)return d(tt,Er),pt&&We(tt,Mr),vr;if(Er===null){for(;Mr<it.length;Mr++)Er=jt(tt,it[Mr],Ht),Er!==null&&(He=I(Er,He,Mr),Sr===null?vr=Er:Sr.sibling=Er,Sr=Er);return pt&&We(tt,Mr),vr}for(Er=y(tt,Er);Mr<it.length;Mr++)ai=rr(Er,tt,Mr,it[Mr],Ht),ai!==null&&(s&&ai.alternate!==null&&Er.delete(ai.key===null?Mr:ai.key),He=I(ai,He,Mr),Sr===null?vr=ai:Sr.sibling=ai,Sr=ai);return s&&Er.forEach(function(Oc){return c(tt,Oc)}),pt&&We(tt,Mr),vr}function dr(tt,He,it,Ht){var vr=ne(it);if(typeof vr!="function")throw Error(r(150));if(it=vr.call(it),it==null)throw Error(r(151));for(var Sr=vr=null,Er=He,Mr=He=0,ai=null,xn=it.next();Er!==null&&!xn.done;Mr++,xn=it.next()){Er.index>Mr?(ai=Er,Er=null):ai=Er.sibling;var Oc=Pt(tt,Er,xn.value,Ht);if(Oc===null){Er===null&&(Er=ai);break}s&&Er&&Oc.alternate===null&&c(tt,Er),He=I(Oc,He,Mr),Sr===null?vr=Oc:Sr.sibling=Oc,Sr=Oc,Er=ai}if(xn.done)return d(tt,Er),pt&&We(tt,Mr),vr;if(Er===null){for(;!xn.done;Mr++,xn=it.next())xn=jt(tt,xn.value,Ht),xn!==null&&(He=I(xn,He,Mr),Sr===null?vr=xn:Sr.sibling=xn,Sr=xn);return pt&&We(tt,Mr),vr}for(Er=y(tt,Er);!xn.done;Mr++,xn=it.next())xn=rr(Er,tt,Mr,xn.value,Ht),xn!==null&&(s&&xn.alternate!==null&&Er.delete(xn.key===null?Mr:xn.key),He=I(xn,He,Mr),Sr===null?vr=xn:Sr.sibling=xn,Sr=xn);return s&&Er.forEach(function(w_){return c(tt,w_)}),pt&&We(tt,Mr),vr}function ka(tt,He,it,Ht){if(typeof it=="object"&&it!==null&&it.type===B&&it.key===null&&(it=it.props.children),typeof it=="object"&&it!==null){switch(it.$$typeof){case te:e:{for(var vr=it.key,Sr=He;Sr!==null;){if(Sr.key===vr){if(vr=it.type,vr===B){if(Sr.tag===7){d(tt,Sr.sibling),He=T(Sr,it.props.children),He.return=tt,tt=He;break e}}else if(Sr.elementType===vr||typeof vr=="object"&&vr!==null&&vr.$$typeof===Fe&&di(vr)===Sr.type){d(tt,Sr.sibling),He=T(Sr,it.props),He.ref=Ir(tt,Sr,it),He.return=tt,tt=He;break e}d(tt,Sr);break}else c(tt,Sr);Sr=Sr.sibling}it.type===B?(He=pu(it.props.children,tt.mode,Ht,it.key),He.return=tt,tt=He):(Ht=Vh(it.type,it.key,it.props,null,tt.mode,Ht),Ht.ref=Ir(tt,He,it),Ht.return=tt,tt=Ht)}return Q(tt);case re:e:{for(Sr=it.key;He!==null;){if(He.key===Sr)if(He.tag===4&&He.stateNode.containerInfo===it.containerInfo&&He.stateNode.implementation===it.implementation){d(tt,He.sibling),He=T(He,it.children||[]),He.return=tt,tt=He;break e}else{d(tt,He);break}else c(tt,He);He=He.sibling}He=s1(it,tt.mode,Ht),He.return=tt,tt=He}return Q(tt);case Fe:return Sr=it._init,ka(tt,He,Sr(it._payload),Ht)}if(_t(it))return sr(tt,He,it,Ht);if(ne(it))return dr(tt,He,it,Ht);Yn(tt,it)}return typeof it=="string"&&it!==""||typeof it=="number"?(it=""+it,He!==null&&He.tag===6?(d(tt,He.sibling),He=T(He,it),He.return=tt,tt=He):(d(tt,He),He=i1(it,tt.mode,Ht),He.return=tt,tt=He),Q(tt)):d(tt,He)}return ka}var wa=sa(!0),mn=sa(!1),ti=Ks(null),ri=null,Xn=null,ba=null;function Ua(){ba=Xn=ri=null}function Ri(s){var c=ti.current;wn(ti),s._currentValue=c}function Ts(s,c,d){for(;s!==null;){var y=s.alternate;if((s.childLanes&c)!==c?(s.childLanes|=c,y!==null&&(y.childLanes|=c)):y!==null&&(y.childLanes&c)!==c&&(y.childLanes|=c),s===d)break;s=s.return}}function Jn(s,c){ri=s,ba=Xn=null,s=s.dependencies,s!==null&&s.firstContext!==null&&((s.lanes&c)!==0&&(Fs=!0),s.firstContext=null)}function la(s){var c=s._currentValue;if(ba!==s)if(s={context:s,memoizedValue:c,next:null},Xn===null){if(ri===null)throw Error(r(308));Xn=s,ri.dependencies={lanes:0,firstContext:s}}else Xn=Xn.next=s;return c}var ls=null;function Sl(s){ls===null?ls=[s]:ls.push(s)}function Uo(s,c,d,y){var T=c.interleaved;return T===null?(d.next=d,Sl(c)):(d.next=T.next,T.next=d),c.interleaved=d,vn(s,y)}function vn(s,c){s.lanes|=c;var d=s.alternate;for(d!==null&&(d.lanes|=c),d=s,s=s.return;s!==null;)s.childLanes|=c,d=s.alternate,d!==null&&(d.childLanes|=c),d=s,s=s.return;return d.tag===3?d.stateNode:null}var vo=!1;function Hu(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Jf(s,c){s=s.updateQueue,c.updateQueue===s&&(c.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function Cs(s,c){return{eventTime:s,lane:c,tag:0,payload:null,callback:null,next:null}}function Ps(s,c,d){var y=s.updateQueue;if(y===null)return null;if(y=y.shared,(dn&2)!==0){var T=y.pending;return T===null?c.next=c:(c.next=T.next,T.next=c),y.pending=c,vn(s,d)}return T=y.interleaved,T===null?(c.next=c,Sl(y)):(c.next=T.next,T.next=c),y.interleaved=c,vn(s,d)}function Yl(s,c,d){if(c=c.updateQueue,c!==null&&(c=c.shared,(d&4194240)!==0)){var y=c.lanes;y&=s.pendingLanes,d|=y,c.lanes=d,Po(s,d)}}function Ls(s,c){var d=s.updateQueue,y=s.alternate;if(y!==null&&(y=y.updateQueue,d===y)){var T=null,I=null;if(d=d.firstBaseUpdate,d!==null){do{var Q={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};I===null?T=I=Q:I=I.next=Q,d=d.next}while(d!==null);I===null?T=I=c:I=I.next=c}else T=I=c;d={baseState:y.baseState,firstBaseUpdate:T,lastBaseUpdate:I,shared:y.shared,effects:y.effects},s.updateQueue=d;return}s=d.lastBaseUpdate,s===null?d.firstBaseUpdate=c:s.next=c,d.lastBaseUpdate=c}function zo(s,c,d,y){var T=s.updateQueue;vo=!1;var I=T.firstBaseUpdate,Q=T.lastBaseUpdate,Pe=T.shared.pending;if(Pe!==null){T.shared.pending=null;var je=Pe,lt=je.next;je.next=null,Q===null?I=lt:Q.next=lt,Q=je;var Ot=s.alternate;Ot!==null&&(Ot=Ot.updateQueue,Pe=Ot.lastBaseUpdate,Pe!==Q&&(Pe===null?Ot.firstBaseUpdate=lt:Pe.next=lt,Ot.lastBaseUpdate=je))}if(I!==null){var jt=T.baseState;Q=0,Ot=lt=je=null,Pe=I;do{var Pt=Pe.lane,rr=Pe.eventTime;if((y&Pt)===Pt){Ot!==null&&(Ot=Ot.next={eventTime:rr,lane:0,tag:Pe.tag,payload:Pe.payload,callback:Pe.callback,next:null});e:{var sr=s,dr=Pe;switch(Pt=c,rr=d,dr.tag){case 1:if(sr=dr.payload,typeof sr=="function"){jt=sr.call(rr,jt,Pt);break e}jt=sr;break e;case 3:sr.flags=sr.flags&-65537|128;case 0:if(sr=dr.payload,Pt=typeof sr=="function"?sr.call(rr,jt,Pt):sr,Pt==null)break e;jt=Ee({},jt,Pt);break e;case 2:vo=!0}}Pe.callback!==null&&Pe.lane!==0&&(s.flags|=64,Pt=T.effects,Pt===null?T.effects=[Pe]:Pt.push(Pe))}else rr={eventTime:rr,lane:Pt,tag:Pe.tag,payload:Pe.payload,callback:Pe.callback,next:null},Ot===null?(lt=Ot=rr,je=jt):Ot=Ot.next=rr,Q|=Pt;if(Pe=Pe.next,Pe===null){if(Pe=T.shared.pending,Pe===null)break;Pt=Pe,Pe=Pt.next,Pt.next=null,T.lastBaseUpdate=Pt,T.shared.pending=null}}while(!0);if(Ot===null&&(je=jt),T.baseState=je,T.firstBaseUpdate=lt,T.lastBaseUpdate=Ot,c=T.shared.interleaved,c!==null){T=c;do Q|=T.lane,T=T.next;while(T!==c)}else I===null&&(T.shared.lanes=0);uu|=Q,s.lanes=Q,s.memoizedState=jt}}function Xl(s,c,d){if(s=c.effects,c.effects=null,s!==null)for(c=0;c<s.length;c++){var y=s[c],T=y.callback;if(T!==null){if(y.callback=null,y=d,typeof T!="function")throw Error(r(191,T));T.call(y)}}}var bc={},cs=Ks(bc),_c=Ks(bc),El=Ks(bc);function qo(s){if(s===bc)throw Error(r(174));return s}function kc(s,c){switch(_n(El,c),_n(_c,s),_n(cs,bc),s=c.nodeType,s){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:yr(null,"");break;default:s=s===8?c.parentNode:c,c=s.namespaceURI||null,s=s.tagName,c=yr(c,s)}wn(cs),_n(cs,c)}function xo(){wn(cs),wn(_c),wn(El)}function Ah(s){qo(El.current);var c=qo(cs.current),d=yr(c,s.type);c!==d&&(_n(_c,s),_n(cs,d))}function Qf(s){_c.current===s&&(wn(cs),wn(_c))}var Dn=Ks(0);function Gs(s){for(var c=s;c!==null;){if(c.tag===13){var d=c.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var Zf=[];function e0(){for(var s=0;s<Zf.length;s++)Zf[s]._workInProgressVersionPrimary=null;Zf.length=0}var Vu=K.ReactCurrentDispatcher,Wu=K.ReactCurrentBatchConfig,yo=0,Vn=null,ca=null,oa=null,Sc=!1,$o=!1,Ec=0,Lp=0;function _a(){throw Error(r(321))}function Ku(s,c){if(c===null)return!1;for(var d=0;d<c.length&&d<s.length;d++)if(!Ne(s[d],c[d]))return!1;return!0}function ou(s,c,d,y,T,I){if(yo=I,Vn=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,Vu.current=s===null||s.memoizedState===null?Wb:Kb,s=d(y,T),$o){I=0;do{if($o=!1,Ec=0,25<=I)throw Error(r(301));I+=1,oa=ca=null,c.updateQueue=null,Vu.current=Gb,s=d(y,T)}while($o)}if(Vu.current=Lh,c=ca!==null&&ca.next!==null,yo=0,oa=ca=Vn=null,Sc=!1,c)throw Error(r(300));return s}function wo(){var s=Ec!==0;return Ec=0,s}function Ys(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return oa===null?Vn.memoizedState=oa=s:oa=oa.next=s,oa}function us(){if(ca===null){var s=Vn.alternate;s=s!==null?s.memoizedState:null}else s=ca.next;var c=oa===null?Vn.memoizedState:oa.next;if(c!==null)oa=c,ca=s;else{if(s===null)throw Error(r(310));ca=s,s={memoizedState:ca.memoizedState,baseState:ca.baseState,baseQueue:ca.baseQueue,queue:ca.queue,next:null},oa===null?Vn.memoizedState=oa=s:oa=oa.next=s}return oa}function lu(s,c){return typeof c=="function"?c(s):c}function Gu(s){var c=us(),d=c.queue;if(d===null)throw Error(r(311));d.lastRenderedReducer=s;var y=ca,T=y.baseQueue,I=d.pending;if(I!==null){if(T!==null){var Q=T.next;T.next=I.next,I.next=Q}y.baseQueue=T=I,d.pending=null}if(T!==null){I=T.next,y=y.baseState;var Pe=Q=null,je=null,lt=I;do{var Ot=lt.lane;if((yo&Ot)===Ot)je!==null&&(je=je.next={lane:0,action:lt.action,hasEagerState:lt.hasEagerState,eagerState:lt.eagerState,next:null}),y=lt.hasEagerState?lt.eagerState:s(y,lt.action);else{var jt={lane:Ot,action:lt.action,hasEagerState:lt.hasEagerState,eagerState:lt.eagerState,next:null};je===null?(Pe=je=jt,Q=y):je=je.next=jt,Vn.lanes|=Ot,uu|=Ot}lt=lt.next}while(lt!==null&&lt!==I);je===null?Q=y:je.next=Pe,Ne(y,c.memoizedState)||(Fs=!0),c.memoizedState=y,c.baseState=Q,c.baseQueue=je,d.lastRenderedState=y}if(s=d.interleaved,s!==null){T=s;do I=T.lane,Vn.lanes|=I,uu|=I,T=T.next;while(T!==s)}else T===null&&(d.lanes=0);return[c.memoizedState,d.dispatch]}function Al(s){var c=us(),d=c.queue;if(d===null)throw Error(r(311));d.lastRenderedReducer=s;var y=d.dispatch,T=d.pending,I=c.memoizedState;if(T!==null){d.pending=null;var Q=T=T.next;do I=s(I,Q.action),Q=Q.next;while(Q!==T);Ne(I,c.memoizedState)||(Fs=!0),c.memoizedState=I,c.baseQueue===null&&(c.baseState=I),d.lastRenderedState=I}return[I,y]}function Nh(){}function t0(s,c){var d=Vn,y=us(),T=c(),I=!Ne(y.memoizedState,T);if(I&&(y.memoizedState=T,Fs=!0),y=y.queue,Ju(Ch.bind(null,d,y,s),[s]),y.getSnapshot!==c||I||oa!==null&&oa.memoizedState.tag&1){if(d.flags|=2048,fs(9,r0.bind(null,d,y,T,c),void 0,null),ni===null)throw Error(r(349));(yo&30)!==0||Th(d,c,T)}return T}function Th(s,c,d){s.flags|=16384,s={getSnapshot:c,value:d},c=Vn.updateQueue,c===null?(c={lastEffect:null,stores:null},Vn.updateQueue=c,c.stores=[s]):(d=c.stores,d===null?c.stores=[s]:d.push(s))}function r0(s,c,d,y){c.value=d,c.getSnapshot=y,Ac(c)&&Yu(s)}function Ch(s,c,d){return d(function(){Ac(c)&&Yu(s)})}function Ac(s){var c=s.getSnapshot;s=s.value;try{var d=c();return!Ne(s,d)}catch{return!0}}function Yu(s){var c=vn(s,1);c!==null&&Go(c,s,1,-1)}function cu(s){var c=Ys();return typeof s=="function"&&(s=s()),c.memoizedState=c.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:lu,lastRenderedState:s},c.queue=s,s=s.dispatch=Vb.bind(null,Vn,s),[c.memoizedState,s]}function fs(s,c,d,y){return s={tag:s,create:c,destroy:d,deps:y,next:null},c=Vn.updateQueue,c===null?(c={lastEffect:null,stores:null},Vn.updateQueue=c,c.lastEffect=s.next=s):(d=c.lastEffect,d===null?c.lastEffect=s.next=s:(y=d.next,d.next=s,s.next=y,c.lastEffect=s)),s}function Ho(){return us().memoizedState}function Xs(s,c,d,y){var T=Ys();Vn.flags|=s,T.memoizedState=fs(1|c,d,void 0,y===void 0?null:y)}function Jl(s,c,d,y){var T=us();y=y===void 0?null:y;var I=void 0;if(ca!==null){var Q=ca.memoizedState;if(I=Q.destroy,y!==null&&Ku(y,Q.deps)){T.memoizedState=fs(c,d,I,y);return}}Vn.flags|=s,T.memoizedState=fs(1|c,d,I,y)}function Xu(s,c){return Xs(8390656,8,s,c)}function Ju(s,c){return Jl(2048,8,s,c)}function Ph(s,c){return Jl(4,2,s,c)}function Qu(s,c){return Jl(4,4,s,c)}function Zu(s,c){if(typeof c=="function")return s=s(),c(s),function(){c(null)};if(c!=null)return s=s(),c.current=s,function(){c.current=null}}function Vm(s,c,d){return d=d!=null?d.concat([s]):null,Jl(4,4,Zu.bind(null,c,s),d)}function Fp(){}function Wm(s,c){var d=us();c=c===void 0?null:c;var y=d.memoizedState;return y!==null&&c!==null&&Ku(c,y[1])?y[0]:(d.memoizedState=[s,c],s)}function Km(s,c){var d=us();c=c===void 0?null:c;var y=d.memoizedState;return y!==null&&c!==null&&Ku(c,y[1])?y[0]:(s=s(),d.memoizedState=[s,c],s)}function Gm(s,c,d){return(yo&21)===0?(s.baseState&&(s.baseState=!1,Fs=!0),s.memoizedState=d):(Ne(d,c)||(d=hl(),Vn.lanes|=d,uu|=d,s.baseState=!0),c)}function $b(s,c){var d=sn;sn=d!==0&&4>d?d:4,s(!0);var y=Wu.transition;Wu.transition={};try{s(!1),c()}finally{sn=d,Wu.transition=y}}function Ym(){return us().memoizedState}function Hb(s,c,d){var y=Pc(s);if(d={lane:y,action:d,hasEagerState:!1,eagerState:null,next:null},Xm(s))Jm(c,d);else if(d=Uo(s,c,d,y),d!==null){var T=ds();Go(d,s,y,T),Qm(d,c,y)}}function Vb(s,c,d){var y=Pc(s),T={lane:y,action:d,hasEagerState:!1,eagerState:null,next:null};if(Xm(s))Jm(c,T);else{var I=s.alternate;if(s.lanes===0&&(I===null||I.lanes===0)&&(I=c.lastRenderedReducer,I!==null))try{var Q=c.lastRenderedState,Pe=I(Q,d);if(T.hasEagerState=!0,T.eagerState=Pe,Ne(Pe,Q)){var je=c.interleaved;je===null?(T.next=T,Sl(c)):(T.next=je.next,je.next=T),c.interleaved=T;return}}catch{}finally{}d=Uo(s,c,T,y),d!==null&&(T=ds(),Go(d,s,y,T),Qm(d,c,y))}}function Xm(s){var c=s.alternate;return s===Vn||c!==null&&c===Vn}function Jm(s,c){$o=Sc=!0;var d=s.pending;d===null?c.next=c:(c.next=d.next,d.next=c),s.pending=c}function Qm(s,c,d){if((d&4194240)!==0){var y=c.lanes;y&=s.pendingLanes,d|=y,c.lanes=d,Po(s,d)}}var Lh={readContext:la,useCallback:_a,useContext:_a,useEffect:_a,useImperativeHandle:_a,useInsertionEffect:_a,useLayoutEffect:_a,useMemo:_a,useReducer:_a,useRef:_a,useState:_a,useDebugValue:_a,useDeferredValue:_a,useTransition:_a,useMutableSource:_a,useSyncExternalStore:_a,useId:_a,unstable_isNewReconciler:!1},Wb={readContext:la,useCallback:function(s,c){return Ys().memoizedState=[s,c===void 0?null:c],s},useContext:la,useEffect:Xu,useImperativeHandle:function(s,c,d){return d=d!=null?d.concat([s]):null,Xs(4194308,4,Zu.bind(null,c,s),d)},useLayoutEffect:function(s,c){return Xs(4194308,4,s,c)},useInsertionEffect:function(s,c){return Xs(4,2,s,c)},useMemo:function(s,c){var d=Ys();return c=c===void 0?null:c,s=s(),d.memoizedState=[s,c],s},useReducer:function(s,c,d){var y=Ys();return c=d!==void 0?d(c):c,y.memoizedState=y.baseState=c,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:c},y.queue=s,s=s.dispatch=Hb.bind(null,Vn,s),[y.memoizedState,s]},useRef:function(s){var c=Ys();return s={current:s},c.memoizedState=s},useState:cu,useDebugValue:Fp,useDeferredValue:function(s){return Ys().memoizedState=s},useTransition:function(){var s=cu(!1),c=s[0];return s=$b.bind(null,s[1]),Ys().memoizedState=s,[c,s]},useMutableSource:function(){},useSyncExternalStore:function(s,c,d){var y=Vn,T=Ys();if(pt){if(d===void 0)throw Error(r(407));d=d()}else{if(d=c(),ni===null)throw Error(r(349));(yo&30)!==0||Th(y,c,d)}T.memoizedState=d;var I={value:d,getSnapshot:c};return T.queue=I,Xu(Ch.bind(null,y,I,s),[s]),y.flags|=2048,fs(9,r0.bind(null,y,I,d,c),void 0,null),d},useId:function(){var s=Ys(),c=ni.identifierPrefix;if(pt){var d=et,y=Ze;d=(y&~(1<<32-pr(y)-1)).toString(32)+d,c=":"+c+"R"+d,d=Ec++,0<d&&(c+="H"+d.toString(32)),c+=":"}else d=Lp++,c=":"+c+"r"+d.toString(32)+":";return s.memoizedState=c},unstable_isNewReconciler:!1},Kb={readContext:la,useCallback:Wm,useContext:la,useEffect:Ju,useImperativeHandle:Vm,useInsertionEffect:Ph,useLayoutEffect:Qu,useMemo:Km,useReducer:Gu,useRef:Ho,useState:function(){return Gu(lu)},useDebugValue:Fp,useDeferredValue:function(s){var c=us();return Gm(c,ca.memoizedState,s)},useTransition:function(){var s=Gu(lu)[0],c=us().memoizedState;return[s,c]},useMutableSource:Nh,useSyncExternalStore:t0,useId:Ym,unstable_isNewReconciler:!1},Gb={readContext:la,useCallback:Wm,useContext:la,useEffect:Ju,useImperativeHandle:Vm,useInsertionEffect:Ph,useLayoutEffect:Qu,useMemo:Km,useReducer:Al,useRef:Ho,useState:function(){return Al(lu)},useDebugValue:Fp,useDeferredValue:function(s){var c=us();return ca===null?c.memoizedState=s:Gm(c,ca.memoizedState,s)},useTransition:function(){var s=Al(lu)[0],c=us().memoizedState;return[s,c]},useMutableSource:Nh,useSyncExternalStore:t0,useId:Ym,unstable_isNewReconciler:!1};function Vo(s,c){if(s&&s.defaultProps){c=Ee({},c),s=s.defaultProps;for(var d in s)c[d]===void 0&&(c[d]=s[d]);return c}return c}function Op(s,c,d,y){c=s.memoizedState,d=d(y,c),d=d==null?c:Ee({},c,d),s.memoizedState=d,s.lanes===0&&(s.updateQueue.baseState=d)}var Fh={isMounted:function(s){return(s=s._reactInternals)?ke(s)===s:!1},enqueueSetState:function(s,c,d){s=s._reactInternals;var y=ds(),T=Pc(s),I=Cs(y,T);I.payload=c,d!=null&&(I.callback=d),c=Ps(s,I,T),c!==null&&(Go(c,s,T,y),Yl(c,s,T))},enqueueReplaceState:function(s,c,d){s=s._reactInternals;var y=ds(),T=Pc(s),I=Cs(y,T);I.tag=1,I.payload=c,d!=null&&(I.callback=d),c=Ps(s,I,T),c!==null&&(Go(c,s,T,y),Yl(c,s,T))},enqueueForceUpdate:function(s,c){s=s._reactInternals;var d=ds(),y=Pc(s),T=Cs(d,y);T.tag=2,c!=null&&(T.callback=c),c=Ps(s,T,y),c!==null&&(Go(c,s,y,d),Yl(c,s,y))}};function Zm(s,c,d,y,T,I,Q){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(y,I,Q):c.prototype&&c.prototype.isPureReactComponent?!Ke(d,y)||!Ke(T,I):!0}function ev(s,c,d){var y=!1,T=kl,I=c.contextType;return typeof I=="object"&&I!==null?I=la(I):(T=Ii(c)?Kl:Ba.current,y=c.contextTypes,I=(y=y!=null)?wc(s,T):kl),c=new c(d,I),s.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=Fh,s.stateNode=c,c._reactInternals=s,y&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=T,s.__reactInternalMemoizedMaskedChildContext=I),c}function tv(s,c,d,y){s=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(d,y),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(d,y),c.state!==s&&Fh.enqueueReplaceState(c,c.state,null)}function Ip(s,c,d,y){var T=s.stateNode;T.props=d,T.state=s.memoizedState,T.refs={},Hu(s);var I=c.contextType;typeof I=="object"&&I!==null?T.context=la(I):(I=Ii(c)?Kl:Ba.current,T.context=wc(s,I)),T.state=s.memoizedState,I=c.getDerivedStateFromProps,typeof I=="function"&&(Op(s,c,I,d),T.state=s.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(c=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),c!==T.state&&Fh.enqueueReplaceState(T,T.state,null),zo(s,d,T,y),T.state=s.memoizedState),typeof T.componentDidMount=="function"&&(s.flags|=4194308)}function ef(s,c){try{var d="",y=c;do d+=H(y),y=y.return;while(y);var T=d}catch(I){T=`
Error generating stack: `+I.message+`
`+I.stack}return{value:s,source:c,stack:T,digest:null}}function Rp(s,c,d){return{value:s,source:null,stack:d??null,digest:c??null}}function Dp(s,c){try{console.error(c.value)}catch(d){setTimeout(function(){throw d})}}var Yb=typeof WeakMap=="function"?WeakMap:Map;function rv(s,c,d){d=Cs(-1,d),d.tag=3,d.payload={element:null};var y=c.value;return d.callback=function(){Bh||(Bh=!0,Jp=y),Dp(s,c)},d}function nv(s,c,d){d=Cs(-1,d),d.tag=3;var y=s.type.getDerivedStateFromError;if(typeof y=="function"){var T=c.value;d.payload=function(){return y(T)},d.callback=function(){Dp(s,c)}}var I=s.stateNode;return I!==null&&typeof I.componentDidCatch=="function"&&(d.callback=function(){Dp(s,c),typeof y!="function"&&(Tc===null?Tc=new Set([this]):Tc.add(this));var Q=c.stack;this.componentDidCatch(c.value,{componentStack:Q!==null?Q:""})}),d}function av(s,c,d){var y=s.pingCache;if(y===null){y=s.pingCache=new Yb;var T=new Set;y.set(c,T)}else T=y.get(c),T===void 0&&(T=new Set,y.set(c,T));T.has(d)||(T.add(d),s=c_.bind(null,s,c,d),c.then(s,s))}function iv(s){do{var c;if((c=s.tag===13)&&(c=s.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return s;s=s.return}while(s!==null);return null}function sv(s,c,d,y,T){return(s.mode&1)===0?(s===c?s.flags|=65536:(s.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(c=Cs(-1,1),c.tag=2,Ps(d,c,1))),d.lanes|=1),s):(s.flags|=65536,s.lanes=T,s)}var Xb=K.ReactCurrentOwner,Fs=!1;function hs(s,c,d,y){c.child=s===null?mn(c,null,d,y):wa(c,s.child,d,y)}function ov(s,c,d,y,T){d=d.render;var I=c.ref;return Jn(c,T),y=ou(s,c,d,y,I,T),d=wo(),s!==null&&!Fs?(c.updateQueue=s.updateQueue,c.flags&=-2053,s.lanes&=~T,Ql(s,c,T)):(pt&&d&&ft(c),c.flags|=1,hs(s,c,y,T),c.child)}function lv(s,c,d,y,T){if(s===null){var I=d.type;return typeof I=="function"&&!a1(I)&&I.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(c.tag=15,c.type=I,cv(s,c,I,y,T)):(s=Vh(d.type,null,y,c,c.mode,T),s.ref=c.ref,s.return=c,c.child=s)}if(I=s.child,(s.lanes&T)===0){var Q=I.memoizedProps;if(d=d.compare,d=d!==null?d:Ke,d(Q,y)&&s.ref===c.ref)return Ql(s,c,T)}return c.flags|=1,s=Fc(I,y),s.ref=c.ref,s.return=c,c.child=s}function cv(s,c,d,y,T){if(s!==null){var I=s.memoizedProps;if(Ke(I,y)&&s.ref===c.ref)if(Fs=!1,c.pendingProps=y=I,(s.lanes&T)!==0)(s.flags&131072)!==0&&(Fs=!0);else return c.lanes=s.lanes,Ql(s,c,T)}return jp(s,c,d,y,T)}function uv(s,c,d){var y=c.pendingProps,T=y.children,I=s!==null?s.memoizedState:null;if(y.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},_n(rf,Js),Js|=d;else{if((d&1073741824)===0)return s=I!==null?I.baseLanes|d:d,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:s,cachePool:null,transitions:null},c.updateQueue=null,_n(rf,Js),Js|=s,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},y=I!==null?I.baseLanes:d,_n(rf,Js),Js|=y}else I!==null?(y=I.baseLanes|d,c.memoizedState=null):y=d,_n(rf,Js),Js|=y;return hs(s,c,T,d),c.child}function fv(s,c){var d=c.ref;(s===null&&d!==null||s!==null&&s.ref!==d)&&(c.flags|=512,c.flags|=2097152)}function jp(s,c,d,y,T){var I=Ii(d)?Kl:Ba.current;return I=wc(c,I),Jn(c,T),d=ou(s,c,d,y,I,T),y=wo(),s!==null&&!Fs?(c.updateQueue=s.updateQueue,c.flags&=-2053,s.lanes&=~T,Ql(s,c,T)):(pt&&y&&ft(c),c.flags|=1,hs(s,c,d,T),c.child)}function hv(s,c,d,y,T){if(Ii(d)){var I=!0;Gl(c)}else I=!1;if(Jn(c,T),c.stateNode===null)Ih(s,c),ev(c,d,y),Ip(c,d,y,T),y=!0;else if(s===null){var Q=c.stateNode,Pe=c.memoizedProps;Q.props=Pe;var je=Q.context,lt=d.contextType;typeof lt=="object"&&lt!==null?lt=la(lt):(lt=Ii(d)?Kl:Ba.current,lt=wc(c,lt));var Ot=d.getDerivedStateFromProps,jt=typeof Ot=="function"||typeof Q.getSnapshotBeforeUpdate=="function";jt||typeof Q.UNSAFE_componentWillReceiveProps!="function"&&typeof Q.componentWillReceiveProps!="function"||(Pe!==y||je!==lt)&&tv(c,Q,y,lt),vo=!1;var Pt=c.memoizedState;Q.state=Pt,zo(c,y,Q,T),je=c.memoizedState,Pe!==y||Pt!==je||Oi.current||vo?(typeof Ot=="function"&&(Op(c,d,Ot,y),je=c.memoizedState),(Pe=vo||Zm(c,d,Pe,y,Pt,je,lt))?(jt||typeof Q.UNSAFE_componentWillMount!="function"&&typeof Q.componentWillMount!="function"||(typeof Q.componentWillMount=="function"&&Q.componentWillMount(),typeof Q.UNSAFE_componentWillMount=="function"&&Q.UNSAFE_componentWillMount()),typeof Q.componentDidMount=="function"&&(c.flags|=4194308)):(typeof Q.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=y,c.memoizedState=je),Q.props=y,Q.state=je,Q.context=lt,y=Pe):(typeof Q.componentDidMount=="function"&&(c.flags|=4194308),y=!1)}else{Q=c.stateNode,Jf(s,c),Pe=c.memoizedProps,lt=c.type===c.elementType?Pe:Vo(c.type,Pe),Q.props=lt,jt=c.pendingProps,Pt=Q.context,je=d.contextType,typeof je=="object"&&je!==null?je=la(je):(je=Ii(d)?Kl:Ba.current,je=wc(c,je));var rr=d.getDerivedStateFromProps;(Ot=typeof rr=="function"||typeof Q.getSnapshotBeforeUpdate=="function")||typeof Q.UNSAFE_componentWillReceiveProps!="function"&&typeof Q.componentWillReceiveProps!="function"||(Pe!==jt||Pt!==je)&&tv(c,Q,y,je),vo=!1,Pt=c.memoizedState,Q.state=Pt,zo(c,y,Q,T);var sr=c.memoizedState;Pe!==jt||Pt!==sr||Oi.current||vo?(typeof rr=="function"&&(Op(c,d,rr,y),sr=c.memoizedState),(lt=vo||Zm(c,d,lt,y,Pt,sr,je)||!1)?(Ot||typeof Q.UNSAFE_componentWillUpdate!="function"&&typeof Q.componentWillUpdate!="function"||(typeof Q.componentWillUpdate=="function"&&Q.componentWillUpdate(y,sr,je),typeof Q.UNSAFE_componentWillUpdate=="function"&&Q.UNSAFE_componentWillUpdate(y,sr,je)),typeof Q.componentDidUpdate=="function"&&(c.flags|=4),typeof Q.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof Q.componentDidUpdate!="function"||Pe===s.memoizedProps&&Pt===s.memoizedState||(c.flags|=4),typeof Q.getSnapshotBeforeUpdate!="function"||Pe===s.memoizedProps&&Pt===s.memoizedState||(c.flags|=1024),c.memoizedProps=y,c.memoizedState=sr),Q.props=y,Q.state=sr,Q.context=je,y=lt):(typeof Q.componentDidUpdate!="function"||Pe===s.memoizedProps&&Pt===s.memoizedState||(c.flags|=4),typeof Q.getSnapshotBeforeUpdate!="function"||Pe===s.memoizedProps&&Pt===s.memoizedState||(c.flags|=1024),y=!1)}return Mp(s,c,d,y,I,T)}function Mp(s,c,d,y,T,I){fv(s,c);var Q=(c.flags&128)!==0;if(!y&&!Q)return T&&Eh(c,d,!1),Ql(s,c,I);y=c.stateNode,Xb.current=c;var Pe=Q&&typeof d.getDerivedStateFromError!="function"?null:y.render();return c.flags|=1,s!==null&&Q?(c.child=wa(c,s.child,null,I),c.child=wa(c,null,Pe,I)):hs(s,c,Pe,I),c.memoizedState=y.state,T&&Eh(c,d,!0),c.child}function dv(s){var c=s.stateNode;c.pendingContext?Sh(s,c.pendingContext,c.pendingContext!==c.context):c.context&&Sh(s,c.context,!1),kc(s,c.containerInfo)}function pv(s,c,d,y,T){return Hr(),bn(T),c.flags|=256,hs(s,c,d,y),c.child}var Bp={dehydrated:null,treeContext:null,retryLane:0};function Up(s){return{baseLanes:s,cachePool:null,transitions:null}}function gv(s,c,d){var y=c.pendingProps,T=Dn.current,I=!1,Q=(c.flags&128)!==0,Pe;if((Pe=Q)||(Pe=s!==null&&s.memoizedState===null?!1:(T&2)!==0),Pe?(I=!0,c.flags&=-129):(s===null||s.memoizedState!==null)&&(T|=1),_n(Dn,T&1),s===null)return Yt(c),s=c.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?((c.mode&1)===0?c.lanes=1:s.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(Q=y.children,s=y.fallback,I?(y=c.mode,I=c.child,Q={mode:"hidden",children:Q},(y&1)===0&&I!==null?(I.childLanes=0,I.pendingProps=Q):I=Wh(Q,y,0,null),s=pu(s,y,d,null),I.return=c,s.return=c,I.sibling=s,c.child=I,c.child.memoizedState=Up(d),c.memoizedState=Bp,s):zp(c,Q));if(T=s.memoizedState,T!==null&&(Pe=T.dehydrated,Pe!==null))return Jb(s,c,Q,y,Pe,T,d);if(I){I=y.fallback,Q=c.mode,T=s.child,Pe=T.sibling;var je={mode:"hidden",children:y.children};return(Q&1)===0&&c.child!==T?(y=c.child,y.childLanes=0,y.pendingProps=je,c.deletions=null):(y=Fc(T,je),y.subtreeFlags=T.subtreeFlags&14680064),Pe!==null?I=Fc(Pe,I):(I=pu(I,Q,d,null),I.flags|=2),I.return=c,y.return=c,y.sibling=I,c.child=y,y=I,I=c.child,Q=s.child.memoizedState,Q=Q===null?Up(d):{baseLanes:Q.baseLanes|d,cachePool:null,transitions:Q.transitions},I.memoizedState=Q,I.childLanes=s.childLanes&~d,c.memoizedState=Bp,y}return I=s.child,s=I.sibling,y=Fc(I,{mode:"visible",children:y.children}),(c.mode&1)===0&&(y.lanes=d),y.return=c,y.sibling=null,s!==null&&(d=c.deletions,d===null?(c.deletions=[s],c.flags|=16):d.push(s)),c.child=y,c.memoizedState=null,y}function zp(s,c){return c=Wh({mode:"visible",children:c},s.mode,0,null),c.return=s,s.child=c}function Oh(s,c,d,y){return y!==null&&bn(y),wa(c,s.child,null,d),s=zp(c,c.pendingProps.children),s.flags|=2,c.memoizedState=null,s}function Jb(s,c,d,y,T,I,Q){if(d)return c.flags&256?(c.flags&=-257,y=Rp(Error(r(422))),Oh(s,c,Q,y)):c.memoizedState!==null?(c.child=s.child,c.flags|=128,null):(I=y.fallback,T=c.mode,y=Wh({mode:"visible",children:y.children},T,0,null),I=pu(I,T,Q,null),I.flags|=2,y.return=c,I.return=c,y.sibling=I,c.child=y,(c.mode&1)!==0&&wa(c,s.child,null,Q),c.child.memoizedState=Up(Q),c.memoizedState=Bp,I);if((c.mode&1)===0)return Oh(s,c,Q,null);if(T.data==="$!"){if(y=T.nextSibling&&T.nextSibling.dataset,y)var Pe=y.dgst;return y=Pe,I=Error(r(419)),y=Rp(I,y,void 0),Oh(s,c,Q,y)}if(Pe=(Q&s.childLanes)!==0,Fs||Pe){if(y=ni,y!==null){switch(Q&-Q){case 4:T=2;break;case 16:T=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:T=32;break;case 536870912:T=268435456;break;default:T=0}T=(T&(y.suspendedLanes|Q))!==0?0:T,T!==0&&T!==I.retryLane&&(I.retryLane=T,vn(s,T),Go(y,s,T,-1))}return n1(),y=Rp(Error(r(421))),Oh(s,c,Q,y)}return T.data==="$?"?(c.flags|=128,c.child=s.child,c=u_.bind(null,s),T._reactRetry=c,null):(s=I.treeContext,gt=hi(T.nextSibling),Ue=c,pt=!0,vt=null,s!==null&&(oe[ge++]=Ze,oe[ge++]=et,oe[ge++]=Re,Ze=s.id,et=s.overflow,Re=c),c=zp(c,y.children),c.flags|=4096,c)}function mv(s,c,d){s.lanes|=c;var y=s.alternate;y!==null&&(y.lanes|=c),Ts(s.return,c,d)}function qp(s,c,d,y,T){var I=s.memoizedState;I===null?s.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:y,tail:d,tailMode:T}:(I.isBackwards=c,I.rendering=null,I.renderingStartTime=0,I.last=y,I.tail=d,I.tailMode=T)}function vv(s,c,d){var y=c.pendingProps,T=y.revealOrder,I=y.tail;if(hs(s,c,y.children,d),y=Dn.current,(y&2)!==0)y=y&1|2,c.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=c.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&mv(s,d,c);else if(s.tag===19)mv(s,d,c);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===c)break e;for(;s.sibling===null;){if(s.return===null||s.return===c)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}y&=1}if(_n(Dn,y),(c.mode&1)===0)c.memoizedState=null;else switch(T){case"forwards":for(d=c.child,T=null;d!==null;)s=d.alternate,s!==null&&Gs(s)===null&&(T=d),d=d.sibling;d=T,d===null?(T=c.child,c.child=null):(T=d.sibling,d.sibling=null),qp(c,!1,T,d,I);break;case"backwards":for(d=null,T=c.child,c.child=null;T!==null;){if(s=T.alternate,s!==null&&Gs(s)===null){c.child=T;break}s=T.sibling,T.sibling=d,d=T,T=s}qp(c,!0,d,null,I);break;case"together":qp(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function Ih(s,c){(c.mode&1)===0&&s!==null&&(s.alternate=null,c.alternate=null,c.flags|=2)}function Ql(s,c,d){if(s!==null&&(c.dependencies=s.dependencies),uu|=c.lanes,(d&c.childLanes)===0)return null;if(s!==null&&c.child!==s.child)throw Error(r(153));if(c.child!==null){for(s=c.child,d=Fc(s,s.pendingProps),c.child=d,d.return=c;s.sibling!==null;)s=s.sibling,d=d.sibling=Fc(s,s.pendingProps),d.return=c;d.sibling=null}return c.child}function Qb(s,c,d){switch(c.tag){case 3:dv(c),Hr();break;case 5:Ah(c);break;case 1:Ii(c.type)&&Gl(c);break;case 4:kc(c,c.stateNode.containerInfo);break;case 10:var y=c.type._context,T=c.memoizedProps.value;_n(ti,y._currentValue),y._currentValue=T;break;case 13:if(y=c.memoizedState,y!==null)return y.dehydrated!==null?(_n(Dn,Dn.current&1),c.flags|=128,null):(d&c.child.childLanes)!==0?gv(s,c,d):(_n(Dn,Dn.current&1),s=Ql(s,c,d),s!==null?s.sibling:null);_n(Dn,Dn.current&1);break;case 19:if(y=(d&c.childLanes)!==0,(s.flags&128)!==0){if(y)return vv(s,c,d);c.flags|=128}if(T=c.memoizedState,T!==null&&(T.rendering=null,T.tail=null,T.lastEffect=null),_n(Dn,Dn.current),y)break;return null;case 22:case 23:return c.lanes=0,uv(s,c,d)}return Ql(s,c,d)}var xv,$p,yv,wv;xv=function(s,c){for(var d=c.child;d!==null;){if(d.tag===5||d.tag===6)s.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},$p=function(){},yv=function(s,c,d,y){var T=s.memoizedProps;if(T!==y){s=c.stateNode,qo(cs.current);var I=null;switch(d){case"input":T=Dt(s,T),y=Dt(s,y),I=[];break;case"select":T=Ee({},T,{value:void 0}),y=Ee({},y,{value:void 0}),I=[];break;case"textarea":T=Bt(s,T),y=Bt(s,y),I=[];break;default:typeof T.onClick!="function"&&typeof y.onClick=="function"&&(s.onclick=vc)}Ut(d,y);var Q;d=null;for(lt in T)if(!y.hasOwnProperty(lt)&&T.hasOwnProperty(lt)&&T[lt]!=null)if(lt==="style"){var Pe=T[lt];for(Q in Pe)Pe.hasOwnProperty(Q)&&(d||(d={}),d[Q]="")}else lt!=="dangerouslySetInnerHTML"&&lt!=="children"&&lt!=="suppressContentEditableWarning"&&lt!=="suppressHydrationWarning"&&lt!=="autoFocus"&&(a.hasOwnProperty(lt)?I||(I=[]):(I=I||[]).push(lt,null));for(lt in y){var je=y[lt];if(Pe=T?.[lt],y.hasOwnProperty(lt)&&je!==Pe&&(je!=null||Pe!=null))if(lt==="style")if(Pe){for(Q in Pe)!Pe.hasOwnProperty(Q)||je&&je.hasOwnProperty(Q)||(d||(d={}),d[Q]="");for(Q in je)je.hasOwnProperty(Q)&&Pe[Q]!==je[Q]&&(d||(d={}),d[Q]=je[Q])}else d||(I||(I=[]),I.push(lt,d)),d=je;else lt==="dangerouslySetInnerHTML"?(je=je?je.__html:void 0,Pe=Pe?Pe.__html:void 0,je!=null&&Pe!==je&&(I=I||[]).push(lt,je)):lt==="children"?typeof je!="string"&&typeof je!="number"||(I=I||[]).push(lt,""+je):lt!=="suppressContentEditableWarning"&&lt!=="suppressHydrationWarning"&&(a.hasOwnProperty(lt)?(je!=null&&lt==="onScroll"&&An("scroll",s),I||Pe===je||(I=[])):(I=I||[]).push(lt,je))}d&&(I=I||[]).push("style",d);var lt=I;(c.updateQueue=lt)&&(c.flags|=4)}},wv=function(s,c,d,y){d!==y&&(c.flags|=4)};function n0(s,c){if(!pt)switch(s.tailMode){case"hidden":c=s.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?s.tail=null:d.sibling=null;break;case"collapsed":d=s.tail;for(var y=null;d!==null;)d.alternate!==null&&(y=d),d=d.sibling;y===null?c||s.tail===null?s.tail=null:s.tail.sibling=null:y.sibling=null}}function Di(s){var c=s.alternate!==null&&s.alternate.child===s.child,d=0,y=0;if(c)for(var T=s.child;T!==null;)d|=T.lanes|T.childLanes,y|=T.subtreeFlags&14680064,y|=T.flags&14680064,T.return=s,T=T.sibling;else for(T=s.child;T!==null;)d|=T.lanes|T.childLanes,y|=T.subtreeFlags,y|=T.flags,T.return=s,T=T.sibling;return s.subtreeFlags|=y,s.childLanes=d,c}function Zb(s,c,d){var y=c.pendingProps;switch(Be(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Di(c),null;case 1:return Ii(c.type)&&$u(),Di(c),null;case 3:return y=c.stateNode,xo(),wn(Oi),wn(Ba),e0(),y.pendingContext&&(y.context=y.pendingContext,y.pendingContext=null),(s===null||s.child===null)&&(un(c)?c.flags|=4:s===null||s.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,vt!==null&&(e1(vt),vt=null))),$p(s,c),Di(c),null;case 5:Qf(c);var T=qo(El.current);if(d=c.type,s!==null&&c.stateNode!=null)yv(s,c,d,y,T),s.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!y){if(c.stateNode===null)throw Error(r(166));return Di(c),null}if(s=qo(cs.current),un(c)){y=c.stateNode,d=c.type;var I=c.memoizedProps;switch(y[mo]=c,y[xc]=I,s=(c.mode&1)!==0,d){case"dialog":An("cancel",y),An("close",y);break;case"iframe":case"object":case"embed":An("load",y);break;case"video":case"audio":for(T=0;T<bl.length;T++)An(bl[T],y);break;case"source":An("error",y);break;case"img":case"image":case"link":An("error",y),An("load",y);break;case"details":An("toggle",y);break;case"input":Je(y,I),An("invalid",y);break;case"select":y._wrapperState={wasMultiple:!!I.multiple},An("invalid",y);break;case"textarea":Jt(y,I),An("invalid",y)}Ut(d,I),T=null;for(var Q in I)if(I.hasOwnProperty(Q)){var Pe=I[Q];Q==="children"?typeof Pe=="string"?y.textContent!==Pe&&(I.suppressHydrationWarning!==!0&&qu(y.textContent,Pe,s),T=["children",Pe]):typeof Pe=="number"&&y.textContent!==""+Pe&&(I.suppressHydrationWarning!==!0&&qu(y.textContent,Pe,s),T=["children",""+Pe]):a.hasOwnProperty(Q)&&Pe!=null&&Q==="onScroll"&&An("scroll",y)}switch(d){case"input":ct(y),qt(y,I,!0);break;case"textarea":ct(y),cr(y);break;case"select":case"option":break;default:typeof I.onClick=="function"&&(y.onclick=vc)}y=T,c.updateQueue=y,y!==null&&(c.flags|=4)}else{Q=T.nodeType===9?T:T.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=gr(d)),s==="http://www.w3.org/1999/xhtml"?d==="script"?(s=Q.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof y.is=="string"?s=Q.createElement(d,{is:y.is}):(s=Q.createElement(d),d==="select"&&(Q=s,y.multiple?Q.multiple=!0:y.size&&(Q.size=y.size))):s=Q.createElementNS(s,d),s[mo]=c,s[xc]=y,xv(s,c,!1,!1),c.stateNode=s;e:{switch(Q=Zn(d,y),d){case"dialog":An("cancel",s),An("close",s),T=y;break;case"iframe":case"object":case"embed":An("load",s),T=y;break;case"video":case"audio":for(T=0;T<bl.length;T++)An(bl[T],s);T=y;break;case"source":An("error",s),T=y;break;case"img":case"image":case"link":An("error",s),An("load",s),T=y;break;case"details":An("toggle",s),T=y;break;case"input":Je(s,y),T=Dt(s,y),An("invalid",s);break;case"option":T=y;break;case"select":s._wrapperState={wasMultiple:!!y.multiple},T=Ee({},y,{value:void 0}),An("invalid",s);break;case"textarea":Jt(s,y),T=Bt(s,y),An("invalid",s);break;default:T=y}Ut(d,T),Pe=T;for(I in Pe)if(Pe.hasOwnProperty(I)){var je=Pe[I];I==="style"?Tn(s,je):I==="dangerouslySetInnerHTML"?(je=je?je.__html:void 0,je!=null&&Qt(s,je)):I==="children"?typeof je=="string"?(d!=="textarea"||je!=="")&&$t(s,je):typeof je=="number"&&$t(s,""+je):I!=="suppressContentEditableWarning"&&I!=="suppressHydrationWarning"&&I!=="autoFocus"&&(a.hasOwnProperty(I)?je!=null&&I==="onScroll"&&An("scroll",s):je!=null&&F(s,I,je,Q))}switch(d){case"input":ct(s),qt(s,y,!1);break;case"textarea":ct(s),cr(s);break;case"option":y.value!=null&&s.setAttribute("value",""+Ae(y.value));break;case"select":s.multiple=!!y.multiple,I=y.value,I!=null?Et(s,!!y.multiple,I,!1):y.defaultValue!=null&&Et(s,!!y.multiple,y.defaultValue,!0);break;default:typeof T.onClick=="function"&&(s.onclick=vc)}switch(d){case"button":case"input":case"select":case"textarea":y=!!y.autoFocus;break e;case"img":y=!0;break e;default:y=!1}}y&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return Di(c),null;case 6:if(s&&c.stateNode!=null)wv(s,c,s.memoizedProps,y);else{if(typeof y!="string"&&c.stateNode===null)throw Error(r(166));if(d=qo(El.current),qo(cs.current),un(c)){if(y=c.stateNode,d=c.memoizedProps,y[mo]=c,(I=y.nodeValue!==d)&&(s=Ue,s!==null))switch(s.tag){case 3:qu(y.nodeValue,d,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&qu(y.nodeValue,d,(s.mode&1)!==0)}I&&(c.flags|=4)}else y=(d.nodeType===9?d:d.ownerDocument).createTextNode(y),y[mo]=c,c.stateNode=y}return Di(c),null;case 13:if(wn(Dn),y=c.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(pt&&gt!==null&&(c.mode&1)!==0&&(c.flags&128)===0)rn(),Hr(),c.flags|=98560,I=!1;else if(I=un(c),y!==null&&y.dehydrated!==null){if(s===null){if(!I)throw Error(r(318));if(I=c.memoizedState,I=I!==null?I.dehydrated:null,!I)throw Error(r(317));I[mo]=c}else Hr(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Di(c),I=!1}else vt!==null&&(e1(vt),vt=null),I=!0;if(!I)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=d,c):(y=y!==null,y!==(s!==null&&s.memoizedState!==null)&&y&&(c.child.flags|=8192,(c.mode&1)!==0&&(s===null||(Dn.current&1)!==0?za===0&&(za=3):n1())),c.updateQueue!==null&&(c.flags|=4),Di(c),null);case 4:return xo(),$p(s,c),s===null&&$l(c.stateNode.containerInfo),Di(c),null;case 10:return Ri(c.type._context),Di(c),null;case 17:return Ii(c.type)&&$u(),Di(c),null;case 19:if(wn(Dn),I=c.memoizedState,I===null)return Di(c),null;if(y=(c.flags&128)!==0,Q=I.rendering,Q===null)if(y)n0(I,!1);else{if(za!==0||s!==null&&(s.flags&128)!==0)for(s=c.child;s!==null;){if(Q=Gs(s),Q!==null){for(c.flags|=128,n0(I,!1),y=Q.updateQueue,y!==null&&(c.updateQueue=y,c.flags|=4),c.subtreeFlags=0,y=d,d=c.child;d!==null;)I=d,s=y,I.flags&=14680066,Q=I.alternate,Q===null?(I.childLanes=0,I.lanes=s,I.child=null,I.subtreeFlags=0,I.memoizedProps=null,I.memoizedState=null,I.updateQueue=null,I.dependencies=null,I.stateNode=null):(I.childLanes=Q.childLanes,I.lanes=Q.lanes,I.child=Q.child,I.subtreeFlags=0,I.deletions=null,I.memoizedProps=Q.memoizedProps,I.memoizedState=Q.memoizedState,I.updateQueue=Q.updateQueue,I.type=Q.type,s=Q.dependencies,I.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),d=d.sibling;return _n(Dn,Dn.current&1|2),c.child}s=s.sibling}I.tail!==null&&kt()>nf&&(c.flags|=128,y=!0,n0(I,!1),c.lanes=4194304)}else{if(!y)if(s=Gs(Q),s!==null){if(c.flags|=128,y=!0,d=s.updateQueue,d!==null&&(c.updateQueue=d,c.flags|=4),n0(I,!0),I.tail===null&&I.tailMode==="hidden"&&!Q.alternate&&!pt)return Di(c),null}else 2*kt()-I.renderingStartTime>nf&&d!==1073741824&&(c.flags|=128,y=!0,n0(I,!1),c.lanes=4194304);I.isBackwards?(Q.sibling=c.child,c.child=Q):(d=I.last,d!==null?d.sibling=Q:c.child=Q,I.last=Q)}return I.tail!==null?(c=I.tail,I.rendering=c,I.tail=c.sibling,I.renderingStartTime=kt(),c.sibling=null,d=Dn.current,_n(Dn,y?d&1|2:d&1),c):(Di(c),null);case 22:case 23:return r1(),y=c.memoizedState!==null,s!==null&&s.memoizedState!==null!==y&&(c.flags|=8192),y&&(c.mode&1)!==0?(Js&1073741824)!==0&&(Di(c),c.subtreeFlags&6&&(c.flags|=8192)):Di(c),null;case 24:return null;case 25:return null}throw Error(r(156,c.tag))}function e_(s,c){switch(Be(c),c.tag){case 1:return Ii(c.type)&&$u(),s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 3:return xo(),wn(Oi),wn(Ba),e0(),s=c.flags,(s&65536)!==0&&(s&128)===0?(c.flags=s&-65537|128,c):null;case 5:return Qf(c),null;case 13:if(wn(Dn),s=c.memoizedState,s!==null&&s.dehydrated!==null){if(c.alternate===null)throw Error(r(340));Hr()}return s=c.flags,s&65536?(c.flags=s&-65537|128,c):null;case 19:return wn(Dn),null;case 4:return xo(),null;case 10:return Ri(c.type._context),null;case 22:case 23:return r1(),null;case 24:return null;default:return null}}var Rh=!1,ji=!1,t_=typeof WeakSet=="function"?WeakSet:Set,ir=null;function tf(s,c){var d=s.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(y){ua(s,c,y)}else d.current=null}function Hp(s,c,d){try{d()}catch(y){ua(s,c,y)}}var bv=!1;function r_(s,c){if(au=bs,s=$e(),at(s)){if("selectionStart"in s)var d={start:s.selectionStart,end:s.selectionEnd};else e:{d=(d=s.ownerDocument)&&d.defaultView||window;var y=d.getSelection&&d.getSelection();if(y&&y.rangeCount!==0){d=y.anchorNode;var T=y.anchorOffset,I=y.focusNode;y=y.focusOffset;try{d.nodeType,I.nodeType}catch{d=null;break e}var Q=0,Pe=-1,je=-1,lt=0,Ot=0,jt=s,Pt=null;t:for(;;){for(var rr;jt!==d||T!==0&&jt.nodeType!==3||(Pe=Q+T),jt!==I||y!==0&&jt.nodeType!==3||(je=Q+y),jt.nodeType===3&&(Q+=jt.nodeValue.length),(rr=jt.firstChild)!==null;)Pt=jt,jt=rr;for(;;){if(jt===s)break t;if(Pt===d&&++lt===T&&(Pe=Q),Pt===I&&++Ot===y&&(je=Q),(rr=jt.nextSibling)!==null)break;jt=Pt,Pt=jt.parentNode}jt=rr}d=Pe===-1||je===-1?null:{start:Pe,end:je}}else d=null}d=d||{start:0,end:0}}else d=null;for(Vl={focusedElem:s,selectionRange:d},bs=!1,ir=c;ir!==null;)if(c=ir,s=c.child,(c.subtreeFlags&1028)!==0&&s!==null)s.return=c,ir=s;else for(;ir!==null;){c=ir;try{var sr=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(sr!==null){var dr=sr.memoizedProps,ka=sr.memoizedState,tt=c.stateNode,He=tt.getSnapshotBeforeUpdate(c.elementType===c.type?dr:Vo(c.type,dr),ka);tt.__reactInternalSnapshotBeforeUpdate=He}break;case 3:var it=c.stateNode.containerInfo;it.nodeType===1?it.textContent="":it.nodeType===9&&it.documentElement&&it.removeChild(it.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Ht){ua(c,c.return,Ht)}if(s=c.sibling,s!==null){s.return=c.return,ir=s;break}ir=c.return}return sr=bv,bv=!1,sr}function a0(s,c,d){var y=c.updateQueue;if(y=y!==null?y.lastEffect:null,y!==null){var T=y=y.next;do{if((T.tag&s)===s){var I=T.destroy;T.destroy=void 0,I!==void 0&&Hp(c,d,I)}T=T.next}while(T!==y)}}function Dh(s,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var d=c=c.next;do{if((d.tag&s)===s){var y=d.create;d.destroy=y()}d=d.next}while(d!==c)}}function Vp(s){var c=s.ref;if(c!==null){var d=s.stateNode;switch(s.tag){case 5:s=d;break;default:s=d}typeof c=="function"?c(s):c.current=s}}function _v(s){var c=s.alternate;c!==null&&(s.alternate=null,_v(c)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(c=s.stateNode,c!==null&&(delete c[mo],delete c[xc],delete c[Fi],delete c[Cp],delete c[Pp])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function kv(s){return s.tag===5||s.tag===3||s.tag===4}function Sv(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||kv(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Wp(s,c,d){var y=s.tag;if(y===5||y===6)s=s.stateNode,c?d.nodeType===8?d.parentNode.insertBefore(s,c):d.insertBefore(s,c):(d.nodeType===8?(c=d.parentNode,c.insertBefore(s,d)):(c=d,c.appendChild(s)),d=d._reactRootContainer,d!=null||c.onclick!==null||(c.onclick=vc));else if(y!==4&&(s=s.child,s!==null))for(Wp(s,c,d),s=s.sibling;s!==null;)Wp(s,c,d),s=s.sibling}function Kp(s,c,d){var y=s.tag;if(y===5||y===6)s=s.stateNode,c?d.insertBefore(s,c):d.appendChild(s);else if(y!==4&&(s=s.child,s!==null))for(Kp(s,c,d),s=s.sibling;s!==null;)Kp(s,c,d),s=s.sibling}var pi=null,Wo=!1;function Nc(s,c,d){for(d=d.child;d!==null;)Ev(s,c,d),d=d.sibling}function Ev(s,c,d){if(Fn&&typeof Fn.onCommitFiberUnmount=="function")try{Fn.onCommitFiberUnmount(Ga,d)}catch{}switch(d.tag){case 5:ji||tf(d,c);case 6:var y=pi,T=Wo;pi=null,Nc(s,c,d),pi=y,Wo=T,pi!==null&&(Wo?(s=pi,d=d.stateNode,s.nodeType===8?s.parentNode.removeChild(d):s.removeChild(d)):pi.removeChild(d.stateNode));break;case 18:pi!==null&&(Wo?(s=pi,d=d.stateNode,s.nodeType===8?Gf(s.parentNode,d):s.nodeType===1&&Gf(s,d),Ai(s)):Gf(pi,d.stateNode));break;case 4:y=pi,T=Wo,pi=d.stateNode.containerInfo,Wo=!0,Nc(s,c,d),pi=y,Wo=T;break;case 0:case 11:case 14:case 15:if(!ji&&(y=d.updateQueue,y!==null&&(y=y.lastEffect,y!==null))){T=y=y.next;do{var I=T,Q=I.destroy;I=I.tag,Q!==void 0&&((I&2)!==0||(I&4)!==0)&&Hp(d,c,Q),T=T.next}while(T!==y)}Nc(s,c,d);break;case 1:if(!ji&&(tf(d,c),y=d.stateNode,typeof y.componentWillUnmount=="function"))try{y.props=d.memoizedProps,y.state=d.memoizedState,y.componentWillUnmount()}catch(Pe){ua(d,c,Pe)}Nc(s,c,d);break;case 21:Nc(s,c,d);break;case 22:d.mode&1?(ji=(y=ji)||d.memoizedState!==null,Nc(s,c,d),ji=y):Nc(s,c,d);break;default:Nc(s,c,d)}}function Av(s){var c=s.updateQueue;if(c!==null){s.updateQueue=null;var d=s.stateNode;d===null&&(d=s.stateNode=new t_),c.forEach(function(y){var T=f_.bind(null,s,y);d.has(y)||(d.add(y),y.then(T,T))})}}function Ko(s,c){var d=c.deletions;if(d!==null)for(var y=0;y<d.length;y++){var T=d[y];try{var I=s,Q=c,Pe=Q;e:for(;Pe!==null;){switch(Pe.tag){case 5:pi=Pe.stateNode,Wo=!1;break e;case 3:pi=Pe.stateNode.containerInfo,Wo=!0;break e;case 4:pi=Pe.stateNode.containerInfo,Wo=!0;break e}Pe=Pe.return}if(pi===null)throw Error(r(160));Ev(I,Q,T),pi=null,Wo=!1;var je=T.alternate;je!==null&&(je.return=null),T.return=null}catch(lt){ua(T,c,lt)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)Nv(c,s),c=c.sibling}function Nv(s,c){var d=s.alternate,y=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(Ko(c,s),Nl(s),y&4){try{a0(3,s,s.return),Dh(3,s)}catch(dr){ua(s,s.return,dr)}try{a0(5,s,s.return)}catch(dr){ua(s,s.return,dr)}}break;case 1:Ko(c,s),Nl(s),y&512&&d!==null&&tf(d,d.return);break;case 5:if(Ko(c,s),Nl(s),y&512&&d!==null&&tf(d,d.return),s.flags&32){var T=s.stateNode;try{$t(T,"")}catch(dr){ua(s,s.return,dr)}}if(y&4&&(T=s.stateNode,T!=null)){var I=s.memoizedProps,Q=d!==null?d.memoizedProps:I,Pe=s.type,je=s.updateQueue;if(s.updateQueue=null,je!==null)try{Pe==="input"&&I.type==="radio"&&I.name!=null&&we(T,I),Zn(Pe,Q);var lt=Zn(Pe,I);for(Q=0;Q<je.length;Q+=2){var Ot=je[Q],jt=je[Q+1];Ot==="style"?Tn(T,jt):Ot==="dangerouslySetInnerHTML"?Qt(T,jt):Ot==="children"?$t(T,jt):F(T,Ot,jt,lt)}switch(Pe){case"input":mt(T,I);break;case"textarea":nr(T,I);break;case"select":var Pt=T._wrapperState.wasMultiple;T._wrapperState.wasMultiple=!!I.multiple;var rr=I.value;rr!=null?Et(T,!!I.multiple,rr,!1):Pt!==!!I.multiple&&(I.defaultValue!=null?Et(T,!!I.multiple,I.defaultValue,!0):Et(T,!!I.multiple,I.multiple?[]:"",!1))}T[xc]=I}catch(dr){ua(s,s.return,dr)}}break;case 6:if(Ko(c,s),Nl(s),y&4){if(s.stateNode===null)throw Error(r(162));T=s.stateNode,I=s.memoizedProps;try{T.nodeValue=I}catch(dr){ua(s,s.return,dr)}}break;case 3:if(Ko(c,s),Nl(s),y&4&&d!==null&&d.memoizedState.isDehydrated)try{Ai(c.containerInfo)}catch(dr){ua(s,s.return,dr)}break;case 4:Ko(c,s),Nl(s);break;case 13:Ko(c,s),Nl(s),T=s.child,T.flags&8192&&(I=T.memoizedState!==null,T.stateNode.isHidden=I,!I||T.alternate!==null&&T.alternate.memoizedState!==null||(Xp=kt())),y&4&&Av(s);break;case 22:if(Ot=d!==null&&d.memoizedState!==null,s.mode&1?(ji=(lt=ji)||Ot,Ko(c,s),ji=lt):Ko(c,s),Nl(s),y&8192){if(lt=s.memoizedState!==null,(s.stateNode.isHidden=lt)&&!Ot&&(s.mode&1)!==0)for(ir=s,Ot=s.child;Ot!==null;){for(jt=ir=Ot;ir!==null;){switch(Pt=ir,rr=Pt.child,Pt.tag){case 0:case 11:case 14:case 15:a0(4,Pt,Pt.return);break;case 1:tf(Pt,Pt.return);var sr=Pt.stateNode;if(typeof sr.componentWillUnmount=="function"){y=Pt,d=Pt.return;try{c=y,sr.props=c.memoizedProps,sr.state=c.memoizedState,sr.componentWillUnmount()}catch(dr){ua(y,d,dr)}}break;case 5:tf(Pt,Pt.return);break;case 22:if(Pt.memoizedState!==null){Pv(jt);continue}}rr!==null?(rr.return=Pt,ir=rr):Pv(jt)}Ot=Ot.sibling}e:for(Ot=null,jt=s;;){if(jt.tag===5){if(Ot===null){Ot=jt;try{T=jt.stateNode,lt?(I=T.style,typeof I.setProperty=="function"?I.setProperty("display","none","important"):I.display="none"):(Pe=jt.stateNode,je=jt.memoizedProps.style,Q=je!=null&&je.hasOwnProperty("display")?je.display:null,Pe.style.display=ur("display",Q))}catch(dr){ua(s,s.return,dr)}}}else if(jt.tag===6){if(Ot===null)try{jt.stateNode.nodeValue=lt?"":jt.memoizedProps}catch(dr){ua(s,s.return,dr)}}else if((jt.tag!==22&&jt.tag!==23||jt.memoizedState===null||jt===s)&&jt.child!==null){jt.child.return=jt,jt=jt.child;continue}if(jt===s)break e;for(;jt.sibling===null;){if(jt.return===null||jt.return===s)break e;Ot===jt&&(Ot=null),jt=jt.return}Ot===jt&&(Ot=null),jt.sibling.return=jt.return,jt=jt.sibling}}break;case 19:Ko(c,s),Nl(s),y&4&&Av(s);break;case 21:break;default:Ko(c,s),Nl(s)}}function Nl(s){var c=s.flags;if(c&2){try{e:{for(var d=s.return;d!==null;){if(kv(d)){var y=d;break e}d=d.return}throw Error(r(160))}switch(y.tag){case 5:var T=y.stateNode;y.flags&32&&($t(T,""),y.flags&=-33);var I=Sv(s);Kp(s,I,T);break;case 3:case 4:var Q=y.stateNode.containerInfo,Pe=Sv(s);Wp(s,Pe,Q);break;default:throw Error(r(161))}}catch(je){ua(s,s.return,je)}s.flags&=-3}c&4096&&(s.flags&=-4097)}function n_(s,c,d){ir=s,Tv(s)}function Tv(s,c,d){for(var y=(s.mode&1)!==0;ir!==null;){var T=ir,I=T.child;if(T.tag===22&&y){var Q=T.memoizedState!==null||Rh;if(!Q){var Pe=T.alternate,je=Pe!==null&&Pe.memoizedState!==null||ji;Pe=Rh;var lt=ji;if(Rh=Q,(ji=je)&&!lt)for(ir=T;ir!==null;)Q=ir,je=Q.child,Q.tag===22&&Q.memoizedState!==null?Lv(T):je!==null?(je.return=Q,ir=je):Lv(T);for(;I!==null;)ir=I,Tv(I),I=I.sibling;ir=T,Rh=Pe,ji=lt}Cv(s)}else(T.subtreeFlags&8772)!==0&&I!==null?(I.return=T,ir=I):Cv(s)}}function Cv(s){for(;ir!==null;){var c=ir;if((c.flags&8772)!==0){var d=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:ji||Dh(5,c);break;case 1:var y=c.stateNode;if(c.flags&4&&!ji)if(d===null)y.componentDidMount();else{var T=c.elementType===c.type?d.memoizedProps:Vo(c.type,d.memoizedProps);y.componentDidUpdate(T,d.memoizedState,y.__reactInternalSnapshotBeforeUpdate)}var I=c.updateQueue;I!==null&&Xl(c,I,y);break;case 3:var Q=c.updateQueue;if(Q!==null){if(d=null,c.child!==null)switch(c.child.tag){case 5:d=c.child.stateNode;break;case 1:d=c.child.stateNode}Xl(c,Q,d)}break;case 5:var Pe=c.stateNode;if(d===null&&c.flags&4){d=Pe;var je=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":je.autoFocus&&d.focus();break;case"img":je.src&&(d.src=je.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var lt=c.alternate;if(lt!==null){var Ot=lt.memoizedState;if(Ot!==null){var jt=Ot.dehydrated;jt!==null&&Ai(jt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}ji||c.flags&512&&Vp(c)}catch(Pt){ua(c,c.return,Pt)}}if(c===s){ir=null;break}if(d=c.sibling,d!==null){d.return=c.return,ir=d;break}ir=c.return}}function Pv(s){for(;ir!==null;){var c=ir;if(c===s){ir=null;break}var d=c.sibling;if(d!==null){d.return=c.return,ir=d;break}ir=c.return}}function Lv(s){for(;ir!==null;){var c=ir;try{switch(c.tag){case 0:case 11:case 15:var d=c.return;try{Dh(4,c)}catch(je){ua(c,d,je)}break;case 1:var y=c.stateNode;if(typeof y.componentDidMount=="function"){var T=c.return;try{y.componentDidMount()}catch(je){ua(c,T,je)}}var I=c.return;try{Vp(c)}catch(je){ua(c,I,je)}break;case 5:var Q=c.return;try{Vp(c)}catch(je){ua(c,Q,je)}}}catch(je){ua(c,c.return,je)}if(c===s){ir=null;break}var Pe=c.sibling;if(Pe!==null){Pe.return=c.return,ir=Pe;break}ir=c.return}}var a_=Math.ceil,jh=K.ReactCurrentDispatcher,Gp=K.ReactCurrentOwner,bo=K.ReactCurrentBatchConfig,dn=0,ni=null,Fa=null,gi=0,Js=0,rf=Ks(0),za=0,i0=null,uu=0,Mh=0,Yp=0,s0=null,Os=null,Xp=0,nf=1/0,Zl=null,Bh=!1,Jp=null,Tc=null,Uh=!1,Cc=null,zh=0,o0=0,Qp=null,qh=-1,$h=0;function ds(){return(dn&6)!==0?kt():qh!==-1?qh:qh=kt()}function Pc(s){return(s.mode&1)===0?1:(dn&2)!==0&&gi!==0?gi&-gi:kn.transition!==null?($h===0&&($h=hl()),$h):(s=sn,s!==0||(s=window.event,s=s===void 0?16:ql(s.type)),s)}function Go(s,c,d,y){if(50<o0)throw o0=0,Qp=null,Error(r(185));Ms(s,d,y),((dn&2)===0||s!==ni)&&(s===ni&&((dn&2)===0&&(Mh|=d),za===4&&Lc(s,gi)),Is(s,y),d===1&&dn===0&&(c.mode&1)===0&&(nf=kt()+500,su&&R()))}function Is(s,c){var d=s.callbackNode;Pa(s,c);var y=aa(s,s===ni?gi:0);if(y===0)d!==null&&zt(d),s.callbackNode=null,s.callbackPriority=0;else if(c=y&-y,s.callbackPriority!==c){if(d!=null&&zt(d),c===1)s.tag===0?P(Ov.bind(null,s)):w(Ov.bind(null,s)),Np(function(){(dn&6)===0&&R()}),d=null;else{switch(Gr(y)){case 1:d=Kr;break;case 4:d=en;break;case 16:d=En;break;case 536870912:d=Ca;break;default:d=En}d=zv(d,Fv.bind(null,s))}s.callbackPriority=c,s.callbackNode=d}}function Fv(s,c){if(qh=-1,$h=0,(dn&6)!==0)throw Error(r(327));var d=s.callbackNode;if(af()&&s.callbackNode!==d)return null;var y=aa(s,s===ni?gi:0);if(y===0)return null;if((y&30)!==0||(y&s.expiredLanes)!==0||c)c=Hh(s,y);else{c=y;var T=dn;dn|=2;var I=Rv();(ni!==s||gi!==c)&&(Zl=null,nf=kt()+500,hu(s,c));do try{o_();break}catch(Pe){Iv(s,Pe)}while(!0);Ua(),jh.current=I,dn=T,Fa!==null?c=0:(ni=null,gi=0,c=za)}if(c!==0){if(c===2&&(T=ws(s),T!==0&&(y=T,c=Zp(s,T))),c===1)throw d=i0,hu(s,0),Lc(s,y),Is(s,kt()),d;if(c===6)Lc(s,y);else{if(T=s.current.alternate,(y&30)===0&&!i_(T)&&(c=Hh(s,y),c===2&&(I=ws(s),I!==0&&(y=I,c=Zp(s,I))),c===1))throw d=i0,hu(s,0),Lc(s,y),Is(s,kt()),d;switch(s.finishedWork=T,s.finishedLanes=y,c){case 0:case 1:throw Error(r(345));case 2:du(s,Os,Zl);break;case 3:if(Lc(s,y),(y&130023424)===y&&(c=Xp+500-kt(),10<c)){if(aa(s,0)!==0)break;if(T=s.suspendedLanes,(T&y)!==y){ds(),s.pingedLanes|=s.suspendedLanes&T;break}s.timeoutHandle=Kf(du.bind(null,s,Os,Zl),c);break}du(s,Os,Zl);break;case 4:if(Lc(s,y),(y&4194240)===y)break;for(c=s.eventTimes,T=-1;0<y;){var Q=31-pr(y);I=1<<Q,Q=c[Q],Q>T&&(T=Q),y&=~I}if(y=T,y=kt()-y,y=(120>y?120:480>y?480:1080>y?1080:1920>y?1920:3e3>y?3e3:4320>y?4320:1960*a_(y/1960))-y,10<y){s.timeoutHandle=Kf(du.bind(null,s,Os,Zl),y);break}du(s,Os,Zl);break;case 5:du(s,Os,Zl);break;default:throw Error(r(329))}}}return Is(s,kt()),s.callbackNode===d?Fv.bind(null,s):null}function Zp(s,c){var d=s0;return s.current.memoizedState.isDehydrated&&(hu(s,c).flags|=256),s=Hh(s,c),s!==2&&(c=Os,Os=d,c!==null&&e1(c)),s}function e1(s){Os===null?Os=s:Os.push.apply(Os,s)}function i_(s){for(var c=s;;){if(c.flags&16384){var d=c.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var y=0;y<d.length;y++){var T=d[y],I=T.getSnapshot;T=T.value;try{if(!Ne(I(),T))return!1}catch{return!1}}}if(d=c.child,c.subtreeFlags&16384&&d!==null)d.return=c,c=d;else{if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Lc(s,c){for(c&=~Yp,c&=~Mh,s.suspendedLanes|=c,s.pingedLanes&=~c,s=s.expirationTimes;0<c;){var d=31-pr(c),y=1<<d;s[d]=-1,c&=~y}}function Ov(s){if((dn&6)!==0)throw Error(r(327));af();var c=aa(s,0);if((c&1)===0)return Is(s,kt()),null;var d=Hh(s,c);if(s.tag!==0&&d===2){var y=ws(s);y!==0&&(c=y,d=Zp(s,y))}if(d===1)throw d=i0,hu(s,0),Lc(s,c),Is(s,kt()),d;if(d===6)throw Error(r(345));return s.finishedWork=s.current.alternate,s.finishedLanes=c,du(s,Os,Zl),Is(s,kt()),null}function t1(s,c){var d=dn;dn|=1;try{return s(c)}finally{dn=d,dn===0&&(nf=kt()+500,su&&R())}}function fu(s){Cc!==null&&Cc.tag===0&&(dn&6)===0&&af();var c=dn;dn|=1;var d=bo.transition,y=sn;try{if(bo.transition=null,sn=1,s)return s()}finally{sn=y,bo.transition=d,dn=c,(dn&6)===0&&R()}}function r1(){Js=rf.current,wn(rf)}function hu(s,c){s.finishedWork=null,s.finishedLanes=0;var d=s.timeoutHandle;if(d!==-1&&(s.timeoutHandle=-1,_h(d)),Fa!==null)for(d=Fa.return;d!==null;){var y=d;switch(Be(y),y.tag){case 1:y=y.type.childContextTypes,y!=null&&$u();break;case 3:xo(),wn(Oi),wn(Ba),e0();break;case 5:Qf(y);break;case 4:xo();break;case 13:wn(Dn);break;case 19:wn(Dn);break;case 10:Ri(y.type._context);break;case 22:case 23:r1()}d=d.return}if(ni=s,Fa=s=Fc(s.current,null),gi=Js=c,za=0,i0=null,Yp=Mh=uu=0,Os=s0=null,ls!==null){for(c=0;c<ls.length;c++)if(d=ls[c],y=d.interleaved,y!==null){d.interleaved=null;var T=y.next,I=d.pending;if(I!==null){var Q=I.next;I.next=T,y.next=Q}d.pending=y}ls=null}return s}function Iv(s,c){do{var d=Fa;try{if(Ua(),Vu.current=Lh,Sc){for(var y=Vn.memoizedState;y!==null;){var T=y.queue;T!==null&&(T.pending=null),y=y.next}Sc=!1}if(yo=0,oa=ca=Vn=null,$o=!1,Ec=0,Gp.current=null,d===null||d.return===null){za=1,i0=c,Fa=null;break}e:{var I=s,Q=d.return,Pe=d,je=c;if(c=gi,Pe.flags|=32768,je!==null&&typeof je=="object"&&typeof je.then=="function"){var lt=je,Ot=Pe,jt=Ot.tag;if((Ot.mode&1)===0&&(jt===0||jt===11||jt===15)){var Pt=Ot.alternate;Pt?(Ot.updateQueue=Pt.updateQueue,Ot.memoizedState=Pt.memoizedState,Ot.lanes=Pt.lanes):(Ot.updateQueue=null,Ot.memoizedState=null)}var rr=iv(Q);if(rr!==null){rr.flags&=-257,sv(rr,Q,Pe,I,c),rr.mode&1&&av(I,lt,c),c=rr,je=lt;var sr=c.updateQueue;if(sr===null){var dr=new Set;dr.add(je),c.updateQueue=dr}else sr.add(je);break e}else{if((c&1)===0){av(I,lt,c),n1();break e}je=Error(r(426))}}else if(pt&&Pe.mode&1){var ka=iv(Q);if(ka!==null){(ka.flags&65536)===0&&(ka.flags|=256),sv(ka,Q,Pe,I,c),bn(ef(je,Pe));break e}}I=je=ef(je,Pe),za!==4&&(za=2),s0===null?s0=[I]:s0.push(I),I=Q;do{switch(I.tag){case 3:I.flags|=65536,c&=-c,I.lanes|=c;var tt=rv(I,je,c);Ls(I,tt);break e;case 1:Pe=je;var He=I.type,it=I.stateNode;if((I.flags&128)===0&&(typeof He.getDerivedStateFromError=="function"||it!==null&&typeof it.componentDidCatch=="function"&&(Tc===null||!Tc.has(it)))){I.flags|=65536,c&=-c,I.lanes|=c;var Ht=nv(I,Pe,c);Ls(I,Ht);break e}}I=I.return}while(I!==null)}jv(d)}catch(vr){c=vr,Fa===d&&d!==null&&(Fa=d=d.return);continue}break}while(!0)}function Rv(){var s=jh.current;return jh.current=Lh,s===null?Lh:s}function n1(){(za===0||za===3||za===2)&&(za=4),ni===null||(uu&268435455)===0&&(Mh&268435455)===0||Lc(ni,gi)}function Hh(s,c){var d=dn;dn|=2;var y=Rv();(ni!==s||gi!==c)&&(Zl=null,hu(s,c));do try{s_();break}catch(T){Iv(s,T)}while(!0);if(Ua(),dn=d,jh.current=y,Fa!==null)throw Error(r(261));return ni=null,gi=0,za}function s_(){for(;Fa!==null;)Dv(Fa)}function o_(){for(;Fa!==null&&!It();)Dv(Fa)}function Dv(s){var c=Uv(s.alternate,s,Js);s.memoizedProps=s.pendingProps,c===null?jv(s):Fa=c,Gp.current=null}function jv(s){var c=s;do{var d=c.alternate;if(s=c.return,(c.flags&32768)===0){if(d=Zb(d,c,Js),d!==null){Fa=d;return}}else{if(d=e_(d,c),d!==null){d.flags&=32767,Fa=d;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{za=6,Fa=null;return}}if(c=c.sibling,c!==null){Fa=c;return}Fa=c=s}while(c!==null);za===0&&(za=5)}function du(s,c,d){var y=sn,T=bo.transition;try{bo.transition=null,sn=1,l_(s,c,d,y)}finally{bo.transition=T,sn=y}return null}function l_(s,c,d,y){do af();while(Cc!==null);if((dn&6)!==0)throw Error(r(327));d=s.finishedWork;var T=s.finishedLanes;if(d===null)return null;if(s.finishedWork=null,s.finishedLanes=0,d===s.current)throw Error(r(177));s.callbackNode=null,s.callbackPriority=0;var I=d.lanes|d.childLanes;if(Co(s,I),s===ni&&(Fa=ni=null,gi=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||Uh||(Uh=!0,zv(En,function(){return af(),null})),I=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||I){I=bo.transition,bo.transition=null;var Q=sn;sn=1;var Pe=dn;dn|=4,Gp.current=null,r_(s,d),Nv(d,s),st(Vl),bs=!!au,Vl=au=null,s.current=d,n_(d),Lt(),dn=Pe,sn=Q,bo.transition=I}else s.current=d;if(Uh&&(Uh=!1,Cc=s,zh=T),I=s.pendingLanes,I===0&&(Tc=null),Ji(d.stateNode),Is(s,kt()),c!==null)for(y=s.onRecoverableError,d=0;d<c.length;d++)T=c[d],y(T.value,{componentStack:T.stack,digest:T.digest});if(Bh)throw Bh=!1,s=Jp,Jp=null,s;return(zh&1)!==0&&s.tag!==0&&af(),I=s.pendingLanes,(I&1)!==0?s===Qp?o0++:(o0=0,Qp=s):o0=0,R(),null}function af(){if(Cc!==null){var s=Gr(zh),c=bo.transition,d=sn;try{if(bo.transition=null,sn=16>s?16:s,Cc===null)var y=!1;else{if(s=Cc,Cc=null,zh=0,(dn&6)!==0)throw Error(r(331));var T=dn;for(dn|=4,ir=s.current;ir!==null;){var I=ir,Q=I.child;if((ir.flags&16)!==0){var Pe=I.deletions;if(Pe!==null){for(var je=0;je<Pe.length;je++){var lt=Pe[je];for(ir=lt;ir!==null;){var Ot=ir;switch(Ot.tag){case 0:case 11:case 15:a0(8,Ot,I)}var jt=Ot.child;if(jt!==null)jt.return=Ot,ir=jt;else for(;ir!==null;){Ot=ir;var Pt=Ot.sibling,rr=Ot.return;if(_v(Ot),Ot===lt){ir=null;break}if(Pt!==null){Pt.return=rr,ir=Pt;break}ir=rr}}}var sr=I.alternate;if(sr!==null){var dr=sr.child;if(dr!==null){sr.child=null;do{var ka=dr.sibling;dr.sibling=null,dr=ka}while(dr!==null)}}ir=I}}if((I.subtreeFlags&2064)!==0&&Q!==null)Q.return=I,ir=Q;else e:for(;ir!==null;){if(I=ir,(I.flags&2048)!==0)switch(I.tag){case 0:case 11:case 15:a0(9,I,I.return)}var tt=I.sibling;if(tt!==null){tt.return=I.return,ir=tt;break e}ir=I.return}}var He=s.current;for(ir=He;ir!==null;){Q=ir;var it=Q.child;if((Q.subtreeFlags&2064)!==0&&it!==null)it.return=Q,ir=it;else e:for(Q=He;ir!==null;){if(Pe=ir,(Pe.flags&2048)!==0)try{switch(Pe.tag){case 0:case 11:case 15:Dh(9,Pe)}}catch(vr){ua(Pe,Pe.return,vr)}if(Pe===Q){ir=null;break e}var Ht=Pe.sibling;if(Ht!==null){Ht.return=Pe.return,ir=Ht;break e}ir=Pe.return}}if(dn=T,R(),Fn&&typeof Fn.onPostCommitFiberRoot=="function")try{Fn.onPostCommitFiberRoot(Ga,s)}catch{}y=!0}return y}finally{sn=d,bo.transition=c}}return!1}function Mv(s,c,d){c=ef(d,c),c=rv(s,c,1),s=Ps(s,c,1),c=ds(),s!==null&&(Ms(s,1,c),Is(s,c))}function ua(s,c,d){if(s.tag===3)Mv(s,s,d);else for(;c!==null;){if(c.tag===3){Mv(c,s,d);break}else if(c.tag===1){var y=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(Tc===null||!Tc.has(y))){s=ef(d,s),s=nv(c,s,1),c=Ps(c,s,1),s=ds(),c!==null&&(Ms(c,1,s),Is(c,s));break}}c=c.return}}function c_(s,c,d){var y=s.pingCache;y!==null&&y.delete(c),c=ds(),s.pingedLanes|=s.suspendedLanes&d,ni===s&&(gi&d)===d&&(za===4||za===3&&(gi&130023424)===gi&&500>kt()-Xp?hu(s,0):Yp|=d),Is(s,c)}function Bv(s,c){c===0&&((s.mode&1)===0?c=1:(c=_i,_i<<=1,(_i&130023424)===0&&(_i=4194304)));var d=ds();s=vn(s,c),s!==null&&(Ms(s,c,d),Is(s,d))}function u_(s){var c=s.memoizedState,d=0;c!==null&&(d=c.retryLane),Bv(s,d)}function f_(s,c){var d=0;switch(s.tag){case 13:var y=s.stateNode,T=s.memoizedState;T!==null&&(d=T.retryLane);break;case 19:y=s.stateNode;break;default:throw Error(r(314))}y!==null&&y.delete(c),Bv(s,d)}var Uv;Uv=function(s,c,d){if(s!==null)if(s.memoizedProps!==c.pendingProps||Oi.current)Fs=!0;else{if((s.lanes&d)===0&&(c.flags&128)===0)return Fs=!1,Qb(s,c,d);Fs=(s.flags&131072)!==0}else Fs=!1,pt&&(c.flags&1048576)!==0&&yt(c,ae,c.index);switch(c.lanes=0,c.tag){case 2:var y=c.type;Ih(s,c),s=c.pendingProps;var T=wc(c,Ba.current);Jn(c,d),T=ou(null,c,y,s,T,d);var I=wo();return c.flags|=1,typeof T=="object"&&T!==null&&typeof T.render=="function"&&T.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,Ii(y)?(I=!0,Gl(c)):I=!1,c.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,Hu(c),T.updater=Fh,c.stateNode=T,T._reactInternals=c,Ip(c,y,s,d),c=Mp(null,c,y,!0,I,d)):(c.tag=0,pt&&I&&ft(c),hs(null,c,T,d),c=c.child),c;case 16:y=c.elementType;e:{switch(Ih(s,c),s=c.pendingProps,T=y._init,y=T(y._payload),c.type=y,T=c.tag=d_(y),s=Vo(y,s),T){case 0:c=jp(null,c,y,s,d);break e;case 1:c=hv(null,c,y,s,d);break e;case 11:c=ov(null,c,y,s,d);break e;case 14:c=lv(null,c,y,Vo(y.type,s),d);break e}throw Error(r(306,y,""))}return c;case 0:return y=c.type,T=c.pendingProps,T=c.elementType===y?T:Vo(y,T),jp(s,c,y,T,d);case 1:return y=c.type,T=c.pendingProps,T=c.elementType===y?T:Vo(y,T),hv(s,c,y,T,d);case 3:e:{if(dv(c),s===null)throw Error(r(387));y=c.pendingProps,I=c.memoizedState,T=I.element,Jf(s,c),zo(c,y,null,d);var Q=c.memoizedState;if(y=Q.element,I.isDehydrated)if(I={element:y,isDehydrated:!1,cache:Q.cache,pendingSuspenseBoundaries:Q.pendingSuspenseBoundaries,transitions:Q.transitions},c.updateQueue.baseState=I,c.memoizedState=I,c.flags&256){T=ef(Error(r(423)),c),c=pv(s,c,y,d,T);break e}else if(y!==T){T=ef(Error(r(424)),c),c=pv(s,c,y,d,T);break e}else for(gt=hi(c.stateNode.containerInfo.firstChild),Ue=c,pt=!0,vt=null,d=mn(c,null,y,d),c.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(Hr(),y===T){c=Ql(s,c,d);break e}hs(s,c,y,d)}c=c.child}return c;case 5:return Ah(c),s===null&&Yt(c),y=c.type,T=c.pendingProps,I=s!==null?s.memoizedProps:null,Q=T.children,Wf(y,T)?Q=null:I!==null&&Wf(y,I)&&(c.flags|=32),fv(s,c),hs(s,c,Q,d),c.child;case 6:return s===null&&Yt(c),null;case 13:return gv(s,c,d);case 4:return kc(c,c.stateNode.containerInfo),y=c.pendingProps,s===null?c.child=wa(c,null,y,d):hs(s,c,y,d),c.child;case 11:return y=c.type,T=c.pendingProps,T=c.elementType===y?T:Vo(y,T),ov(s,c,y,T,d);case 7:return hs(s,c,c.pendingProps,d),c.child;case 8:return hs(s,c,c.pendingProps.children,d),c.child;case 12:return hs(s,c,c.pendingProps.children,d),c.child;case 10:e:{if(y=c.type._context,T=c.pendingProps,I=c.memoizedProps,Q=T.value,_n(ti,y._currentValue),y._currentValue=Q,I!==null)if(Ne(I.value,Q)){if(I.children===T.children&&!Oi.current){c=Ql(s,c,d);break e}}else for(I=c.child,I!==null&&(I.return=c);I!==null;){var Pe=I.dependencies;if(Pe!==null){Q=I.child;for(var je=Pe.firstContext;je!==null;){if(je.context===y){if(I.tag===1){je=Cs(-1,d&-d),je.tag=2;var lt=I.updateQueue;if(lt!==null){lt=lt.shared;var Ot=lt.pending;Ot===null?je.next=je:(je.next=Ot.next,Ot.next=je),lt.pending=je}}I.lanes|=d,je=I.alternate,je!==null&&(je.lanes|=d),Ts(I.return,d,c),Pe.lanes|=d;break}je=je.next}}else if(I.tag===10)Q=I.type===c.type?null:I.child;else if(I.tag===18){if(Q=I.return,Q===null)throw Error(r(341));Q.lanes|=d,Pe=Q.alternate,Pe!==null&&(Pe.lanes|=d),Ts(Q,d,c),Q=I.sibling}else Q=I.child;if(Q!==null)Q.return=I;else for(Q=I;Q!==null;){if(Q===c){Q=null;break}if(I=Q.sibling,I!==null){I.return=Q.return,Q=I;break}Q=Q.return}I=Q}hs(s,c,T.children,d),c=c.child}return c;case 9:return T=c.type,y=c.pendingProps.children,Jn(c,d),T=la(T),y=y(T),c.flags|=1,hs(s,c,y,d),c.child;case 14:return y=c.type,T=Vo(y,c.pendingProps),T=Vo(y.type,T),lv(s,c,y,T,d);case 15:return cv(s,c,c.type,c.pendingProps,d);case 17:return y=c.type,T=c.pendingProps,T=c.elementType===y?T:Vo(y,T),Ih(s,c),c.tag=1,Ii(y)?(s=!0,Gl(c)):s=!1,Jn(c,d),ev(c,y,T),Ip(c,y,T,d),Mp(null,c,y,!0,s,d);case 19:return vv(s,c,d);case 22:return uv(s,c,d)}throw Error(r(156,c.tag))};function zv(s,c){return St(s,c)}function h_(s,c,d,y){this.tag=s,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function _o(s,c,d,y){return new h_(s,c,d,y)}function a1(s){return s=s.prototype,!(!s||!s.isReactComponent)}function d_(s){if(typeof s=="function")return a1(s)?1:0;if(s!=null){if(s=s.$$typeof,s===D)return 11;if(s===Te)return 14}return 2}function Fc(s,c){var d=s.alternate;return d===null?(d=_o(s.tag,c,s.key,s.mode),d.elementType=s.elementType,d.type=s.type,d.stateNode=s.stateNode,d.alternate=s,s.alternate=d):(d.pendingProps=c,d.type=s.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=s.flags&14680064,d.childLanes=s.childLanes,d.lanes=s.lanes,d.child=s.child,d.memoizedProps=s.memoizedProps,d.memoizedState=s.memoizedState,d.updateQueue=s.updateQueue,c=s.dependencies,d.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},d.sibling=s.sibling,d.index=s.index,d.ref=s.ref,d}function Vh(s,c,d,y,T,I){var Q=2;if(y=s,typeof s=="function")a1(s)&&(Q=1);else if(typeof s=="string")Q=5;else e:switch(s){case B:return pu(d.children,T,I,c);case V:Q=8,T|=8;break;case Y:return s=_o(12,d,c,T|2),s.elementType=Y,s.lanes=I,s;case le:return s=_o(13,d,c,T),s.elementType=le,s.lanes=I,s;case ue:return s=_o(19,d,c,T),s.elementType=ue,s.lanes=I,s;case Le:return Wh(d,T,I,c);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case ye:Q=10;break e;case U:Q=9;break e;case D:Q=11;break e;case Te:Q=14;break e;case Fe:Q=16,y=null;break e}throw Error(r(130,s==null?s:typeof s,""))}return c=_o(Q,d,c,T),c.elementType=s,c.type=y,c.lanes=I,c}function pu(s,c,d,y){return s=_o(7,s,y,c),s.lanes=d,s}function Wh(s,c,d,y){return s=_o(22,s,y,c),s.elementType=Le,s.lanes=d,s.stateNode={isHidden:!1},s}function i1(s,c,d){return s=_o(6,s,null,c),s.lanes=d,s}function s1(s,c,d){return c=_o(4,s.children!==null?s.children:[],s.key,c),c.lanes=d,c.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},c}function p_(s,c,d,y,T){this.tag=c,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=so(0),this.expirationTimes=so(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=so(0),this.identifierPrefix=y,this.onRecoverableError=T,this.mutableSourceEagerHydrationData=null}function o1(s,c,d,y,T,I,Q,Pe,je){return s=new p_(s,c,d,Pe,je),c===1?(c=1,I===!0&&(c|=8)):c=0,I=_o(3,null,null,c),s.current=I,I.stateNode=s,I.memoizedState={element:y,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},Hu(I),s}function g_(s,c,d){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:re,key:y==null?null:""+y,children:s,containerInfo:c,implementation:d}}function qv(s){if(!s)return kl;s=s._reactInternals;e:{if(ke(s)!==s||s.tag!==1)throw Error(r(170));var c=s;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(Ii(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(r(171))}if(s.tag===1){var d=s.type;if(Ii(d))return Xf(s,d,c)}return c}function $v(s,c,d,y,T,I,Q,Pe,je){return s=o1(d,y,!0,s,T,I,Q,Pe,je),s.context=qv(null),d=s.current,y=ds(),T=Pc(d),I=Cs(y,T),I.callback=c??null,Ps(d,I,T),s.current.lanes=T,Ms(s,T,y),Is(s,y),s}function Kh(s,c,d,y){var T=c.current,I=ds(),Q=Pc(T);return d=qv(d),c.context===null?c.context=d:c.pendingContext=d,c=Cs(I,Q),c.payload={element:s},y=y===void 0?null:y,y!==null&&(c.callback=y),s=Ps(T,c,Q),s!==null&&(Go(s,T,Q,I),Yl(s,T,Q)),Q}function Gh(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function Hv(s,c){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var d=s.retryLane;s.retryLane=d!==0&&d<c?d:c}}function l1(s,c){Hv(s,c),(s=s.alternate)&&Hv(s,c)}function m_(){return null}var Vv=typeof reportError=="function"?reportError:function(s){console.error(s)};function c1(s){this._internalRoot=s}Yh.prototype.render=c1.prototype.render=function(s){var c=this._internalRoot;if(c===null)throw Error(r(409));Kh(s,c,null,null)},Yh.prototype.unmount=c1.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var c=s.containerInfo;fu(function(){Kh(null,s,null,null)}),c[ei]=null}};function Yh(s){this._internalRoot=s}Yh.prototype.unstable_scheduleHydration=function(s){if(s){var c=zn();s={blockedOn:null,target:s,priority:c};for(var d=0;d<Xa.length&&c!==0&&c<Xa[d].priority;d++);Xa.splice(d,0,s),d===0&&lo(s)}};function u1(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function Xh(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function Wv(){}function v_(s,c,d,y,T){if(T){if(typeof y=="function"){var I=y;y=function(){var lt=Gh(Q);I.call(lt)}}var Q=$v(c,y,s,0,null,!1,!1,"",Wv);return s._reactRootContainer=Q,s[ei]=Q.current,$l(s.nodeType===8?s.parentNode:s),fu(),Q}for(;T=s.lastChild;)s.removeChild(T);if(typeof y=="function"){var Pe=y;y=function(){var lt=Gh(je);Pe.call(lt)}}var je=o1(s,0,!1,null,null,!1,!1,"",Wv);return s._reactRootContainer=je,s[ei]=je.current,$l(s.nodeType===8?s.parentNode:s),fu(function(){Kh(c,je,d,y)}),je}function Jh(s,c,d,y,T){var I=d._reactRootContainer;if(I){var Q=I;if(typeof T=="function"){var Pe=T;T=function(){var je=Gh(Q);Pe.call(je)}}Kh(c,Q,s,T)}else Q=v_(d,c,s,T,y);return Gh(Q)}dl=function(s){switch(s.tag){case 3:var c=s.stateNode;if(c.current.memoizedState.isDehydrated){var d=Qi(c.pendingLanes);d!==0&&(Po(c,d|1),Is(c,kt()),(dn&6)===0&&(nf=kt()+500,R()))}break;case 13:fu(function(){var y=vn(s,1);if(y!==null){var T=ds();Go(y,s,1,T)}}),l1(s,1)}},Ul=function(s){if(s.tag===13){var c=vn(s,134217728);if(c!==null){var d=ds();Go(c,s,134217728,d)}l1(s,134217728)}},pc=function(s){if(s.tag===13){var c=Pc(s),d=vn(s,c);if(d!==null){var y=ds();Go(d,s,c,y)}l1(s,c)}},zn=function(){return sn},ki=function(s,c){var d=sn;try{return sn=s,c()}finally{sn=d}},At=function(s,c,d){switch(c){case"input":if(mt(s,d),c=d.name,d.type==="radio"&&c!=null){for(d=s;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<d.length;c++){var y=d[c];if(y!==s&&y.form===s.form){var T=iu(y);if(!T)throw Error(r(90));se(y),mt(y,T)}}}break;case"textarea":nr(s,d);break;case"select":c=d.value,c!=null&&Et(s,!!d.multiple,c,!1)}},Ln=t1,Jr=fu;var x_={usingClientEntryPoint:!1,Events:[yc,Wl,iu,ar,Or,t1]},l0={findFiberByHostInstance:_l,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},y_={bundleType:l0.bundleType,version:l0.version,rendererPackageName:l0.rendererPackageName,rendererConfig:l0.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:K.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=rt(s),s===null?null:s.stateNode},findFiberByHostInstance:l0.findFiberByHostInstance||m_,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Qh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qh.isDisabled&&Qh.supportsFiber)try{Ga=Qh.inject(y_),Fn=Qh}catch{}}return Rs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=x_,Rs.createPortal=function(s,c){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u1(c))throw Error(r(200));return g_(s,c,null,d)},Rs.createRoot=function(s,c){if(!u1(s))throw Error(r(299));var d=!1,y="",T=Vv;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(y=c.identifierPrefix),c.onRecoverableError!==void 0&&(T=c.onRecoverableError)),c=o1(s,1,!1,null,null,d,!1,y,T),s[ei]=c.current,$l(s.nodeType===8?s.parentNode:s),new c1(c)},Rs.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var c=s._reactInternals;if(c===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=rt(c),s=s===null?null:s.stateNode,s},Rs.flushSync=function(s){return fu(s)},Rs.hydrate=function(s,c,d){if(!Xh(c))throw Error(r(200));return Jh(null,s,c,!0,d)},Rs.hydrateRoot=function(s,c,d){if(!u1(s))throw Error(r(405));var y=d!=null&&d.hydratedSources||null,T=!1,I="",Q=Vv;if(d!=null&&(d.unstable_strictMode===!0&&(T=!0),d.identifierPrefix!==void 0&&(I=d.identifierPrefix),d.onRecoverableError!==void 0&&(Q=d.onRecoverableError)),c=$v(c,null,s,1,d??null,T,!1,I,Q),s[ei]=c.current,$l(s),y)for(s=0;s<y.length;s++)d=y[s],T=d._getVersion,T=T(d._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[d,T]:c.mutableSourceEagerHydrationData.push(d,T);return new Yh(c)},Rs.render=function(s,c,d){if(!Xh(c))throw Error(r(200));return Jh(null,s,c,!1,d)},Rs.unmountComponentAtNode=function(s){if(!Xh(s))throw Error(r(40));return s._reactRootContainer?(fu(function(){Jh(null,null,s,!1,function(){s._reactRootContainer=null,s[ei]=null})}),!0):!1},Rs.unstable_batchedUpdates=t1,Rs.unstable_renderSubtreeIntoContainer=function(s,c,d,y){if(!Xh(d))throw Error(r(200));if(s==null||s._reactInternals===void 0)throw Error(r(38));return Jh(s,c,d,!1,y)},Rs.version="18.3.1-next-f1338f8080-20240426",Rs}var e2;function Sy(){if(e2)return d1.exports;e2=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),d1.exports=N_(),d1.exports}var t2;function T_(){if(t2)return Zh;t2=1;var e=Sy();return Zh.createRoot=e.createRoot,Zh.hydrateRoot=e.hydrateRoot,Zh}var C_=T_();/**
 * react-router v7.7.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var r2="popstate";function P_(e={}){function t(n,a){let{pathname:i,search:o,hash:l}=n.location;return J1("",{pathname:i,search:o,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:D0(a)}return F_(t,r,null,e)}function na(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function ol(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function L_(){return Math.random().toString(36).substring(2,10)}function n2(e,t){return{usr:e.state,key:e.key,idx:t}}function J1(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?jf(t):t,state:r,key:t&&t.key||n||L_()}}function D0({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function jf(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function F_(e,t,r,n={}){let{window:a=document.defaultView,v5Compat:i=!1}=n,o=a.history,l="POP",u=null,f=h();f==null&&(f=0,o.replaceState({...o.state,idx:f},""));function h(){return(o.state||{idx:null}).idx}function g(){l="POP";let E=h(),N=E==null?null:E-f;f=E,u&&u({action:l,location:b.location,delta:N})}function x(E,N){l="PUSH";let O=J1(b.location,E,N);f=h()+1;let F=n2(O,f),K=b.createHref(O);try{o.pushState(F,"",K)}catch(te){if(te instanceof DOMException&&te.name==="DataCloneError")throw te;a.location.assign(K)}i&&u&&u({action:l,location:b.location,delta:1})}function m(E,N){l="REPLACE";let O=J1(b.location,E,N);f=h();let F=n2(O,f),K=b.createHref(O);o.replaceState(F,"",K),i&&u&&u({action:l,location:b.location,delta:0})}function k(E){return O_(E)}let b={get action(){return l},get location(){return e(a,o)},listen(E){if(u)throw new Error("A history only accepts one active listener");return a.addEventListener(r2,g),u=E,()=>{a.removeEventListener(r2,g),u=null}},createHref(E){return t(a,E)},createURL:k,encodeLocation(E){let N=k(E);return{pathname:N.pathname,search:N.search,hash:N.hash}},push:x,replace:m,go(E){return o.go(E)}};return b}function O_(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),na(r,"No window.location.(origin|href) available to create URL");let n=typeof e=="string"?e:D0(e);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function Ey(e,t,r="/"){return I_(e,t,r,!1)}function I_(e,t,r,n){let a=typeof t=="string"?jf(t):t,i=oc(a.pathname||"/",r);if(i==null)return null;let o=Ay(e);R_(o);let l=null;for(let u=0;l==null&&u<o.length;++u){let f=W_(i);l=H_(o[u],f,n)}return l}function Ay(e,t=[],r=[],n=""){let a=(i,o,l)=>{let u={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};u.relativePath.startsWith("/")&&(na(u.relativePath.startsWith(n),`Absolute route path "${u.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(n.length));let f=ac([n,u.relativePath]),h=r.concat(u);i.children&&i.children.length>0&&(na(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),Ay(i.children,t,h,f)),!(i.path==null&&!i.index)&&t.push({path:f,score:q_(f,i.index),routesMeta:h})};return e.forEach((i,o)=>{if(i.path===""||!i.path?.includes("?"))a(i,o);else for(let l of Ny(i.path))a(i,o,l)}),t}function Ny(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let o=Ny(n.join("/")),l=[];return l.push(...o.map(u=>u===""?i:[i,u].join("/"))),a&&l.push(...o),l.map(u=>e.startsWith("/")&&u===""?"/":u)}function R_(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:$_(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var D_=/^:[\w-]+$/,j_=3,M_=2,B_=1,U_=10,z_=-2,a2=e=>e==="*";function q_(e,t){let r=e.split("/"),n=r.length;return r.some(a2)&&(n+=z_),t&&(n+=M_),r.filter(a=>!a2(a)).reduce((a,i)=>a+(D_.test(i)?j_:i===""?B_:U_),n)}function $_(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function H_(e,t,r=!1){let{routesMeta:n}=e,a={},i="/",o=[];for(let l=0;l<n.length;++l){let u=n[l],f=l===n.length-1,h=i==="/"?t:t.slice(i.length)||"/",g=Pd({path:u.relativePath,caseSensitive:u.caseSensitive,end:f},h),x=u.route;if(!g&&f&&r&&!n[n.length-1].route.index&&(g=Pd({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},h)),!g)return null;Object.assign(a,g.params),o.push({params:a,pathname:ac([i,g.pathname]),pathnameBase:X_(ac([i,g.pathnameBase])),route:x}),g.pathnameBase!=="/"&&(i=ac([i,g.pathnameBase]))}return o}function Pd(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=V_(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:n.reduce((f,{paramName:h,isOptional:g},x)=>{if(h==="*"){let k=l[x]||"";o=i.slice(0,i.length-k.length).replace(/(.)\/+$/,"$1")}const m=l[x];return g&&!m?f[h]=void 0:f[h]=(m||"").replace(/%2F/g,"/"),f},{}),pathname:i,pathnameBase:o,pattern:e}}function V_(e,t=!1,r=!0){ol(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,u)=>(n.push({paramName:l,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function W_(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return ol(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function oc(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function K_(e,t="/"){let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?jf(e):e;return{pathname:r?r.startsWith("/")?r:G_(r,t):t,search:J_(n),hash:Q_(a)}}function G_(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function m1(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Y_(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function $g(e){let t=Y_(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function Hg(e,t,r,n=!1){let a;typeof e=="string"?a=jf(e):(a={...e},na(!a.pathname||!a.pathname.includes("?"),m1("?","pathname","search",a)),na(!a.pathname||!a.pathname.includes("#"),m1("#","pathname","hash",a)),na(!a.search||!a.search.includes("#"),m1("#","search","hash",a)));let i=e===""||a.pathname==="",o=i?"/":a.pathname,l;if(o==null)l=r;else{let g=t.length-1;if(!n&&o.startsWith("..")){let x=o.split("/");for(;x[0]==="..";)x.shift(),g-=1;a.pathname=x.join("/")}l=g>=0?t[g]:"/"}let u=K_(a,l),f=o&&o!=="/"&&o.endsWith("/"),h=(i||o===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(f||h)&&(u.pathname+="/"),u}var ac=e=>e.join("/").replace(/\/\/+/g,"/"),X_=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),J_=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Q_=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function Z_(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var Ty=["POST","PUT","PATCH","DELETE"];new Set(Ty);var e4=["GET",...Ty];new Set(e4);var Mf=ce.createContext(null);Mf.displayName="DataRouter";var ip=ce.createContext(null);ip.displayName="DataRouterState";ce.createContext(!1);var Cy=ce.createContext({isTransitioning:!1});Cy.displayName="ViewTransition";var t4=ce.createContext(new Map);t4.displayName="Fetchers";var r4=ce.createContext(null);r4.displayName="Await";var cl=ce.createContext(null);cl.displayName="Navigation";var ih=ce.createContext(null);ih.displayName="Location";var Il=ce.createContext({outlet:null,matches:[],isDataRoute:!1});Il.displayName="Route";var Vg=ce.createContext(null);Vg.displayName="RouteError";function n4(e,{relative:t}={}){na(Bf(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=ce.useContext(cl),{hash:a,pathname:i,search:o}=sh(e,{relative:t}),l=i;return r!=="/"&&(l=i==="/"?r:ac([r,i])),n.createHref({pathname:l,search:o,hash:a})}function Bf(){return ce.useContext(ih)!=null}function fc(){return na(Bf(),"useLocation() may be used only in the context of a <Router> component."),ce.useContext(ih).location}var Py="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Ly(e){ce.useContext(cl).static||ce.useLayoutEffect(e)}function Fy(){let{isDataRoute:e}=ce.useContext(Il);return e?m4():a4()}function a4(){na(Bf(),"useNavigate() may be used only in the context of a <Router> component.");let e=ce.useContext(Mf),{basename:t,navigator:r}=ce.useContext(cl),{matches:n}=ce.useContext(Il),{pathname:a}=fc(),i=JSON.stringify($g(n)),o=ce.useRef(!1);return Ly(()=>{o.current=!0}),ce.useCallback((u,f={})=>{if(ol(o.current,Py),!o.current)return;if(typeof u=="number"){r.go(u);return}let h=Hg(u,JSON.parse(i),a,f.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:ac([t,h.pathname])),(f.replace?r.replace:r.push)(h,f.state,f)},[t,r,i,a,e])}ce.createContext(null);function sh(e,{relative:t}={}){let{matches:r}=ce.useContext(Il),{pathname:n}=fc(),a=JSON.stringify($g(r));return ce.useMemo(()=>Hg(e,JSON.parse(a),n,t==="path"),[e,a,n,t])}function i4(e,t){return Oy(e,t)}function Oy(e,t,r,n){na(Bf(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=ce.useContext(cl),{matches:i}=ce.useContext(Il),o=i[i.length-1],l=o?o.params:{},u=o?o.pathname:"/",f=o?o.pathnameBase:"/",h=o&&o.route;{let N=h&&h.path||"";Iy(u,!h||N.endsWith("*")||N.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${N}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${N}"> to <Route path="${N==="/"?"*":`${N}/*`}">.`)}let g=fc(),x;if(t){let N=typeof t=="string"?jf(t):t;na(f==="/"||N.pathname?.startsWith(f),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${f}" but pathname "${N.pathname}" was given in the \`location\` prop.`),x=N}else x=g;let m=x.pathname||"/",k=m;if(f!=="/"){let N=f.replace(/^\//,"").split("/");k="/"+m.replace(/^\//,"").split("/").slice(N.length).join("/")}let b=Ey(e,{pathname:k});ol(h||b!=null,`No routes matched location "${x.pathname}${x.search}${x.hash}" `),ol(b==null||b[b.length-1].route.element!==void 0||b[b.length-1].route.Component!==void 0||b[b.length-1].route.lazy!==void 0,`Matched leaf route at location "${x.pathname}${x.search}${x.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let E=u4(b&&b.map(N=>Object.assign({},N,{params:Object.assign({},l,N.params),pathname:ac([f,a.encodeLocation?a.encodeLocation(N.pathname).pathname:N.pathname]),pathnameBase:N.pathnameBase==="/"?f:ac([f,a.encodeLocation?a.encodeLocation(N.pathnameBase).pathname:N.pathnameBase])})),i,r,n);return t&&E?ce.createElement(ih.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...x},navigationType:"POP"}},E):E}function s4(){let e=g4(),t=Z_(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},i={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=ce.createElement(ce.Fragment,null,ce.createElement("p",null," Hey developer "),ce.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",ce.createElement("code",{style:i},"ErrorBoundary")," or"," ",ce.createElement("code",{style:i},"errorElement")," prop on your route.")),ce.createElement(ce.Fragment,null,ce.createElement("h2",null,"Unexpected Application Error!"),ce.createElement("h3",{style:{fontStyle:"italic"}},t),r?ce.createElement("pre",{style:a},r):null,o)}var o4=ce.createElement(s4,null),l4=class extends ce.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?ce.createElement(Il.Provider,{value:this.props.routeContext},ce.createElement(Vg.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function c4({routeContext:e,match:t,children:r}){let n=ce.useContext(Mf);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),ce.createElement(Il.Provider,{value:e},r)}function u4(e,t=[],r=null,n=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let a=e,i=r?.errors;if(i!=null){let u=a.findIndex(f=>f.route.id&&i?.[f.route.id]!==void 0);na(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),a=a.slice(0,Math.min(a.length,u+1))}let o=!1,l=-1;if(r)for(let u=0;u<a.length;u++){let f=a[u];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(l=u),f.route.id){let{loaderData:h,errors:g}=r,x=f.route.loader&&!h.hasOwnProperty(f.route.id)&&(!g||g[f.route.id]===void 0);if(f.route.lazy||x){o=!0,l>=0?a=a.slice(0,l+1):a=[a[0]];break}}}return a.reduceRight((u,f,h)=>{let g,x=!1,m=null,k=null;r&&(g=i&&f.route.id?i[f.route.id]:void 0,m=f.route.errorElement||o4,o&&(l<0&&h===0?(Iy("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),x=!0,k=null):l===h&&(x=!0,k=f.route.hydrateFallbackElement||null)));let b=t.concat(a.slice(0,h+1)),E=()=>{let N;return g?N=m:x?N=k:f.route.Component?N=ce.createElement(f.route.Component,null):f.route.element?N=f.route.element:N=u,ce.createElement(c4,{match:f,routeContext:{outlet:u,matches:b,isDataRoute:r!=null},children:N})};return r&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?ce.createElement(l4,{location:r.location,revalidation:r.revalidation,component:m,error:g,children:E(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):E()},null)}function Wg(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function f4(e){let t=ce.useContext(Mf);return na(t,Wg(e)),t}function h4(e){let t=ce.useContext(ip);return na(t,Wg(e)),t}function d4(e){let t=ce.useContext(Il);return na(t,Wg(e)),t}function Kg(e){let t=d4(e),r=t.matches[t.matches.length-1];return na(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function p4(){return Kg("useRouteId")}function g4(){let e=ce.useContext(Vg),t=h4("useRouteError"),r=Kg("useRouteError");return e!==void 0?e:t.errors?.[r]}function m4(){let{router:e}=f4("useNavigate"),t=Kg("useNavigate"),r=ce.useRef(!1);return Ly(()=>{r.current=!0}),ce.useCallback(async(a,i={})=>{ol(r.current,Py),r.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:t,...i}))},[e,t])}var i2={};function Iy(e,t,r){!t&&!i2[e]&&(i2[e]=!0,ol(!1,r))}ce.memo(v4);function v4({routes:e,future:t,state:r}){return Oy(e,void 0,r,t)}function s2({to:e,replace:t,state:r,relative:n}){na(Bf(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=ce.useContext(cl);ol(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=ce.useContext(Il),{pathname:o}=fc(),l=Fy(),u=Hg(e,$g(i),o,n==="path"),f=JSON.stringify(u);return ce.useEffect(()=>{l(JSON.parse(f),{replace:t,state:r,relative:n})},[l,f,n,t,r]),null}function p0(e){na(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function x4({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:a,static:i=!1}){na(!Bf(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),l=ce.useMemo(()=>({basename:o,navigator:a,static:i,future:{}}),[o,a,i]);typeof r=="string"&&(r=jf(r));let{pathname:u="/",search:f="",hash:h="",state:g=null,key:x="default"}=r,m=ce.useMemo(()=>{let k=oc(u,o);return k==null?null:{location:{pathname:k,search:f,hash:h,state:g,key:x},navigationType:n}},[o,u,f,h,g,x,n]);return ol(m!=null,`<Router basename="${o}"> is not able to match the URL "${u}${f}${h}" because it does not start with the basename, so the <Router> won't render anything.`),m==null?null:ce.createElement(cl.Provider,{value:l},ce.createElement(ih.Provider,{children:t,value:m}))}function y4({children:e,location:t}){return i4(Q1(e),t)}function Q1(e,t=[]){let r=[];return ce.Children.forEach(e,(n,a)=>{if(!ce.isValidElement(n))return;let i=[...t,a];if(n.type===ce.Fragment){r.push.apply(r,Q1(n.props.children,i));return}na(n.type===p0,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),na(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=Q1(n.props.children,i)),r.push(o)}),r}var _d="get",kd="application/x-www-form-urlencoded";function sp(e){return e!=null&&typeof e.tagName=="string"}function w4(e){return sp(e)&&e.tagName.toLowerCase()==="button"}function b4(e){return sp(e)&&e.tagName.toLowerCase()==="form"}function _4(e){return sp(e)&&e.tagName.toLowerCase()==="input"}function k4(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function S4(e,t){return e.button===0&&(!t||t==="_self")&&!k4(e)}var ed=null;function E4(){if(ed===null)try{new FormData(document.createElement("form"),0),ed=!1}catch{ed=!0}return ed}var A4=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function v1(e){return e!=null&&!A4.has(e)?(ol(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${kd}"`),null):e}function N4(e,t){let r,n,a,i,o;if(b4(e)){let l=e.getAttribute("action");n=l?oc(l,t):null,r=e.getAttribute("method")||_d,a=v1(e.getAttribute("enctype"))||kd,i=new FormData(e)}else if(w4(e)||_4(e)&&(e.type==="submit"||e.type==="image")){let l=e.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=e.getAttribute("formaction")||l.getAttribute("action");if(n=u?oc(u,t):null,r=e.getAttribute("formmethod")||l.getAttribute("method")||_d,a=v1(e.getAttribute("formenctype"))||v1(l.getAttribute("enctype"))||kd,i=new FormData(l,e),!E4()){let{name:f,type:h,value:g}=e;if(h==="image"){let x=f?`${f}.`:"";i.append(`${x}x`,"0"),i.append(`${x}y`,"0")}else f&&i.append(f,g)}}else{if(sp(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=_d,n=null,a=kd,o=e}return i&&a==="text/plain"&&(o=i,i=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Gg(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function T4(e,t,r){let n=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return n.pathname==="/"?n.pathname=`_root.${r}`:t&&oc(n.pathname,t)==="/"?n.pathname=`${t.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function C4(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function P4(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function L4(e,t,r){let n=await Promise.all(e.map(async a=>{let i=t.routes[a.route.id];if(i){let o=await C4(i,r);return o.links?o.links():[]}return[]}));return R4(n.flat(1).filter(P4).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function o2(e,t,r,n,a,i){let o=(u,f)=>r[f]?u.route.id!==r[f].route.id:!0,l=(u,f)=>r[f].pathname!==u.pathname||r[f].route.path?.endsWith("*")&&r[f].params["*"]!==u.params["*"];return i==="assets"?t.filter((u,f)=>o(u,f)||l(u,f)):i==="data"?t.filter((u,f)=>{let h=n.routes[u.route.id];if(!h||!h.hasLoader)return!1;if(o(u,f)||l(u,f))return!0;if(u.route.shouldRevalidate){let g=u.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:r[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof g=="boolean")return g}return!0}):[]}function F4(e,t,{includeHydrateFallback:r}={}){return O4(e.map(n=>{let a=t.routes[n.route.id];if(!a)return[];let i=[a.module];return a.clientActionModule&&(i=i.concat(a.clientActionModule)),a.clientLoaderModule&&(i=i.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(i=i.concat(a.hydrateFallbackModule)),a.imports&&(i=i.concat(a.imports)),i}).flat(1))}function O4(e){return[...new Set(e)]}function I4(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function R4(e,t){let r=new Set;return new Set(t),e.reduce((n,a)=>{let i=JSON.stringify(I4(a));return r.has(i)||(r.add(i),n.push({key:i,link:a})),n},[])}function Ry(){let e=ce.useContext(Mf);return Gg(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function D4(){let e=ce.useContext(ip);return Gg(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Yg=ce.createContext(void 0);Yg.displayName="FrameworkContext";function Dy(){let e=ce.useContext(Yg);return Gg(e,"You must render this element inside a <HydratedRouter> element"),e}function j4(e,t){let r=ce.useContext(Yg),[n,a]=ce.useState(!1),[i,o]=ce.useState(!1),{onFocus:l,onBlur:u,onMouseEnter:f,onMouseLeave:h,onTouchStart:g}=t,x=ce.useRef(null);ce.useEffect(()=>{if(e==="render"&&o(!0),e==="viewport"){let b=N=>{N.forEach(O=>{o(O.isIntersecting)})},E=new IntersectionObserver(b,{threshold:.5});return x.current&&E.observe(x.current),()=>{E.disconnect()}}},[e]),ce.useEffect(()=>{if(n){let b=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(b)}}},[n]);let m=()=>{a(!0)},k=()=>{a(!1),o(!1)};return r?e!=="intent"?[i,x,{}]:[i,x,{onFocus:u0(l,m),onBlur:u0(u,k),onMouseEnter:u0(f,m),onMouseLeave:u0(h,k),onTouchStart:u0(g,m)}]:[!1,x,{}]}function u0(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function M4({page:e,...t}){let{router:r}=Ry(),n=ce.useMemo(()=>Ey(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?ce.createElement(U4,{page:e,matches:n,...t}):null}function B4(e){let{manifest:t,routeModules:r}=Dy(),[n,a]=ce.useState([]);return ce.useEffect(()=>{let i=!1;return L4(e,t,r).then(o=>{i||a(o)}),()=>{i=!0}},[e,t,r]),n}function U4({page:e,matches:t,...r}){let n=fc(),{manifest:a,routeModules:i}=Dy(),{basename:o}=Ry(),{loaderData:l,matches:u}=D4(),f=ce.useMemo(()=>o2(e,t,u,a,n,"data"),[e,t,u,a,n]),h=ce.useMemo(()=>o2(e,t,u,a,n,"assets"),[e,t,u,a,n]),g=ce.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let k=new Set,b=!1;if(t.forEach(N=>{let O=a.routes[N.route.id];!O||!O.hasLoader||(!f.some(F=>F.route.id===N.route.id)&&N.route.id in l&&i[N.route.id]?.shouldRevalidate||O.hasClientLoader?b=!0:k.add(N.route.id))}),k.size===0)return[];let E=T4(e,o,"data");return b&&k.size>0&&E.searchParams.set("_routes",t.filter(N=>k.has(N.route.id)).map(N=>N.route.id).join(",")),[E.pathname+E.search]},[o,l,n,a,f,t,e,i]),x=ce.useMemo(()=>F4(h,a),[h,a]),m=B4(h);return ce.createElement(ce.Fragment,null,g.map(k=>ce.createElement("link",{key:k,rel:"prefetch",as:"fetch",href:k,...r})),x.map(k=>ce.createElement("link",{key:k,rel:"modulepreload",href:k,...r})),m.map(({key:k,link:b})=>ce.createElement("link",{key:k,...b})))}function z4(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var jy=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{jy&&(window.__reactRouterVersion="7.7.0")}catch{}function q4({basename:e,children:t,window:r}){let n=ce.useRef();n.current==null&&(n.current=P_({window:r,v5Compat:!0}));let a=n.current,[i,o]=ce.useState({action:a.action,location:a.location}),l=ce.useCallback(u=>{ce.startTransition(()=>o(u))},[o]);return ce.useLayoutEffect(()=>a.listen(l),[a,l]),ce.createElement(x4,{basename:e,children:t,location:i.location,navigationType:i.action,navigator:a})}var My=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ld=ce.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:a,reloadDocument:i,replace:o,state:l,target:u,to:f,preventScrollReset:h,viewTransition:g,...x},m){let{basename:k}=ce.useContext(cl),b=typeof f=="string"&&My.test(f),E,N=!1;if(typeof f=="string"&&b&&(E=f,jy))try{let Y=new URL(window.location.href),ye=f.startsWith("//")?new URL(Y.protocol+f):new URL(f),U=oc(ye.pathname,k);ye.origin===Y.origin&&U!=null?f=U+ye.search+ye.hash:N=!0}catch{ol(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let O=n4(f,{relative:a}),[F,K,te]=j4(n,x),re=W4(f,{replace:o,state:l,target:u,preventScrollReset:h,relative:a,viewTransition:g});function B(Y){t&&t(Y),Y.defaultPrevented||re(Y)}let V=ce.createElement("a",{...x,...te,href:E||O,onClick:N||i?t:B,ref:z4(m,K),target:u,"data-discover":!b&&r==="render"?"true":void 0});return F&&!b?ce.createElement(ce.Fragment,null,V,ce.createElement(M4,{page:O})):V});Ld.displayName="Link";var $4=ce.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:a=!1,style:i,to:o,viewTransition:l,children:u,...f},h){let g=sh(o,{relative:f.relative}),x=fc(),m=ce.useContext(ip),{navigator:k,basename:b}=ce.useContext(cl),E=m!=null&&J4(g)&&l===!0,N=k.encodeLocation?k.encodeLocation(g).pathname:g.pathname,O=x.pathname,F=m&&m.navigation&&m.navigation.location?m.navigation.location.pathname:null;r||(O=O.toLowerCase(),F=F?F.toLowerCase():null,N=N.toLowerCase()),F&&b&&(F=oc(F,b)||F);const K=N!=="/"&&N.endsWith("/")?N.length-1:N.length;let te=O===N||!a&&O.startsWith(N)&&O.charAt(K)==="/",re=F!=null&&(F===N||!a&&F.startsWith(N)&&F.charAt(N.length)==="/"),B={isActive:te,isPending:re,isTransitioning:E},V=te?t:void 0,Y;typeof n=="function"?Y=n(B):Y=[n,te?"active":null,re?"pending":null,E?"transitioning":null].filter(Boolean).join(" ");let ye=typeof i=="function"?i(B):i;return ce.createElement(Ld,{...f,"aria-current":V,className:Y,ref:h,style:ye,to:o,viewTransition:l},typeof u=="function"?u(B):u)});$4.displayName="NavLink";var H4=ce.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:a,state:i,method:o=_d,action:l,onSubmit:u,relative:f,preventScrollReset:h,viewTransition:g,...x},m)=>{let k=Y4(),b=X4(l,{relative:f}),E=o.toLowerCase()==="get"?"get":"post",N=typeof l=="string"&&My.test(l),O=F=>{if(u&&u(F),F.defaultPrevented)return;F.preventDefault();let K=F.nativeEvent.submitter,te=K?.getAttribute("formmethod")||o;k(K||F.currentTarget,{fetcherKey:t,method:te,navigate:r,replace:a,state:i,relative:f,preventScrollReset:h,viewTransition:g})};return ce.createElement("form",{ref:m,method:E,action:b,onSubmit:n?u:O,...x,"data-discover":!N&&e==="render"?"true":void 0})});H4.displayName="Form";function V4(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function By(e){let t=ce.useContext(Mf);return na(t,V4(e)),t}function W4(e,{target:t,replace:r,state:n,preventScrollReset:a,relative:i,viewTransition:o}={}){let l=Fy(),u=fc(),f=sh(e,{relative:i});return ce.useCallback(h=>{if(S4(h,t)){h.preventDefault();let g=r!==void 0?r:D0(u)===D0(f);l(e,{replace:g,state:n,preventScrollReset:a,relative:i,viewTransition:o})}},[u,l,f,r,n,t,e,a,i,o])}var K4=0,G4=()=>`__${String(++K4)}__`;function Y4(){let{router:e}=By("useSubmit"),{basename:t}=ce.useContext(cl),r=p4();return ce.useCallback(async(n,a={})=>{let{action:i,method:o,encType:l,formData:u,body:f}=N4(n,t);if(a.navigate===!1){let h=a.fetcherKey||G4();await e.fetch(h,r,a.action||i,{preventScrollReset:a.preventScrollReset,formData:u,body:f,formMethod:a.method||o,formEncType:a.encType||l,flushSync:a.flushSync})}else await e.navigate(a.action||i,{preventScrollReset:a.preventScrollReset,formData:u,body:f,formMethod:a.method||o,formEncType:a.encType||l,replace:a.replace,state:a.state,fromRouteId:r,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,t,r])}function X4(e,{relative:t}={}){let{basename:r}=ce.useContext(cl),n=ce.useContext(Il);na(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),i={...sh(e||".",{relative:t})},o=fc();if(e==null){i.search=o.search;let l=new URLSearchParams(i.search),u=l.getAll("index");if(u.some(h=>h==="")){l.delete("index"),u.filter(g=>g).forEach(g=>l.append("index",g));let h=l.toString();i.search=h?`?${h}`:""}}return(!e||e===".")&&a.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(i.pathname=i.pathname==="/"?r:ac([r,i.pathname])),D0(i)}function J4(e,t={}){let r=ce.useContext(Cy);na(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=By("useViewTransitionState"),a=sh(e,{relative:t.relative});if(!r.isTransitioning)return!1;let i=oc(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=oc(r.nextLocation.pathname,n)||r.nextLocation.pathname;return Pd(a.pathname,o)!=null||Pd(a.pathname,i)!=null}var g0=Sy();/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Q4={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z4=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),$r=(e,t)=>{const r=ce.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:l="",children:u,...f},h)=>ce.createElement("svg",{ref:h,...Q4,width:a,height:a,stroke:n,strokeWidth:o?Number(i)*24/Number(a):i,className:["lucide",`lucide-${Z4(e)}`,l].join(" "),...f},[...t.map(([g,x])=>ce.createElement(g,x)),...Array.isArray(u)?u:[u]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const op=$r("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e3=$r("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uy=$r("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t3=$r("BedDouble",[["path",{d:"M2 20v-8a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v8",key:"1k78r4"}],["path",{d:"M4 10V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4",key:"fb3tl2"}],["path",{d:"M12 4v6",key:"1dcgq2"}],["path",{d:"M2 18h20",key:"ajqnye"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zy=$r("Bed",[["path",{d:"M2 4v16",key:"vw9hq8"}],["path",{d:"M2 8h18a2 2 0 0 1 2 2v10",key:"1dgv2r"}],["path",{d:"M2 17h20",key:"18nfp3"}],["path",{d:"M6 8v9",key:"1yriud"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ef=$r("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fd=$r("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x1=$r("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qy=$r("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r3=$r("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xg=$r("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n3=$r("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $y=$r("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a3=$r("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j0=$r("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i3=$r("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l2=$r("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hy=$r("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s3=$r("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c2=$r("Hotel",[["path",{d:"M18 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2Z",key:"p9z69c"}],["path",{d:"m9 16 .348-.24c1.465-1.013 3.84-1.013 5.304 0L15 16",key:"1bvcvh"}],["path",{d:"M8 7h.01",key:"1vti4s"}],["path",{d:"M16 7h.01",key:"1kdx03"}],["path",{d:"M12 7h.01",key:"1ivr5q"}],["path",{d:"M12 11h.01",key:"z322tv"}],["path",{d:"M16 11h.01",key:"xkw8gn"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M10 22v-6.5m4 0V22",key:"16gs4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o3=$r("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vy=$r("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jg=$r("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l3=$r("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wy=$r("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c3=$r("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u3=$r("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Od=$r("Plane",[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Id=$r("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ky=$r("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qg=$r("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f3=$r("Scan",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z1=$r("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zg=$r("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h3=$r("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eg=$r("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u2=$r("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rd=$r("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d3=$r("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tu=$r("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gy=$r("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p3=$r("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g3=$r("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const em=$r("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Yy=ce.createContext(void 0),tm=()=>{const e=ce.useContext(Yy);if(!e)throw new Error("useSettings must be used within a SettingsProvider");return e},m3=({children:e})=>{const[t,r]=ce.useState(()=>localStorage.getItem("travelpro-theme")||"light"),[n,a]=ce.useState(()=>localStorage.getItem("travelpro-language")||"en");ce.useEffect(()=>{localStorage.setItem("travelpro-theme",t),t==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[t]),ce.useEffect(()=>{localStorage.setItem("travelpro-language",n),n==="ar"?(document.documentElement.dir="rtl",document.documentElement.lang="ar"):(document.documentElement.dir="ltr",document.documentElement.lang=n)},[n]);const i=l=>{r(l)},o=l=>{a(l)};return A.jsx(Yy.Provider,{value:{theme:t,language:n,setTheme:i,setLanguage:o},children:e})},f2={en:{welcome:"Welcome to Agence de Voyage!",dashboard:"Dashboard",settings:"Settings",save:"Save",cancel:"Cancel",close:"Close",loading:"Loading...",error:"Error",success:"Success",agentDashboard:"Agent Dashboard",createInvoice:"Create Invoice",createAndManage:"Create and manage client invoices efficiently",todaysActivity:"Today's Activity",performance:"Performance",quickTip:"Quick Tip",recentInvoices:"Your Recent Invoices",readyToStart:"Ready to get started?",createFirstInvoice:"Create your first invoice to begin tracking your client billing.",createYourFirst:"Create Your First Invoice",createNewInvoice:"Create New Invoice",fillDetails:"Fill in the details to generate an invoice for your client",clientInformation:"Client Information",clientName:"Client Name",emailAddress:"Email Address",phoneNumber:"Phone Number",dueDate:"Due Date",address:"Address",servicesItems:"Services & Items",addItem:"Add Item",serviceDescription:"Service/Description",quantity:"Quantity",unitPrice:"Unit Price",total:"Total",invoiceSummary:"Invoice Summary",subtotal:"Subtotal",tax:"Tax",currency:"DH",additionalNotes:"Additional Notes",saveAsDraft:"Save as Draft",createAndSend:"Create & Send",umrahDetails:"Umrah Details",travelInfo:"Travel and accommodation information",passportNumber:"Passport Number",flightNumber:"Flight Number",departureDate:"Departure Date",roomType:"Room Type",visaStatus:"Visa Status",gender:"Gender",male:"Male",female:"Female",double:"Double",triple:"Triple",quad:"Quad",quint:"Quint",visaPending:"Pending",visaIssued:"Issued",scanPassport:"Scan ",scanning:"Scanning...",dateOfBirth:"Date of Birth",ocrError:"Failed to scan . Please try again.",settingsTitle:"Settings",appearance:"Appearance",theme:"Theme",lightMode:"Light Mode",darkMode:"Dark Mode",language:"Language",selectLanguage:"Select Language",english:"English",arabic:"",french:"Franais",chinese:"",draft:"Draft",sent:"Sent",paid:"Paid",overdue:"Overdue",totalRevenue:"Total Revenue",totalInvoices:"Total Invoices",pending:"Pending",followUpTip:"Follow up on pending invoices within 3 days to improve your collection rate and maintain good client relationships."},ar:{welcome:"    !",dashboard:" ",settings:"",save:"",cancel:"",close:"",loading:" ...",error:"",success:"",agentDashboard:"  ",createInvoice:" ",createAndManage:"    ",todaysActivity:" ",performance:"",quickTip:" ",recentInvoices:" ",readyToStart:" ",createFirstInvoice:"      .",createYourFirst:"  ",createNewInvoice:"  ",fillDetails:"    ",clientInformation:" ",clientName:" ",emailAddress:"  ",phoneNumber:" ",dueDate:" ",address:"",servicesItems:" ",addItem:" ",serviceDescription:"/",quantity:"",unitPrice:" ",total:"",invoiceSummary:" ",subtotal:" ",tax:"",currency:"",additionalNotes:" ",saveAsDraft:" ",createAndSend:" ",umrahDetails:" ",travelInfo:"  ",passportNumber:" ",flightNumber:" ",departureDate:" ",roomType:" ",visaStatus:" ",gender:"",male:"",female:"",double:"",triple:"",quad:"",quint:"",visaPending:" ",visaIssued:"",scanPassport:" ",scanning:" ...",dateOfBirth:" ",ocrError:"  .   .",settingsTitle:"",appearance:"",theme:"",lightMode:" ",darkMode:" ",language:"",selectLanguage:" ",english:"English",arabic:"",french:"Franais",chinese:"",draft:"",sent:"",paid:"",overdue:"",totalRevenue:" ",totalInvoices:" ",pending:"",followUpTip:"    3          ."},fr:{welcome:"Bienvenue chez Agence de Voyage!",dashboard:"Tableau de bord",settings:"Paramtres",save:"Enregistrer",cancel:"Annuler",close:"Fermer",loading:"Chargement...",error:"Erreur",success:"Succs",agentDashboard:"Tableau de bord Agent",createInvoice:"Crer une facture",createAndManage:"Crer et grer efficacement les factures clients",todaysActivity:"Activit d'aujourd'hui",performance:"Performance",quickTip:"Conseil rapide",recentInvoices:"Vos factures rcentes",readyToStart:"Prt  commencer?",createFirstInvoice:"Crez votre premire facture pour commencer  suivre la facturation client.",createYourFirst:"Crez votre premire facture",createNewInvoice:"Crer une nouvelle facture",fillDetails:"Remplissez les dtails pour gnrer une facture pour votre client",clientInformation:"Informations client",clientName:"Nom du client",emailAddress:"Adresse e-mail",phoneNumber:"Numro de tlphone",dueDate:"Date d'chance",address:"Adresse",servicesItems:"Services et articles",addItem:"Ajouter un article",serviceDescription:"Service/Description",quantity:"Quantit",unitPrice:"Prix unitaire",total:"Total",invoiceSummary:"Rsum de la facture",subtotal:"Sous-total",tax:"Taxe",currency:"DH",additionalNotes:"Notes supplmentaires",saveAsDraft:"Enregistrer comme brouillon",createAndSend:"Crer et envoyer",umrahDetails:"Dtails de l'Umrah",travelInfo:"Informations de voyage et d'hbergement",passportNumber:"Numro de passeport",flightNumber:"Numro de vol",departureDate:"Date de dpart",roomType:"Type de chambre",visaStatus:"Statut du visa",gender:"Sexe",male:"Homme",female:"Femme",double:"Double",triple:"Triple",quad:"Quad",quint:"Quint",visaPending:"En attente",visaIssued:"Dlivr",scanPassport:"Scanner ",scanning:"Scan en cours...",dateOfBirth:"Date de naissance",ocrError:"chec du scan. Veuillez ressayer.",settingsTitle:"Paramtres",appearance:"Apparence",theme:"Thme",lightMode:"Mode clair",darkMode:"Mode sombre",language:"Langue",selectLanguage:"Slectionner la langue",english:"English",arabic:"",french:"Franais",chinese:"",draft:"Brouillon",sent:"Envoy",paid:"Pay",overdue:"En retard",totalRevenue:"Revenus totaux",totalInvoices:"Total des factures",pending:"En attente",followUpTip:"Suivez les factures en attente dans les 3 jours pour amliorer votre taux de recouvrement et maintenir de bonnes relations clients."},zh:{welcome:"",dashboard:"",settings:"",save:"",cancel:"",close:"",loading:"...",error:"",success:"",agentDashboard:"",createInvoice:"",createAndManage:"",todaysActivity:"",performance:"",quickTip:"",recentInvoices:"",readyToStart:"",createFirstInvoice:"",createYourFirst:"",createNewInvoice:"",fillDetails:"",clientInformation:"",clientName:"",emailAddress:"",phoneNumber:"",dueDate:"",address:"",servicesItems:"",addItem:"",serviceDescription:"/",quantity:"",unitPrice:"",total:"",invoiceSummary:"",subtotal:"",tax:"",currency:"",additionalNotes:"",saveAsDraft:"",createAndSend:"",umrahDetails:"",travelInfo:"",passportNumber:"",flightNumber:"",departureDate:"",roomType:"",visaStatus:"",gender:"",male:"",female:"",double:"",triple:"",quad:"",quint:"",visaPending:"",visaIssued:"",scanPassport:"",scanning:"...",dateOfBirth:"",ocrError:"",settingsTitle:"",appearance:"",theme:"",lightMode:"",darkMode:"",language:"",selectLanguage:"",english:"English",arabic:"",french:"Franais",chinese:"",draft:"",sent:"",paid:"",overdue:"",totalRevenue:"",totalInvoices:"",pending:"",followUpTip:"3"}},rm=e=>({t:t=>f2[e][t]||f2.en[t]||t}),v3=({isOpen:e,onClose:t})=>{const{theme:r,language:n,setTheme:a,setLanguage:i}=tm(),{t:o}=rm(n);if(!e)return null;const l=[{code:"en",name:"English",nativeName:"English"},{code:"ar",name:"Arabic",nativeName:""},{code:"fr",name:"French",nativeName:"Franais"},{code:"zh",name:"Chinese",nativeName:""}];return A.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:A.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[A.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200 dark:border-gray-700",children:[A.jsxs("div",{className:"flex items-center space-x-3",children:[A.jsx("div",{className:"bg-blue-100 dark:bg-blue-900 p-2 rounded-lg",children:A.jsx(l2,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),A.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:o("settingsTitle")})]}),A.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 p-2 rounded-lg transition-colors duration-200",children:A.jsx(em,{className:"h-5 w-5"})})]}),A.jsxs("div",{className:"p-6 space-y-8",children:[A.jsxs("div",{children:[A.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center space-x-2",children:[A.jsx(u2,{className:"h-5 w-5 text-yellow-500"}),A.jsx("span",{children:o("appearance")})]}),A.jsxs("div",{className:"space-y-3",children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:o("theme")}),A.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[A.jsx("button",{onClick:()=>a("light"),className:`p-4 rounded-lg border-2 transition-all duration-200 ${r==="light"?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500"}`,children:A.jsxs("div",{className:"flex items-center space-x-3",children:[A.jsx("div",{className:"bg-yellow-100 p-2 rounded-full",children:A.jsx(u2,{className:"h-4 w-4 text-yellow-600"})}),A.jsxs("div",{className:"text-left",children:[A.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:o("lightMode")}),r==="light"&&A.jsx(x1,{className:"h-4 w-4 text-blue-500 mt-1"})]})]})}),A.jsx("button",{onClick:()=>a("dark"),className:`p-4 rounded-lg border-2 transition-all duration-200 ${r==="dark"?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500"}`,children:A.jsxs("div",{className:"flex items-center space-x-3",children:[A.jsx("div",{className:"bg-gray-100 dark:bg-gray-700 p-2 rounded-full",children:A.jsx(u3,{className:"h-4 w-4 text-gray-600 dark:text-gray-300"})}),A.jsxs("div",{className:"text-left",children:[A.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:o("darkMode")}),r==="dark"&&A.jsx(x1,{className:"h-4 w-4 text-blue-500 mt-1"})]})]})})]})]})]}),A.jsxs("div",{children:[A.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center space-x-2",children:[A.jsx(l2,{className:"h-5 w-5 text-blue-500"}),A.jsx("span",{children:o("language")})]}),A.jsxs("div",{className:"space-y-3",children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:o("selectLanguage")}),A.jsx("div",{className:"space-y-2",children:l.map(u=>A.jsx("button",{onClick:()=>i(u.code),className:`w-full p-3 rounded-lg border-2 transition-all duration-200 text-left ${n===u.code?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500"}`,children:A.jsxs("div",{className:"flex items-center justify-between",children:[A.jsxs("div",{children:[A.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:u.nativeName}),A.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:u.name})]}),n===u.code&&A.jsx(x1,{className:"h-5 w-5 text-blue-500"})]})},u.code))})]})]})]}),A.jsx("div",{className:"px-6 py-4 border-t border-gray-200 dark:border-gray-700",children:A.jsx("button",{onClick:t,className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-3 px-4 rounded-lg font-medium transition-colors duration-200",children:o("close")})})]})})},td=({children:e,title:t,userName:r,onLogout:n,onSignOut:a})=>{const[i,o]=ce.useState(!1),{theme:l,language:u}=tm(),{t:f}=rm(u),h=a||n;return A.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors duration-200",children:[A.jsx("header",{className:"bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700 transition-colors duration-200",children:A.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:A.jsxs("div",{className:"flex justify-between items-center h-16",children:[A.jsxs("div",{className:"flex items-center space-x-3",children:[A.jsx("div",{className:"p-2 rounded-lg",style:{backgroundColor:"#03989e"},children:A.jsx(Od,{className:"h-6 w-6 text-white"})}),A.jsxs("div",{children:[A.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Agence de Voyage"}),A.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t})]})]}),A.jsxs("div",{className:"flex items-center space-x-4",children:[A.jsxs("div",{className:"flex items-center space-x-2",children:[A.jsx("div",{className:"bg-gray-100 dark:bg-gray-700 p-2 rounded-full",children:A.jsx(Tu,{className:"h-5 w-5 text-gray-600 dark:text-gray-300"})}),A.jsxs("div",{className:"hidden sm:block",children:[A.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:r||"Agent Portal"}),A.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Travel Agent"})]})]}),A.jsx("button",{onClick:()=>o(!0),className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors duration-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",title:f("settings"),children:A.jsx(h3,{className:"h-5 w-5"})}),h&&A.jsx("button",{onClick:h,className:"p-2 text-gray-400 hover:text-red-600 dark:hover:text-red-400 transition-colors duration-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",title:"Sign Out",children:A.jsx(Wy,{className:"h-5 w-5"})})]})]})})}),A.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e}),A.jsx(v3,{isOpen:i,onClose:()=>o(!1)})]})},x3=()=>{const e=new Date,t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0"),a=Math.floor(Math.random()*1e3).toString().padStart(3,"0");return`INV-${t}${r}${n}-${a}`},y3=(e,t)=>e*t,w3=e=>e.reduce((t,r)=>t+r.total,0),b3=(e,t=0)=>e*t,_3=(e,t)=>e+t,Va=e=>new Intl.NumberFormat("fr-MA",{style:"currency",currency:"MAD",currencyDisplay:"code"}).format(e).replace("MAD","DH"),Vc=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),Xy=e=>{switch(e){case"draft":return"bg-gray-100 text-gray-800";case"sent":return"bg-blue-100 text-blue-800";case"paid":return"bg-green-100 text-green-800";case"overdue":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},h2=0,k3=["Flight Booking","Hotel Reservation","Car Rental","Travel Insurance","Visa Processing","Tour Package","Airport Transfer","Travel Consultation","Group Booking","Cruise Booking","Desert Safari","Atlas Mountains Trek","Marrakech City Tour","Casablanca Tour","Fes Cultural Tour","Chefchaouen Day Trip","Sahara Desert Tour","Essaouira Excursion"],S3="AIzaSyDB4EEBC-iAoWSttL9hKC3LfoctV1Z_AzY",E3="https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-lite-preview-09-2025:generateContent",A3=async e=>{const t=e.match(/^data:([a-zA-Z0-9]+\/[a-zA-Z0-9-.+]+);base64,(.+)$/);if(!t)throw new Error("Invalid image format. Please upload a valid image file.");const r=t[1],n=t[2],a={contents:[{parts:[{text:"Extract ALL relevant details from this image to fill an invoice form. Return a JSON object with these keys: passportNumber, name (full name), dateOfBirth (YYYY-MM-DD), gender (Male/Female), nationality, address (if available), flightNumber (if available), departureDate (YYYY-MM-DD, if available). Also infer logical defaults if possible: visaStatus ('Issued' if visa is visible, else 'Pending'). Return ONLY the JSON object, no markdown."},{inline_data:{mime_type:r,data:n}}]}]};try{const i=await fetch(`${E3}?key=${S3}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!i.ok){const f=await i.json();console.error("Gemini API Error Detail:",f);const h=f.error?.message||i.statusText||"Unknown Error";throw new Error(`Gemini API Error (${i.status}): ${h}`)}const l=(await i.json()).candidates?.[0]?.content?.parts?.[0]?.text;if(!l)throw new Error("No text extracted from the image");const u=l.replace(/```json/g,"").replace(/```/g,"").trim();try{const f=JSON.parse(u);return{passportNumber:f.passportNumber,name:f.name,dateOfBirth:f.dateOfBirth,gender:f.gender==="M"?"Male":f.gender==="F"?"Female":f.gender,nationality:f.nationality,address:f.address,flightNumber:f.flightNumber,departureDate:f.departureDate,visaStatus:f.visaStatus}}catch{throw console.error("Failed to parse Gemini response:",l),new Error("Failed to parse extracted passport data")}}catch(i){throw console.error("OCR Error:",i),i}};let N3={data:""},T3=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||N3,C3=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,P3=/\/\*[^]*?\*\/|  +/g,d2=/\n+/g,Bc=(e,t)=>{let r="",n="",a="";for(let i in e){let o=e[i];i[0]=="@"?i[1]=="i"?r=i+" "+o+";":n+=i[1]=="f"?Bc(o,i):i+"{"+Bc(o,i[1]=="k"?"":t)+"}":typeof o=="object"?n+=Bc(o,t?t.replace(/([^,])+/g,l=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,u=>/&/.test(u)?u.replace(/&/g,l):l?l+" "+u:u)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),a+=Bc.p?Bc.p(i,o):i+":"+o+";")}return r+(t&&a?t+"{"+a+"}":a)+n},ec={},Jy=e=>{if(typeof e=="object"){let t="";for(let r in e)t+=r+Jy(e[r]);return t}return e},L3=(e,t,r,n,a)=>{let i=Jy(e),o=ec[i]||(ec[i]=(u=>{let f=0,h=11;for(;f<u.length;)h=101*h+u.charCodeAt(f++)>>>0;return"go"+h})(i));if(!ec[o]){let u=i!==e?e:(f=>{let h,g,x=[{}];for(;h=C3.exec(f.replace(P3,""));)h[4]?x.shift():h[3]?(g=h[3].replace(d2," ").trim(),x.unshift(x[0][g]=x[0][g]||{})):x[0][h[1]]=h[2].replace(d2," ").trim();return x[0]})(e);ec[o]=Bc(a?{["@keyframes "+o]:u}:u,r?"":"."+o)}let l=r&&ec.g?ec.g:null;return r&&(ec.g=ec[o]),((u,f,h,g)=>{g?f.data=f.data.replace(g,u):f.data.indexOf(u)===-1&&(f.data=h?u+f.data:f.data+u)})(ec[o],t,n,l),o},F3=(e,t,r)=>e.reduce((n,a,i)=>{let o=t[i];if(o&&o.call){let l=o(r),u=l&&l.props&&l.props.className||/^go/.test(l)&&l;o=u?"."+u:l&&typeof l=="object"?l.props?"":Bc(l,""):l===!1?"":l}return n+a+(o??"")},"");function lp(e){let t=this||{},r=e.call?e(t.p):e;return L3(r.unshift?r.raw?F3(r,[].slice.call(arguments,1),t.p):r.reduce((n,a)=>Object.assign(n,a&&a.call?a(t.p):a),{}):r,T3(t.target),t.g,t.o,t.k)}let Qy,tg,rg;lp.bind({g:1});let lc=lp.bind({k:1});function O3(e,t,r,n){Bc.p=t,Qy=e,tg=r,rg=n}function Jc(e,t){let r=this||{};return function(){let n=arguments;function a(i,o){let l=Object.assign({},i),u=l.className||a.className;r.p=Object.assign({theme:tg&&tg()},l),r.o=/ *go\d+/.test(u),l.className=lp.apply(r,n)+(u?" "+u:"");let f=e;return e[0]&&(f=l.as||e,delete l.as),rg&&f[0]&&rg(l),Qy(f,l)}return a}}var I3=e=>typeof e=="function",ng=(e,t)=>I3(e)?e(t):e,R3=(()=>{let e=0;return()=>(++e).toString()})(),D3=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),j3=20,Zy=(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,j3)};case 1:return{...e,toasts:e.toasts.map(i=>i.id===t.toast.id?{...i,...t.toast}:i)};case 2:let{toast:r}=t;return Zy(e,{type:e.toasts.find(i=>i.id===r.id)?1:0,toast:r});case 3:let{toastId:n}=t;return{...e,toasts:e.toasts.map(i=>i.id===n||n===void 0?{...i,dismissed:!0,visible:!1}:i)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(i=>i.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let a=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(i=>({...i,pauseDuration:i.pauseDuration+a}))}}},M3=[],y1={toasts:[],pausedAt:void 0},nm=e=>{y1=Zy(y1,e),M3.forEach(t=>{t(y1)})},B3=(e,t="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...r,id:r?.id||R3()}),oh=e=>(t,r)=>{let n=B3(t,e,r);return nm({type:2,toast:n}),n.id},Zs=(e,t)=>oh("blank")(e,t);Zs.error=oh("error");Zs.success=oh("success");Zs.loading=oh("loading");Zs.custom=oh("custom");Zs.dismiss=e=>{nm({type:3,toastId:e})};Zs.remove=e=>nm({type:4,toastId:e});Zs.promise=(e,t,r)=>{let n=Zs.loading(t.loading,{...r,...r?.loading});return typeof e=="function"&&(e=e()),e.then(a=>{let i=t.success?ng(t.success,a):void 0;return i?Zs.success(i,{id:n,...r,...r?.success}):Zs.dismiss(n),a}).catch(a=>{let i=t.error?ng(t.error,a):void 0;i?Zs.error(i,{id:n,...r,...r?.error}):Zs.dismiss(n)}),e};var U3=lc`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,z3=lc`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,q3=lc`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,$3=Jc("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${U3} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${z3} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${q3} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,H3=lc`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,V3=Jc("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${H3} 1s linear infinite;
`,W3=lc`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,K3=lc`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,G3=Jc("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${W3} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${K3} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Y3=Jc("div")`
  position: absolute;
`,X3=Jc("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,J3=lc`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Q3=Jc("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${J3} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Z3=({toast:e})=>{let{icon:t,type:r,iconTheme:n}=e;return t!==void 0?typeof t=="string"?ce.createElement(Q3,null,t):t:r==="blank"?null:ce.createElement(X3,null,ce.createElement(V3,{...n}),r!=="loading"&&ce.createElement(Y3,null,r==="error"?ce.createElement($3,{...n}):ce.createElement(G3,{...n})))},ek=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,tk=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,rk="0%{opacity:0;} 100%{opacity:1;}",nk="0%{opacity:1;} 100%{opacity:0;}",ak=Jc("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,ik=Jc("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,sk=(e,t)=>{let r=e.includes("top")?1:-1,[n,a]=D3()?[rk,nk]:[ek(r),tk(r)];return{animation:t?`${lc(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${lc(a)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}};ce.memo(({toast:e,position:t,style:r,children:n})=>{let a=e.height?sk(e.position||t||"top-center",e.visible):{opacity:0},i=ce.createElement(Z3,{toast:e}),o=ce.createElement(ik,{...e.ariaProps},ng(e.message,e));return ce.createElement(ak,{className:e.className,style:{...a,...r,...e.style}},typeof n=="function"?n({icon:i,message:o}):ce.createElement(ce.Fragment,null,i,o))});O3(ce.createElement);lp`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`;var bf=Zs;const w1=e=>{if(!e)return"";try{const t=new Date(e);return isNaN(t.getTime())?"":t.toISOString().split("T")[0]}catch{return""}},p2=({onSave:e,onCancel:t,currentAgent:r,editingInvoice:n})=>{const{language:a}=tm(),{t:i}=rm(a),o=ce.useRef(null),[l,u]=ce.useState(!1),[f,h]=ce.useState({id:n?.client?.id||"",name:n?.client?.name||n?.clientName||"",email:n?.client?.email||n?.clientEmail||"",phone:n?.client?.phone||"",address:n?.client?.address||"",passportNumber:n?.client?.passportNumber||"",gender:n?.client?.gender,dateOfBirth:n?.client?.dateOfBirth||""}),[g,x]=ce.useState(n?.items||[{id:Date.now().toString(),description:"",quantity:1,unitPrice:0,total:0,invoiceId:""}]),[m,k]=ce.useState(w1(n?.dueDate||n?.createdAt)),[b,E]=ce.useState(n?.notes||""),[N,O]=ce.useState(n?.passportNumber||""),[F,K]=ce.useState(n?.gender),[te,re]=ce.useState(n?.flightNumber||""),[B,V]=ce.useState(n?.roomType||"Double"),[Y,ye]=ce.useState(n?.visaStatus||"Pending"),[U,D]=ce.useState(w1(n?.departureDate)),[le,ue]=ce.useState(w1(n?.dateOfBirth)),Te=async M=>{const z=M.target.files?.[0];if(!z)return;u(!0);const H=new FileReader;H.onloadend=async()=>{try{const ie=H.result,xe=await A3(ie);xe.name&&h(Ae=>({...Ae,name:xe.name})),xe.passportNumber&&(h(Ae=>({...Ae,passportNumber:xe.passportNumber})),O(xe.passportNumber)),xe.gender&&(h(Ae=>({...Ae,gender:xe.gender})),K(xe.gender)),xe.dateOfBirth&&(h(Ae=>({...Ae,dateOfBirth:xe.dateOfBirth})),ue(xe.dateOfBirth)),xe.address&&h(Ae=>({...Ae,address:xe.address})),xe.flightNumber&&re(xe.flightNumber),xe.departureDate&&D(xe.departureDate),xe.visaStatus&&ye(xe.visaStatus),bf.success("Passport details extracted successfully!")}catch(ie){console.error("OCR Error:",ie),bf.error(ie.message||i("ocrError"))}finally{u(!1),o.current&&(o.current.value="")}},H.readAsDataURL(z)},Fe=()=>{x([...g,{id:Date.now().toString(),description:"",quantity:1,unitPrice:0,total:0,invoiceId:""}])},Le=M=>{g.length>1&&x(g.filter(z=>z.id!==M))},me=(M,z,H)=>{x(g.map(ie=>{if(ie.id===M){const xe={...ie,[z]:H};return(z==="quantity"||z==="unitPrice")&&(xe.total=y3(xe.quantity,xe.unitPrice)),xe}return ie}))},ne=w3(g),Ee=b3(ne,h2),pe=_3(ne,Ee),C=M=>{if(!f.name||!f.email){alert("Please fill in required client information");return}if(g.some(H=>!H.description||!H.quantity||!H.unitPrice)){alert("Please complete all item details");return}const z={...n?.id?{id:n.id}:{},invoiceNumber:n?.invoiceNumber||x3(),client:{...f,...n?.client?.id?{id:n.client.id}:{}},agentId:r?.id||n?.agentId||"",agentName:r?.name||n?.agentName||"Unknown Agent",items:g,subtotal:ne,tax:Ee,total:pe,status:M,createdAt:n?.createdAt||new Date().toISOString(),dueDate:m,notes:b,passportNumber:N,gender:F,flightNumber:te,roomType:B,visaStatus:Y,departureDate:U,dateOfBirth:le};e(z)};return A.jsxs("div",{className:"max-w-4xl mx-auto",children:[A.jsxs("div",{className:"flex justify-between items-center mb-6",children:[A.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:n?a==="ar"?" ":"Edit Invoice":i("createInvoice")}),A.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors duration-200",children:A.jsx(Rd,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"})})]}),A.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-8",children:[A.jsxs("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-6 flex items-center gap-2",children:[A.jsx(Tu,{className:"w-5 h-5 text-[#03989e]"}),"Client Information"]}),A.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Client Name *"}),A.jsx("input",{type:"text",value:f.name,onChange:M=>h({...f,name:M.target.value}),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:border-transparent transition-all duration-200 bg-white dark:bg-gray-800 text-gray-900 dark:text-white",style:{"--tw-ring-color":"#03989e"},placeholder:"Enter client name"})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address *"}),A.jsx("input",{type:"email",value:f.email,onChange:M=>h({...f,email:M.target.value}),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:border-transparent transition-all duration-200 bg-white dark:bg-gray-800 text-gray-900 dark:text-white",style:{"--tw-ring-color":"#03989e"},placeholder:"client@example.com"})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Phone Number"}),A.jsx("input",{type:"tel",value:f.phone,onChange:M=>h({...f,phone:M.target.value}),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:border-transparent transition-all duration-200 bg-white dark:bg-gray-800 text-gray-900 dark:text-white",style:{"--tw-ring-color":"#03989e"},placeholder:"+1 (555) 000-0000"})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Address"}),A.jsx("input",{type:"text",value:f.address,onChange:M=>h({...f,address:M.target.value}),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:border-transparent transition-all duration-200 bg-white dark:bg-gray-800 text-gray-900 dark:text-white",style:{"--tw-ring-color":"#03989e"},placeholder:"Enter address"})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Due Date *"}),A.jsx("input",{type:"date",value:m,onChange:M=>k(M.target.value),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:border-transparent transition-all duration-200 bg-white dark:bg-gray-800 text-gray-900 dark:text-white",style:{"--tw-ring-color":"#03989e"}})]})]})]}),A.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-8",children:[A.jsxs("div",{className:"flex justify-between items-center mb-6",children:[A.jsxs("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[A.jsx(Od,{className:"w-5 h-5 text-[#03989e]"}),i("umrahDetails")]}),A.jsxs("div",{className:"relative",children:[A.jsx("input",{type:"file",ref:o,onChange:Te,accept:"image/*",className:"hidden"}),A.jsx("button",{onClick:()=>o.current?.click(),disabled:l,className:"flex items-center gap-2 px-4 py-2 bg-[#03989e] text-white rounded-lg hover:bg-[#02868b] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:l?A.jsxs(A.Fragment,{children:[A.jsx(Jg,{className:"w-4 h-4 animate-spin"}),i("scanning")]}):A.jsxs(A.Fragment,{children:[A.jsx(f3,{className:"w-4 h-4"}),i("scanPassport")]})})]})]}),A.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:i("passportNumber")}),A.jsxs("div",{className:"relative",children:[A.jsx(j0,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),A.jsx("input",{type:"text",value:N,onChange:M=>O(M.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:border-transparent transition-all duration-200 bg-white dark:bg-gray-800 text-gray-900 dark:text-white",style:{"--tw-ring-color":"#03989e"},placeholder:i("passportNumber")})]})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:i("gender")}),A.jsxs("div",{className:"flex gap-4 h-[50px] items-center",children:[A.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[A.jsx("input",{type:"radio",name:"gender",value:"Male",checked:F==="Male",onChange:M=>K(M.target.value),className:"w-4 h-4 text-[#03989e] focus:ring-[#03989e]"}),A.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:i("male")})]}),A.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[A.jsx("input",{type:"radio",name:"gender",value:"Female",checked:F==="Female",onChange:M=>K(M.target.value),className:"w-4 h-4 text-[#03989e] focus:ring-[#03989e]"}),A.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:i("female")})]})]})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:i("dateOfBirth")}),A.jsxs("div",{className:"relative",children:[A.jsx(Ef,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),A.jsx("input",{type:"date",value:le,onChange:M=>ue(M.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:border-transparent transition-all duration-200 bg-white dark:bg-gray-800 text-gray-900 dark:text-white",style:{"--tw-ring-color":"#03989e"}})]})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:i("flightNumber")}),A.jsxs("div",{className:"relative",children:[A.jsx(Od,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),A.jsx("input",{type:"text",value:te,onChange:M=>re(M.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:border-transparent transition-all duration-200 bg-white dark:bg-gray-800 text-gray-900 dark:text-white",style:{"--tw-ring-color":"#03989e"},placeholder:"SVW123"})]})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:i("roomType")}),A.jsxs("div",{className:"relative",children:[A.jsx(zy,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),A.jsxs("select",{value:B,onChange:M=>V(M.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:border-transparent transition-all duration-200 bg-white dark:bg-gray-800 text-gray-900 dark:text-white appearance-none",style:{"--tw-ring-color":"#03989e"},children:[A.jsx("option",{value:"Double",children:i("double")}),A.jsx("option",{value:"Triple",children:i("triple")}),A.jsx("option",{value:"Quad",children:i("quad")}),A.jsx("option",{value:"Quint",children:i("quint")})]})]})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:i("visaStatus")}),A.jsxs("div",{className:"relative",children:[A.jsx(j0,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),A.jsxs("select",{value:Y,onChange:M=>ye(M.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:border-transparent transition-all duration-200 bg-white dark:bg-gray-800 text-gray-900 dark:text-white appearance-none",style:{"--tw-ring-color":"#03989e"},children:[A.jsx("option",{value:"Pending",children:i("visaPending")}),A.jsx("option",{value:"Issued",children:i("visaIssued")})]})]})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:i("departureDate")}),A.jsxs("div",{className:"relative",children:[A.jsx(Ef,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),A.jsx("input",{type:"date",value:U,onChange:M=>D(M.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:border-transparent transition-all duration-200 bg-white dark:bg-gray-800 text-gray-900 dark:text-white",style:{"--tw-ring-color":"#03989e"}})]})]})]})]}),A.jsxs("div",{className:"mb-8",children:[A.jsxs("div",{className:"flex justify-between items-center mb-4",children:[A.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Services & Items"}),A.jsxs("button",{onClick:Fe,className:"text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors duration-200",style:{backgroundColor:"#03989e"},onMouseEnter:M=>{M.currentTarget.style.backgroundColor="#027a7f"},onMouseLeave:M=>{M.currentTarget.style.backgroundColor="#03989e"},children:[A.jsx(Id,{className:"h-4 w-4"}),A.jsx("span",{children:"Add Item"})]})]}),A.jsx("div",{className:"space-y-4",children:g.map(M=>A.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 p-6 rounded-lg",children:A.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-4 items-end",children:[A.jsxs("div",{className:"md:col-span-5",children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Service/Description *"}),A.jsxs("select",{value:M.description||"",onChange:z=>me(M.id,"description",z.target.value),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:border-transparent transition-all duration-200 bg-white dark:bg-gray-800 text-gray-900 dark:text-white",style:{"--tw-ring-color":"#03989e"},children:[A.jsx("option",{value:"",children:"Select a service"}),k3.map(z=>A.jsx("option",{value:z,children:z},z))]})]}),A.jsxs("div",{className:"md:col-span-2",children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Quantity *"}),A.jsx("input",{type:"number",min:"1",value:M.quantity??0,onChange:z=>me(M.id,"quantity",parseInt(z.target.value)||1),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:border-transparent transition-all duration-200 bg-white dark:bg-gray-800 text-gray-900 dark:text-white",style:{"--tw-ring-color":"#03989e"}})]}),A.jsxs("div",{className:"md:col-span-2",children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Unit Price *"}),A.jsx("input",{type:"number",min:"0",step:"0.01",value:M.unitPrice??0,onChange:z=>me(M.id,"unitPrice",parseFloat(z.target.value)||0),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:border-transparent transition-all duration-200 bg-white dark:bg-gray-800 text-gray-900 dark:text-white",style:{"--tw-ring-color":"#03989e"}})]}),A.jsxs("div",{className:"md:col-span-2",children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Total"}),A.jsx("div",{className:"px-4 py-3 bg-gray-100 dark:bg-gray-600 rounded-lg text-gray-900 dark:text-white font-medium",children:Va(M.total||0)})]}),A.jsx("div",{className:"md:col-span-1",children:A.jsx("button",{onClick:()=>Le(M.id),disabled:g.length===1,className:"w-full p-3 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:A.jsx(Rd,{className:"h-4 w-4 mx-auto"})})})]})},M.id))})]}),A.jsx("div",{className:"mb-8",children:A.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-6 rounded-lg",children:[A.jsx("div",{className:"flex justify-between items-center mb-4",children:A.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Invoice Summary"})}),A.jsxs("div",{className:"space-y-3",children:[A.jsxs("div",{className:"flex justify-between",children:[A.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Subtotal:"}),A.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:Va(ne)})]}),A.jsxs("div",{className:"flex justify-between",children:[A.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:["Tax (",(h2*100).toFixed(0),"%):"]}),A.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:Va(Ee)})]}),A.jsx("div",{className:"border-t dark:border-gray-600 pt-3",children:A.jsxs("div",{className:"flex justify-between",children:[A.jsx("span",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Total:"}),A.jsx("span",{className:"text-lg font-bold",style:{color:"#03989e"},children:Va(pe)})]})})]})]})}),A.jsxs("div",{className:"mb-8",children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Additional Notes"}),A.jsx("textarea",{value:b,onChange:M=>E(M.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:border-transparent transition-all duration-200 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white",style:{"--tw-ring-color":"#03989e"},placeholder:"Add any additional notes or terms..."})]}),A.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-end",children:[A.jsx("button",{onClick:t,className:"px-6 py-3 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200",children:"Cancel"}),A.jsxs("button",{onClick:()=>C("draft"),className:"px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white rounded-lg flex items-center justify-center space-x-2 transition-colors duration-200",children:[A.jsx(Qg,{className:"h-4 w-4"}),A.jsx("span",{children:n?"Update as Draft":"Save as Draft"})]}),A.jsxs("button",{onClick:()=>C("sent"),className:"px-6 py-3 text-white rounded-lg flex items-center justify-center space-x-2 transition-colors duration-200",style:{backgroundColor:"#03989e"},onMouseEnter:M=>{M.currentTarget.style.backgroundColor="#027a7f"},onMouseLeave:M=>{M.currentTarget.style.backgroundColor="#03989e"},children:[A.jsx(Zg,{className:"h-4 w-4"}),A.jsx("span",{children:n?"Update & Send":"Create & Send"})]})]})]})},ok="modulepreload",lk=function(e){return"/"+e},g2={},M0=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){let u=function(f){return Promise.all(f.map(h=>Promise.resolve(h).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");a=u(r.map(f=>{if(f=lk(f),f in g2)return;g2[f]=!0;const h=f.endsWith(".css"),g=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${g}`))return;const x=document.createElement("link");if(x.rel=h?"stylesheet":ok,h||(x.as="script"),x.crossOrigin="",x.href=f,l&&x.setAttribute("nonce",l),document.head.appendChild(x),h)return new Promise((m,k)=>{x.addEventListener("load",m),x.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${f}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return a.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return t().catch(i)})};function Nn(e){"@babel/helpers - typeof";return Nn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nn(e)}var Vi=Uint8Array,no=Uint16Array,am=Int32Array,cp=new Vi([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),up=new Vi([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ag=new Vi([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ew=function(e,t){for(var r=new no(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var a=new am(r[30]),n=1;n<30;++n)for(var i=r[n];i<r[n+1];++i)a[i]=i-r[n]<<5|n;return{b:r,r:a}},tw=ew(cp,2),rw=tw.b,ig=tw.r;rw[28]=258,ig[258]=28;var nw=ew(up,0),ck=nw.b,m2=nw.r,sg=new no(32768);for(var Qn=0;Qn<32768;++Qn){var Ic=(Qn&43690)>>1|(Qn&21845)<<1;Ic=(Ic&52428)>>2|(Ic&13107)<<2,Ic=(Ic&61680)>>4|(Ic&3855)<<4,sg[Qn]=((Ic&65280)>>8|(Ic&255)<<8)>>1}var Fl=function(e,t,r){for(var n=e.length,a=0,i=new no(t);a<n;++a)e[a]&&++i[e[a]-1];var o=new no(t);for(a=1;a<t;++a)o[a]=o[a-1]+i[a-1]<<1;var l;if(r){l=new no(1<<t);var u=15-t;for(a=0;a<n;++a)if(e[a])for(var f=a<<4|e[a],h=t-e[a],g=o[e[a]-1]++<<h,x=g|(1<<h)-1;g<=x;++g)l[sg[g]>>u]=f}else for(l=new no(n),a=0;a<n;++a)e[a]&&(l[a]=sg[o[e[a]-1]++]>>15-e[a]);return l},Kc=new Vi(288);for(var Qn=0;Qn<144;++Qn)Kc[Qn]=8;for(var Qn=144;Qn<256;++Qn)Kc[Qn]=9;for(var Qn=256;Qn<280;++Qn)Kc[Qn]=7;for(var Qn=280;Qn<288;++Qn)Kc[Qn]=8;var B0=new Vi(32);for(var Qn=0;Qn<32;++Qn)B0[Qn]=5;var uk=Fl(Kc,9,0),fk=Fl(Kc,9,1),hk=Fl(B0,5,0),dk=Fl(B0,5,1),b1=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},Yo=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(t&7)&r},_1=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(t&7)},im=function(e){return(e+7)/8|0},aw=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new Vi(e.subarray(t,r))},pk=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],el=function(e,t,r){var n=new Error(t||pk[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,el),!r)throw n;return n},gk=function(e,t,r,n){var a=e.length,i=0;if(!a||t.f&&!t.l)return r||new Vi(0);var o=!r,l=o||t.i!=2,u=t.i;o&&(r=new Vi(a*3));var f=function(ct){var se=r.length;if(ct>se){var bt=new Vi(Math.max(se*2,ct));bt.set(r),r=bt}},h=t.f||0,g=t.p||0,x=t.b||0,m=t.l,k=t.d,b=t.m,E=t.n,N=a*8;do{if(!m){h=Yo(e,g,1);var O=Yo(e,g+1,3);if(g+=3,O)if(O==1)m=fk,k=dk,b=9,E=5;else if(O==2){var re=Yo(e,g,31)+257,B=Yo(e,g+10,15)+4,V=re+Yo(e,g+5,31)+1;g+=14;for(var Y=new Vi(V),ye=new Vi(19),U=0;U<B;++U)ye[ag[U]]=Yo(e,g+U*3,7);g+=B*3;for(var D=b1(ye),le=(1<<D)-1,ue=Fl(ye,D,1),U=0;U<V;){var Te=ue[Yo(e,g,le)];g+=Te&15;var F=Te>>4;if(F<16)Y[U++]=F;else{var Fe=0,Le=0;for(F==16?(Le=3+Yo(e,g,3),g+=2,Fe=Y[U-1]):F==17?(Le=3+Yo(e,g,7),g+=3):F==18&&(Le=11+Yo(e,g,127),g+=7);Le--;)Y[U++]=Fe}}var me=Y.subarray(0,re),ne=Y.subarray(re);b=b1(me),E=b1(ne),m=Fl(me,b,1),k=Fl(ne,E,1)}else el(1);else{var F=im(g)+4,K=e[F-4]|e[F-3]<<8,te=F+K;if(te>a){u&&el(0);break}l&&f(x+K),r.set(e.subarray(F,te),x),t.b=x+=K,t.p=g=te*8,t.f=h;continue}if(g>N){u&&el(0);break}}l&&f(x+131072);for(var Ee=(1<<b)-1,pe=(1<<E)-1,C=g;;C=g){var Fe=m[_1(e,g)&Ee],M=Fe>>4;if(g+=Fe&15,g>N){u&&el(0);break}if(Fe||el(2),M<256)r[x++]=M;else if(M==256){C=g,m=null;break}else{var z=M-254;if(M>264){var U=M-257,H=cp[U];z=Yo(e,g,(1<<H)-1)+rw[U],g+=H}var ie=k[_1(e,g)&pe],xe=ie>>4;ie||el(3),g+=ie&15;var ne=ck[xe];if(xe>3){var H=up[xe];ne+=_1(e,g)&(1<<H)-1,g+=H}if(g>N){u&&el(0);break}l&&f(x+131072);var Ae=x+z;if(x<ne){var de=i-ne,Me=Math.min(ne,Ae);for(de+x<0&&el(3);x<Me;++x)r[x]=n[de+x]}for(;x<Ae;++x)r[x]=r[x-ne]}}t.l=m,t.p=C,t.b=x,t.f=h,m&&(h=1,t.m=b,t.d=k,t.n=E)}while(!h);return x!=r.length&&o?aw(r,0,x):r.subarray(0,x)},tc=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},f0=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},k1=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var a=r.length,i=r.slice();if(!a)return{t:sw,l:0};if(a==1){var o=new Vi(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(te,re){return te.f-re.f}),r.push({s:-1,f:25001});var l=r[0],u=r[1],f=0,h=1,g=2;for(r[0]={s:-1,f:l.f+u.f,l,r:u};h!=a-1;)l=r[r[f].f<r[g].f?f++:g++],u=r[f!=h&&r[f].f<r[g].f?f++:g++],r[h++]={s:-1,f:l.f+u.f,l,r:u};for(var x=i[0].s,n=1;n<a;++n)i[n].s>x&&(x=i[n].s);var m=new no(x+1),k=og(r[h-1],m,0);if(k>t){var n=0,b=0,E=k-t,N=1<<E;for(i.sort(function(re,B){return m[B.s]-m[re.s]||re.f-B.f});n<a;++n){var O=i[n].s;if(m[O]>t)b+=N-(1<<k-m[O]),m[O]=t;else break}for(b>>=E;b>0;){var F=i[n].s;m[F]<t?b-=1<<t-m[F]++-1:++n}for(;n>=0&&b;--n){var K=i[n].s;m[K]==t&&(--m[K],++b)}k=t}return{t:new Vi(m),l:k}},og=function(e,t,r){return e.s==-1?Math.max(og(e.l,t,r+1),og(e.r,t,r+1)):t[e.s]=r},v2=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new no(++t),n=0,a=e[0],i=1,o=function(u){r[n++]=u},l=1;l<=t;++l)if(e[l]==a&&l!=t)++i;else{if(!a&&i>2){for(;i>138;i-=138)o(32754);i>2&&(o(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(o(a),--i;i>6;i-=6)o(8304);i>2&&(o(i-3<<5|8208),i=0)}for(;i--;)o(a);i=1,a=e[l]}return{c:r.subarray(0,n),n:t}},h0=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},iw=function(e,t,r){var n=r.length,a=im(t+2);e[a]=n&255,e[a+1]=n>>8,e[a+2]=e[a]^255,e[a+3]=e[a+1]^255;for(var i=0;i<n;++i)e[a+i+4]=r[i];return(a+4+n)*8},x2=function(e,t,r,n,a,i,o,l,u,f,h){tc(t,h++,r),++a[256];for(var g=k1(a,15),x=g.t,m=g.l,k=k1(i,15),b=k.t,E=k.l,N=v2(x),O=N.c,F=N.n,K=v2(b),te=K.c,re=K.n,B=new no(19),V=0;V<O.length;++V)++B[O[V]&31];for(var V=0;V<te.length;++V)++B[te[V]&31];for(var Y=k1(B,7),ye=Y.t,U=Y.l,D=19;D>4&&!ye[ag[D-1]];--D);var le=f+5<<3,ue=h0(a,Kc)+h0(i,B0)+o,Te=h0(a,x)+h0(i,b)+o+14+3*D+h0(B,ye)+2*B[16]+3*B[17]+7*B[18];if(u>=0&&le<=ue&&le<=Te)return iw(t,h,e.subarray(u,u+f));var Fe,Le,me,ne;if(tc(t,h,1+(Te<ue)),h+=2,Te<ue){Fe=Fl(x,m,0),Le=x,me=Fl(b,E,0),ne=b;var Ee=Fl(ye,U,0);tc(t,h,F-257),tc(t,h+5,re-1),tc(t,h+10,D-4),h+=14;for(var V=0;V<D;++V)tc(t,h+3*V,ye[ag[V]]);h+=3*D;for(var pe=[O,te],C=0;C<2;++C)for(var M=pe[C],V=0;V<M.length;++V){var z=M[V]&31;tc(t,h,Ee[z]),h+=ye[z],z>15&&(tc(t,h,M[V]>>5&127),h+=M[V]>>12)}}else Fe=uk,Le=Kc,me=hk,ne=B0;for(var V=0;V<l;++V){var H=n[V];if(H>255){var z=H>>18&31;f0(t,h,Fe[z+257]),h+=Le[z+257],z>7&&(tc(t,h,H>>23&31),h+=cp[z]);var ie=H&31;f0(t,h,me[ie]),h+=ne[ie],ie>3&&(f0(t,h,H>>5&8191),h+=up[ie])}else f0(t,h,Fe[H]),h+=Le[H]}return f0(t,h,Fe[256]),h+Le[256]},mk=new am([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),sw=new Vi(0),vk=function(e,t,r,n,a,i){var o=i.z||e.length,l=new Vi(n+o+5*(1+Math.ceil(o/7e3))+a),u=l.subarray(n,l.length-a),f=i.l,h=(i.r||0)&7;if(t){h&&(u[0]=i.r>>3);for(var g=mk[t-1],x=g>>13,m=g&8191,k=(1<<r)-1,b=i.p||new no(32768),E=i.h||new no(k+1),N=Math.ceil(r/3),O=2*N,F=function(Dt){return(e[Dt]^e[Dt+1]<<N^e[Dt+2]<<O)&k},K=new am(25e3),te=new no(288),re=new no(32),B=0,V=0,Y=i.i||0,ye=0,U=i.w||0,D=0;Y+2<o;++Y){var le=F(Y),ue=Y&32767,Te=E[le];if(b[ue]=Te,E[le]=ue,U<=Y){var Fe=o-Y;if((B>7e3||ye>24576)&&(Fe>423||!f)){h=x2(e,u,0,K,te,re,V,ye,D,Y-D,h),ye=B=V=0,D=Y;for(var Le=0;Le<286;++Le)te[Le]=0;for(var Le=0;Le<30;++Le)re[Le]=0}var me=2,ne=0,Ee=m,pe=ue-Te&32767;if(Fe>2&&le==F(Y-pe))for(var C=Math.min(x,Fe)-1,M=Math.min(32767,Y),z=Math.min(258,Fe);pe<=M&&--Ee&&ue!=Te;){if(e[Y+me]==e[Y+me-pe]){for(var H=0;H<z&&e[Y+H]==e[Y+H-pe];++H);if(H>me){if(me=H,ne=pe,H>C)break;for(var ie=Math.min(pe,H-2),xe=0,Le=0;Le<ie;++Le){var Ae=Y-pe+Le&32767,de=b[Ae],Me=Ae-de&32767;Me>xe&&(xe=Me,Te=Ae)}}}ue=Te,Te=b[ue],pe+=ue-Te&32767}if(ne){K[ye++]=268435456|ig[me]<<18|m2[ne];var ct=ig[me]&31,se=m2[ne]&31;V+=cp[ct]+up[se],++te[257+ct],++re[se],U=Y+me,++B}else K[ye++]=e[Y],++te[e[Y]]}}for(Y=Math.max(Y,U);Y<o;++Y)K[ye++]=e[Y],++te[e[Y]];h=x2(e,u,f,K,te,re,V,ye,D,Y-D,h),f||(i.r=h&7|u[h/8|0]<<3,h-=7,i.h=E,i.p=b,i.i=Y,i.w=U)}else{for(var Y=i.w||0;Y<o+f;Y+=65535){var bt=Y+65535;bt>=o&&(u[h/8|0]=f,bt=o),h=iw(u,h+1,e.subarray(Y,bt))}i.i=o}return aw(l,0,n+im(h)+a)},ow=function(){var e=1,t=0;return{p:function(r){for(var n=e,a=t,i=r.length|0,o=0;o!=i;){for(var l=Math.min(o+2655,i);o<l;++o)a+=n+=r[o];n=(n&65535)+15*(n>>16),a=(a&65535)+15*(a>>16)}e=n,t=a},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},xk=function(e,t,r,n,a){if(!a&&(a={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),o=new Vi(i.length+e.length);o.set(i),o.set(e,i.length),e=o,a.w=i.length}return vk(e,t.level==null?6:t.level,t.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,a)},lw=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},yk=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var a=ow();a.p(t.dictionary),lw(e,2,a.d())}},wk=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&el(6,"invalid zlib data"),(e[1]>>5&1)==1&&el(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function lg(e,t){t||(t={});var r=ow();r.p(e);var n=xk(e,t,t.dictionary?6:2,4);return yk(n,t),lw(n,n.length-4,r.d()),n}function bk(e,t){return gk(e.subarray(wk(e),-4),{i:2},t,t)}var _k=typeof TextDecoder<"u"&&new TextDecoder,kk=0;try{_k.decode(sw,{stream:!0}),kk=1}catch{}var Pr=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function S1(){Pr.console&&typeof Pr.console.log=="function"&&Pr.console.log.apply(Pr.console,arguments)}var jn={log:S1,warn:function(e){Pr.console&&(typeof Pr.console.warn=="function"?Pr.console.warn.apply(Pr.console,arguments):S1.call(null,arguments))},error:function(e){Pr.console&&(typeof Pr.console.error=="function"?Pr.console.error.apply(Pr.console,arguments):S1(e))}};function E1(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){vu(n.response,t,r)},n.onerror=function(){jn.error("could not download file")},n.send()}function y2(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function rd(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var b0,cg,vu=Pr.saveAs||((typeof window>"u"?"undefined":Nn(window))!=="object"||window!==Pr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=Pr.URL||Pr.webkitURL,a=document.createElement("a");t=t||e.name||"download",a.download=t,a.rel="noopener",typeof e=="string"?(a.href=e,a.origin!==location.origin?y2(a.href)?E1(e,t,r):rd(a,a.target="_blank"):rd(a)):(a.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){rd(a)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(y2(e))E1(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){rd(n)})}else navigator.msSaveOrOpenBlob(function(a,i){return i===void 0?i={autoBom:!1}:Nn(i)!=="object"&&(jn.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return E1(e,t,r);var a=e.type==="application/octet-stream",i=/constructor/i.test(Pr.HTMLElement)||Pr.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||a&&i)&&(typeof FileReader>"u"?"undefined":Nn(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var h=l.result;h=o?h:h.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=h:location=h,n=null},l.readAsDataURL(e)}else{var u=Pr.URL||Pr.webkitURL,f=u.createObjectURL(e);n?n.location=f:location.href=f,n=null,setTimeout(function(){u.revokeObjectURL(f)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function cw(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var a=r[n].re,i=r[n].process,o=a.exec(e);o&&(t=i(o),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),u=this.g.toString(16),f=this.b.toString(16);return l.length==1&&(l="0"+l),u.length==1&&(u="0"+u),f.length==1&&(f="0"+f),"#"+l+u+f}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function A1(e,t){var r=e[0],n=e[1],a=e[2],i=e[3];r=Mi(r,n,a,i,t[0],7,-680876936),i=Mi(i,r,n,a,t[1],12,-389564586),a=Mi(a,i,r,n,t[2],17,606105819),n=Mi(n,a,i,r,t[3],22,-1044525330),r=Mi(r,n,a,i,t[4],7,-176418897),i=Mi(i,r,n,a,t[5],12,1200080426),a=Mi(a,i,r,n,t[6],17,-1473231341),n=Mi(n,a,i,r,t[7],22,-45705983),r=Mi(r,n,a,i,t[8],7,1770035416),i=Mi(i,r,n,a,t[9],12,-1958414417),a=Mi(a,i,r,n,t[10],17,-42063),n=Mi(n,a,i,r,t[11],22,-1990404162),r=Mi(r,n,a,i,t[12],7,1804603682),i=Mi(i,r,n,a,t[13],12,-40341101),a=Mi(a,i,r,n,t[14],17,-1502002290),r=Bi(r,n=Mi(n,a,i,r,t[15],22,1236535329),a,i,t[1],5,-165796510),i=Bi(i,r,n,a,t[6],9,-1069501632),a=Bi(a,i,r,n,t[11],14,643717713),n=Bi(n,a,i,r,t[0],20,-373897302),r=Bi(r,n,a,i,t[5],5,-701558691),i=Bi(i,r,n,a,t[10],9,38016083),a=Bi(a,i,r,n,t[15],14,-660478335),n=Bi(n,a,i,r,t[4],20,-405537848),r=Bi(r,n,a,i,t[9],5,568446438),i=Bi(i,r,n,a,t[14],9,-1019803690),a=Bi(a,i,r,n,t[3],14,-187363961),n=Bi(n,a,i,r,t[8],20,1163531501),r=Bi(r,n,a,i,t[13],5,-1444681467),i=Bi(i,r,n,a,t[2],9,-51403784),a=Bi(a,i,r,n,t[7],14,1735328473),r=Ui(r,n=Bi(n,a,i,r,t[12],20,-1926607734),a,i,t[5],4,-378558),i=Ui(i,r,n,a,t[8],11,-2022574463),a=Ui(a,i,r,n,t[11],16,1839030562),n=Ui(n,a,i,r,t[14],23,-35309556),r=Ui(r,n,a,i,t[1],4,-1530992060),i=Ui(i,r,n,a,t[4],11,1272893353),a=Ui(a,i,r,n,t[7],16,-155497632),n=Ui(n,a,i,r,t[10],23,-1094730640),r=Ui(r,n,a,i,t[13],4,681279174),i=Ui(i,r,n,a,t[0],11,-358537222),a=Ui(a,i,r,n,t[3],16,-722521979),n=Ui(n,a,i,r,t[6],23,76029189),r=Ui(r,n,a,i,t[9],4,-640364487),i=Ui(i,r,n,a,t[12],11,-421815835),a=Ui(a,i,r,n,t[15],16,530742520),r=zi(r,n=Ui(n,a,i,r,t[2],23,-995338651),a,i,t[0],6,-198630844),i=zi(i,r,n,a,t[7],10,1126891415),a=zi(a,i,r,n,t[14],15,-1416354905),n=zi(n,a,i,r,t[5],21,-57434055),r=zi(r,n,a,i,t[12],6,1700485571),i=zi(i,r,n,a,t[3],10,-1894986606),a=zi(a,i,r,n,t[10],15,-1051523),n=zi(n,a,i,r,t[1],21,-2054922799),r=zi(r,n,a,i,t[8],6,1873313359),i=zi(i,r,n,a,t[15],10,-30611744),a=zi(a,i,r,n,t[6],15,-1560198380),n=zi(n,a,i,r,t[13],21,1309151649),r=zi(r,n,a,i,t[4],6,-145523070),i=zi(i,r,n,a,t[11],10,-1120210379),a=zi(a,i,r,n,t[2],15,718787259),n=zi(n,a,i,r,t[9],21,-343485551),e[0]=qc(r,e[0]),e[1]=qc(n,e[1]),e[2]=qc(a,e[2]),e[3]=qc(i,e[3])}function fp(e,t,r,n,a,i){return t=qc(qc(t,e),qc(n,i)),qc(t<<a|t>>>32-a,r)}function Mi(e,t,r,n,a,i,o){return fp(t&r|~t&n,e,t,a,i,o)}function Bi(e,t,r,n,a,i,o){return fp(t&n|r&~n,e,t,a,i,o)}function Ui(e,t,r,n,a,i,o){return fp(t^r^n,e,t,a,i,o)}function zi(e,t,r,n,a,i,o){return fp(r^(t|~n),e,t,a,i,o)}function uw(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)A1(n,Sk(e.substring(t-64,t)));e=e.substring(t-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)a[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(a[t>>2]|=128<<(t%4<<3),t>55)for(A1(n,a),t=0;t<16;t++)a[t]=0;return a[14]=8*r,A1(n,a),n}function Sk(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}b0=Pr.atob.bind(Pr),cg=Pr.btoa.bind(Pr);var w2="0123456789abcdef".split("");function Ek(e){for(var t="",r=0;r<4;r++)t+=w2[e>>8*r+4&15]+w2[e>>8*r&15];return t}function Ak(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function ug(e){return uw(e).map(Ak).join("")}var Nk=function(e){for(var t=0;t<e.length;t++)e[t]=Ek(e[t]);return e.join("")}(uw("hello"))!="5d41402abc4b2a76b9719d911017c592";function qc(e,t){if(Nk){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function fg(e,t){var r,n,a,i;if(e!==r){for(var o=(a=e,i=1+(256/e.length>>0),new Array(i+1).join(a)),l=[],u=0;u<256;u++)l[u]=u;var f=0;for(u=0;u<256;u++){var h=l[u];f=(f+h+o.charCodeAt(u))%256,l[u]=l[f],l[f]=h}r=e,n=l}else l=n;var g=t.length,x=0,m=0,k="";for(u=0;u<g;u++)m=(m+(h=l[x=(x+1)%256]))%256,l[x]=l[m],l[m]=h,o=l[(l[x]+l[m])%256],k+=String.fromCharCode(t.charCodeAt(u)^o);return k}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var b2={print:4,modify:8,copy:16,"annot-forms":32};function gf(e,t,r,n){this.v=1,this.r=2;var a=192;e.forEach(function(l){if(b2.perm!==void 0)throw new Error("Invalid permission: "+l);a+=b2[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var i=(t+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,o),this.P=-(1+(255^a)),this.encryptionKey=ug(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=fg(this.encryptionKey,this.padding)}function mf(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var a=e.charCodeAt(n);a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?t+="#"+("0"+a.toString(16)).slice(-2):t+=e[n]}return t}function _2(e){if(Nn(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,a){if(a=a||!1,typeof r!="string"||typeof n!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var i=Math.random().toString(35);return t[r][i]=[n,!!a],i},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),a=[];for(var i in t[r]){var o=t[r][i];try{o[0].apply(e,n)}catch(l){Pr.console&&jn.error("jsPDF PubSub Error",l.message,l)}o[1]&&a.push(i)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Dd(e){if(!(this instanceof Dd))return new Dd(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function fw(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function yu(e,t,r,n,a){if(!(this instanceof yu))return new yu(e,t,r,n,a);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,fw.call(this,n,a)}function _f(e,t,r,n,a){if(!(this instanceof _f))return new _f(e,t,r,n,a);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,fw.call(this,n,a)}function Tr(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],a=arguments[2],i=arguments[3],o=[],l=1,u=16,f="S",h=null;Nn(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,a=e.format||a,i=e.compress||e.compressPdf||i,(h=e.encryption||null)!==null&&(h.userPassword=h.userPassword||"",h.ownerPassword=h.ownerPassword||"",h.userPermissions=h.userPermissions||[]),l=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(u=e.floatPrecision),f=e.defaultPathOperation||"S"),o=e.filters||(i===!0?["FlateEncode"]:o),n=n||"mm",r=(""+(r||"P")).toLowerCase();var g=e.putOnlyUsedFonts||!1,x={},m={internal:{},__private__:{}};m.__private__.PubSub=_2;var k="1.3",b=m.__private__.getPdfVersion=function(){return k};m.__private__.setPdfVersion=function(S){k=S};var E={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};m.__private__.getPageFormats=function(){return E};var N=m.__private__.getPageFormat=function(S){return E[S]};a=a||"a4";var O={COMPAT:"compat",ADVANCED:"advanced"},F=O.COMPAT;function K(){this.saveGraphicsState(),we(new Gt(wt,0,0,-wt,0,is()*wt).toString()+" cm"),this.setFontSize(this.getFontSize()/wt),f="n",F=O.ADVANCED}function te(){this.restoreGraphicsState(),f="S",F=O.COMPAT}var re=m.__private__.combineFontStyleAndFontWeight=function(S,G){if(S=="bold"&&G=="normal"||S=="bold"&&G==400||S=="normal"&&G=="italic"||S=="bold"&&G=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return G&&(S=G==400||G==="normal"?S==="italic"?"italic":"normal":G!=700&&G!=="bold"||S!=="normal"?(G==700?"bold":G)+""+S:"bold"),S};m.advancedAPI=function(S){var G=F===O.COMPAT;return G&&K.call(this),typeof S!="function"||(S(this),G&&te.call(this)),this},m.compatAPI=function(S){var G=F===O.ADVANCED;return G&&te.call(this),typeof S!="function"||(S(this),G&&K.call(this)),this},m.isAdvancedAPI=function(){return F===O.ADVANCED};var B,V=function(S){if(F!==O.ADVANCED)throw new Error(S+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},Y=m.roundToPrecision=m.__private__.roundToPrecision=function(S,G){var Se=t||G;if(isNaN(S)||isNaN(Se))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return S.toFixed(Se).replace(/0+$/,"")};B=m.hpf=m.__private__.hpf=typeof u=="number"?function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.hpf");return Y(S,u)}:u==="smart"?function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.hpf");return Y(S,S>-1&&S<1?16:5)}:function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.hpf");return Y(S,16)};var ye=m.f2=m.__private__.f2=function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.f2");return Y(S,2)},U=m.__private__.f3=function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.f3");return Y(S,3)},D=m.scale=m.__private__.scale=function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.scale");return F===O.COMPAT?S*wt:F===O.ADVANCED?S:void 0},le=function(S){return F===O.COMPAT?is()-S:F===O.ADVANCED?S:void 0},ue=function(S){return D(le(S))};m.__private__.setPrecision=m.setPrecision=function(S){typeof parseInt(S,10)=="number"&&(t=parseInt(S,10))};var Te,Fe="00000000000000000000000000000000",Le=m.__private__.getFileId=function(){return Fe},me=m.__private__.setFileId=function(S){return Fe=S!==void 0&&/^[a-fA-F0-9]{32}$/.test(S)?S.toUpperCase():Fe.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),h!==null&&(Cn=new gf(h.userPermissions,h.userPassword,h.ownerPassword,Fe)),Fe};m.setFileId=function(S){return me(S),this},m.getFileId=function(){return Le()};var ne=m.__private__.convertDateToPDFDate=function(S){var G=S.getTimezoneOffset(),Se=G<0?"+":"-",Oe=Math.floor(Math.abs(G/60)),Ye=Math.abs(G%60),dt=[Se,z(Oe),"'",z(Ye),"'"].join("");return["D:",S.getFullYear(),z(S.getMonth()+1),z(S.getDate()),z(S.getHours()),z(S.getMinutes()),z(S.getSeconds()),dt].join("")},Ee=m.__private__.convertPDFDateToDate=function(S){var G=parseInt(S.substr(2,4),10),Se=parseInt(S.substr(6,2),10)-1,Oe=parseInt(S.substr(8,2),10),Ye=parseInt(S.substr(10,2),10),dt=parseInt(S.substr(12,2),10),Nt=parseInt(S.substr(14,2),10);return new Date(G,Se,Oe,Ye,dt,Nt,0)},pe=m.__private__.setCreationDate=function(S){var G;if(S===void 0&&(S=new Date),S instanceof Date)G=ne(S);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(S))throw new Error("Invalid argument passed to jsPDF.setCreationDate");G=S}return Te=G},C=m.__private__.getCreationDate=function(S){var G=Te;return S==="jsDate"&&(G=Ee(Te)),G};m.setCreationDate=function(S){return pe(S),this},m.getCreationDate=function(S){return C(S)};var M,z=m.__private__.padd2=function(S){return("0"+parseInt(S)).slice(-2)},H=m.__private__.padd2Hex=function(S){return("00"+(S=S.toString())).substr(S.length)},ie=0,xe=[],Ae=[],de=0,Me=[],ct=[],se=!1,bt=Ae,Dt=function(){ie=0,de=0,Ae=[],xe=[],Me=[],fe=Qr(),he=Qr()};m.__private__.setCustomOutputDestination=function(S){se=!0,bt=S};var Je=function(S){se||(bt=S)};m.__private__.resetCustomOutputDestination=function(){se=!1,bt=Ae};var we=m.__private__.out=function(S){return S=S.toString(),de+=S.length+1,bt.push(S),bt},mt=m.__private__.write=function(S){return we(arguments.length===1?S.toString():Array.prototype.join.call(arguments," "))},qt=m.__private__.getArrayBuffer=function(S){for(var G=S.length,Se=new ArrayBuffer(G),Oe=new Uint8Array(Se);G--;)Oe[G]=S.charCodeAt(G);return Se},xt=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];m.__private__.getStandardFonts=function(){return xt};var _t=e.fontSize||16;m.__private__.setFontSize=m.setFontSize=function(S){return _t=F===O.ADVANCED?S/wt:S,this};var Et,Bt=m.__private__.getFontSize=m.getFontSize=function(){return F===O.COMPAT?_t:_t*wt},Jt=e.R2L||!1;m.__private__.setR2L=m.setR2L=function(S){return Jt=S,this},m.__private__.getR2L=m.getR2L=function(){return Jt};var nr,cr=m.__private__.setZoomMode=function(S){var G=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(S))Et=S;else if(isNaN(S)){if(G.indexOf(S)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+S+'" is not recognized.');Et=S}else Et=parseInt(S,10)};m.__private__.getZoomMode=function(){return Et};var gr,yr=m.__private__.setPageMode=function(S){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(S)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+S+'" is not recognized.');nr=S};m.__private__.getPageMode=function(){return nr};var mr=m.__private__.setLayoutMode=function(S){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(S)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+S+'" is not recognized.');gr=S};m.__private__.getLayoutMode=function(){return gr},m.__private__.setDisplayMode=m.setDisplayMode=function(S,G,Se){return cr(S),mr(G),yr(Se),this};var Qt={title:"",subject:"",author:"",keywords:"",creator:""};m.__private__.getDocumentProperty=function(S){if(Object.keys(Qt).indexOf(S)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Qt[S]},m.__private__.getDocumentProperties=function(){return Qt},m.__private__.setDocumentProperties=m.setProperties=m.setDocumentProperties=function(S){for(var G in Qt)Qt.hasOwnProperty(G)&&S[G]&&(Qt[G]=S[G]);return this},m.__private__.setDocumentProperty=function(S,G){if(Object.keys(Qt).indexOf(S)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Qt[S]=G};var $t,wt,Vr,ur,Tn,Ur={},Ut={},Zn=[],Lr={},ga={},At={},Bn={},Xr=null,Fr=0,ar=[],Or=new _2(m),Ln=e.hotfixes||[],Jr={},ln={},Sn=[],Gt=function S(G,Se,Oe,Ye,dt,Nt){if(!(this instanceof S))return new S(G,Se,Oe,Ye,dt,Nt);isNaN(G)&&(G=1),isNaN(Se)&&(Se=0),isNaN(Oe)&&(Oe=0),isNaN(Ye)&&(Ye=1),isNaN(dt)&&(dt=0),isNaN(Nt)&&(Nt=0),this._matrix=[G,Se,Oe,Ye,dt,Nt]};Object.defineProperty(Gt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(S){this._matrix[0]=S}}),Object.defineProperty(Gt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(S){this._matrix[1]=S}}),Object.defineProperty(Gt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(S){this._matrix[2]=S}}),Object.defineProperty(Gt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(S){this._matrix[3]=S}}),Object.defineProperty(Gt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(S){this._matrix[4]=S}}),Object.defineProperty(Gt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(S){this._matrix[5]=S}}),Object.defineProperty(Gt.prototype,"a",{get:function(){return this._matrix[0]},set:function(S){this._matrix[0]=S}}),Object.defineProperty(Gt.prototype,"b",{get:function(){return this._matrix[1]},set:function(S){this._matrix[1]=S}}),Object.defineProperty(Gt.prototype,"c",{get:function(){return this._matrix[2]},set:function(S){this._matrix[2]=S}}),Object.defineProperty(Gt.prototype,"d",{get:function(){return this._matrix[3]},set:function(S){this._matrix[3]=S}}),Object.defineProperty(Gt.prototype,"e",{get:function(){return this._matrix[4]},set:function(S){this._matrix[4]=S}}),Object.defineProperty(Gt.prototype,"f",{get:function(){return this._matrix[5]},set:function(S){this._matrix[5]=S}}),Object.defineProperty(Gt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Gt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Gt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Gt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Gt.prototype.join=function(S){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(B).join(S)},Gt.prototype.multiply=function(S){var G=S.sx*this.sx+S.shy*this.shx,Se=S.sx*this.shy+S.shy*this.sy,Oe=S.shx*this.sx+S.sy*this.shx,Ye=S.shx*this.shy+S.sy*this.sy,dt=S.tx*this.sx+S.ty*this.shx+this.tx,Nt=S.tx*this.shy+S.ty*this.sy+this.ty;return new Gt(G,Se,Oe,Ye,dt,Nt)},Gt.prototype.decompose=function(){var S=this.sx,G=this.shy,Se=this.shx,Oe=this.sy,Ye=this.tx,dt=this.ty,Nt=Math.sqrt(S*S+G*G),Xt=(S/=Nt)*Se+(G/=Nt)*Oe;Se-=S*Xt,Oe-=G*Xt;var hr=Math.sqrt(Se*Se+Oe*Oe);return Xt/=hr,S*(Oe/=hr)<G*(Se/=hr)&&(S=-S,G=-G,Xt=-Xt,Nt=-Nt),{scale:new Gt(Nt,0,0,hr,0,0),translate:new Gt(1,0,0,1,Ye,dt),rotate:new Gt(S,G,-G,S,0,0),skew:new Gt(1,0,Xt,1,0,0)}},Gt.prototype.toString=function(S){return this.join(" ")},Gt.prototype.inversed=function(){var S=this.sx,G=this.shy,Se=this.shx,Oe=this.sy,Ye=this.tx,dt=this.ty,Nt=1/(S*Oe-G*Se),Xt=Oe*Nt,hr=-G*Nt,jr=-Se*Nt,Ar=S*Nt;return new Gt(Xt,hr,jr,Ar,-Xt*Ye-jr*dt,-hr*Ye-Ar*dt)},Gt.prototype.applyToPoint=function(S){var G=S.x*this.sx+S.y*this.shx+this.tx,Se=S.x*this.shy+S.y*this.sy+this.ty;return new Ci(G,Se)},Gt.prototype.applyToRectangle=function(S){var G=this.applyToPoint(S),Se=this.applyToPoint(new Ci(S.x+S.w,S.y+S.h));return new On(G.x,G.y,Se.x-G.x,Se.y-G.y)},Gt.prototype.clone=function(){var S=this.sx,G=this.shy,Se=this.shx,Oe=this.sy,Ye=this.tx,dt=this.ty;return new Gt(S,G,Se,Oe,Ye,dt)},m.Matrix=Gt;var yn=m.matrixMult=function(S,G){return G.multiply(S)},wr=new Gt(1,0,0,1,0,0);m.unitMatrix=m.identityMatrix=wr;var Dr=function(S,G){if(!ga[S]){var Se=(G instanceof yu?"Sh":"P")+(Object.keys(Lr).length+1).toString(10);G.id=Se,ga[S]=Se,Lr[Se]=G,Or.publish("addPattern",G)}};m.ShadingPattern=yu,m.TilingPattern=_f,m.addShadingPattern=function(S,G){return V("addShadingPattern()"),Dr(S,G),this},m.beginTilingPattern=function(S){V("beginTilingPattern()"),ho(S.boundingBox[0],S.boundingBox[1],S.boundingBox[2]-S.boundingBox[0],S.boundingBox[3]-S.boundingBox[1],S.matrix)},m.endTilingPattern=function(S,G){V("endTilingPattern()"),G.stream=ct[M].join(`
`),Dr(S,G),Or.publish("endTilingPattern",G),Sn.pop().restore()};var nn=m.__private__.newObject=function(){var S=Qr();return X(S,!0),S},Qr=m.__private__.newObjectDeferred=function(){return ie++,xe[ie]=function(){return de},ie},X=function(S,G){return G=typeof G=="boolean"&&G,xe[S]=de,G&&we(S+" 0 obj"),S},be=m.__private__.newAdditionalObject=function(){var S={objId:Qr(),content:""};return Me.push(S),S},fe=Qr(),he=Qr(),_e=m.__private__.decodeColorString=function(S){var G=S.split(" ");if(G.length!==2||G[1]!=="g"&&G[1]!=="G")G.length===5&&(G[4]==="k"||G[4]==="K")&&(G=[(1-G[0])*(1-G[3]),(1-G[1])*(1-G[3]),(1-G[2])*(1-G[3]),"r"]);else{var Se=parseFloat(G[0]);G=[Se,Se,Se,"r"]}for(var Oe="#",Ye=0;Ye<3;Ye++)Oe+=("0"+Math.floor(255*parseFloat(G[Ye])).toString(16)).slice(-2);return Oe},ke=m.__private__.encodeColorString=function(S){var G;typeof S=="string"&&(S={ch1:S});var Se=S.ch1,Oe=S.ch2,Ye=S.ch3,dt=S.ch4,Nt=S.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Se=="string"&&Se.charAt(0)!=="#"){var Xt=new cw(Se);if(Xt.ok)Se=Xt.toHex();else if(!/^\d*\.?\d*$/.test(Se))throw new Error('Invalid color "'+Se+'" passed to jsPDF.encodeColorString.')}if(typeof Se=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Se)&&(Se="#"+Se[1]+Se[1]+Se[2]+Se[2]+Se[3]+Se[3]),typeof Se=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Se)){var hr=parseInt(Se.substr(1),16);Se=hr>>16&255,Oe=hr>>8&255,Ye=255&hr}if(Oe===void 0||dt===void 0&&Se===Oe&&Oe===Ye)if(typeof Se=="string")G=Se+" "+Nt[0];else switch(S.precision){case 2:G=ye(Se/255)+" "+Nt[0];break;case 3:default:G=U(Se/255)+" "+Nt[0]}else if(dt===void 0||Nn(dt)==="object"){if(dt&&!isNaN(dt.a)&&dt.a===0)return G=["1.","1.","1.",Nt[1]].join(" ");if(typeof Se=="string")G=[Se,Oe,Ye,Nt[1]].join(" ");else switch(S.precision){case 2:G=[ye(Se/255),ye(Oe/255),ye(Ye/255),Nt[1]].join(" ");break;default:case 3:G=[U(Se/255),U(Oe/255),U(Ye/255),Nt[1]].join(" ")}}else if(typeof Se=="string")G=[Se,Oe,Ye,dt,Nt[2]].join(" ");else switch(S.precision){case 2:G=[ye(Se),ye(Oe),ye(Ye),ye(dt),Nt[2]].join(" ");break;case 3:default:G=[U(Se),U(Oe),U(Ye),U(dt),Nt[2]].join(" ")}return G},Qe=m.__private__.getFilters=function(){return o},ut=m.__private__.putStream=function(S){var G=(S=S||{}).data||"",Se=S.filters||Qe(),Oe=S.alreadyAppliedFilters||[],Ye=S.addLength1||!1,dt=G.length,Nt=S.objectId,Xt=function(va){return va};if(h!==null&&Nt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");h!==null&&(Xt=Cn.encryptor(Nt,0));var hr={};Se===!0&&(Se=["FlateEncode"]);var jr=S.additionalKeyValues||[],Ar=(hr=Tr.API.processDataByFilters!==void 0?Tr.API.processDataByFilters(G,Se):{data:G,reverseChain:[]}).reverseChain+(Array.isArray(Oe)?Oe.join(" "):Oe.toString());if(hr.data.length!==0&&(jr.push({key:"Length",value:hr.data.length}),Ye===!0&&jr.push({key:"Length1",value:dt})),Ar.length!=0)if(Ar.split("/").length-1==1)jr.push({key:"Filter",value:Ar});else{jr.push({key:"Filter",value:"["+Ar+"]"});for(var Yr=0;Yr<jr.length;Yr+=1)if(jr[Yr].key==="DecodeParms"){for(var In=[],Rn=0;Rn<hr.reverseChain.split("/").length-1;Rn+=1)In.push("null");In.push(jr[Yr].value),jr[Yr].value="["+In.join(" ")+"]"}}we("<<");for(var ea=0;ea<jr.length;ea++)we("/"+jr[ea].key+" "+jr[ea].value);we(">>"),hr.data.length!==0&&(we("stream"),we(Xt(hr.data)),we("endstream"))},Xe=m.__private__.putPage=function(S){var G=S.number,Se=S.data,Oe=S.objId,Ye=S.contentsObjId;X(Oe,!0),we("<</Type /Page"),we("/Parent "+S.rootDictionaryObjId+" 0 R"),we("/Resources "+S.resourceDictionaryObjId+" 0 R"),we("/MediaBox ["+parseFloat(B(S.mediaBox.bottomLeftX))+" "+parseFloat(B(S.mediaBox.bottomLeftY))+" "+B(S.mediaBox.topRightX)+" "+B(S.mediaBox.topRightY)+"]"),S.cropBox!==null&&we("/CropBox ["+B(S.cropBox.bottomLeftX)+" "+B(S.cropBox.bottomLeftY)+" "+B(S.cropBox.topRightX)+" "+B(S.cropBox.topRightY)+"]"),S.bleedBox!==null&&we("/BleedBox ["+B(S.bleedBox.bottomLeftX)+" "+B(S.bleedBox.bottomLeftY)+" "+B(S.bleedBox.topRightX)+" "+B(S.bleedBox.topRightY)+"]"),S.trimBox!==null&&we("/TrimBox ["+B(S.trimBox.bottomLeftX)+" "+B(S.trimBox.bottomLeftY)+" "+B(S.trimBox.topRightX)+" "+B(S.trimBox.topRightY)+"]"),S.artBox!==null&&we("/ArtBox ["+B(S.artBox.bottomLeftX)+" "+B(S.artBox.bottomLeftY)+" "+B(S.artBox.topRightX)+" "+B(S.artBox.topRightY)+"]"),typeof S.userUnit=="number"&&S.userUnit!==1&&we("/UserUnit "+S.userUnit),Or.publish("putPage",{objId:Oe,pageContext:ar[G],pageNumber:G,page:Se}),we("/Contents "+Ye+" 0 R"),we(">>"),we("endobj");var dt=Se.join(`
`);return F===O.ADVANCED&&(dt+=`
Q`),X(Ye,!0),ut({data:dt,filters:Qe(),objectId:Ye}),we("endobj"),Oe},rt=m.__private__.putPages=function(){var S,G,Se=[];for(S=1;S<=Fr;S++)ar[S].objId=Qr(),ar[S].contentsObjId=Qr();for(S=1;S<=Fr;S++)Se.push(Xe({number:S,data:ct[S],objId:ar[S].objId,contentsObjId:ar[S].contentsObjId,mediaBox:ar[S].mediaBox,cropBox:ar[S].cropBox,bleedBox:ar[S].bleedBox,trimBox:ar[S].trimBox,artBox:ar[S].artBox,userUnit:ar[S].userUnit,rootDictionaryObjId:fe,resourceDictionaryObjId:he}));X(fe,!0),we("<</Type /Pages");var Oe="/Kids [";for(G=0;G<Fr;G++)Oe+=Se[G]+" 0 R ";we(Oe+"]"),we("/Count "+Fr),we(">>"),we("endobj"),Or.publish("postPutPages")},nt=function(S){Or.publish("putFont",{font:S,out:we,newObject:nn,putStream:ut}),S.isAlreadyPutted!==!0&&(S.objectNumber=nn(),we("<<"),we("/Type /Font"),we("/BaseFont /"+mf(S.postScriptName)),we("/Subtype /Type1"),typeof S.encoding=="string"&&we("/Encoding /"+S.encoding),we("/FirstChar 32"),we("/LastChar 255"),we(">>"),we("endobj"))},St=function(){for(var S in Ur)Ur.hasOwnProperty(S)&&(g===!1||g===!0&&x.hasOwnProperty(S))&&nt(Ur[S])},zt=function(S){S.objectNumber=nn();var G=[];G.push({key:"Type",value:"/XObject"}),G.push({key:"Subtype",value:"/Form"}),G.push({key:"BBox",value:"["+[B(S.x),B(S.y),B(S.x+S.width),B(S.y+S.height)].join(" ")+"]"}),G.push({key:"Matrix",value:"["+S.matrix.toString()+"]"});var Se=S.pages[1].join(`
`);ut({data:Se,additionalKeyValues:G,objectId:S.objectNumber}),we("endobj")},It=function(){for(var S in Jr)Jr.hasOwnProperty(S)&&zt(Jr[S])},Lt=function(S,G){var Se,Oe=[],Ye=1/(G-1);for(Se=0;Se<1;Se+=Ye)Oe.push(Se);if(Oe.push(1),S[0].offset!=0){var dt={offset:0,color:S[0].color};S.unshift(dt)}if(S[S.length-1].offset!=1){var Nt={offset:1,color:S[S.length-1].color};S.push(Nt)}for(var Xt="",hr=0,jr=0;jr<Oe.length;jr++){for(Se=Oe[jr];Se>S[hr+1].offset;)hr++;var Ar=S[hr].offset,Yr=(Se-Ar)/(S[hr+1].offset-Ar),In=S[hr].color,Rn=S[hr+1].color;Xt+=H(Math.round((1-Yr)*In[0]+Yr*Rn[0]).toString(16))+H(Math.round((1-Yr)*In[1]+Yr*Rn[1]).toString(16))+H(Math.round((1-Yr)*In[2]+Yr*Rn[2]).toString(16))}return Xt.trim()},kt=function(S,G){G||(G=21);var Se=nn(),Oe=Lt(S.colors,G),Ye=[];Ye.push({key:"FunctionType",value:"0"}),Ye.push({key:"Domain",value:"[0.0 1.0]"}),Ye.push({key:"Size",value:"["+G+"]"}),Ye.push({key:"BitsPerSample",value:"8"}),Ye.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ye.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ut({data:Oe,additionalKeyValues:Ye,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Se}),we("endobj"),S.objectNumber=nn(),we("<< /ShadingType "+S.type),we("/ColorSpace /DeviceRGB");var dt="/Coords ["+B(parseFloat(S.coords[0]))+" "+B(parseFloat(S.coords[1]))+" ";S.type===2?dt+=B(parseFloat(S.coords[2]))+" "+B(parseFloat(S.coords[3])):dt+=B(parseFloat(S.coords[2]))+" "+B(parseFloat(S.coords[3]))+" "+B(parseFloat(S.coords[4]))+" "+B(parseFloat(S.coords[5])),we(dt+="]"),S.matrix&&we("/Matrix ["+S.matrix.toString()+"]"),we("/Function "+Se+" 0 R"),we("/Extend [true true]"),we(">>"),we("endobj")},kr=function(S,G){var Se=Qr(),Oe=nn();G.push({resourcesOid:Se,objectOid:Oe}),S.objectNumber=Oe;var Ye=[];Ye.push({key:"Type",value:"/Pattern"}),Ye.push({key:"PatternType",value:"1"}),Ye.push({key:"PaintType",value:"1"}),Ye.push({key:"TilingType",value:"1"}),Ye.push({key:"BBox",value:"["+S.boundingBox.map(B).join(" ")+"]"}),Ye.push({key:"XStep",value:B(S.xStep)}),Ye.push({key:"YStep",value:B(S.yStep)}),Ye.push({key:"Resources",value:Se+" 0 R"}),S.matrix&&Ye.push({key:"Matrix",value:"["+S.matrix.toString()+"]"}),ut({data:S.stream,additionalKeyValues:Ye,objectId:S.objectNumber}),we("endobj")},Kr=function(S){var G;for(G in Lr)Lr.hasOwnProperty(G)&&(Lr[G]instanceof yu?kt(Lr[G]):Lr[G]instanceof _f&&kr(Lr[G],S))},en=function(S){for(var G in S.objectNumber=nn(),we("<<"),S)switch(G){case"opacity":we("/ca "+ye(S[G]));break;case"stroke-opacity":we("/CA "+ye(S[G]))}we(">>"),we("endobj")},En=function(){var S;for(S in At)At.hasOwnProperty(S)&&en(At[S])},ci=function(){for(var S in we("/XObject <<"),Jr)Jr.hasOwnProperty(S)&&Jr[S].objectNumber>=0&&we("/"+S+" "+Jr[S].objectNumber+" 0 R");Or.publish("putXobjectDict"),we(">>")},Ca=function(){Cn.oid=nn(),we("<<"),we("/Filter /Standard"),we("/V "+Cn.v),we("/R "+Cn.r),we("/U <"+Cn.toHexString(Cn.U)+">"),we("/O <"+Cn.toHexString(Cn.O)+">"),we("/P "+Cn.P),we(">>"),we("endobj")},Ga=function(){for(var S in we("/Font <<"),Ur)Ur.hasOwnProperty(S)&&(g===!1||g===!0&&x.hasOwnProperty(S))&&we("/"+S+" "+Ur[S].objectNumber+" 0 R");we(">>")},Fn=function(){if(Object.keys(Lr).length>0){for(var S in we("/Shading <<"),Lr)Lr.hasOwnProperty(S)&&Lr[S]instanceof yu&&Lr[S].objectNumber>=0&&we("/"+S+" "+Lr[S].objectNumber+" 0 R");Or.publish("putShadingPatternDict"),we(">>")}},Ji=function(S){if(Object.keys(Lr).length>0){for(var G in we("/Pattern <<"),Lr)Lr.hasOwnProperty(G)&&Lr[G]instanceof m.TilingPattern&&Lr[G].objectNumber>=0&&Lr[G].objectNumber<S&&we("/"+G+" "+Lr[G].objectNumber+" 0 R");Or.publish("putTilingPatternDict"),we(">>")}},pr=function(){if(Object.keys(At).length>0){var S;for(S in we("/ExtGState <<"),At)At.hasOwnProperty(S)&&At[S].objectNumber>=0&&we("/"+S+" "+At[S].objectNumber+" 0 R");Or.publish("putGStateDict"),we(">>")}},Un=function(S){X(S.resourcesOid,!0),we("<<"),we("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Ga(),Fn(),Ji(S.objectOid),pr(),ci(),we(">>"),we("endobj")},Ml=function(){var S=[];St(),En(),It(),Kr(S),Or.publish("putResources"),S.forEach(Un),Un({resourcesOid:he,objectOid:Number.MAX_SAFE_INTEGER}),Or.publish("postPutResources")},Bl=function(){Or.publish("putAdditionalObjects");for(var S=0;S<Me.length;S++){var G=Me[S];X(G.objId,!0),we(G.content),we("endobj")}Or.publish("postPutAdditionalObjects")},an=function(S){Ut[S.fontName]=Ut[S.fontName]||{},Ut[S.fontName][S.fontStyle]=S.id},_i=function(S,G,Se,Oe,Ye){var dt={id:"F"+(Object.keys(Ur).length+1).toString(10),postScriptName:S,fontName:G,fontStyle:Se,encoding:Oe,isStandardFont:Ye||!1,metadata:{}};return Or.publish("addFont",{font:dt,instance:this}),Ur[dt.id]=dt,an(dt),dt.id},Qi=function(S){for(var G=0,Se=xt.length;G<Se;G++){var Oe=_i.call(this,S[G][0],S[G][1],S[G][2],xt[G][3],!0);g===!1&&(x[Oe]=!0);var Ye=S[G][0].split("-");an({id:Oe,fontName:Ye[0],fontStyle:Ye[1]||""})}Or.publish("addFonts",{fonts:Ur,dictionary:Ut})},aa=function(S){return S.foo=function(){try{return S.apply(this,arguments)}catch(Oe){var G=Oe.stack||"";~G.indexOf(" at ")&&(G=G.split(" at ")[1]);var Se="Error in function "+G.split(`
`)[0].split("<")[0]+": "+Oe.message;if(!Pr.console)throw new Error(Se);Pr.console.error(Se,Oe),Pr.alert&&alert(Se)}},S.foo.bar=S,S.foo},io=function(S,G){var Se,Oe,Ye,dt,Nt,Xt,hr,jr,Ar;if(Ye=(G=G||{}).sourceEncoding||"Unicode",Nt=G.outputEncoding,(G.autoencode||Nt)&&Ur[$t].metadata&&Ur[$t].metadata[Ye]&&Ur[$t].metadata[Ye].encoding&&(dt=Ur[$t].metadata[Ye].encoding,!Nt&&Ur[$t].encoding&&(Nt=Ur[$t].encoding),!Nt&&dt.codePages&&(Nt=dt.codePages[0]),typeof Nt=="string"&&(Nt=dt[Nt]),Nt)){for(hr=!1,Xt=[],Se=0,Oe=S.length;Se<Oe;Se++)(jr=Nt[S.charCodeAt(Se)])?Xt.push(String.fromCharCode(jr)):Xt.push(S[Se]),Xt[Se].charCodeAt(0)>>8&&(hr=!0);S=Xt.join("")}for(Se=S.length;hr===void 0&&Se!==0;)S.charCodeAt(Se-1)>>8&&(hr=!0),Se--;if(!hr)return S;for(Xt=G.noBOM?[]:[254,255],Se=0,Oe=S.length;Se<Oe;Se++){if((Ar=(jr=S.charCodeAt(Se))>>8)>>8)throw new Error("Character at position "+Se+" of string '"+S+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Xt.push(Ar),Xt.push(jr-(Ar<<8))}return String.fromCharCode.apply(void 0,Xt)},Pa=m.__private__.pdfEscape=m.pdfEscape=function(S,G){return io(S,G).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ws=m.__private__.beginPage=function(S){ct[++Fr]=[],ar[Fr]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(S[0]),topRightY:Number(S[1])}},Ms(Fr),Je(ct[M])},hl=function(S,G){var Se,Oe,Ye;switch(r=G||r,typeof S=="string"&&(Se=N(S.toLowerCase()),Array.isArray(Se)&&(Oe=Se[0],Ye=Se[1])),Array.isArray(S)&&(Oe=S[0]*wt,Ye=S[1]*wt),isNaN(Oe)&&(Oe=a[0],Ye=a[1]),(Oe>14400||Ye>14400)&&(jn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Oe=Math.min(14400,Oe),Ye=Math.min(14400,Ye)),a=[Oe,Ye],r.substr(0,1)){case"l":Ye>Oe&&(a=[Ye,Oe]);break;case"p":Oe>Ye&&(a=[Ye,Oe])}ws(a),_s(zl),we(ma),Io!==0&&we(Io+" J"),zs!==0&&we(zs+" j"),Or.publish("addPage",{pageNumber:Fr})},so=function(S){S>0&&S<=Fr&&(ct.splice(S,1),ar.splice(S,1),Fr--,M>Fr&&(M=Fr),this.setPage(M))},Ms=function(S){S>0&&S<=Fr&&(M=S)},Co=m.__private__.getNumberOfPages=m.getNumberOfPages=function(){return ct.length-1},Po=function(S,G,Se){var Oe,Ye=void 0;return Se=Se||{},S=S!==void 0?S:Ur[$t].fontName,G=G!==void 0?G:Ur[$t].fontStyle,Oe=S.toLowerCase(),Ut[Oe]!==void 0&&Ut[Oe][G]!==void 0?Ye=Ut[Oe][G]:Ut[S]!==void 0&&Ut[S][G]!==void 0?Ye=Ut[S][G]:Se.disableWarning===!1&&jn.warn("Unable to look up font label for font '"+S+"', '"+G+"'. Refer to getFontList() for available fonts."),Ye||Se.noFallback||(Ye=Ut.times[G])==null&&(Ye=Ut.times.normal),Ye},sn=m.__private__.putInfo=function(){var S=nn(),G=function(Oe){return Oe};for(var Se in h!==null&&(G=Cn.encryptor(S,0)),we("<<"),we("/Producer ("+Pa(G("jsPDF "+Tr.version))+")"),Qt)Qt.hasOwnProperty(Se)&&Qt[Se]&&we("/"+Se.substr(0,1).toUpperCase()+Se.substr(1)+" ("+Pa(G(Qt[Se]))+")");we("/CreationDate ("+Pa(G(Te))+")"),we(">>"),we("endobj")},Gr=m.__private__.putCatalog=function(S){var G=(S=S||{}).rootDictionaryObjId||fe;switch(nn(),we("<<"),we("/Type /Catalog"),we("/Pages "+G+" 0 R"),Et||(Et="fullwidth"),Et){case"fullwidth":we("/OpenAction [3 0 R /FitH null]");break;case"fullheight":we("/OpenAction [3 0 R /FitV null]");break;case"fullpage":we("/OpenAction [3 0 R /Fit]");break;case"original":we("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Se=""+Et;Se.substr(Se.length-1)==="%"&&(Et=parseInt(Et)/100),typeof Et=="number"&&we("/OpenAction [3 0 R /XYZ null null "+ye(Et)+"]")}switch(gr||(gr="continuous"),gr){case"continuous":we("/PageLayout /OneColumn");break;case"single":we("/PageLayout /SinglePage");break;case"two":case"twoleft":we("/PageLayout /TwoColumnLeft");break;case"tworight":we("/PageLayout /TwoColumnRight")}nr&&we("/PageMode /"+nr),Or.publish("putCatalog"),we(">>"),we("endobj")},dl=m.__private__.putTrailer=function(){we("trailer"),we("<<"),we("/Size "+(ie+1)),we("/Root "+ie+" 0 R"),we("/Info "+(ie-1)+" 0 R"),h!==null&&we("/Encrypt "+Cn.oid+" 0 R"),we("/ID [ <"+Fe+"> <"+Fe+"> ]"),we(">>")},Ul=m.__private__.putHeader=function(){we("%PDF-"+k),we("%")},pc=m.__private__.putXRef=function(){var S="0000000000";we("xref"),we("0 "+(ie+1)),we("0000000000 65535 f ");for(var G=1;G<=ie;G++)typeof xe[G]=="function"?we((S+xe[G]()).slice(-10)+" 00000 n "):xe[G]!==void 0?we((S+xe[G]).slice(-10)+" 00000 n "):we("0000000000 00000 n ")},zn=m.__private__.buildDocument=function(){Dt(),Je(Ae),Or.publish("buildDocument"),Ul(),rt(),Bl(),Ml(),h!==null&&Ca(),sn(),Gr();var S=de;return pc(),dl(),we("startxref"),we(""+S),we("%%EOF"),Je(ct[M]),Ae.join(`
`)},ki=m.__private__.getBlob=function(S){return new Blob([qt(S)],{type:"application/pdf"})},Zi=m.output=m.__private__.output=aa(function(S,G){switch(typeof(G=G||{})=="string"?G={filename:G}:G.filename=G.filename||"generated.pdf",S){case void 0:return zn();case"save":m.save(G.filename);break;case"arraybuffer":return qt(zn());case"blob":return ki(zn());case"bloburi":case"bloburl":if(Pr.URL!==void 0&&typeof Pr.URL.createObjectURL=="function")return Pr.URL&&Pr.URL.createObjectURL(ki(zn()))||void 0;jn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Se="",Oe=zn();try{Se=cg(Oe)}catch{Se=cg(unescape(encodeURIComponent(Oe)))}return"data:application/pdf;filename="+G.filename+";base64,"+Se;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Pr)==="[object Window]"){var Ye="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",dt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';G.pdfObjectUrl&&(Ye=G.pdfObjectUrl,dt="");var Nt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ye+'"'+dt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(G)+");<\/script></body></html>",Xt=Pr.open();return Xt!==null&&Xt.document.write(Nt),Xt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Pr)==="[object Window]"){var hr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(G.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+G.filename+'" width="500px" height="400px" /></body></html>',jr=Pr.open();if(jr!==null){jr.document.write(hr);var Ar=this;jr.document.documentElement.querySelector("#pdfViewer").onload=function(){jr.document.title=G.filename,jr.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Ar.output("bloburl"))}}return jr}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Pr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Yr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",G)+'"></iframe></body></html>',In=Pr.open();if(In!==null&&(In.document.write(Yr),In.document.title=G.filename),In||typeof safari>"u")return In;break;case"datauri":case"dataurl":return Pr.document.location.href=this.output("datauristring",G);default:return null}}),Ya=function(S){return Array.isArray(Ln)===!0&&Ln.indexOf(S)>-1};switch(n){case"pt":wt=1;break;case"mm":wt=72/25.4;break;case"cm":wt=72/2.54;break;case"in":wt=72;break;case"px":wt=Ya("px_scaling")==1?.75:96/72;break;case"pc":case"em":wt=12;break;case"ex":wt=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);wt=n}var Cn=null;pe(),me();var es=function(S){return h!==null?Cn.encryptor(S,0):function(G){return G}},gn=m.__private__.getPageInfo=m.getPageInfo=function(S){if(isNaN(S)||S%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:ar[S].objId,pageNumber:S,pageContext:ar[S]}},fr=m.__private__.getPageInfoByObjId=function(S){if(isNaN(S)||S%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var G in ar)if(ar[G].objId===S)break;return gn(G)},ts=m.__private__.getCurrentPageInfo=m.getCurrentPageInfo=function(){return{objId:ar[M].objId,pageNumber:M,pageContext:ar[M]}};m.addPage=function(){return hl.apply(this,arguments),this},m.setPage=function(){return Ms.apply(this,arguments),Je.call(this,ct[M]),this},m.insertPage=function(S){return this.addPage(),this.movePage(M,S),this},m.movePage=function(S,G){var Se,Oe;if(S>G){Se=ct[S],Oe=ar[S];for(var Ye=S;Ye>G;Ye--)ct[Ye]=ct[Ye-1],ar[Ye]=ar[Ye-1];ct[G]=Se,ar[G]=Oe,this.setPage(G)}else if(S<G){Se=ct[S],Oe=ar[S];for(var dt=S;dt<G;dt++)ct[dt]=ct[dt+1],ar[dt]=ar[dt+1];ct[G]=Se,ar[G]=Oe,this.setPage(G)}return this},m.deletePage=function(){return so.apply(this,arguments),this},m.__private__.text=m.text=function(S,G,Se,Oe,Ye){var dt,Nt,Xt,hr,jr,Ar,Yr,In,Rn,ea=(Oe=Oe||{}).scope||this;if(typeof S=="number"&&typeof G=="number"&&(typeof Se=="string"||Array.isArray(Se))){var va=Se;Se=G,G=S,S=va}if(arguments[3]instanceof Gt?(V("The transform parameter of text() with a Matrix value"),Rn=Ye):(Xt=arguments[4],hr=arguments[5],Nn(Yr=arguments[3])==="object"&&Yr!==null||(typeof Xt=="string"&&(hr=Xt,Xt=null),typeof Yr=="string"&&(hr=Yr,Yr=null),typeof Yr=="number"&&(Xt=Yr,Yr=null),Oe={flags:Yr,angle:Xt,align:hr})),isNaN(G)||isNaN(Se)||S==null)throw new Error("Invalid arguments passed to jsPDF.text");if(S.length===0)return ea;var ia="",ss=!1,Qa=typeof Oe.lineHeightFactor=="number"?Oe.lineHeightFactor:Oo,Za=ea.internal.scaleFactor;function $s(er){return er=er.split("	").join(Array(Oe.TabLen||9).join(" ")),Pa(er,Yr)}function vl(er){for(var tr,lr=er.concat(),tn=[],br=lr.length;br--;)typeof(tr=lr.shift())=="string"?tn.push(tr):Array.isArray(er)&&(tr.length===1||tr[1]===void 0&&tr[2]===void 0)?tn.push(tr[0]):tn.push([tr[0],tr[1],tr[2]]);return tn}function xl(er,tr){var lr;if(typeof er=="string")lr=tr(er)[0];else if(Array.isArray(er)){for(var tn,br,Gn=er.concat(),Hn=[],go=Gn.length;go--;)typeof(tn=Gn.shift())=="string"?Hn.push(tr(tn)[0]):Array.isArray(tn)&&typeof tn[0]=="string"&&(br=tr(tn[0],tn[1],tn[2]),Hn.push([br[0],br[1],br[2]]));lr=Hn}return lr}var Do=!1,yl=!0;if(typeof S=="string")Do=!0;else if(Array.isArray(S)){var Hs=S.concat();Nt=[];for(var Ma,Br=Hs.length;Br--;)(typeof(Ma=Hs.shift())!="string"||Array.isArray(Ma)&&typeof Ma[0]!="string")&&(yl=!1);Do=yl}if(Do===!1)throw new Error('Type of text must be string or Array. "'+S+'" is not recognized.');typeof S=="string"&&(S=S.match(/[\r?\n]/)?S.split(/\r\n|\r|\n/g):[S]);var Vs=_t/ea.internal.scaleFactor,xa=Vs*(Qa-1);switch(Oe.baseline){case"bottom":Se-=xa;break;case"top":Se+=Vs-xa;break;case"hanging":Se+=Vs-2*xa;break;case"middle":Se+=Vs/2-xa}if((Ar=Oe.maxWidth||0)>0&&(typeof S=="string"?S=ea.splitTextToSize(S,Ar):Object.prototype.toString.call(S)==="[object Array]"&&(S=S.reduce(function(er,tr){return er.concat(ea.splitTextToSize(tr,Ar))},[]))),dt={text:S,x:G,y:Se,options:Oe,mutex:{pdfEscape:Pa,activeFontKey:$t,fonts:Ur,activeFontSize:_t}},Or.publish("preProcessText",dt),S=dt.text,Xt=(Oe=dt.options).angle,!(Rn instanceof Gt)&&Xt&&typeof Xt=="number"){Xt*=Math.PI/180,Oe.rotationDirection===0&&(Xt=-Xt),F===O.ADVANCED&&(Xt=-Xt);var wl=Math.cos(Xt),po=Math.sin(Xt);Rn=new Gt(wl,po,-po,wl,0,0)}else Xt&&Xt instanceof Gt&&(Rn=Xt);F!==O.ADVANCED||Rn||(Rn=wr),(jr=Oe.charSpace||uo)!==void 0&&(ia+=B(D(jr))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(In=Oe.horizontalScale)!==void 0&&(ia+=B(100*In)+` Tz
`),Oe.lang;var La=-1,fi=Oe.renderingMode!==void 0?Oe.renderingMode:Oe.stroke,os=ea.internal.getCurrentPageInfo().pageContext;switch(fi){case 0:case!1:case"fill":La=0;break;case 1:case!0:case"stroke":La=1;break;case 2:case"fillThenStroke":La=2;break;case 3:case"invisible":La=3;break;case 4:case"fillAndAddForClipping":La=4;break;case 5:case"strokeAndAddPathForClipping":La=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":La=6;break;case 7:case"addToPathForClipping":La=7}var Ws=os.usedRenderingMode!==void 0?os.usedRenderingMode:-1;La!==-1?ia+=La+` Tr
`:Ws!==-1&&(ia+=`0 Tr
`),La!==-1&&(os.usedRenderingMode=La),hr=Oe.align||"left";var $n,jo=_t*Qa,v=ea.internal.pageSize.getWidth(),_=Ur[$t];jr=Oe.charSpace||uo,Ar=Oe.maxWidth||0,Yr=Object.assign({autoencode:!0,noBOM:!0},Oe.flags);var L=[],j=function(er){return ea.getStringUnitWidth(er,{font:_,charSpace:jr,fontSize:_t,doKerning:!1})*_t/Za};if(Object.prototype.toString.call(S)==="[object Array]"){var q;Nt=vl(S),hr!=="left"&&($n=Nt.map(j));var Z,ve=0;if(hr==="right"){G-=$n[0],S=[],Br=Nt.length;for(var Ce=0;Ce<Br;Ce++)Ce===0?(Z=Ni(G),q=Ja(Se)):(Z=D(ve-$n[Ce]),q=-jo),S.push([Nt[Ce],Z,q]),ve=$n[Ce]}else if(hr==="center"){G-=$n[0]/2,S=[],Br=Nt.length;for(var De=0;De<Br;De++)De===0?(Z=Ni(G),q=Ja(Se)):(Z=D((ve-$n[De])/2),q=-jo),S.push([Nt[De],Z,q]),ve=$n[De]}else if(hr==="left"){S=[],Br=Nt.length;for(var ze=0;ze<Br;ze++)S.push(Nt[ze])}else if(hr==="justify"&&_.encoding==="Identity-H"){S=[],Br=Nt.length,Ar=Ar!==0?Ar:v;for(var Ve=0,Ne=0;Ne<Br;Ne++)if(q=Ne===0?Ja(Se):-jo,Z=Ne===0?Ni(G):Ve,Ne<Br-1){var Ke=D((Ar-$n[Ne])/(Nt[Ne].split(" ").length-1)),Ie=Nt[Ne].split(" ");S.push([Ie[0]+" ",Z,q]),Ve=0;for(var qe=1;qe<Ie.length;qe++){var Ge=(j(Ie[qe-1]+" "+Ie[qe])-j(Ie[qe]))*Za+Ke;qe==Ie.length-1?S.push([Ie[qe],Ge,0]):S.push([Ie[qe]+" ",Ge,0]),Ve-=Ge}}else S.push([Nt[Ne],Z,q]);S.push(["",Ve,0])}else{if(hr!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(S=[],Br=Nt.length,Ar=Ar!==0?Ar:v,Ne=0;Ne<Br;Ne++)q=Ne===0?Ja(Se):-jo,Z=Ne===0?Ni(G):0,Ne<Br-1?L.push(B(D((Ar-$n[Ne])/(Nt[Ne].split(" ").length-1)))):L.push(0),S.push([Nt[Ne],Z,q])}}var $e=typeof Oe.R2L=="boolean"?Oe.R2L:Jt;$e===!0&&(S=xl(S,function(er,tr,lr){return[er.split("").reverse().join(""),tr,lr]})),dt={text:S,x:G,y:Se,options:Oe,mutex:{pdfEscape:Pa,activeFontKey:$t,fonts:Ur,activeFontSize:_t}},Or.publish("postProcessText",dt),S=dt.text,ss=dt.mutex.isHex||!1;var at=Ur[$t].encoding;at!=="WinAnsiEncoding"&&at!=="StandardEncoding"||(S=xl(S,function(er,tr,lr){return[$s(er),tr,lr]})),Nt=vl(S),S=[];for(var st,ot,ht,Tt=0,Mt=1,Ct=Array.isArray(Nt[0])?Mt:Tt,Rt="",Vt=function(er,tr,lr){var tn="";return lr instanceof Gt?(lr=typeof Oe.angle=="number"?yn(lr,new Gt(1,0,0,1,er,tr)):yn(new Gt(1,0,0,1,er,tr),lr),F===O.ADVANCED&&(lr=yn(new Gt(1,0,0,-1,0,0),lr)),tn=lr.join(" ")+` Tm
`):tn=B(er)+" "+B(tr)+` Td
`,tn},Ft=0;Ft<Nt.length;Ft++){switch(Rt="",Ct){case Mt:ht=(ss?"<":"(")+Nt[Ft][0]+(ss?">":")"),st=parseFloat(Nt[Ft][1]),ot=parseFloat(Nt[Ft][2]);break;case Tt:ht=(ss?"<":"(")+Nt[Ft]+(ss?">":")"),st=Ni(G),ot=Ja(Se)}L!==void 0&&L[Ft]!==void 0&&(Rt=L[Ft]+` Tw
`),Ft===0?S.push(Rt+Vt(st,ot,Rn)+ht):Ct===Tt?S.push(Rt+ht):Ct===Mt&&S.push(Rt+Vt(st,ot,Rn)+ht)}S=Ct===Tt?S.join(` Tj
T* `):S.join(` Tj
`),S+=` Tj
`;var Wt=`BT
/`;return Wt+=$t+" "+_t+` Tf
`,Wt+=B(_t*Qa)+` TL
`,Wt+=qn+`
`,Wt+=ia,Wt+=S,we(Wt+="ET"),x[$t]=!0,ea};var Xa=m.__private__.clip=m.clip=function(S){return we(S==="evenodd"?"W*":"W"),this};m.clipEvenOdd=function(){return Xa("evenodd")},m.__private__.discardPath=m.discardPath=function(){return we("n"),this};var Si=m.__private__.isValidStyle=function(S){var G=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(S)!==-1&&(G=!0),G};m.__private__.setDefaultPathOperation=m.setDefaultPathOperation=function(S){return Si(S)&&(f=S),this};var Ei=m.__private__.getStyle=m.getStyle=function(S){var G=f;switch(S){case"D":case"S":G="S";break;case"F":G="f";break;case"FD":case"DF":G="B";break;case"f":case"f*":case"B":case"B*":G=S}return G},oo=m.close=function(){return we("h"),this};m.stroke=function(){return we("S"),this},m.fill=function(S){return ja("f",S),this},m.fillEvenOdd=function(S){return ja("f*",S),this},m.fillStroke=function(S){return ja("B",S),this},m.fillStrokeEvenOdd=function(S){return ja("B*",S),this};var ja=function(S,G){Nn(G)==="object"?pl(G,S):we(S)},lo=function(S){S===null||F===O.ADVANCED&&S===void 0||(S=Ei(S),we(S))};function Lo(S,G,Se,Oe,Ye){var dt=new _f(G||this.boundingBox,Se||this.xStep,Oe||this.yStep,this.gState,Ye||this.matrix);dt.stream=this.stream;var Nt=S+"$$"+this.cloneIndex+++"$$";return Dr(Nt,dt),dt}var pl=function(S,G){var Se=ga[S.key],Oe=Lr[Se];if(Oe instanceof yu)we("q"),we(Fo(G)),Oe.gState&&m.setGState(Oe.gState),we(S.matrix.toString()+" cm"),we("/"+Se+" sh"),we("Q");else if(Oe instanceof _f){var Ye=new Gt(1,0,0,-1,0,is());S.matrix&&(Ye=Ye.multiply(S.matrix||wr),Se=Lo.call(Oe,S.key,S.boundingBox,S.xStep,S.yStep,Ye).id),we("q"),we("/Pattern cs"),we("/"+Se+" scn"),Oe.gState&&m.setGState(Oe.gState),we(G),we("Q")}},Fo=function(S){switch(S){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},rs=m.moveTo=function(S,G){return we(B(D(S))+" "+B(ue(G))+" m"),this},Ai=m.lineTo=function(S,G){return we(B(D(S))+" "+B(ue(G))+" l"),this},ui=m.curveTo=function(S,G,Se,Oe,Ye,dt){return we([B(D(S)),B(ue(G)),B(D(Se)),B(ue(Oe)),B(D(Ye)),B(ue(dt)),"c"].join(" ")),this};m.__private__.line=m.line=function(S,G,Se,Oe,Ye){if(isNaN(S)||isNaN(G)||isNaN(Se)||isNaN(Oe)||!Si(Ye))throw new Error("Invalid arguments passed to jsPDF.line");return F===O.COMPAT?this.lines([[Se-S,Oe-G]],S,G,[1,1],Ye||"S"):this.lines([[Se-S,Oe-G]],S,G,[1,1]).stroke()},m.__private__.lines=m.lines=function(S,G,Se,Oe,Ye,dt){var Nt,Xt,hr,jr,Ar,Yr,In,Rn,ea,va,ia,ss;if(typeof S=="number"&&(ss=Se,Se=G,G=S,S=ss),Oe=Oe||[1,1],dt=dt||!1,isNaN(G)||isNaN(Se)||!Array.isArray(S)||!Array.isArray(Oe)||!Si(Ye)||typeof dt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(rs(G,Se),Nt=Oe[0],Xt=Oe[1],jr=S.length,va=G,ia=Se,hr=0;hr<jr;hr++)(Ar=S[hr]).length===2?(va=Ar[0]*Nt+va,ia=Ar[1]*Xt+ia,Ai(va,ia)):(Yr=Ar[0]*Nt+va,In=Ar[1]*Xt+ia,Rn=Ar[2]*Nt+va,ea=Ar[3]*Xt+ia,va=Ar[4]*Nt+va,ia=Ar[5]*Xt+ia,ui(Yr,In,Rn,ea,va,ia));return dt&&oo(),lo(Ye),this},m.path=function(S){for(var G=0;G<S.length;G++){var Se=S[G],Oe=Se.c;switch(Se.op){case"m":rs(Oe[0],Oe[1]);break;case"l":Ai(Oe[0],Oe[1]);break;case"c":ui.apply(this,Oe);break;case"h":oo()}}return this},m.__private__.rect=m.rect=function(S,G,Se,Oe,Ye){if(isNaN(S)||isNaN(G)||isNaN(Se)||isNaN(Oe)||!Si(Ye))throw new Error("Invalid arguments passed to jsPDF.rect");return F===O.COMPAT&&(Oe=-Oe),we([B(D(S)),B(ue(G)),B(D(Se)),B(D(Oe)),"re"].join(" ")),lo(Ye),this},m.__private__.triangle=m.triangle=function(S,G,Se,Oe,Ye,dt,Nt){if(isNaN(S)||isNaN(G)||isNaN(Se)||isNaN(Oe)||isNaN(Ye)||isNaN(dt)||!Si(Nt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Se-S,Oe-G],[Ye-Se,dt-Oe],[S-Ye,G-dt]],S,G,[1,1],Nt,!0),this},m.__private__.roundedRect=m.roundedRect=function(S,G,Se,Oe,Ye,dt,Nt){if(isNaN(S)||isNaN(G)||isNaN(Se)||isNaN(Oe)||isNaN(Ye)||isNaN(dt)||!Si(Nt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Xt=4/3*(Math.SQRT2-1);return Ye=Math.min(Ye,.5*Se),dt=Math.min(dt,.5*Oe),this.lines([[Se-2*Ye,0],[Ye*Xt,0,Ye,dt-dt*Xt,Ye,dt],[0,Oe-2*dt],[0,dt*Xt,-Ye*Xt,dt,-Ye,dt],[2*Ye-Se,0],[-Ye*Xt,0,-Ye,-dt*Xt,-Ye,-dt],[0,2*dt-Oe],[0,-dt*Xt,Ye*Xt,-dt,Ye,-dt]],S+Ye,G,[1,1],Nt,!0),this},m.__private__.ellipse=m.ellipse=function(S,G,Se,Oe,Ye){if(isNaN(S)||isNaN(G)||isNaN(Se)||isNaN(Oe)||!Si(Ye))throw new Error("Invalid arguments passed to jsPDF.ellipse");var dt=4/3*(Math.SQRT2-1)*Se,Nt=4/3*(Math.SQRT2-1)*Oe;return rs(S+Se,G),ui(S+Se,G-Nt,S+dt,G-Oe,S,G-Oe),ui(S-dt,G-Oe,S-Se,G-Nt,S-Se,G),ui(S-Se,G+Nt,S-dt,G+Oe,S,G+Oe),ui(S+dt,G+Oe,S+Se,G+Nt,S+Se,G),lo(Ye),this},m.__private__.circle=m.circle=function(S,G,Se,Oe){if(isNaN(S)||isNaN(G)||isNaN(Se)||!Si(Oe))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(S,G,Se,Se,Oe)},m.setFont=function(S,G,Se){return Se&&(G=re(G,Se)),$t=Po(S,G,{disableWarning:!1}),this};var bs=m.__private__.getFont=m.getFont=function(){return Ur[Po.apply(m,arguments)]};m.__private__.getFontList=m.getFontList=function(){var S,G,Se={};for(S in Ut)if(Ut.hasOwnProperty(S))for(G in Se[S]=[],Ut[S])Ut[S].hasOwnProperty(G)&&Se[S].push(G);return Se},m.addFont=function(S,G,Se,Oe,Ye){var dt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&dt.indexOf(arguments[3])!==-1?Ye=arguments[3]:arguments[3]&&dt.indexOf(arguments[3])==-1&&(Se=re(Se,Oe)),Ye=Ye||"Identity-H",_i.call(this,S,G,Se,Ye)};var Oo,zl=e.lineWidth||.200025,ns=m.__private__.getLineWidth=m.getLineWidth=function(){return zl},_s=m.__private__.setLineWidth=m.setLineWidth=function(S){return zl=S,we(B(D(S))+" w"),this};m.__private__.setLineDash=Tr.API.setLineDash=Tr.API.setLineDashPattern=function(S,G){if(S=S||[],G=G||0,isNaN(G)||!Array.isArray(S))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return S=S.map(function(Se){return B(D(Se))}).join(" "),G=B(D(G)),we("["+S+"] "+G+" d"),this};var co=m.__private__.getLineHeight=m.getLineHeight=function(){return _t*Oo};m.__private__.getLineHeight=m.getLineHeight=function(){return _t*Oo};var ql=m.__private__.setLineHeightFactor=m.setLineHeightFactor=function(S){return typeof(S=S||1.15)=="number"&&(Oo=S),this},as=m.__private__.getLineHeightFactor=m.getLineHeightFactor=function(){return Oo};ql(e.lineHeight);var Ni=m.__private__.getHorizontalCoordinate=function(S){return D(S)},Ja=m.__private__.getVerticalCoordinate=function(S){return F===O.ADVANCED?S:ar[M].mediaBox.topRightY-ar[M].mediaBox.bottomLeftY-D(S)},gl=m.__private__.getHorizontalCoordinateString=m.getHorizontalCoordinateString=function(S){return B(Ni(S))},Ti=m.__private__.getVerticalCoordinateString=m.getVerticalCoordinateString=function(S){return B(Ja(S))},ma=e.strokeColor||"0 G";m.__private__.getStrokeColor=m.getDrawColor=function(){return _e(ma)},m.__private__.setStrokeColor=m.setDrawColor=function(S,G,Se,Oe){return ma=ke({ch1:S,ch2:G,ch3:Se,ch4:Oe,pdfColorType:"draw",precision:2}),we(ma),this};var Bs=e.fillColor||"0 g";m.__private__.getFillColor=m.getFillColor=function(){return _e(Bs)},m.__private__.setFillColor=m.setFillColor=function(S,G,Se,Oe){return Bs=ke({ch1:S,ch2:G,ch3:Se,ch4:Oe,pdfColorType:"fill",precision:2}),we(Bs),this};var qn=e.textColor||"0 g",Us=m.__private__.getTextColor=m.getTextColor=function(){return _e(qn)};m.__private__.setTextColor=m.setTextColor=function(S,G,Se,Oe){return qn=ke({ch1:S,ch2:G,ch3:Se,ch4:Oe,pdfColorType:"text",precision:3}),this};var uo=e.charSpace,ks=m.__private__.getCharSpace=m.getCharSpace=function(){return parseFloat(uo||0)};m.__private__.setCharSpace=m.setCharSpace=function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return uo=S,this};var Io=0;m.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},m.__private__.setLineCap=m.setLineCap=function(S){var G=m.CapJoinStyles[S];if(G===void 0)throw new Error("Line cap style of '"+S+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Io=G,we(G+" J"),this};var zs=0;m.__private__.setLineJoin=m.setLineJoin=function(S){var G=m.CapJoinStyles[S];if(G===void 0)throw new Error("Line join style of '"+S+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return zs=G,we(G+" j"),this},m.__private__.setLineMiterLimit=m.__private__.setMiterLimit=m.setLineMiterLimit=m.setMiterLimit=function(S){if(S=S||0,isNaN(S))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return we(B(D(S))+" M"),this},m.GState=Dd,m.setGState=function(S){(S=typeof S=="string"?At[Bn[S]]:fo(null,S)).equals(Xr)||(we("/"+S.id+" gs"),Xr=S)};var fo=function(S,G){if(!S||!Bn[S]){var Se=!1;for(var Oe in At)if(At.hasOwnProperty(Oe)&&At[Oe].equals(G)){Se=!0;break}if(Se)G=At[Oe];else{var Ye="GS"+(Object.keys(At).length+1).toString(10);At[Ye]=G,G.id=Ye}return S&&(Bn[S]=G.id),Or.publish("addGState",G),G}};m.addGState=function(S,G){return fo(S,G),this},m.saveGraphicsState=function(){return we("q"),Zn.push({key:$t,size:_t,color:qn}),this},m.restoreGraphicsState=function(){we("Q");var S=Zn.pop();return $t=S.key,_t=S.size,qn=S.color,Xr=null,this},m.setCurrentTransformationMatrix=function(S){return we(S.toString()+" cm"),this},m.comment=function(S){return we("#"+S),this};var Ci=function(S,G){var Se=S||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Se},set:function(dt){isNaN(dt)||(Se=parseFloat(dt))}});var Oe=G||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Oe},set:function(dt){isNaN(dt)||(Oe=parseFloat(dt))}});var Ye="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ye},set:function(dt){Ye=dt.toString()}}),this},On=function(S,G,Se,Oe){Ci.call(this,S,G),this.type="rect";var Ye=Se||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ye},set:function(Nt){isNaN(Nt)||(Ye=parseFloat(Nt))}});var dt=Oe||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return dt},set:function(Nt){isNaN(Nt)||(dt=parseFloat(Nt))}}),this},Ss=function(){this.page=Fr,this.currentPage=M,this.pages=ct.slice(0),this.pagesContext=ar.slice(0),this.x=Vr,this.y=ur,this.matrix=Tn,this.width=Es(M),this.height=is(M),this.outputDestination=bt,this.id="",this.objectNumber=-1};Ss.prototype.restore=function(){Fr=this.page,M=this.currentPage,ar=this.pagesContext,ct=this.pages,Vr=this.x,ur=this.y,Tn=this.matrix,ml(M,this.width),Ro(M,this.height),bt=this.outputDestination};var ho=function(S,G,Se,Oe,Ye){Sn.push(new Ss),Fr=M=0,ct=[],Vr=S,ur=G,Tn=Ye,ws([Se,Oe])},gc=function(S){if(ln[S])Sn.pop().restore();else{var G=new Ss,Se="Xo"+(Object.keys(Jr).length+1).toString(10);G.id=Se,ln[S]=Se,Jr[Se]=G,Or.publish("addFormObject",G),Sn.pop().restore()}};for(var qs in m.beginFormObject=function(S,G,Se,Oe,Ye){return ho(S,G,Se,Oe,Ye),this},m.endFormObject=function(S){return gc(S),this},m.doFormObject=function(S,G){var Se=Jr[ln[S]];return we("q"),we(G.toString()+" cm"),we("/"+Se.id+" Do"),we("Q"),this},m.getFormObject=function(S){var G=Jr[ln[S]];return{x:G.x,y:G.y,width:G.width,height:G.height,matrix:G.matrix}},m.save=function(S,G){return S=S||"generated.pdf",(G=G||{}).returnPromise=G.returnPromise||!1,G.returnPromise===!1?(vu(ki(zn()),S),typeof vu.unload=="function"&&Pr.setTimeout&&setTimeout(vu.unload,911),this):new Promise(function(Se,Oe){try{var Ye=vu(ki(zn()),S);typeof vu.unload=="function"&&Pr.setTimeout&&setTimeout(vu.unload,911),Se(Ye)}catch(dt){Oe(dt.message)}})},Tr.API)Tr.API.hasOwnProperty(qs)&&(qs==="events"&&Tr.API.events.length?function(S,G){var Se,Oe,Ye;for(Ye=G.length-1;Ye!==-1;Ye--)Se=G[Ye][0],Oe=G[Ye][1],S.subscribe.apply(S,[Se].concat(typeof Oe=="function"?[Oe]:Oe))}(Or,Tr.API.events):m[qs]=Tr.API[qs]);var Es=m.getPageWidth=function(S){return(ar[S=S||M].mediaBox.topRightX-ar[S].mediaBox.bottomLeftX)/wt},ml=m.setPageWidth=function(S,G){ar[S].mediaBox.topRightX=G*wt+ar[S].mediaBox.bottomLeftX},is=m.getPageHeight=function(S){return(ar[S=S||M].mediaBox.topRightY-ar[S].mediaBox.bottomLeftY)/wt},Ro=m.setPageHeight=function(S,G){ar[S].mediaBox.topRightY=G*wt+ar[S].mediaBox.bottomLeftY};return m.internal={pdfEscape:Pa,getStyle:Ei,getFont:bs,getFontSize:Bt,getCharSpace:ks,getTextColor:Us,getLineHeight:co,getLineHeightFactor:as,getLineWidth:ns,write:mt,getHorizontalCoordinate:Ni,getVerticalCoordinate:Ja,getCoordinateString:gl,getVerticalCoordinateString:Ti,collections:{},newObject:nn,newAdditionalObject:be,newObjectDeferred:Qr,newObjectDeferredBegin:X,getFilters:Qe,putStream:ut,events:Or,scaleFactor:wt,pageSize:{getWidth:function(){return Es(M)},setWidth:function(S){ml(M,S)},getHeight:function(){return is(M)},setHeight:function(S){Ro(M,S)}},encryptionOptions:h,encryption:Cn,getEncryptor:es,output:Zi,getNumberOfPages:Co,pages:ct,out:we,f2:ye,f3:U,getPageInfo:gn,getPageInfoByObjId:fr,getCurrentPageInfo:ts,getPDFVersion:b,Point:Ci,Rectangle:On,Matrix:Gt,hasHotfix:Ya},Object.defineProperty(m.internal.pageSize,"width",{get:function(){return Es(M)},set:function(S){ml(M,S)},enumerable:!0,configurable:!0}),Object.defineProperty(m.internal.pageSize,"height",{get:function(){return is(M)},set:function(S){Ro(M,S)},enumerable:!0,configurable:!0}),Qi.call(m,xt),$t="F1",hl(a,r),Or.publish("initialized"),m}gf.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},gf.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},gf.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},gf.prototype.processOwnerPassword=function(e,t){return fg(ug(t).substr(0,5),e)},gf.prototype.encryptor=function(e,t){var r=ug(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return fg(r,n)}},Dd.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||Nn(e)!==Nn(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},Tr.API={events:[]},Tr.version="3.0.1";var fa=Tr.API,sm=1,Fu=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},sf=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},zr=function(e){return e.toFixed(2)},Rc=function(e){return e.toFixed(5)};fa.__acroform__={};var js=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},k2=function(e){return e*sm},Cl=function(e){var t=new dw,r=or.internal.getHeight(e)||0,n=or.internal.getWidth(e)||0;return t.BBox=[0,0,Number(zr(n)),Number(zr(r))],t},Tk=fa.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<t},Ck=fa.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<t)},Pk=fa.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return(e&1<<t)==0?0:1},Aa=fa.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Pk(e,t-1)},Na=fa.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return Tk(e,t-1)},Ta=fa.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Ck(e,t-1)},Lk=fa.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,a=e[0],i=e[1],o=e[2],l=e[3],u={};return u.lowerLeft_X=r(a)||0,u.lowerLeft_Y=n(i+l)||0,u.upperRight_X=r(a+o)||0,u.upperRight_Y=n(i)||0,[Number(zr(u.lowerLeft_X)),Number(zr(u.lowerLeft_Y)),Number(zr(u.upperRight_X)),Number(zr(u.upperRight_Y))]},Fk=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=hg(e,r),a=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+a+" "+zr(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var i=Cl(e);return i.scope=e.scope,i.stream=t.join(`
`),i}},hg=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},a=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");a=e.multiline?a.map(function(U){return U.split(`
`)}):a.map(function(U){return[U]});var i=r,o=or.internal.getHeight(e)||0;o=o<0?-o:o;var l=or.internal.getWidth(e)||0;l=l<0?-l:l;var u=function(U,D,le){if(U+1<a.length){var ue=D+" "+a[U+1][0];return nd(ue,e,le).width<=l-4}return!1};i++;e:for(;i>0;){t="",i--;var f,h,g=nd("3",e,i).height,x=e.multiline?o-i:(o-g)/2,m=x+=2,k=0,b=0,E=0;if(i<=0){t=`(...) Tj
`,t+="% Width of Text: "+nd(t,e,i=12).width+", FieldWidth:"+l+`
`;break}for(var N="",O=0,F=0;F<a.length;F++)if(a.hasOwnProperty(F)){var K=!1;if(a[F].length!==1&&E!==a[F].length-1){if((g+2)*(O+2)+2>o)continue e;N+=a[F][E],K=!0,b=F,F--}else{N=(N+=a[F][E]+" ").substr(N.length-1)==" "?N.substr(0,N.length-1):N;var te=parseInt(F),re=u(te,N,i),B=F>=a.length-1;if(re&&!B){N+=" ",E=0;continue}if(re||B){if(B)b=te;else if(e.multiline&&(g+2)*(O+2)+2>o)continue e}else{if(!e.multiline||(g+2)*(O+2)+2>o)continue e;b=te}}for(var V="",Y=k;Y<=b;Y++){var ye=a[Y];if(e.multiline){if(Y===b){V+=ye[E]+" ",E=(E+1)%ye.length;continue}if(Y===k){V+=ye[ye.length-1]+" ";continue}}V+=ye[0]+" "}switch(V=V.substr(V.length-1)==" "?V.substr(0,V.length-1):V,h=nd(V,e,i).width,e.textAlign){case"right":f=l-h-2;break;case"center":f=(l-h)/2;break;case"left":default:f=2}t+=zr(f)+" "+zr(m)+` Td
`,t+="("+Fu(V)+`) Tj
`,t+=-zr(f)+` 0 Td
`,m=-(i+2),h=0,k=K?b:b+1,O++,N=""}break}return n.text=t,n.fontSize=i,n},nd=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),a=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:a}},Ok={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Ik=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},Rk=function(e,t){for(var r in e)if(e.hasOwnProperty(r)){var n=r,a=e[r];t.internal.newObjectDeferredBegin(a.objId,!0),Nn(a)==="object"&&typeof a.putStream=="function"&&a.putStream(),delete e[n]}},Dk=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(ul.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(Ok)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");sm=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new pw,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in n)if(n.hasOwnProperty(a)){var i=n[a];i.objId=void 0,i.hasAnnotation&&Ik(i,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,a){var i=!n;for(var o in n||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var l=n[o],u=[],f=l.Rect;if(l.Rect&&(l.Rect=Lk(l.Rect,a)),a.internal.newObjectDeferredBegin(l.objId,!0),l.DA=or.createDefaultAppearanceStream(l),Nn(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(u=l.getKeyValueListForStream()),l.Rect=f,l.hasAppearanceStream&&!l.appearanceStreamContent){var h=Fk(l);u.push({key:"AP",value:"<</N "+h+">>"}),a.internal.acroformPlugin.xForms.push(h)}if(l.appearanceStreamContent){var g="";for(var x in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(x)){var m=l.appearanceStreamContent[x];if(g+="/"+x+" ",g+="<<",Object.keys(m).length>=1||Array.isArray(m)){for(var o in m)if(m.hasOwnProperty(o)){var k=m[o];typeof k=="function"&&(k=k.call(a,l)),g+="/"+o+" "+k+" ",a.internal.acroformPlugin.xForms.indexOf(k)>=0||a.internal.acroformPlugin.xForms.push(k)}}else typeof(k=m)=="function"&&(k=k.call(a,l)),g+="/"+o+" "+k,a.internal.acroformPlugin.xForms.indexOf(k)>=0||a.internal.acroformPlugin.xForms.push(k);g+=">>"}u.push({key:"AP",value:`<<
`+g+">>"})}a.internal.putStream({additionalKeyValues:u,objectId:l.objId}),a.internal.out("endobj")}i&&Rk(a.internal.acroformPlugin.xForms,a)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},hw=fa.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(o){return o};if(Array.isArray(e)){for(var a="[",i=0;i<e.length;i++)switch(i!==0&&(a+=" "),Nn(e[i])){case"boolean":case"number":case"object":a+=e[i].toString();break;case"string":e[i].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),a+="("+Fu(n(e[i].toString()))+")"):a+=e[i].toString()}return a+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},N1=function(e,t,r){var n=function(a){return a};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),e="("+Fu(n(e))+")"},Ll=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Ll.prototype.toString=function(){return this.objId+" 0 R"},Ll.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Ll.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],a=this[n];a&&(Array.isArray(a)?e.push({key:n,value:hw(a,this.objId,this.scope)}):a instanceof Ll?(a.scope=this.scope,e.push({key:n,value:a.objId+" 0 R"})):typeof a!="function"&&e.push({key:n,value:a}))}return e};var dw=function(){Ll.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};js(dw,Ll);var pw=function(){Ll.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Fu(r(e))+")"}},set:function(r){e=r}})};js(pw,Ll);var ul=function e(){Ll.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(N){if(isNaN(N))throw new Error('Invalid value "'+N+'" for attribute F supplied.');t=N}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Aa(t,3)},set:function(N){N?this.F=Na(t,3):this.F=Ta(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(N){if(isNaN(N))throw new Error('Invalid value "'+N+'" for attribute Ff supplied.');r=N}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(N){n=N!==void 0?N:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(N){n[0]=N}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(N){n[1]=N}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(N){n[2]=N}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(N){n[3]=N}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(N){switch(N){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=N;break;default:throw new Error('Invalid value "'+N+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof jd)return;i="FieldObject"+e.FieldNum++}var N=function(O){return O};return this.scope&&(N=this.scope.internal.getEncryptor(this.objId)),"("+Fu(N(i))+")"},set:function(N){i=N.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(N){i=N}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(N){o=N}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(N){l=N}});var u=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return u},set:function(N){u=N}});var f=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return f===void 0?50/sm:f},set:function(N){f=N}});var h="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return h},set:function(N){h=N}});var g="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!g||this instanceof jd||this instanceof Eu))return N1(g,this.objId,this.scope)},set:function(N){N=N.toString(),g=N}});var x=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(x)return this instanceof si?x:N1(x,this.objId,this.scope)},set:function(N){N=N.toString(),x=this instanceof si?N:N.substr(0,1)==="("?sf(N.substr(1,N.length-2)):sf(N)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof si?sf(x.substr(1,x.length-1)):x},set:function(N){N=N.toString(),x=this instanceof si?"/"+N:N}});var m=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(m)return m},set:function(N){this.V=N}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof si?m:N1(m,this.objId,this.scope)},set:function(N){N=N.toString(),m=this instanceof si?N:N.substr(0,1)==="("?sf(N.substr(1,N.length-2)):sf(N)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof si?sf(m.substr(1,m.length-1)):m},set:function(N){N=N.toString(),m=this instanceof si?"/"+N:N}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var k,b=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return b},set:function(N){N=!!N,b=N}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(k)return k},set:function(N){k=N}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Aa(this.Ff,1)},set:function(N){N?this.Ff=Na(this.Ff,1):this.Ff=Ta(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Aa(this.Ff,2)},set:function(N){N?this.Ff=Na(this.Ff,2):this.Ff=Ta(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Aa(this.Ff,3)},set:function(N){N?this.Ff=Na(this.Ff,3):this.Ff=Ta(this.Ff,3)}});var E=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(E!==null)return E},set:function(N){if([0,1,2].indexOf(N)===-1)throw new Error('Invalid value "'+N+'" for attribute Q supplied.');E=N}}),Object.defineProperty(this,"textAlign",{get:function(){var N;switch(E){case 0:default:N="left";break;case 1:N="center";break;case 2:N="right"}return N},configurable:!0,enumerable:!0,set:function(N){switch(N){case"right":case 2:E=2;break;case"center":case 1:E=1;break;case"left":case 0:default:E=0}}})};js(ul,Ll);var Af=function(){ul.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return hw(t,this.objId,this.scope)},set:function(r){var n,a;a=[],typeof(n=r)=="string"&&(a=function(i,o,l){l||(l=1);for(var u,f=[];u=o.exec(i);)f.push(u[l]);return f}(n,/\((.*?)\)/g)),t=a}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Aa(this.Ff,18)},set:function(r){r?this.Ff=Na(this.Ff,18):this.Ff=Ta(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Aa(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Na(this.Ff,19):this.Ff=Ta(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Aa(this.Ff,20)},set:function(r){r?(this.Ff=Na(this.Ff,20),t.sort()):this.Ff=Ta(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Aa(this.Ff,22)},set:function(r){r?this.Ff=Na(this.Ff,22):this.Ff=Ta(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Aa(this.Ff,23)},set:function(r){r?this.Ff=Na(this.Ff,23):this.Ff=Ta(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Aa(this.Ff,27)},set:function(r){r?this.Ff=Na(this.Ff,27):this.Ff=Ta(this.Ff,27)}}),this.hasAppearanceStream=!1};js(Af,ul);var Nf=function(){Af.call(this),this.fontName="helvetica",this.combo=!1};js(Nf,Af);var Tf=function(){Nf.call(this),this.combo=!0};js(Tf,Nf);var Sd=function(){Tf.call(this),this.edit=!0};js(Sd,Tf);var si=function(){ul.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Aa(this.Ff,15)},set:function(r){r?this.Ff=Na(this.Ff,15):this.Ff=Ta(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Aa(this.Ff,16)},set:function(r){r?this.Ff=Na(this.Ff,16):this.Ff=Ta(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Aa(this.Ff,17)},set:function(r){r?this.Ff=Na(this.Ff,17):this.Ff=Ta(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Aa(this.Ff,26)},set:function(r){r?this.Ff=Na(this.Ff,26):this.Ff=Ta(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(i){return i};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,a=[];for(n in a.push("<<"),t)a.push("/"+n+" ("+Fu(r(t[n]))+")");return a.push(">>"),a.join(`
`)}},set:function(r){Nn(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};js(si,ul);var Ed=function(){si.call(this),this.pushButton=!0};js(Ed,si);var Cf=function(){si.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};js(Cf,si);var jd=function(){var e,t;ul.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(a){e=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(a){t=a}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(l){return l};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var i,o=[];for(i in o.push("<<"),n)o.push("/"+i+" ("+Fu(a(n[i]))+")");return o.push(">>"),o.join(`
`)},set:function(a){Nn(a)==="object"&&(n=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(a){typeof a=="string"&&(n.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(a){r=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(a){r="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=or.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};js(jd,ul),Cf.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},Cf.prototype.createOption=function(e){var t=new jd;return t.Parent=this,t.optionName=e,this.Kids.push(t),jk.call(this.scope,t),t};var Ad=function(){si.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=or.CheckBox.createAppearanceStream()};js(Ad,si);var Eu=function(){ul.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Aa(this.Ff,13)},set:function(t){t?this.Ff=Na(this.Ff,13):this.Ff=Ta(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Aa(this.Ff,21)},set:function(t){t?this.Ff=Na(this.Ff,21):this.Ff=Ta(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Aa(this.Ff,23)},set:function(t){t?this.Ff=Na(this.Ff,23):this.Ff=Ta(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Aa(this.Ff,24)},set:function(t){t?this.Ff=Na(this.Ff,24):this.Ff=Ta(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Aa(this.Ff,25)},set:function(t){t?this.Ff=Na(this.Ff,25):this.Ff=Ta(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Aa(this.Ff,26)},set:function(t){t?this.Ff=Na(this.Ff,26):this.Ff=Ta(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};js(Eu,ul);var Nd=function(){Eu.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Aa(this.Ff,14)},set:function(e){e?this.Ff=Na(this.Ff,14):this.Ff=Ta(this.Ff,14)}}),this.password=!0};js(Nd,Eu);var or={CheckBox:{createAppearanceStream:function(){return{N:{On:or.CheckBox.YesNormal},D:{On:or.CheckBox.YesPushDown,Off:or.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=Cl(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),i=hg(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+zr(or.internal.getWidth(e))+" "+zr(or.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+zr(i.fontSize)+" Tf "+a),r.push("BT"),r.push(i.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=Cl(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),a=[],i=or.internal.getHeight(e),o=or.internal.getWidth(e),l=hg(e,e.caption);return a.push("1 g"),a.push("0 0 "+zr(o)+" "+zr(i)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+zr(o-1)+" "+zr(i-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+r+" "+zr(l.fontSize)+" Tf "+n),a.push(l.text),a.push("ET"),a.push("Q"),t.stream=a.join(`
`),t},OffPushDown:function(e){var t=Cl(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+zr(or.internal.getWidth(e))+" "+zr(or.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:or.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=or.RadioButton.Circle.YesNormal,t.D[e]=or.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=Cl(e);t.scope=e.scope;var r=[],n=or.internal.getWidth(e)<=or.internal.getHeight(e)?or.internal.getWidth(e)/4:or.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=or.internal.Bezier_C,i=Number((n*a).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Rc(or.internal.getWidth(e)/2)+" "+Rc(or.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Cl(e);t.scope=e.scope;var r=[],n=or.internal.getWidth(e)<=or.internal.getHeight(e)?or.internal.getWidth(e)/4:or.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*or.internal.Bezier_C).toFixed(5)),o=Number((n*or.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Rc(or.internal.getWidth(e)/2)+" "+Rc(or.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Rc(or.internal.getWidth(e)/2)+" "+Rc(or.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=Cl(e);t.scope=e.scope;var r=[],n=or.internal.getWidth(e)<=or.internal.getHeight(e)?or.internal.getWidth(e)/4:or.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*or.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Rc(or.internal.getWidth(e)/2)+" "+Rc(or.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:or.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=or.RadioButton.Cross.YesNormal,t.D[e]=or.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=Cl(e);t.scope=e.scope;var r=[],n=or.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+zr(or.internal.getWidth(e)-2)+" "+zr(or.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(zr(n.x1.x)+" "+zr(n.x1.y)+" m"),r.push(zr(n.x2.x)+" "+zr(n.x2.y)+" l"),r.push(zr(n.x4.x)+" "+zr(n.x4.y)+" m"),r.push(zr(n.x3.x)+" "+zr(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Cl(e);t.scope=e.scope;var r=or.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+zr(or.internal.getWidth(e))+" "+zr(or.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+zr(or.internal.getWidth(e)-2)+" "+zr(or.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(zr(r.x1.x)+" "+zr(r.x1.y)+" m"),n.push(zr(r.x2.x)+" "+zr(r.x2.y)+" l"),n.push(zr(r.x4.x)+" "+zr(r.x4.y)+" m"),n.push(zr(r.x3.x)+" "+zr(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=Cl(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+zr(or.internal.getWidth(e))+" "+zr(or.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};or.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=or.internal.getWidth(e),r=or.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},or.internal.getWidth=function(e){var t=0;return Nn(e)==="object"&&(t=k2(e.Rect[2])),t},or.internal.getHeight=function(e){var t=0;return Nn(e)==="object"&&(t=k2(e.Rect[3])),t};var jk=fa.addField=function(e){if(Dk(this,e),!(e instanceof ul))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};fa.AcroFormChoiceField=Af,fa.AcroFormListBox=Nf,fa.AcroFormComboBox=Tf,fa.AcroFormEditBox=Sd,fa.AcroFormButton=si,fa.AcroFormPushButton=Ed,fa.AcroFormRadioButton=Cf,fa.AcroFormCheckBox=Ad,fa.AcroFormTextField=Eu,fa.AcroFormPasswordField=Nd,fa.AcroFormAppearance=or,fa.AcroForm={ChoiceField:Af,ListBox:Nf,ComboBox:Tf,EditBox:Sd,Button:si,PushButton:Ed,RadioButton:Cf,CheckBox:Ad,TextField:Eu,PasswordField:Nd,Appearance:or},Tr.AcroForm={ChoiceField:Af,ListBox:Nf,ComboBox:Tf,EditBox:Sd,Button:si,PushButton:Ed,RadioButton:Cf,CheckBox:Ad,TextField:Eu,PasswordField:Nd,Appearance:or};Tr.AcroForm;function gw(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){e.__addimage__={};var t="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=e.__addimage__.getImageFileTypeByImageData=function(U,D){var le,ue,Te,Fe,Le,me=t;if((D=D||t)==="RGBA"||U.data!==void 0&&U.data instanceof Uint8ClampedArray&&"height"in U&&"width"in U)return"RGBA";if(re(U))for(Le in r)for(Te=r[Le],le=0;le<Te.length;le+=1){for(Fe=!0,ue=0;ue<Te[le].length;ue+=1)if(Te[le][ue]!==void 0&&Te[le][ue]!==U[ue]){Fe=!1;break}if(Fe===!0){me=Le;break}}else for(Le in r)for(Te=r[Le],le=0;le<Te.length;le+=1){for(Fe=!0,ue=0;ue<Te[le].length;ue+=1)if(Te[le][ue]!==void 0&&Te[le][ue]!==U.charCodeAt(ue)){Fe=!1;break}if(Fe===!0){me=Le;break}}return me===t&&D!==t&&(me=D),me},a=function U(D){for(var le=this.internal.write,ue=this.internal.putStream,Te=(0,this.internal.getFilters)();Te.indexOf("FlateEncode")!==-1;)Te.splice(Te.indexOf("FlateEncode"),1);D.objectId=this.internal.newObject();var Fe=[];if(Fe.push({key:"Type",value:"/XObject"}),Fe.push({key:"Subtype",value:"/Image"}),Fe.push({key:"Width",value:D.width}),Fe.push({key:"Height",value:D.height}),D.colorSpace===E.INDEXED?Fe.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(D.palette.length/3-1)+" "+("sMask"in D&&D.sMask!==void 0?D.objectId+2:D.objectId+1)+" 0 R]"}):(Fe.push({key:"ColorSpace",value:"/"+D.colorSpace}),D.colorSpace===E.DEVICE_CMYK&&Fe.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),Fe.push({key:"BitsPerComponent",value:D.bitsPerComponent}),"decodeParameters"in D&&D.decodeParameters!==void 0&&Fe.push({key:"DecodeParms",value:"<<"+D.decodeParameters+">>"}),"transparency"in D&&Array.isArray(D.transparency)){for(var Le="",me=0,ne=D.transparency.length;me<ne;me++)Le+=D.transparency[me]+" "+D.transparency[me]+" ";Fe.push({key:"Mask",value:"["+Le+"]"})}D.sMask!==void 0&&Fe.push({key:"SMask",value:D.objectId+1+" 0 R"});var Ee=D.filter!==void 0?["/"+D.filter]:void 0;if(ue({data:D.data,additionalKeyValues:Fe,alreadyAppliedFilters:Ee,objectId:D.objectId}),le("endobj"),"sMask"in D&&D.sMask!==void 0){var pe="/Predictor "+D.predictor+" /Colors 1 /BitsPerComponent "+D.bitsPerComponent+" /Columns "+D.width,C={width:D.width,height:D.height,colorSpace:"DeviceGray",bitsPerComponent:D.bitsPerComponent,decodeParameters:pe,data:D.sMask};"filter"in D&&(C.filter=D.filter),U.call(this,C)}if(D.colorSpace===E.INDEXED){var M=this.internal.newObject();ue({data:V(new Uint8Array(D.palette)),objectId:M}),le("endobj")}},i=function(){var U=this.internal.collections.addImage_images;for(var D in U)a.call(this,U[D])},o=function(){var U,D=this.internal.collections.addImage_images,le=this.internal.write;for(var ue in D)le("/I"+(U=D[ue]).index,U.objectId,"0","R")},l=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",o))},u=function(){var U=this.internal.collections.addImage_images;return l.call(this),U},f=function(){return Object.keys(this.internal.collections.addImage_images).length},h=function(U){return typeof e["process"+U.toUpperCase()]=="function"},g=function(U){return Nn(U)==="object"&&U.nodeType===1},x=function(U,D){if(U.nodeName==="IMG"&&U.hasAttribute("src")){var le=""+U.getAttribute("src");if(le.indexOf("data:image/")===0)return b0(unescape(le).split("base64,").pop());var ue=e.loadFile(le,!0);if(ue!==void 0)return ue}if(U.nodeName==="CANVAS"){if(U.width===0||U.height===0)throw new Error("Given canvas must have data. Canvas width: "+U.width+", height: "+U.height);var Te;switch(D){case"PNG":Te="image/png";break;case"WEBP":Te="image/webp";break;case"JPEG":case"JPG":default:Te="image/jpeg"}return b0(U.toDataURL(Te,1).split("base64,").pop())}},m=function(U){var D=this.internal.collections.addImage_images;if(D){for(var le in D)if(U===D[le].alias)return D[le]}},k=function(U,D,le){return U||D||(U=-96,D=-96),U<0&&(U=-1*le.width*72/U/this.internal.scaleFactor),D<0&&(D=-1*le.height*72/D/this.internal.scaleFactor),U===0&&(U=D*le.width/le.height),D===0&&(D=U*le.height/le.width),[U,D]},b=function(U,D,le,ue,Te,Fe){var Le=k.call(this,le,ue,Te),me=this.internal.getCoordinateString,ne=this.internal.getVerticalCoordinateString,Ee=u.call(this);if(le=Le[0],ue=Le[1],Ee[Te.index]=Te,Fe){Fe*=Math.PI/180;var pe=Math.cos(Fe),C=Math.sin(Fe),M=function(H){return H.toFixed(4)},z=[M(pe),M(C),M(-1*C),M(pe),0,0,"cm"]}this.internal.write("q"),Fe?(this.internal.write([1,"0","0",1,me(U),ne(D+ue),"cm"].join(" ")),this.internal.write(z.join(" ")),this.internal.write([me(le),"0","0",me(ue),"0","0","cm"].join(" "))):this.internal.write([me(le),"0","0",me(ue),me(U),ne(D+ue),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+Te.index+" Do"),this.internal.write("Q")},E=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var N=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},O=e.__addimage__.sHashCode=function(U){var D,le,ue=0;if(typeof U=="string")for(le=U.length,D=0;D<le;D++)ue=(ue<<5)-ue+U.charCodeAt(D),ue|=0;else if(re(U))for(le=U.byteLength/2,D=0;D<le;D++)ue=(ue<<5)-ue+U[D],ue|=0;return ue},F=e.__addimage__.validateStringAsBase64=function(U){(U=U||"").toString().trim();var D=!0;return U.length===0&&(D=!1),U.length%4!=0&&(D=!1),/^[A-Za-z0-9+/]+$/.test(U.substr(0,U.length-2))===!1&&(D=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(U.substr(-2))===!1&&(D=!1),D},K=e.__addimage__.extractImageFromDataUrl=function(U){if(U==null||!(U=U.trim()).startsWith("data:"))return null;var D=U.indexOf(",");return D<0?null:U.substring(0,D).trim().endsWith("base64")?U.substring(D+1):null},te=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(U){return te()&&U instanceof ArrayBuffer};var re=e.__addimage__.isArrayBufferView=function(U){return te()&&typeof Uint32Array<"u"&&(U instanceof Int8Array||U instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&U instanceof Uint8ClampedArray||U instanceof Int16Array||U instanceof Uint16Array||U instanceof Int32Array||U instanceof Uint32Array||U instanceof Float32Array||U instanceof Float64Array)},B=e.__addimage__.binaryStringToUint8Array=function(U){for(var D=U.length,le=new Uint8Array(D),ue=0;ue<D;ue++)le[ue]=U.charCodeAt(ue);return le},V=e.__addimage__.arrayBufferToBinaryString=function(U){for(var D="",le=re(U)?U:new Uint8Array(U),ue=0;ue<le.length;ue+=8192)D+=String.fromCharCode.apply(null,le.subarray(ue,ue+8192));return D};e.addImage=function(){var U,D,le,ue,Te,Fe,Le,me,ne;if(typeof arguments[1]=="number"?(D=t,le=arguments[1],ue=arguments[2],Te=arguments[3],Fe=arguments[4],Le=arguments[5],me=arguments[6],ne=arguments[7]):(D=arguments[1],le=arguments[2],ue=arguments[3],Te=arguments[4],Fe=arguments[5],Le=arguments[6],me=arguments[7],ne=arguments[8]),Nn(U=arguments[0])==="object"&&!g(U)&&"imageData"in U){var Ee=U;U=Ee.imageData,D=Ee.format||D||t,le=Ee.x||le||0,ue=Ee.y||ue||0,Te=Ee.w||Ee.width||Te,Fe=Ee.h||Ee.height||Fe,Le=Ee.alias||Le,me=Ee.compression||me,ne=Ee.rotation||Ee.angle||ne}var pe=this.internal.getFilters();if(me===void 0&&pe.indexOf("FlateEncode")!==-1&&(me="SLOW"),isNaN(le)||isNaN(ue))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var C=Y.call(this,U,D,Le,me);return b.call(this,le,ue,Te,Fe,C,ne),this};var Y=function(U,D,le,ue){var Te,Fe,Le;if(typeof U=="string"&&n(U)===t){U=unescape(U);var me=ye(U,!1);(me!==""||(me=e.loadFile(U,!0))!==void 0)&&(U=me)}if(g(U)&&(U=x(U,D)),D=n(U,D),!h(D))throw new Error("addImage does not support files of type '"+D+"', please ensure that a plugin for '"+D+"' support is added.");if(((Le=le)==null||Le.length===0)&&(le=function(ne){return typeof ne=="string"||re(ne)?O(ne):re(ne.data)?O(ne.data):null}(U)),(Te=m.call(this,le))||(te()&&(U instanceof Uint8Array||D==="RGBA"||(Fe=U,U=B(U))),Te=this["process"+D.toUpperCase()](U,f.call(this),le,function(ne){return ne&&typeof ne=="string"&&(ne=ne.toUpperCase()),ne in e.image_compression?ne:N.NONE}(ue),Fe)),!Te)throw new Error("An unknown error occurred whilst processing the image.");return Te},ye=e.__addimage__.convertBase64ToBinaryString=function(U,D){D=typeof D!="boolean"||D;var le,ue="";if(typeof U=="string"){var Te;le=(Te=K(U))!==null&&Te!==void 0?Te:U;try{ue=b0(le)}catch(Fe){if(D)throw F(le)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+Fe.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return ue};e.getImageProperties=function(U){var D,le,ue="";if(g(U)&&(U=x(U)),typeof U=="string"&&n(U)===t&&((ue=ye(U,!1))===""&&(ue=e.loadFile(U)||""),U=ue),le=n(U),!h(le))throw new Error("addImage does not support files of type '"+le+"', please ensure that a plugin for '"+le+"' support is added.");if(!te()||U instanceof Uint8Array||(U=B(U)),!(D=this["process"+le.toUpperCase()](U)))throw new Error("An unknown error occurred whilst processing the image");return D.fileType=le,D}})(Tr.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};Tr.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,a,i,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,u=this.internal.getPageInfoByObjId(r.objId),f=r.pageContext.annotations,h=!1,g=0;g<f.length&&!h;g++)switch((n=f[g]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(h=!0);break;case"reference":case"text":case"freetext":h=!0}if(h!=0){this.internal.write("/Annots [");for(var x=0;x<f.length;x++){n=f[x];var m=this.internal.pdfEscape,k=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var b=this.internal.newAdditionalObject(),E=this.internal.newAdditionalObject(),N=this.internal.getEncryptor(b.objId),O=n.title||"Note";i="<</Type /Annot /Subtype /Text "+(a="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+m(N(n.contents))+")",i+=" /Popup "+E.objId+" 0 R",i+=" /P "+u.objId+" 0 R",i+=" /T ("+m(N(O))+") >>",b.content=i;var F=b.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+o(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+F,n.open&&(i+=" /Open true"),i+=" >>",E.content=i,this.internal.write(b.objId,"0 R",E.objId,"0 R");break;case"freetext":a="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var K=n.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+m(k(n.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+K+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(n.options.name){var te=this.annotations._nameMap[n.options.name];n.options.pageNumber=te.page,n.options.top=te.y}else n.options.top||(n.options.top=0);if(a="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",i="",n.options.url)i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+m(k(n.options.url))+") >>";else if(n.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,i+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var re=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),i+=" /XYZ "+n.options.left+" "+re+" "+n.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,a,i,o){var l=this.internal.getCurrentPageInfo(),u=this.internal.getCoordinateString,f=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:u(r),y:f(n),w:u(r+a),h:f(n+i)},options:o,type:"link"})},e.textWithLink=function(r,n,a,i){var o,l,u=this.getTextWidth(r),f=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){l=i.maxWidth;var h=this.splitTextToSize(r,l).length;o=Math.ceil(f*h)}else l=u,o=f;return this.text(r,n,a,i),a+=.2*f,i.align==="center"&&(n-=u/2),i.align==="right"&&(n-=u),this.link(n,a-f,l,o,i),u},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(Tr.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];e.__arabicParser__={};var i=e.__arabicParser__.isInArabicSubstitutionA=function(b){return t[b.charCodeAt(0)]!==void 0},o=e.__arabicParser__.isArabicLetter=function(b){return typeof b=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(b)},l=e.__arabicParser__.isArabicEndLetter=function(b){return o(b)&&i(b)&&t[b.charCodeAt(0)].length<=2},u=e.__arabicParser__.isArabicAlfLetter=function(b){return o(b)&&a.indexOf(b.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(b){return o(b)&&i(b)&&t[b.charCodeAt(0)].length>=1};var f=e.__arabicParser__.arabicLetterHasFinalForm=function(b){return o(b)&&i(b)&&t[b.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(b){return o(b)&&i(b)&&t[b.charCodeAt(0)].length>=3};var h=e.__arabicParser__.arabicLetterHasMedialForm=function(b){return o(b)&&i(b)&&t[b.charCodeAt(0)].length==4},g=e.__arabicParser__.resolveLigatures=function(b){var E=0,N=r,O="",F=0;for(E=0;E<b.length;E+=1)N[b.charCodeAt(E)]!==void 0?(F++,typeof(N=N[b.charCodeAt(E)])=="number"&&(O+=String.fromCharCode(N),N=r,F=0),E===b.length-1&&(N=r,O+=b.charAt(E-(F-1)),E-=F-1,F=0)):(N=r,O+=b.charAt(E-F),E-=F,F=0);return O};e.__arabicParser__.isArabicDiacritic=function(b){return b!==void 0&&n[b.charCodeAt(0)]!==void 0};var x=e.__arabicParser__.getCorrectForm=function(b,E,N){return o(b)?i(b)===!1?-1:!f(b)||!o(E)&&!o(N)||!o(N)&&l(E)||l(b)&&!o(E)||l(b)&&u(E)||l(b)&&l(E)?0:h(b)&&o(E)&&!l(E)&&o(N)&&f(N)?3:l(b)||!o(N)?1:2:-1},m=function(b){var E=0,N=0,O=0,F="",K="",te="",re=(b=b||"").split("\\s+"),B=[];for(E=0;E<re.length;E+=1){for(B.push(""),N=0;N<re[E].length;N+=1)F=re[E][N],K=re[E][N-1],te=re[E][N+1],o(F)?(O=x(F,K,te),B[E]+=O!==-1?String.fromCharCode(t[F.charCodeAt(0)][O]):F):B[E]+=F;B[E]=g(B[E])}return B.join(" ")},k=e.__arabicParser__.processArabic=e.processArabic=function(){var b,E=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,N=[];if(Array.isArray(E)){var O=0;for(N=[],O=0;O<E.length;O+=1)Array.isArray(E[O])?N.push([m(E[O][0]),E[O][1],E[O][2]]):N.push([m(E[O])]);b=N}else b=m(E);return typeof arguments[0]=="string"?b:(arguments[0].text=b,arguments[0])};e.events.push(["preProcessText",k])}(Tr.API),Tr.API.autoPrint=function(e){var t;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(l){a=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(l){i=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var a;if((r=r||"2d")!=="2d")return null;for(a in n)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=n[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Tr.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var u=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return u},set:function(b){u=b}});var f=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return f},set:function(b){f=b}});var h=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return h},set:function(b){h=b}});var g=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return g},set:function(b){g=b}});var x=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return x},set:function(b){x=b}});var m=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return m},set:function(b){m=b}});var k=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return k},set:function(b){k=b}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(u){return n.call(this),this.internal.__cell__.headerFunction=typeof u=="function"?u:void 0,this},e.getTextDimensions=function(u,f){n.call(this);var h=(f=f||{}).fontSize||this.getFontSize(),g=f.font||this.getFont(),x=f.scaleFactor||this.internal.scaleFactor,m=0,k=0,b=0,E=this;if(!Array.isArray(u)&&typeof u!="string"){if(typeof u!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");u=String(u)}var N=f.maxWidth;N>0?typeof u=="string"?u=this.splitTextToSize(u,N):Object.prototype.toString.call(u)==="[object Array]"&&(u=u.reduce(function(F,K){return F.concat(E.splitTextToSize(K,N))},[])):u=Array.isArray(u)?u:[u];for(var O=0;O<u.length;O++)m<(b=this.getStringUnitWidth(u[O],{font:g})*h)&&(m=b);return m!==0&&(k=u.length),{w:m/=x,h:Math.max((k*h*this.getLineHeightFactor()-h*(this.getLineHeightFactor()-1))/x,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var u=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new i(u.left,u.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=e.cell=function(){var u;u=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var f=this.internal.__cell__.lastCell,h=this.internal.__cell__.padding,g=this.internal.__cell__.margins||t,x=this.internal.__cell__.tableHeaderRow,m=this.internal.__cell__.printHeaders;return f.lineNumber!==void 0&&(f.lineNumber===u.lineNumber?(u.x=(f.x||0)+(f.width||0),u.y=f.y||0):f.y+f.height+u.height+g.bottom>this.getPageHeight()?(this.cellAddPage(),u.y=g.top,m&&x&&(this.printHeaderRow(u.lineNumber,!0),u.y+=x[0].height)):u.y=f.y+f.height||u.y),u.text[0]!==void 0&&(this.rect(u.x,u.y,u.width,u.height,r===!0?"FD":void 0),u.align==="right"?this.text(u.text,u.x+u.width-h,u.y+h,{align:"right",baseline:"top"}):u.align==="center"?this.text(u.text,u.x+u.width/2,u.y+h,{align:"center",baseline:"top",maxWidth:u.width-h-h}):this.text(u.text,u.x+h,u.y+h,{align:"left",baseline:"top",maxWidth:u.width-h-h})),this.internal.__cell__.lastCell=u,this};e.table=function(u,f,h,g,x){if(n.call(this),!h)throw new Error("No data for PDF table.");var m,k,b,E,N=[],O=[],F=[],K={},te={},re=[],B=[],V=(x=x||{}).autoSize||!1,Y=x.printHeaders!==!1,ye=x.css&&x.css["font-size"]!==void 0?16*x.css["font-size"]:x.fontSize||12,U=x.margins||Object.assign({width:this.getPageWidth()},t),D=typeof x.padding=="number"?x.padding:3,le=x.headerBackgroundColor||"#c8c8c8",ue=x.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=Y,this.internal.__cell__.margins=U,this.internal.__cell__.table_font_size=ye,this.internal.__cell__.padding=D,this.internal.__cell__.headerBackgroundColor=le,this.internal.__cell__.headerTextColor=ue,this.setFontSize(ye),g==null)O=N=Object.keys(h[0]),F=N.map(function(){return"left"});else if(Array.isArray(g)&&Nn(g[0])==="object")for(N=g.map(function(Ee){return Ee.name}),O=g.map(function(Ee){return Ee.prompt||Ee.name||""}),F=g.map(function(Ee){return Ee.align||"left"}),m=0;m<g.length;m+=1)te[g[m].name]=g[m].width*(19.049976/25.4);else Array.isArray(g)&&typeof g[0]=="string"&&(O=N=g,F=N.map(function(){return"left"}));if(V||Array.isArray(g)&&typeof g[0]=="string")for(m=0;m<N.length;m+=1){for(K[E=N[m]]=h.map(function(Ee){return Ee[E]}),this.setFont(void 0,"bold"),re.push(this.getTextDimensions(O[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),k=K[E],this.setFont(void 0,"normal"),b=0;b<k.length;b+=1)re.push(this.getTextDimensions(k[b],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);te[E]=Math.max.apply(null,re)+D+D,re=[]}if(Y){var Te={};for(m=0;m<N.length;m+=1)Te[N[m]]={},Te[N[m]].text=O[m],Te[N[m]].align=F[m];var Fe=l.call(this,Te,te);B=N.map(function(Ee){return new i(u,f,te[Ee],Fe,Te[Ee].text,void 0,Te[Ee].align)}),this.setTableHeaderRow(B),this.printHeaderRow(1,!1)}var Le=g.reduce(function(Ee,pe){return Ee[pe.name]=pe.align,Ee},{});for(m=0;m<h.length;m+=1){"rowStart"in x&&x.rowStart instanceof Function&&x.rowStart({row:m,data:h[m]},this);var me=l.call(this,h[m],te);for(b=0;b<N.length;b+=1){var ne=h[m][N[b]];"cellStart"in x&&x.cellStart instanceof Function&&x.cellStart({row:m,col:b,data:ne},this),o.call(this,new i(u,f,te[N[b]],me,ne,m+2,Le[N[b]]))}}return this.internal.__cell__.table_x=u,this.internal.__cell__.table_y=f,this};var l=function(u,f){var h=this.internal.__cell__.padding,g=this.internal.__cell__.table_font_size,x=this.internal.scaleFactor;return Object.keys(u).map(function(m){var k=u[m];return this.splitTextToSize(k.hasOwnProperty("text")?k.text:k,f[m]-h-h)},this).map(function(m){return this.getLineHeightFactor()*m.length*g/x+h+h},this).reduce(function(m,k){return Math.max(m,k)},0)};e.setTableHeaderRow=function(u){n.call(this),this.internal.__cell__.tableHeaderRow=u},e.printHeaderRow=function(u,f){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var h;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var g=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(g[0],g[1],g[2],g[3],void 0,-1)}this.setFont(void 0,"bold");for(var x=[],m=0;m<this.internal.__cell__.tableHeaderRow.length;m+=1){h=this.internal.__cell__.tableHeaderRow[m].clone(),f&&(h.y=this.internal.__cell__.margins.top||0,x.push(h)),h.lineNumber=u;var k=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,h),this.setTextColor(k)}x.length>0&&this.setTableHeaderRow(x),this.setFont(void 0,"normal"),r=!1}}(Tr.API);var mw={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},vw=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],dg=gw(vw),xw=[100,200,300,400,500,600,700,800,900],Mk=gw(xw);function pg(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(i){return mw[i=i||"normal"]?i:"normal"}(e.style),n=function(i){if(!i)return 400;if(typeof i=="number")return i>=100&&i<=900&&i%100==0?i:400;if(/^\d00$/.test(i))return parseInt(i);switch(i){case"bold":return 700;case"normal":default:return 400}}(e.weight),a=function(i){return typeof dg[i=i||"normal"]=="number"?i:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:a,src:e.src||[],ref:e.ref||{name:t,style:[a,r,n].join(" ")}}}function S2(e,t,r,n){var a;for(a=r;a>=0&&a<t.length;a+=n)if(e[t[a]])return e[t[a]];for(a=r;a>=0&&a<t.length;a-=n)if(e[t[a]])return e[t[a]]}var Bk={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},E2={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function A2(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function Uk(e,t,r){for(var n=(r=r||{}).defaultFontFamily||"times",a=Object.assign({},Bk,r.genericFontFamilies||{}),i=null,o=null,l=0;l<t.length;++l)if(a[(i=pg(t[l])).family]&&(i.family=a[i.family]),e.hasOwnProperty(i.family)){o=e[i.family];break}if(!(o=o||e[n]))throw new Error("Could not find a font-family for the rule '"+A2(i)+"' and default family '"+n+"'.");if(o=function(u,f){if(f[u])return f[u];var h=dg[u],g=h<=dg.normal?-1:1,x=S2(f,vw,h,g);if(!x)throw new Error("Could not find a matching font-stretch value for "+u);return x}(i.stretch,o),o=function(u,f){if(f[u])return f[u];for(var h=mw[u],g=0;g<h.length;++g)if(f[h[g]])return f[h[g]];throw new Error("Could not find a matching font-style for "+u)}(i.style,o),!(o=function(u,f){if(f[u])return f[u];if(u===400&&f[500])return f[500];if(u===500&&f[400])return f[400];var h=Mk[u],g=S2(f,xw,h,u<400?-1:1);if(!g)throw new Error("Could not find a matching font-weight for value "+u);return g}(i.weight,o)))throw new Error("Failed to resolve a font for the rule '"+A2(i)+"'.");return o}function N2(e){return e.trimLeft()}function zk(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function qk(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var ad,T2,C2,T1=["times"];(function(e){var t,r,n,a,i,o,l,u,f,h=function(C){return C=C||{},this.isStrokeTransparent=C.isStrokeTransparent||!1,this.strokeOpacity=C.strokeOpacity||1,this.strokeStyle=C.strokeStyle||"#000000",this.fillStyle=C.fillStyle||"#000000",this.isFillTransparent=C.isFillTransparent||!1,this.fillOpacity=C.fillOpacity||1,this.font=C.font||"10px sans-serif",this.textBaseline=C.textBaseline||"alphabetic",this.textAlign=C.textAlign||"left",this.lineWidth=C.lineWidth||1,this.lineJoin=C.lineJoin||"miter",this.lineCap=C.lineCap||"butt",this.path=C.path||[],this.transform=C.transform!==void 0?C.transform.clone():new u,this.globalCompositeOperation=C.globalCompositeOperation||"normal",this.globalAlpha=C.globalAlpha||1,this.clip_path=C.clip_path||[],this.currentPoint=C.currentPoint||new o,this.miterLimit=C.miterLimit||10,this.lastPoint=C.lastPoint||new o,this.lineDashOffset=C.lineDashOffset||0,this.lineDash=C.lineDash||[],this.margin=C.margin||[0,0,0,0],this.prevPageLastElemOffset=C.prevPageLastElemOffset||0,this.ignoreClearRect=typeof C.ignoreClearRect!="boolean"||C.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new g(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,u=this.internal.Matrix,f=new h}]);var g=function(C){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var M=C;Object.defineProperty(this,"pdf",{get:function(){return M}});var z=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return z},set:function(Je){z=!!Je}});var H=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return H},set:function(Je){H=!!Je}});var ie=0;Object.defineProperty(this,"posX",{get:function(){return ie},set:function(Je){isNaN(Je)||(ie=Je)}});var xe=0;Object.defineProperty(this,"posY",{get:function(){return xe},set:function(Je){isNaN(Je)||(xe=Je)}}),Object.defineProperty(this,"margin",{get:function(){return f.margin},set:function(Je){var we;typeof Je=="number"?we=[Je,Je,Je,Je]:((we=new Array(4))[0]=Je[0],we[1]=Je.length>=2?Je[1]:we[0],we[2]=Je.length>=3?Je[2]:we[0],we[3]=Je.length>=4?Je[3]:we[1]),f.margin=we}});var Ae=!1;Object.defineProperty(this,"autoPaging",{get:function(){return Ae},set:function(Je){Ae=Je}});var de=0;Object.defineProperty(this,"lastBreak",{get:function(){return de},set:function(Je){de=Je}});var Me=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Me},set:function(Je){Me=Je}}),Object.defineProperty(this,"ctx",{get:function(){return f},set:function(Je){Je instanceof h&&(f=Je)}}),Object.defineProperty(this,"path",{get:function(){return f.path},set:function(Je){f.path=Je}});var ct=[];Object.defineProperty(this,"ctxStack",{get:function(){return ct},set:function(Je){ct=Je}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Je){var we;we=x(Je),this.ctx.fillStyle=we.style,this.ctx.isFillTransparent=we.a===0,this.ctx.fillOpacity=we.a,this.pdf.setFillColor(we.r,we.g,we.b,{a:we.a}),this.pdf.setTextColor(we.r,we.g,we.b,{a:we.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Je){var we=x(Je);this.ctx.strokeStyle=we.style,this.ctx.isStrokeTransparent=we.a===0,this.ctx.strokeOpacity=we.a,we.a===0?this.pdf.setDrawColor(255,255,255):(we.a,this.pdf.setDrawColor(we.r,we.g,we.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Je){["butt","round","square"].indexOf(Je)!==-1&&(this.ctx.lineCap=Je,this.pdf.setLineCap(Je))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Je){isNaN(Je)||(this.ctx.lineWidth=Je,this.pdf.setLineWidth(Je))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Je){["bevel","round","miter"].indexOf(Je)!==-1&&(this.ctx.lineJoin=Je,this.pdf.setLineJoin(Je))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Je){isNaN(Je)||(this.ctx.miterLimit=Je,this.pdf.setMiterLimit(Je))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Je){this.ctx.textBaseline=Je}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Je){["right","end","center","left","start"].indexOf(Je)!==-1&&(this.ctx.textAlign=Je)}});var se=null;function bt(Je,we){if(se===null){var mt=function(qt){var xt=[];return Object.keys(qt).forEach(function(_t){qt[_t].forEach(function(Et){var Bt=null;switch(Et){case"bold":Bt={family:_t,weight:"bold"};break;case"italic":Bt={family:_t,style:"italic"};break;case"bolditalic":Bt={family:_t,weight:"bold",style:"italic"};break;case"":case"normal":Bt={family:_t}}Bt!==null&&(Bt.ref={name:_t,style:Et},xt.push(Bt))})}),xt}(Je.getFontList());se=function(qt){for(var xt={},_t=0;_t<qt.length;++_t){var Et=pg(qt[_t]),Bt=Et.family,Jt=Et.stretch,nr=Et.style,cr=Et.weight;xt[Bt]=xt[Bt]||{},xt[Bt][Jt]=xt[Bt][Jt]||{},xt[Bt][Jt][nr]=xt[Bt][Jt][nr]||{},xt[Bt][Jt][nr][cr]=Et}return xt}(mt.concat(we))}return se}var Dt=null;Object.defineProperty(this,"fontFaces",{get:function(){return Dt},set:function(Je){se=null,Dt=Je}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Je){var we;if(this.ctx.font=Je,(we=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Je))!==null){var mt=we[1];we[2];var qt=we[3],xt=we[4];we[5];var _t=we[6],Et=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(xt)[2];xt=Math.floor(Et==="px"?parseFloat(xt)*this.pdf.internal.scaleFactor:Et==="em"?parseFloat(xt)*this.pdf.getFontSize():parseFloat(xt)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(xt);var Bt=function(Qt){var $t,wt,Vr=[],ur=Qt.trim();if(ur==="")return T1;if(ur in E2)return[E2[ur]];for(;ur!=="";){switch(wt=null,$t=(ur=N2(ur)).charAt(0)){case'"':case"'":wt=zk(ur.substring(1),$t);break;default:wt=qk(ur)}if(wt===null||(Vr.push(wt[0]),(ur=N2(wt[1]))!==""&&ur.charAt(0)!==","))return T1;ur=ur.replace(/^,/,"")}return Vr}(_t);if(this.fontFaces){var Jt=Uk(bt(this.pdf,this.fontFaces),Bt.map(function(Qt){return{family:Qt,stretch:"normal",weight:qt,style:mt}}));this.pdf.setFont(Jt.ref.name,Jt.ref.style)}else{var nr="";(qt==="bold"||parseInt(qt,10)>=700||mt==="bold")&&(nr="bold"),mt==="italic"&&(nr+="italic"),nr.length===0&&(nr="normal");for(var cr="",gr={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},yr=0;yr<Bt.length;yr++){if(this.pdf.internal.getFont(Bt[yr],nr,{noFallback:!0,disableWarning:!0})!==void 0){cr=Bt[yr];break}if(nr==="bolditalic"&&this.pdf.internal.getFont(Bt[yr],"bold",{noFallback:!0,disableWarning:!0})!==void 0)cr=Bt[yr],nr="bold";else if(this.pdf.internal.getFont(Bt[yr],"normal",{noFallback:!0,disableWarning:!0})!==void 0){cr=Bt[yr],nr="normal";break}}if(cr===""){for(var mr=0;mr<Bt.length;mr++)if(gr[Bt[mr]]){cr=gr[Bt[mr]];break}}cr=cr===""?"Times":cr,this.pdf.setFont(cr,nr)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Je){this.ctx.globalCompositeOperation=Je}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Je){this.ctx.globalAlpha=Je}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Je){this.ctx.lineDashOffset=Je,pe.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Je){this.ctx.lineDash=Je,pe.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Je){this.ctx.ignoreClearRect=!!Je}})};g.prototype.setLineDash=function(C){this.lineDash=C},g.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},g.prototype.fill=function(){K.call(this,"fill",!1)},g.prototype.stroke=function(){K.call(this,"stroke",!1)},g.prototype.beginPath=function(){this.path=[{type:"begin"}]},g.prototype.moveTo=function(C,M){if(isNaN(C)||isNaN(M))throw jn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var z=this.ctx.transform.applyToPoint(new o(C,M));this.path.push({type:"mt",x:z.x,y:z.y}),this.ctx.lastPoint=new o(C,M)},g.prototype.closePath=function(){var C=new o(0,0),M=0;for(M=this.path.length-1;M!==-1;M--)if(this.path[M].type==="begin"&&Nn(this.path[M+1])==="object"&&typeof this.path[M+1].x=="number"){C=new o(this.path[M+1].x,this.path[M+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(C.x,C.y)},g.prototype.lineTo=function(C,M){if(isNaN(C)||isNaN(M))throw jn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var z=this.ctx.transform.applyToPoint(new o(C,M));this.path.push({type:"lt",x:z.x,y:z.y}),this.ctx.lastPoint=new o(z.x,z.y)},g.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),K.call(this,null,!0)},g.prototype.quadraticCurveTo=function(C,M,z,H){if(isNaN(z)||isNaN(H)||isNaN(C)||isNaN(M))throw jn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ie=this.ctx.transform.applyToPoint(new o(z,H)),xe=this.ctx.transform.applyToPoint(new o(C,M));this.path.push({type:"qct",x1:xe.x,y1:xe.y,x:ie.x,y:ie.y}),this.ctx.lastPoint=new o(ie.x,ie.y)},g.prototype.bezierCurveTo=function(C,M,z,H,ie,xe){if(isNaN(ie)||isNaN(xe)||isNaN(C)||isNaN(M)||isNaN(z)||isNaN(H))throw jn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var Ae=this.ctx.transform.applyToPoint(new o(ie,xe)),de=this.ctx.transform.applyToPoint(new o(C,M)),Me=this.ctx.transform.applyToPoint(new o(z,H));this.path.push({type:"bct",x1:de.x,y1:de.y,x2:Me.x,y2:Me.y,x:Ae.x,y:Ae.y}),this.ctx.lastPoint=new o(Ae.x,Ae.y)},g.prototype.arc=function(C,M,z,H,ie,xe){if(isNaN(C)||isNaN(M)||isNaN(z)||isNaN(H)||isNaN(ie))throw jn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(xe=!!xe,!this.ctx.transform.isIdentity){var Ae=this.ctx.transform.applyToPoint(new o(C,M));C=Ae.x,M=Ae.y;var de=this.ctx.transform.applyToPoint(new o(0,z)),Me=this.ctx.transform.applyToPoint(new o(0,0));z=Math.sqrt(Math.pow(de.x-Me.x,2)+Math.pow(de.y-Me.y,2))}Math.abs(ie-H)>=2*Math.PI&&(H=0,ie=2*Math.PI),this.path.push({type:"arc",x:C,y:M,radius:z,startAngle:H,endAngle:ie,counterclockwise:xe})},g.prototype.arcTo=function(C,M,z,H,ie){throw new Error("arcTo not implemented.")},g.prototype.rect=function(C,M,z,H){if(isNaN(C)||isNaN(M)||isNaN(z)||isNaN(H))throw jn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(C,M),this.lineTo(C+z,M),this.lineTo(C+z,M+H),this.lineTo(C,M+H),this.lineTo(C,M),this.lineTo(C+z,M),this.lineTo(C,M)},g.prototype.fillRect=function(C,M,z,H){if(isNaN(C)||isNaN(M)||isNaN(z)||isNaN(H))throw jn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!m.call(this)){var ie={};this.lineCap!=="butt"&&(ie.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ie.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(C,M,z,H),this.fill(),ie.hasOwnProperty("lineCap")&&(this.lineCap=ie.lineCap),ie.hasOwnProperty("lineJoin")&&(this.lineJoin=ie.lineJoin)}},g.prototype.strokeRect=function(C,M,z,H){if(isNaN(C)||isNaN(M)||isNaN(z)||isNaN(H))throw jn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");k.call(this)||(this.beginPath(),this.rect(C,M,z,H),this.stroke())},g.prototype.clearRect=function(C,M,z,H){if(isNaN(C)||isNaN(M)||isNaN(z)||isNaN(H))throw jn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(C,M,z,H))},g.prototype.save=function(C){C=typeof C!="boolean"||C;for(var M=this.pdf.internal.getCurrentPageInfo().pageNumber,z=0;z<this.pdf.internal.getNumberOfPages();z++)this.pdf.setPage(z+1),this.pdf.internal.out("q");if(this.pdf.setPage(M),C){this.ctx.fontSize=this.pdf.internal.getFontSize();var H=new h(this.ctx);this.ctxStack.push(this.ctx),this.ctx=H}},g.prototype.restore=function(C){C=typeof C!="boolean"||C;for(var M=this.pdf.internal.getCurrentPageInfo().pageNumber,z=0;z<this.pdf.internal.getNumberOfPages();z++)this.pdf.setPage(z+1),this.pdf.internal.out("Q");this.pdf.setPage(M),C&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},g.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var x=function(C){var M,z,H,ie;if(C.isCanvasGradient===!0&&(C=C.getColor()),!C)return{r:0,g:0,b:0,a:0,style:C};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(C))M=0,z=0,H=0,ie=0;else{var xe=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(C);if(xe!==null)M=parseInt(xe[1]),z=parseInt(xe[2]),H=parseInt(xe[3]),ie=1;else if((xe=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(C))!==null)M=parseInt(xe[1]),z=parseInt(xe[2]),H=parseInt(xe[3]),ie=parseFloat(xe[4]);else{if(ie=1,typeof C=="string"&&C.charAt(0)!=="#"){var Ae=new cw(C);C=Ae.ok?Ae.toHex():"#000000"}C.length===4?(M=C.substring(1,2),M+=M,z=C.substring(2,3),z+=z,H=C.substring(3,4),H+=H):(M=C.substring(1,3),z=C.substring(3,5),H=C.substring(5,7)),M=parseInt(M,16),z=parseInt(z,16),H=parseInt(H,16)}}return{r:M,g:z,b:H,a:ie,style:C}},m=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},k=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};g.prototype.fillText=function(C,M,z,H){if(isNaN(M)||isNaN(z)||typeof C!="string")throw jn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(H=isNaN(H)?void 0:H,!m.call(this)){var ie=me(this.ctx.transform.rotation),xe=this.ctx.transform.scaleX;D.call(this,{text:C,x:M,y:z,scale:xe,angle:ie,align:this.textAlign,maxWidth:H})}},g.prototype.strokeText=function(C,M,z,H){if(isNaN(M)||isNaN(z)||typeof C!="string")throw jn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!k.call(this)){H=isNaN(H)?void 0:H;var ie=me(this.ctx.transform.rotation),xe=this.ctx.transform.scaleX;D.call(this,{text:C,x:M,y:z,scale:xe,renderingMode:"stroke",angle:ie,align:this.textAlign,maxWidth:H})}},g.prototype.measureText=function(C){if(typeof C!="string")throw jn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var M=this.pdf,z=this.pdf.internal.scaleFactor,H=M.internal.getFontSize(),ie=M.getStringUnitWidth(C)*H/M.internal.scaleFactor,xe=function(Ae){var de=(Ae=Ae||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return de}}),this};return new xe({width:ie*=Math.round(96*z/72*1e4)/1e4})},g.prototype.scale=function(C,M){if(isNaN(C)||isNaN(M))throw jn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var z=new u(C,0,0,M,0,0);this.ctx.transform=this.ctx.transform.multiply(z)},g.prototype.rotate=function(C){if(isNaN(C))throw jn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var M=new u(Math.cos(C),Math.sin(C),-Math.sin(C),Math.cos(C),0,0);this.ctx.transform=this.ctx.transform.multiply(M)},g.prototype.translate=function(C,M){if(isNaN(C)||isNaN(M))throw jn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var z=new u(1,0,0,1,C,M);this.ctx.transform=this.ctx.transform.multiply(z)},g.prototype.transform=function(C,M,z,H,ie,xe){if(isNaN(C)||isNaN(M)||isNaN(z)||isNaN(H)||isNaN(ie)||isNaN(xe))throw jn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var Ae=new u(C,M,z,H,ie,xe);this.ctx.transform=this.ctx.transform.multiply(Ae)},g.prototype.setTransform=function(C,M,z,H,ie,xe){C=isNaN(C)?1:C,M=isNaN(M)?0:M,z=isNaN(z)?0:z,H=isNaN(H)?1:H,ie=isNaN(ie)?0:ie,xe=isNaN(xe)?0:xe,this.ctx.transform=new u(C,M,z,H,ie,xe)};var b=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};g.prototype.drawImage=function(C,M,z,H,ie,xe,Ae,de,Me){var ct=this.pdf.getImageProperties(C),se=1,bt=1,Dt=1,Je=1;H!==void 0&&de!==void 0&&(Dt=de/H,Je=Me/ie,se=ct.width/H*de/H,bt=ct.height/ie*Me/ie),xe===void 0&&(xe=M,Ae=z,M=0,z=0),H!==void 0&&de===void 0&&(de=H,Me=ie),H===void 0&&de===void 0&&(de=ct.width,Me=ct.height);for(var we,mt=this.ctx.transform.decompose(),qt=me(mt.rotate.shx),xt=new u,_t=(xt=(xt=(xt=xt.multiply(mt.translate)).multiply(mt.skew)).multiply(mt.scale)).applyToRectangle(new l(xe-M*Dt,Ae-z*Je,H*se,ie*bt)),Et=E.call(this,_t),Bt=[],Jt=0;Jt<Et.length;Jt+=1)Bt.indexOf(Et[Jt])===-1&&Bt.push(Et[Jt]);if(F(Bt),this.autoPaging)for(var nr=Bt[0],cr=Bt[Bt.length-1],gr=nr;gr<cr+1;gr++){this.pdf.setPage(gr);var yr=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],mr=gr===1?this.posY+this.margin[0]:this.margin[0],Qt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],$t=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],wt=gr===1?0:Qt+(gr-2)*$t;if(this.ctx.clip_path.length!==0){var Vr=this.path;we=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=O(we,this.posX+this.margin[3],-wt+mr+this.ctx.prevPageLastElemOffset),te.call(this,"fill",!0),this.path=Vr}var ur=JSON.parse(JSON.stringify(_t));ur=O([ur],this.posX+this.margin[3],-wt+mr+this.ctx.prevPageLastElemOffset)[0];var Tn=(gr>nr||gr<cr)&&b.call(this);Tn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],yr,$t,null).clip().discardPath()),this.pdf.addImage(C,"JPEG",ur.x,ur.y,ur.w,ur.h,null,null,qt),Tn&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(C,"JPEG",_t.x,_t.y,_t.w,_t.h,null,null,qt)};var E=function(C,M,z){var H=[];M=M||this.pdf.internal.pageSize.width,z=z||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ie=this.posY+this.ctx.prevPageLastElemOffset;switch(C.type){default:case"mt":case"lt":H.push(Math.floor((C.y+ie)/z)+1);break;case"arc":H.push(Math.floor((C.y+ie-C.radius)/z)+1),H.push(Math.floor((C.y+ie+C.radius)/z)+1);break;case"qct":var xe=ne(this.ctx.lastPoint.x,this.ctx.lastPoint.y,C.x1,C.y1,C.x,C.y);H.push(Math.floor((xe.y+ie)/z)+1),H.push(Math.floor((xe.y+xe.h+ie)/z)+1);break;case"bct":var Ae=Ee(this.ctx.lastPoint.x,this.ctx.lastPoint.y,C.x1,C.y1,C.x2,C.y2,C.x,C.y);H.push(Math.floor((Ae.y+ie)/z)+1),H.push(Math.floor((Ae.y+Ae.h+ie)/z)+1);break;case"rect":H.push(Math.floor((C.y+ie)/z)+1),H.push(Math.floor((C.y+C.h+ie)/z)+1)}for(var de=0;de<H.length;de+=1)for(;this.pdf.internal.getNumberOfPages()<H[de];)N.call(this);return H},N=function(){var C=this.fillStyle,M=this.strokeStyle,z=this.font,H=this.lineCap,ie=this.lineWidth,xe=this.lineJoin;this.pdf.addPage(),this.fillStyle=C,this.strokeStyle=M,this.font=z,this.lineCap=H,this.lineWidth=ie,this.lineJoin=xe},O=function(C,M,z){for(var H=0;H<C.length;H++)switch(C[H].type){case"bct":C[H].x2+=M,C[H].y2+=z;case"qct":C[H].x1+=M,C[H].y1+=z;case"mt":case"lt":case"arc":default:C[H].x+=M,C[H].y+=z}return C},F=function(C){return C.sort(function(M,z){return M-z})},K=function(C,M){for(var z,H,ie=this.fillStyle,xe=this.strokeStyle,Ae=this.lineCap,de=this.lineWidth,Me=Math.abs(de*this.ctx.transform.scaleX),ct=this.lineJoin,se=JSON.parse(JSON.stringify(this.path)),bt=JSON.parse(JSON.stringify(this.path)),Dt=[],Je=0;Je<bt.length;Je++)if(bt[Je].x!==void 0)for(var we=E.call(this,bt[Je]),mt=0;mt<we.length;mt+=1)Dt.indexOf(we[mt])===-1&&Dt.push(we[mt]);for(var qt=0;qt<Dt.length;qt++)for(;this.pdf.internal.getNumberOfPages()<Dt[qt];)N.call(this);if(F(Dt),this.autoPaging)for(var xt=Dt[0],_t=Dt[Dt.length-1],Et=xt;Et<_t+1;Et++){this.pdf.setPage(Et),this.fillStyle=ie,this.strokeStyle=xe,this.lineCap=Ae,this.lineWidth=Me,this.lineJoin=ct;var Bt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Jt=Et===1?this.posY+this.margin[0]:this.margin[0],nr=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],cr=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],gr=Et===1?0:nr+(Et-2)*cr;if(this.ctx.clip_path.length!==0){var yr=this.path;z=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=O(z,this.posX+this.margin[3],-gr+Jt+this.ctx.prevPageLastElemOffset),te.call(this,C,!0),this.path=yr}if(H=JSON.parse(JSON.stringify(se)),this.path=O(H,this.posX+this.margin[3],-gr+Jt+this.ctx.prevPageLastElemOffset),M===!1||Et===0){var mr=(Et>xt||Et<_t)&&b.call(this);mr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Bt,cr,null).clip().discardPath()),te.call(this,C,M),mr&&this.pdf.restoreGraphicsState()}this.lineWidth=de}else this.lineWidth=Me,te.call(this,C,M),this.lineWidth=de;this.path=se},te=function(C,M){if((C!=="stroke"||M||!k.call(this))&&(C==="stroke"||M||!m.call(this))){for(var z,H,ie=[],xe=this.path,Ae=0;Ae<xe.length;Ae++){var de=xe[Ae];switch(de.type){case"begin":ie.push({begin:!0});break;case"close":ie.push({close:!0});break;case"mt":ie.push({start:de,deltas:[],abs:[]});break;case"lt":var Me=ie.length;if(xe[Ae-1]&&!isNaN(xe[Ae-1].x)&&(z=[de.x-xe[Ae-1].x,de.y-xe[Ae-1].y],Me>0)){for(;Me>=0;Me--)if(ie[Me-1].close!==!0&&ie[Me-1].begin!==!0){ie[Me-1].deltas.push(z),ie[Me-1].abs.push(de);break}}break;case"bct":z=[de.x1-xe[Ae-1].x,de.y1-xe[Ae-1].y,de.x2-xe[Ae-1].x,de.y2-xe[Ae-1].y,de.x-xe[Ae-1].x,de.y-xe[Ae-1].y],ie[ie.length-1].deltas.push(z);break;case"qct":var ct=xe[Ae-1].x+2/3*(de.x1-xe[Ae-1].x),se=xe[Ae-1].y+2/3*(de.y1-xe[Ae-1].y),bt=de.x+2/3*(de.x1-de.x),Dt=de.y+2/3*(de.y1-de.y),Je=de.x,we=de.y;z=[ct-xe[Ae-1].x,se-xe[Ae-1].y,bt-xe[Ae-1].x,Dt-xe[Ae-1].y,Je-xe[Ae-1].x,we-xe[Ae-1].y],ie[ie.length-1].deltas.push(z);break;case"arc":ie.push({deltas:[],abs:[],arc:!0}),Array.isArray(ie[ie.length-1].abs)&&ie[ie.length-1].abs.push(de)}}H=M?null:C==="stroke"?"stroke":"fill";for(var mt=!1,qt=0;qt<ie.length;qt++)if(ie[qt].arc)for(var xt=ie[qt].abs,_t=0;_t<xt.length;_t++){var Et=xt[_t];Et.type==="arc"?V.call(this,Et.x,Et.y,Et.radius,Et.startAngle,Et.endAngle,Et.counterclockwise,void 0,M,!mt):le.call(this,Et.x,Et.y),mt=!0}else if(ie[qt].close===!0)this.pdf.internal.out("h"),mt=!1;else if(ie[qt].begin!==!0){var Bt=ie[qt].start.x,Jt=ie[qt].start.y;ue.call(this,ie[qt].deltas,Bt,Jt),mt=!0}H&&Y.call(this,H),M&&ye.call(this)}},re=function(C){var M=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,z=M*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return C-z;case"top":return C+M-z;case"hanging":return C+M-2*z;case"middle":return C+M/2-z;case"ideographic":return C;case"alphabetic":default:return C}},B=function(C){return C+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};g.prototype.createLinearGradient=function(){var C=function(){};return C.colorStops=[],C.addColorStop=function(M,z){this.colorStops.push([M,z])},C.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},C.isCanvasGradient=!0,C},g.prototype.createPattern=function(){return this.createLinearGradient()},g.prototype.createRadialGradient=function(){return this.createLinearGradient()};var V=function(C,M,z,H,ie,xe,Ae,de,Me){for(var ct=Fe.call(this,z,H,ie,xe),se=0;se<ct.length;se++){var bt=ct[se];se===0&&(Me?U.call(this,bt.x1+C,bt.y1+M):le.call(this,bt.x1+C,bt.y1+M)),Te.call(this,C,M,bt.x2,bt.y2,bt.x3,bt.y3,bt.x4,bt.y4)}de?ye.call(this):Y.call(this,Ae)},Y=function(C){switch(C){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},ye=function(){this.pdf.clip(),this.pdf.discardPath()},U=function(C,M){this.pdf.internal.out(r(C)+" "+n(M)+" m")},D=function(C){var M;switch(C.align){case"right":case"end":M="right";break;case"center":M="center";break;case"left":case"start":default:M="left"}var z=this.pdf.getTextDimensions(C.text),H=re.call(this,C.y),ie=B.call(this,H)-z.h,xe=this.ctx.transform.applyToPoint(new o(C.x,H)),Ae=this.ctx.transform.decompose(),de=new u;de=(de=(de=de.multiply(Ae.translate)).multiply(Ae.skew)).multiply(Ae.scale);for(var Me,ct,se,bt=this.ctx.transform.applyToRectangle(new l(C.x,H,z.w,z.h)),Dt=de.applyToRectangle(new l(C.x,ie,z.w,z.h)),Je=E.call(this,Dt),we=[],mt=0;mt<Je.length;mt+=1)we.indexOf(Je[mt])===-1&&we.push(Je[mt]);if(F(we),this.autoPaging)for(var qt=we[0],xt=we[we.length-1],_t=qt;_t<xt+1;_t++){this.pdf.setPage(_t);var Et=_t===1?this.posY+this.margin[0]:this.margin[0],Bt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Jt=this.pdf.internal.pageSize.height-this.margin[2],nr=Jt-this.margin[0],cr=this.pdf.internal.pageSize.width-this.margin[1],gr=cr-this.margin[3],yr=_t===1?0:Bt+(_t-2)*nr;if(this.ctx.clip_path.length!==0){var mr=this.path;Me=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=O(Me,this.posX+this.margin[3],-1*yr+Et),te.call(this,"fill",!0),this.path=mr}var Qt=O([JSON.parse(JSON.stringify(Dt))],this.posX+this.margin[3],-yr+Et+this.ctx.prevPageLastElemOffset)[0];C.scale>=.01&&(ct=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ct*C.scale),se=this.lineWidth,this.lineWidth=se*C.scale);var $t=this.autoPaging!=="text";if($t||Qt.y+Qt.h<=Jt){if($t||Qt.y>=Et&&Qt.x<=cr){var wt=$t?C.text:this.pdf.splitTextToSize(C.text,C.maxWidth||cr-Qt.x)[0],Vr=O([JSON.parse(JSON.stringify(bt))],this.posX+this.margin[3],-yr+Et+this.ctx.prevPageLastElemOffset)[0],ur=$t&&(_t>qt||_t<xt)&&b.call(this);ur&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],gr,nr,null).clip().discardPath()),this.pdf.text(wt,Vr.x,Vr.y,{angle:C.angle,align:M,renderingMode:C.renderingMode}),ur&&this.pdf.restoreGraphicsState()}}else Qt.y<Jt&&(this.ctx.prevPageLastElemOffset+=Jt-Qt.y);C.scale>=.01&&(this.pdf.setFontSize(ct),this.lineWidth=se)}else C.scale>=.01&&(ct=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ct*C.scale),se=this.lineWidth,this.lineWidth=se*C.scale),this.pdf.text(C.text,xe.x+this.posX,xe.y+this.posY,{angle:C.angle,align:M,renderingMode:C.renderingMode,maxWidth:C.maxWidth}),C.scale>=.01&&(this.pdf.setFontSize(ct),this.lineWidth=se)},le=function(C,M,z,H){z=z||0,H=H||0,this.pdf.internal.out(r(C+z)+" "+n(M+H)+" l")},ue=function(C,M,z){return this.pdf.lines(C,M,z,null,null)},Te=function(C,M,z,H,ie,xe,Ae,de){this.pdf.internal.out([t(a(z+C)),t(i(H+M)),t(a(ie+C)),t(i(xe+M)),t(a(Ae+C)),t(i(de+M)),"c"].join(" "))},Fe=function(C,M,z,H){for(var ie=2*Math.PI,xe=Math.PI/2;M>z;)M-=ie;var Ae=Math.abs(z-M);Ae<ie&&H&&(Ae=ie-Ae);for(var de=[],Me=H?-1:1,ct=M;Ae>1e-5;){var se=ct+Me*Math.min(Ae,xe);de.push(Le.call(this,C,ct,se)),Ae-=Math.abs(se-ct),ct=se}return de},Le=function(C,M,z){var H=(z-M)/2,ie=C*Math.cos(H),xe=C*Math.sin(H),Ae=ie,de=-xe,Me=Ae*Ae+de*de,ct=Me+Ae*ie+de*xe,se=4/3*(Math.sqrt(2*Me*ct)-ct)/(Ae*xe-de*ie),bt=Ae-se*de,Dt=de+se*Ae,Je=bt,we=-Dt,mt=H+M,qt=Math.cos(mt),xt=Math.sin(mt);return{x1:C*Math.cos(M),y1:C*Math.sin(M),x2:bt*qt-Dt*xt,y2:bt*xt+Dt*qt,x3:Je*qt-we*xt,y3:Je*xt+we*qt,x4:C*Math.cos(z),y4:C*Math.sin(z)}},me=function(C){return 180*C/Math.PI},ne=function(C,M,z,H,ie,xe){var Ae=C+.5*(z-C),de=M+.5*(H-M),Me=ie+.5*(z-ie),ct=xe+.5*(H-xe),se=Math.min(C,ie,Ae,Me),bt=Math.max(C,ie,Ae,Me),Dt=Math.min(M,xe,de,ct),Je=Math.max(M,xe,de,ct);return new l(se,Dt,bt-se,Je-Dt)},Ee=function(C,M,z,H,ie,xe,Ae,de){var Me,ct,se,bt,Dt,Je,we,mt,qt,xt,_t,Et,Bt,Jt,nr=z-C,cr=H-M,gr=ie-z,yr=xe-H,mr=Ae-ie,Qt=de-xe;for(ct=0;ct<41;ct++)qt=(we=(se=C+(Me=ct/40)*nr)+Me*((Dt=z+Me*gr)-se))+Me*(Dt+Me*(ie+Me*mr-Dt)-we),xt=(mt=(bt=M+Me*cr)+Me*((Je=H+Me*yr)-bt))+Me*(Je+Me*(xe+Me*Qt-Je)-mt),ct==0?(_t=qt,Et=xt,Bt=qt,Jt=xt):(_t=Math.min(_t,qt),Et=Math.min(Et,xt),Bt=Math.max(Bt,qt),Jt=Math.max(Jt,xt));return new l(Math.round(_t),Math.round(Et),Math.round(Bt-_t),Math.round(Jt-Et))},pe=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var C,M,z=(C=this.ctx.lineDash,M=this.ctx.lineDashOffset,JSON.stringify({lineDash:C,lineDashOffset:M}));this.prevLineDash!==z&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=z)}}})(Tr.API),function(e){var t=function(i){var o,l,u,f,h,g,x,m,k,b;for(l=[],u=0,f=(i+=o="\0\0\0\0".slice(i.length%4||4)).length;f>u;u+=4)(h=(i.charCodeAt(u)<<24)+(i.charCodeAt(u+1)<<16)+(i.charCodeAt(u+2)<<8)+i.charCodeAt(u+3))!==0?(g=(h=((h=((h=((h=(h-(b=h%85))/85)-(k=h%85))/85)-(m=h%85))/85)-(x=h%85))/85)%85,l.push(g+33,x+33,m+33,k+33,b+33)):l.push(122);return function(E,N){for(var O=N;O>0;O--)E.pop()}(l,o.length),String.fromCharCode.apply(String,l)+"~>"},r=function(i){var o,l,u,f,h,g=String,x="length",m=255,k="charCodeAt",b="slice",E="replace";for(i[b](-2),i=i[b](0,-2)[E](/\s/g,"")[E]("z","!!!!!"),u=[],f=0,h=(i+=o="uuuuu"[b](i[x]%5||5))[x];h>f;f+=5)l=52200625*(i[k](f)-33)+614125*(i[k](f+1)-33)+7225*(i[k](f+2)-33)+85*(i[k](f+3)-33)+(i[k](f+4)-33),u.push(m&l>>24,m&l>>16,m&l>>8,m&l);return function(N,O){for(var F=O;F>0;F--)N.pop()}(u,o[x]),g.fromCharCode.apply(g,u)},n=function(i){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),o.test(i)===!1)return"";for(var l="",u=0;u<i.length;u+=2)l+=String.fromCharCode("0x"+(i[u]+i[u+1]));return l},a=function(i){for(var o=new Uint8Array(i.length),l=i.length;l--;)o[l]=i.charCodeAt(l);return i=(o=lg(o)).reduce(function(u,f){return u+String.fromCharCode(f)},"")};e.processDataByFilters=function(i,o){var l=0,u=i||"",f=[];for(typeof(o=o||[])=="string"&&(o=[o]),l=0;l<o.length;l+=1)switch(o[l]){case"ASCII85Decode":case"/ASCII85Decode":u=r(u),f.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=t(u),f.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=n(u),f.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=u.split("").map(function(h){return("0"+h.charCodeAt().toString(16)).slice(-2)}).join("")+">",f.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=a(u),f.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[l]+'" is not implemented')}return{data:u,reverseChain:f.reverse().join(" ")}}}(Tr.API),function(e){e.loadFile=function(t,r,n){return function(a,i,o){i=i!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(u,f,h){var g=new XMLHttpRequest,x=0,m=function(k){var b=k.length,E=[],N=String.fromCharCode;for(x=0;x<b;x+=1)E.push(N(255&k.charCodeAt(x)));return E.join("")};if(g.open("GET",u,!f),g.overrideMimeType("text/plain; charset=x-user-defined"),f===!1&&(g.onload=function(){g.status===200?h(m(this.responseText)):h(void 0)}),g.send(null),f&&g.status===200)return m(g.responseText)}(a,i,o)}catch{}return l}(t,r,n)},e.loadImageFile=e.loadFile}(Tr.API),function(e){function t(){return(Pr.html2canvas?Promise.resolve(Pr.html2canvas):M0(()=>import("./html2canvas.esm-BfxBtG_O.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function r(){return(Pr.DOMPurify?Promise.resolve(Pr.DOMPurify):M0(()=>import("./purify.es-CQJ0hv7W.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var n=function(o){var l=Nn(o);return l==="undefined"?"undefined":l==="string"||o instanceof String?"string":l==="number"||o instanceof Number?"number":l==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":l==="object"?"object":"unknown"},a=function(o,l){var u=document.createElement(o);for(var f in l.className&&(u.className=l.className),l.innerHTML&&l.dompurify&&(u.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)u.style[f]=l.style[f];return u},i=function o(l){var u=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),f=o.convert(Promise.resolve(),u);return f=(f=f.setProgress(1,o,1,[o])).set(l)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(o,l){return o.__proto__=l||i.prototype,o},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(o,l){return this.then(function(){switch(l=l||function(u){switch(n(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(o)){case"string":return this.then(r).then(function(u){return this.set({src:a("div",{innerHTML:o,dompurify:u})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},i.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=function u(f,h){for(var g=f.nodeType===3?document.createTextNode(f.nodeValue):f.cloneNode(!1),x=f.firstChild;x;x=x.nextSibling)h!==!0&&x.nodeType===1&&x.nodeName==="SCRIPT"||g.appendChild(u(x,h));return f.nodeType===1&&(f.nodeName==="CANVAS"?(g.width=f.width,g.height=f.height,g.getContext("2d").drawImage(f,0,0)):f.nodeName!=="TEXTAREA"&&f.nodeName!=="SELECT"||(g.value=f.value),g.addEventListener("load",function(){g.scrollTop=f.scrollTop,g.scrollLeft=f.scrollLeft},!0)),g}(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(l){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,l(this.prop.container,u)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(l){var u=this.opt.jsPDF,f=this.opt.fontFaces,h=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,g=Object.assign({async:!0,allowTaint:!0,scale:h,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete g.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=f,f)for(var x=0;x<f.length;++x){var m=f[x],k=m.src.find(function(b){return b.format==="truetype"});k&&u.addFont(k.url,m.ref.name,m.ref.style)}return g.windowHeight=g.windowHeight||0,g.windowHeight=g.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):g.windowHeight,u.context2d.save(!0),l(this.prop.container,g)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(o,l,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(o,l):this.outputPdf(o,l)},i.prototype.outputPdf=function(o,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,l)})},i.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},i.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(o){if(n(o)!=="object")return this;var l=Object.keys(o||{}).map(function(u){if(u in i.template.prop)return function(){this.prop[u]=o[u]};switch(u){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[u]=o[u]}}},this);return this.then(function(){return this.thenList(l)})},i.prototype.get=function(o,l){return this.then(function(){var u=o in i.template.prop?this.prop[o]:this.opt[o];return l?l(u):u})},i.prototype.setMargin=function(o){return this.then(function(){switch(n(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},i.prototype.setPageSize=function(o){function l(u,f){return Math.floor(u*f/72*96)}return this.then(function(){(o=o||Tr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:l(o.inner.width,o.k),height:l(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},i.prototype.setProgress=function(o,l,u,f){return o!=null&&(this.progress.val=o),l!=null&&(this.progress.state=l),u!=null&&(this.progress.n=u),f!=null&&(this.progress.stack=f),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(o,l,u,f){return this.setProgress(o?this.progress.val+o:null,l||null,u?this.progress.n+u:null,f?this.progress.stack.concat(f):null)},i.prototype.then=function(o,l){var u=this;return this.thenCore(o,l,function(f,h){return u.updateProgress(null,null,1,[f]),Promise.prototype.then.call(this,function(g){return u.updateProgress(null,f),g}).then(f,h).then(function(g){return u.updateProgress(1),g})})},i.prototype.thenCore=function(o,l,u){u=u||Promise.prototype.then,o&&(o=o.bind(this)),l&&(l=l.bind(this));var f=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:i.convert(Object.assign({},this),Promise.prototype),h=u.call(f,o,l);return i.convert(h,this.__proto__)},i.prototype.thenExternal=function(o,l){return Promise.prototype.then.call(this,o,l)},i.prototype.thenList=function(o){var l=this;return o.forEach(function(u){l=l.thenCore(u)}),l},i.prototype.catch=function(o){o&&(o=o.bind(this));var l=Promise.prototype.catch.call(this,o);return i.convert(l,this)},i.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},i.prototype.error=function(o){return this.then(function(){throw new Error(o)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,Tr.getPageSize=function(o,l,u){if(Nn(o)==="object"){var f=o;o=f.orientation,l=f.unit||l,u=f.format||u}l=l||"mm",u=u||"a4",o=(""+(o||"P")).toLowerCase();var h,g=(""+u).toLowerCase(),x={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":h=1;break;case"mm":h=72/25.4;break;case"cm":h=72/2.54;break;case"in":h=72;break;case"px":h=.75;break;case"pc":case"em":h=12;break;case"ex":h=6;break;default:throw"Invalid unit: "+l}var m,k=0,b=0;if(x.hasOwnProperty(g))k=x[g][1]/h,b=x[g][0]/h;else try{k=u[1],b=u[0]}catch{throw new Error("Invalid format: "+u)}if(o==="p"||o==="portrait")o="p",b>k&&(m=b,b=k,k=m);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",k>b&&(m=b,b=k,k=m)}return{width:b,height:k,unit:l,k:h,orientation:o}},e.html=function(o,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(pg):null;var u=new i(l);return l.worker?u:u.from(o).doCallback()}}(Tr.API),Tr.API.addJS=function(e){return C2=e,this.internal.events.subscribe("postPutResources",function(){ad=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(ad+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),T2=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+C2+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){ad!==void 0&&T2!==void 0&&this.internal.out("/Names <</JavaScript "+ad+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=r.outline.render().split(/\r\n/),i=0;i<a.length;i++){var o=a[i],l=n.exec(o);if(l!=null){var u=l[1];r.internal.newObjectDeferredBegin(u,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var f=this.internal.pages.length,h=[];for(i=0;i<f;i++){var g=r.internal.newObject();h.push(g);var x=r.internal.getPageInfo(i+1);r.internal.write("<< /D["+x.objId+" 0 R /XYZ null null null]>> endobj")}var m=r.internal.newObject();for(r.internal.write("<< /Names [ "),i=0;i<h.length;i++)r.internal.write("(page_"+(i+1)+")"+h[i]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+m+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,a,i){var o={title:a,options:i,children:[]};return n==null&&(n=this.root),n.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var a=0;a<n.children.length;a++)this.genIds_r(n.children[a])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<n.children.length;i++){var o=n.children[i];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),i>0&&this.line("/Prev "+this.makeRef(n.children[i-1])),i<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[i+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var u=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+u.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var f=0;f<n.children.length;f++)this.renderItems(n.children[f])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,a){for(var i=0;i<a.children.length;i++)n.count++,this.count_r(n,a.children[i]);return n.count}}])}(Tr.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,a,i,o,l){var u,f=this.decode.DCT_DECODE,h=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(u=function(g){for(var x,m=256*g.charCodeAt(4)+g.charCodeAt(5),k=g.length,b={width:0,height:0,numcomponents:1},E=4;E<k;E+=2){if(E+=m,t.indexOf(g.charCodeAt(E+1))!==-1){x=256*g.charCodeAt(E+5)+g.charCodeAt(E+6),b={width:256*g.charCodeAt(E+7)+g.charCodeAt(E+8),height:x,numcomponents:g.charCodeAt(E+9)};break}m=256*g.charCodeAt(E+2)+g.charCodeAt(E+3)}return b}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}h={data:r,width:u.width,height:u.height,colorSpace:l,bitsPerComponent:8,filter:f,index:n,alias:a}}return h}}(Tr.API);var of,id,P2,L2,F2,$k=function(){var e,t,r;function n(i){var o,l,u,f,h,g,x,m,k,b,E,N,O,F;for(this.data=i,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},g=null;;){switch(o=this.readUInt32(),k=(function(){var K,te;for(te=[],K=0;K<4;++K)te.push(String.fromCharCode(this.data[this.pos++]));return te}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(o);break;case"fcTL":g&&this.animation.frames.push(g),this.pos+=4,g={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},h=this.readUInt16(),f=this.readUInt16()||100,g.delay=1e3*h/f,g.disposeOp=this.data[this.pos++],g.blendOp=this.data[this.pos++],g.data=[];break;case"IDAT":case"fdAT":for(k==="fdAT"&&(this.pos+=4,o-=4),i=g?.data||this.imgData,N=0;0<=o?N<o:N>o;0<=o?++N:--N)i.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(u=this.palette.length/3,this.transparency.indexed=this.read(o),this.transparency.indexed.length>u)throw new Error("More transparent colors than palette size");if((b=u-this.transparency.indexed.length)>0)for(O=0;0<=b?O<b:O>b;0<=b?++O:--O)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(o)[0];break;case 2:this.transparency.rgb=this.read(o)}break;case"tEXt":x=(E=this.read(o)).indexOf(0),m=String.fromCharCode.apply(String,E.slice(0,x)),this.text[m]=String.fromCharCode.apply(String,E.slice(x+1));break;case"IEND":return g&&this.animation.frames.push(g),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(F=this.colorType)===4||F===6,l=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*l,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=o}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(i){var o,l;for(l=[],o=0;0<=i?o<i:o>i;0<=i?++o:--o)l.push(this.data[this.pos++]);return l},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(i){var o=this.pixelBitlength/8,l=new Uint8Array(this.width*this.height*o),u=0,f=this;if(i==null&&(i=this.imgData),i.length===0)return new Uint8Array(0);function h(g,x,m,k){var b,E,N,O,F,K,te,re,B,V,Y,ye,U,D,le,ue,Te,Fe,Le,me,ne,Ee=Math.ceil((f.width-g)/m),pe=Math.ceil((f.height-x)/k),C=f.width==Ee&&f.height==pe;for(D=o*Ee,ye=C?l:new Uint8Array(D*pe),K=i.length,U=0,E=0;U<pe&&u<K;){switch(i[u++]){case 0:for(O=Te=0;Te<D;O=Te+=1)ye[E++]=i[u++];break;case 1:for(O=Fe=0;Fe<D;O=Fe+=1)b=i[u++],F=O<o?0:ye[E-o],ye[E++]=(b+F)%256;break;case 2:for(O=Le=0;Le<D;O=Le+=1)b=i[u++],N=(O-O%o)/o,le=U&&ye[(U-1)*D+N*o+O%o],ye[E++]=(le+b)%256;break;case 3:for(O=me=0;me<D;O=me+=1)b=i[u++],N=(O-O%o)/o,F=O<o?0:ye[E-o],le=U&&ye[(U-1)*D+N*o+O%o],ye[E++]=(b+Math.floor((F+le)/2))%256;break;case 4:for(O=ne=0;ne<D;O=ne+=1)b=i[u++],N=(O-O%o)/o,F=O<o?0:ye[E-o],U===0?le=ue=0:(le=ye[(U-1)*D+N*o+O%o],ue=N&&ye[(U-1)*D+(N-1)*o+O%o]),te=F+le-ue,re=Math.abs(te-F),V=Math.abs(te-le),Y=Math.abs(te-ue),B=re<=V&&re<=Y?F:V<=Y?le:ue,ye[E++]=(b+B)%256;break;default:throw new Error("Invalid filter algorithm: "+i[u-1])}if(!C){var M=((x+U*k)*f.width+g)*o,z=U*D;for(O=0;O<Ee;O+=1){for(var H=0;H<o;H+=1)l[M++]=ye[z++];M+=(m-1)*o}}U++}}return i=bk(i),f.interlaceMethod==1?(h(0,0,8,8),h(4,0,8,8),h(0,4,4,8),h(2,0,4,4),h(0,2,2,4),h(1,0,2,2),h(0,1,1,2)):h(0,0,1,1),l},n.prototype.decodePalette=function(){var i,o,l,u,f,h,g,x,m;for(l=this.palette,h=this.transparency.indexed||[],f=new Uint8Array((h.length||0)+l.length),u=0,i=0,o=g=0,x=l.length;g<x;o=g+=3)f[u++]=l[o],f[u++]=l[o+1],f[u++]=l[o+2],f[u++]=(m=h[i++])!=null?m:255;return f},n.prototype.copyToImageData=function(i,o){var l,u,f,h,g,x,m,k,b,E,N;if(u=this.colors,b=null,l=this.hasAlphaChannel,this.palette.length&&(b=(N=this._decodedPalette)!=null?N:this._decodedPalette=this.decodePalette(),u=4,l=!0),k=(f=i.data||i).length,g=b||o,h=x=0,u===1)for(;h<k;)m=b?4*o[h/4]:x,E=g[m++],f[h++]=E,f[h++]=E,f[h++]=E,f[h++]=l?g[m++]:255,x=m;else for(;h<k;)m=b?4*o[h/4]:x,f[h++]=g[m++],f[h++]=g[m++],f[h++]=g[m++],f[h++]=l?g[m++]:255,x=m},n.prototype.decode=function(){var i;return i=new Uint8Array(this.width*this.height*4),this.copyToImageData(i,this.decodePixels()),i};var a=function(){if(Object.prototype.toString.call(Pr)==="[object Window]"){try{t=Pr.document.createElement("canvas"),r=t.getContext("2d")}catch{return!1}return!0}return!1};return a(),e=function(i){var o;if(a()===!0)return r.width=i.width,r.height=i.height,r.clearRect(0,0,i.width,i.height),r.putImageData(i,0,0),(o=new Image).src=t.toDataURL(),o;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(i){var o,l,u,f,h,g,x,m;if(this.animation){for(m=[],l=h=0,g=(x=this.animation.frames).length;h<g;l=++h)o=x[l],u=i.createImageData(o.width,o.height),f=this.decodePixels(new Uint8Array(o.data)),this.copyToImageData(u,f),o.imageData=u,m.push(o.image=e(u));return m}},n.prototype.renderFrame=function(i,o){var l,u,f;return l=(u=this.animation.frames)[o],f=u[o-1],o===0&&i.clearRect(0,0,this.width,this.height),f?.disposeOp===1?i.clearRect(f.xOffset,f.yOffset,f.width,f.height):f?.disposeOp===2&&i.putImageData(f.imageData,f.xOffset,f.yOffset),l.blendOp===0&&i.clearRect(l.xOffset,l.yOffset,l.width,l.height),i.drawImage(l.image,l.xOffset,l.yOffset)},n.prototype.animate=function(i){var o,l,u,f,h,g,x=this;return l=0,g=this.animation,f=g.numFrames,u=g.frames,h=g.numPlays,(o=function(){var m,k;if(m=l++%f,k=u[m],x.renderFrame(i,m),f>1&&l/f<h)return x.animation._timeout=setTimeout(o,k.delay)})()},n.prototype.stopAnimation=function(){var i;return clearTimeout((i=this.animation)!=null?i._timeout:void 0)},n.prototype.render=function(i){var o,l;return i._png&&i._png.stopAnimation(),i._png=this,i.width=this.width,i.height=this.height,o=i.getContext("2d"),this.animation?(this.decodeFrames(o),this.animate(o)):(l=o.createImageData(this.width,this.height),this.copyToImageData(l,this.decodePixels()),o.putImageData(l,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function Hk(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,a=e[t++],i=a>>7,o=1<<(7&a)+1;e[t++],e[t++];var l=null,u=null;i&&(l=t,u=o,t+=3*o);var f=!0,h=[],g=0,x=null,m=0,k=null;for(this.width=r,this.height=n;f&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,k=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((U=e[t++])>=0))throw Error("Invalid block size");if(U===0)break;t+=U}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var b=e[t++];g=e[t++]|e[t++]<<8,x=e[t++],(1&b)==0&&(x=null),m=b>>2&7,t++;break;case 254:for(;;){if(!((U=e[t++])>=0))throw Error("Invalid block size");if(U===0)break;t+=U}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var E=e[t++]|e[t++]<<8,N=e[t++]|e[t++]<<8,O=e[t++]|e[t++]<<8,F=e[t++]|e[t++]<<8,K=e[t++],te=K>>6&1,re=1<<(7&K)+1,B=l,V=u,Y=!1;K>>7&&(Y=!0,B=t,V=re,t+=3*re);var ye=t;for(t++;;){var U;if(!((U=e[t++])>=0))throw Error("Invalid block size");if(U===0)break;t+=U}h.push({x:E,y:N,width:O,height:F,has_local_palette:Y,palette_offset:B,palette_size:V,data_offset:ye,data_length:t-ye,transparent_index:x,interlaced:!!te,delay:g,disposal:m});break;case 59:f=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return h.length},this.loopCount=function(){return k},this.frameInfo=function(D){if(D<0||D>=h.length)throw new Error("Frame index out of range.");return h[D]},this.decodeAndBlitFrameBGRA=function(D,le){var ue=this.frameInfo(D),Te=ue.width*ue.height,Fe=new Uint8Array(Te);O2(e,ue.data_offset,Fe,Te);var Le=ue.palette_offset,me=ue.transparent_index;me===null&&(me=256);var ne=ue.width,Ee=r-ne,pe=ne,C=4*(ue.y*r+ue.x),M=4*((ue.y+ue.height)*r+ue.x),z=C,H=4*Ee;ue.interlaced===!0&&(H+=4*r*7);for(var ie=8,xe=0,Ae=Fe.length;xe<Ae;++xe){var de=Fe[xe];if(pe===0&&(pe=ne,(z+=H)>=M&&(H=4*Ee+4*r*(ie-1),z=C+(ne+Ee)*(ie<<1),ie>>=1)),de===me)z+=4;else{var Me=e[Le+3*de],ct=e[Le+3*de+1],se=e[Le+3*de+2];le[z++]=se,le[z++]=ct,le[z++]=Me,le[z++]=255}--pe}},this.decodeAndBlitFrameRGBA=function(D,le){var ue=this.frameInfo(D),Te=ue.width*ue.height,Fe=new Uint8Array(Te);O2(e,ue.data_offset,Fe,Te);var Le=ue.palette_offset,me=ue.transparent_index;me===null&&(me=256);var ne=ue.width,Ee=r-ne,pe=ne,C=4*(ue.y*r+ue.x),M=4*((ue.y+ue.height)*r+ue.x),z=C,H=4*Ee;ue.interlaced===!0&&(H+=4*r*7);for(var ie=8,xe=0,Ae=Fe.length;xe<Ae;++xe){var de=Fe[xe];if(pe===0&&(pe=ne,(z+=H)>=M&&(H=4*Ee+4*r*(ie-1),z=C+(ne+Ee)*(ie<<1),ie>>=1)),de===me)z+=4;else{var Me=e[Le+3*de],ct=e[Le+3*de+1],se=e[Le+3*de+2];le[z++]=Me,le[z++]=ct,le[z++]=se,le[z++]=255}--pe}}}function O2(e,t,r,n){for(var a=e[t++],i=1<<a,o=i+1,l=o+1,u=a+1,f=(1<<u)-1,h=0,g=0,x=0,m=e[t++],k=new Int32Array(4096),b=null;;){for(;h<16&&m!==0;)g|=e[t++]<<h,h+=8,m===1?m=e[t++]:--m;if(h<u)break;var E=g&f;if(g>>=u,h-=u,E!==i){if(E===o)break;for(var N=E<l?E:b,O=0,F=N;F>i;)F=k[F]>>8,++O;var K=F;if(x+O+(N!==E?1:0)>n)return void jn.log("Warning, gif stream longer than expected.");r[x++]=K;var te=x+=O;for(N!==E&&(r[x++]=K),F=N;O--;)F=k[F],r[--te]=255&F,F>>=8;b!==null&&l<4096&&(k[l++]=b<<8|K,l>=f+1&&u<12&&(++u,f=f<<1|1)),b=E}else l=o+1,f=(1<<(u=a+1))-1,b=null}return x!==n&&jn.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function C1(e){var t,r,n,a,i,o=Math.floor,l=new Array(64),u=new Array(64),f=new Array(64),h=new Array(64),g=new Array(65535),x=new Array(65535),m=new Array(64),k=new Array(64),b=[],E=0,N=7,O=new Array(64),F=new Array(64),K=new Array(64),te=new Array(256),re=new Array(2048),B=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],V=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],Y=[0,1,2,3,4,5,6,7,8,9,10,11],ye=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],U=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],D=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],le=[0,1,2,3,4,5,6,7,8,9,10,11],ue=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Te=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function Fe(C,M){for(var z=0,H=0,ie=new Array,xe=1;xe<=16;xe++){for(var Ae=1;Ae<=C[xe];Ae++)ie[M[H]]=[],ie[M[H]][0]=z,ie[M[H]][1]=xe,H++,z++;z*=2}return ie}function Le(C){for(var M=C[0],z=C[1]-1;z>=0;)M&1<<z&&(E|=1<<N),z--,--N<0&&(E==255?(me(255),me(0)):me(E),N=7,E=0)}function me(C){b.push(C)}function ne(C){me(C>>8&255),me(255&C)}function Ee(C,M,z,H,ie){for(var xe,Ae=ie[0],de=ie[240],Me=function(xt,_t){var Et,Bt,Jt,nr,cr,gr,yr,mr,Qt,$t,wt=0;for(Qt=0;Qt<8;++Qt){Et=xt[wt],Bt=xt[wt+1],Jt=xt[wt+2],nr=xt[wt+3],cr=xt[wt+4],gr=xt[wt+5],yr=xt[wt+6];var Vr=Et+(mr=xt[wt+7]),ur=Et-mr,Tn=Bt+yr,Ur=Bt-yr,Ut=Jt+gr,Zn=Jt-gr,Lr=nr+cr,ga=nr-cr,At=Vr+Lr,Bn=Vr-Lr,Xr=Tn+Ut,Fr=Tn-Ut;xt[wt]=At+Xr,xt[wt+4]=At-Xr;var ar=.707106781*(Fr+Bn);xt[wt+2]=Bn+ar,xt[wt+6]=Bn-ar;var Or=.382683433*((At=ga+Zn)-(Fr=Ur+ur)),Ln=.5411961*At+Or,Jr=1.306562965*Fr+Or,ln=.707106781*(Xr=Zn+Ur),Sn=ur+ln,Gt=ur-ln;xt[wt+5]=Gt+Ln,xt[wt+3]=Gt-Ln,xt[wt+1]=Sn+Jr,xt[wt+7]=Sn-Jr,wt+=8}for(wt=0,Qt=0;Qt<8;++Qt){Et=xt[wt],Bt=xt[wt+8],Jt=xt[wt+16],nr=xt[wt+24],cr=xt[wt+32],gr=xt[wt+40],yr=xt[wt+48];var yn=Et+(mr=xt[wt+56]),wr=Et-mr,Dr=Bt+yr,nn=Bt-yr,Qr=Jt+gr,X=Jt-gr,be=nr+cr,fe=nr-cr,he=yn+be,_e=yn-be,ke=Dr+Qr,Qe=Dr-Qr;xt[wt]=he+ke,xt[wt+32]=he-ke;var ut=.707106781*(Qe+_e);xt[wt+16]=_e+ut,xt[wt+48]=_e-ut;var Xe=.382683433*((he=fe+X)-(Qe=nn+wr)),rt=.5411961*he+Xe,nt=1.306562965*Qe+Xe,St=.707106781*(ke=X+nn),zt=wr+St,It=wr-St;xt[wt+40]=It+rt,xt[wt+24]=It-rt,xt[wt+8]=zt+nt,xt[wt+56]=zt-nt,wt++}for(Qt=0;Qt<64;++Qt)$t=xt[Qt]*_t[Qt],m[Qt]=$t>0?$t+.5|0:$t-.5|0;return m}(C,M),ct=0;ct<64;++ct)k[B[ct]]=Me[ct];var se=k[0]-z;z=k[0],se==0?Le(H[0]):(Le(H[x[xe=32767+se]]),Le(g[xe]));for(var bt=63;bt>0&&k[bt]==0;)bt--;if(bt==0)return Le(Ae),z;for(var Dt,Je=1;Je<=bt;){for(var we=Je;k[Je]==0&&Je<=bt;)++Je;var mt=Je-we;if(mt>=16){Dt=mt>>4;for(var qt=1;qt<=Dt;++qt)Le(de);mt&=15}xe=32767+k[Je],Le(ie[(mt<<4)+x[xe]]),Le(g[xe]),Je++}return bt!=63&&Le(Ae),z}function pe(C){C=Math.min(Math.max(C,1),100),i!=C&&(function(M){for(var z=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],H=0;H<64;H++){var ie=o((z[H]*M+50)/100);ie=Math.min(Math.max(ie,1),255),l[B[H]]=ie}for(var xe=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Ae=0;Ae<64;Ae++){var de=o((xe[Ae]*M+50)/100);de=Math.min(Math.max(de,1),255),u[B[Ae]]=de}for(var Me=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],ct=0,se=0;se<8;se++)for(var bt=0;bt<8;bt++)f[ct]=1/(l[B[ct]]*Me[se]*Me[bt]*8),h[ct]=1/(u[B[ct]]*Me[se]*Me[bt]*8),ct++}(C<50?Math.floor(5e3/C):Math.floor(200-2*C)),i=C)}this.encode=function(C,M){M&&pe(M),b=new Array,E=0,N=7,ne(65496),ne(65504),ne(16),me(74),me(70),me(73),me(70),me(0),me(1),me(1),me(0),ne(1),ne(1),me(0),me(0),function(){ne(65499),ne(132),me(0);for(var Bt=0;Bt<64;Bt++)me(l[Bt]);me(1);for(var Jt=0;Jt<64;Jt++)me(u[Jt])}(),function(Bt,Jt){ne(65472),ne(17),me(8),ne(Jt),ne(Bt),me(3),me(1),me(17),me(0),me(2),me(17),me(1),me(3),me(17),me(1)}(C.width,C.height),function(){ne(65476),ne(418),me(0);for(var Bt=0;Bt<16;Bt++)me(V[Bt+1]);for(var Jt=0;Jt<=11;Jt++)me(Y[Jt]);me(16);for(var nr=0;nr<16;nr++)me(ye[nr+1]);for(var cr=0;cr<=161;cr++)me(U[cr]);me(1);for(var gr=0;gr<16;gr++)me(D[gr+1]);for(var yr=0;yr<=11;yr++)me(le[yr]);me(17);for(var mr=0;mr<16;mr++)me(ue[mr+1]);for(var Qt=0;Qt<=161;Qt++)me(Te[Qt])}(),ne(65498),ne(12),me(3),me(1),me(0),me(2),me(17),me(3),me(17),me(0),me(63),me(0);var z=0,H=0,ie=0;E=0,N=7,this.encode.displayName="_encode_";for(var xe,Ae,de,Me,ct,se,bt,Dt,Je,we=C.data,mt=C.width,qt=C.height,xt=4*mt,_t=0;_t<qt;){for(xe=0;xe<xt;){for(ct=xt*_t+xe,bt=-1,Dt=0,Je=0;Je<64;Je++)se=ct+(Dt=Je>>3)*xt+(bt=4*(7&Je)),_t+Dt>=qt&&(se-=xt*(_t+1+Dt-qt)),xe+bt>=xt&&(se-=xe+bt-xt+4),Ae=we[se++],de=we[se++],Me=we[se++],O[Je]=(re[Ae]+re[de+256>>0]+re[Me+512>>0]>>16)-128,F[Je]=(re[Ae+768>>0]+re[de+1024>>0]+re[Me+1280>>0]>>16)-128,K[Je]=(re[Ae+1280>>0]+re[de+1536>>0]+re[Me+1792>>0]>>16)-128;z=Ee(O,f,z,t,n),H=Ee(F,h,H,r,a),ie=Ee(K,h,ie,r,a),xe+=32}_t+=8}if(N>=0){var Et=[];Et[1]=N+1,Et[0]=(1<<N+1)-1,Le(Et)}return ne(65497),new Uint8Array(b)},e=e||50,function(){for(var C=String.fromCharCode,M=0;M<256;M++)te[M]=C(M)}(),t=Fe(V,Y),r=Fe(D,le),n=Fe(ye,U),a=Fe(ue,Te),function(){for(var C=1,M=2,z=1;z<=15;z++){for(var H=C;H<M;H++)x[32767+H]=z,g[32767+H]=[],g[32767+H][1]=z,g[32767+H][0]=H;for(var ie=-(M-1);ie<=-C;ie++)x[32767+ie]=z,g[32767+ie]=[],g[32767+ie][1]=z,g[32767+ie][0]=M-1+ie;C<<=1,M<<=1}}(),function(){for(var C=0;C<256;C++)re[C]=19595*C,re[C+256>>0]=38470*C,re[C+512>>0]=7471*C+32768,re[C+768>>0]=-11059*C,re[C+1024>>0]=-21709*C,re[C+1280>>0]=32768*C+8421375,re[C+1536>>0]=-27439*C,re[C+1792>>0]=-5329*C}(),pe(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Xo(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function I2(e){function t(V){if(!V)throw Error("assert :P")}function r(V,Y,ye){for(var U=0;4>U;U++)if(V[Y+U]!=ye.charCodeAt(U))return!0;return!1}function n(V,Y,ye,U,D){for(var le=0;le<D;le++)V[Y+le]=ye[U+le]}function a(V,Y,ye,U){for(var D=0;D<U;D++)V[Y+D]=ye}function i(V){return new Int32Array(V)}function o(V,Y){for(var ye=[],U=0;U<V;U++)ye.push(new Y);return ye}function l(V,Y){var ye=[];return function U(D,le,ue){for(var Te=ue[le],Fe=0;Fe<Te&&(D.push(ue.length>le+1?[]:new Y),!(ue.length<le+1));Fe++)U(D[Fe],le+1,ue)}(ye,0,V),ye}var u=function(){var V=this;function Y(p,w){for(var P=1<<w-1>>>0;p&P;)P>>>=1;return P?(p&P-1)+P:p}function ye(p,w,P,R,W){t(!(R%P));do p[w+(R-=P)]=W;while(0<R)}function U(p,w,P,R,W){if(t(2328>=W),512>=W)var J=i(512);else if((J=i(W))==null)return 0;return function(ee,ae,oe,ge,Re,Ze){var et,We,yt=ae,ft=1<<oe,Be=i(16),Ue=i(16);for(t(Re!=0),t(ge!=null),t(ee!=null),t(0<oe),We=0;We<Re;++We){if(15<ge[We])return 0;++Be[ge[We]]}if(Be[0]==Re)return 0;for(Ue[1]=0,et=1;15>et;++et){if(Be[et]>1<<et)return 0;Ue[et+1]=Ue[et]+Be[et]}for(We=0;We<Re;++We)et=ge[We],0<ge[We]&&(Ze[Ue[et]++]=We);if(Ue[15]==1)return(ge=new D).g=0,ge.value=Ze[0],ye(ee,yt,1,ft,ge),ft;var gt,pt=-1,vt=ft-1,Zt=0,Kt=1,_r=1,Yt=1<<oe;for(We=0,et=1,Re=2;et<=oe;++et,Re<<=1){if(Kt+=_r<<=1,0>(_r-=Be[et]))return 0;for(;0<Be[et];--Be[et])(ge=new D).g=et,ge.value=Ze[We++],ye(ee,yt+Zt,Re,Yt,ge),Zt=Y(Zt,et)}for(et=oe+1,Re=2;15>=et;++et,Re<<=1){if(Kt+=_r<<=1,0>(_r-=Be[et]))return 0;for(;0<Be[et];--Be[et]){if(ge=new D,(Zt&vt)!=pt){for(yt+=Yt,gt=1<<(pt=et)-oe;15>pt&&!(0>=(gt-=Be[pt]));)++pt,gt<<=1;ft+=Yt=1<<(gt=pt-oe),ee[ae+(pt=Zt&vt)].g=gt+oe,ee[ae+pt].value=yt-ae-pt}ge.g=et-oe,ge.value=Ze[We++],ye(ee,yt+(Zt>>oe),Re,Yt,ge),Zt=Y(Zt,et)}}return Kt!=2*Ue[15]-1?0:ft}(p,w,P,R,W,J)}function D(){this.value=this.g=0}function le(){this.value=this.g=0}function ue(){this.G=o(5,D),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Br,le)}function Te(p,w,P,R){t(p!=null),t(w!=null),t(2147483648>R),p.Ca=254,p.I=0,p.b=-8,p.Ka=0,p.oa=w,p.pa=P,p.Jd=w,p.Yc=P+R,p.Zc=4<=R?P+R-4+1:P,xe(p)}function Fe(p,w){for(var P=0;0<w--;)P|=de(p,128)<<w;return P}function Le(p,w){var P=Fe(p,w);return Ae(p)?-P:P}function me(p,w,P,R){var W,J=0;for(t(p!=null),t(w!=null),t(4294967288>R),p.Sb=R,p.Ra=0,p.u=0,p.h=0,4<R&&(R=4),W=0;W<R;++W)J+=w[P+W]<<8*W;p.Ra=J,p.bb=R,p.oa=w,p.pa=P}function ne(p){for(;8<=p.u&&p.bb<p.Sb;)p.Ra>>>=8,p.Ra+=p.oa[p.pa+p.bb]<<wl-8>>>0,++p.bb,p.u-=8;z(p)&&(p.h=1,p.u=0)}function Ee(p,w){if(t(0<=w),!p.h&&w<=xa){var P=M(p)&Vs[w];return p.u+=w,ne(p),P}return p.h=1,p.u=0}function pe(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function C(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function M(p){return p.Ra>>>(p.u&wl-1)>>>0}function z(p){return t(p.bb<=p.Sb),p.h||p.bb==p.Sb&&p.u>wl}function H(p,w){p.u=w,p.h=z(p)}function ie(p){p.u>=po&&(t(p.u>=po),ne(p))}function xe(p){t(p!=null&&p.oa!=null),p.pa<p.Zc?(p.I=(p.oa[p.pa++]|p.I<<8)>>>0,p.b+=8):(t(p!=null&&p.oa!=null),p.pa<p.Yc?(p.b+=8,p.I=p.oa[p.pa++]|p.I<<8):p.Ka?p.b=0:(p.I<<=8,p.b+=8,p.Ka=1))}function Ae(p){return Fe(p,1)}function de(p,w){var P=p.Ca;0>p.b&&xe(p);var R=p.b,W=P*w>>>8,J=(p.I>>>R>W)+0;for(J?(P-=W,p.I-=W+1<<R>>>0):P=W+1,R=P,W=0;256<=R;)W+=8,R>>=8;return R=7^W+La[R],p.b-=R,p.Ca=(P<<R)-1,J}function Me(p,w,P){p[w+0]=P>>24&255,p[w+1]=P>>16&255,p[w+2]=P>>8&255,p[w+3]=P>>0&255}function ct(p,w){return p[w+0]<<0|p[w+1]<<8}function se(p,w){return ct(p,w)|p[w+2]<<16}function bt(p,w){return ct(p,w)|ct(p,w+2)<<16}function Dt(p,w){var P=1<<w;return t(p!=null),t(0<w),p.X=i(P),p.X==null?0:(p.Mb=32-w,p.Xa=w,1)}function Je(p,w){t(p!=null),t(w!=null),t(p.Xa==w.Xa),n(w.X,0,p.X,0,1<<w.Xa)}function we(){this.X=[],this.Xa=this.Mb=0}function mt(p,w,P,R){t(P!=null),t(R!=null);var W=P[0],J=R[0];return W==0&&(W=(p*J+w/2)/w),J==0&&(J=(w*W+p/2)/p),0>=W||0>=J?0:(P[0]=W,R[0]=J,1)}function qt(p,w){return p+(1<<w)-1>>>w}function xt(p,w){return((4278255360&p)+(4278255360&w)>>>0&4278255360)+((16711935&p)+(16711935&w)>>>0&16711935)>>>0}function _t(p,w){V[w]=function(P,R,W,J,ee,ae,oe){var ge;for(ge=0;ge<ee;++ge){var Re=V[p](ae[oe+ge-1],W,J+ge);ae[oe+ge]=xt(P[R+ge],Re)}}}function Et(){this.ud=this.hd=this.jd=0}function Bt(p,w){return((4278124286&(p^w))>>>1)+(p&w)>>>0}function Jt(p){return 0<=p&&256>p?p:0>p?0:255<p?255:void 0}function nr(p,w){return Jt(p+(p-w+.5>>1))}function cr(p,w,P){return Math.abs(w-P)-Math.abs(p-P)}function gr(p,w,P,R,W,J,ee){for(R=J[ee-1],P=0;P<W;++P)J[ee+P]=R=xt(p[w+P],R)}function yr(p,w,P,R,W){var J;for(J=0;J<P;++J){var ee=p[w+J],ae=ee>>8&255,oe=16711935&(oe=(oe=16711935&ee)+((ae<<16)+ae));R[W+J]=(4278255360&ee)+oe>>>0}}function mr(p,w){w.jd=p>>0&255,w.hd=p>>8&255,w.ud=p>>16&255}function Qt(p,w,P,R,W,J){var ee;for(ee=0;ee<R;++ee){var ae=w[P+ee],oe=ae>>>8,ge=ae,Re=255&(Re=(Re=ae>>>16)+((p.jd<<24>>24)*(oe<<24>>24)>>>5));ge=255&(ge=(ge=ge+((p.hd<<24>>24)*(oe<<24>>24)>>>5))+((p.ud<<24>>24)*(Re<<24>>24)>>>5)),W[J+ee]=(4278255360&ae)+(Re<<16)+ge}}function $t(p,w,P,R,W){V[w]=function(J,ee,ae,oe,ge,Re,Ze,et,We){for(oe=Ze;oe<et;++oe)for(Ze=0;Ze<We;++Ze)ge[Re++]=W(ae[R(J[ee++])])},V[p]=function(J,ee,ae,oe,ge,Re,Ze){var et=8>>J.b,We=J.Ea,yt=J.K[0],ft=J.w;if(8>et)for(J=(1<<J.b)-1,ft=(1<<et)-1;ee<ae;++ee){var Be,Ue=0;for(Be=0;Be<We;++Be)Be&J||(Ue=R(oe[ge++])),Re[Ze++]=W(yt[Ue&ft]),Ue>>=et}else V["VP8LMapColor"+P](oe,ge,yt,ft,Re,Ze,ee,ae,We)}}function wt(p,w,P,R,W){for(P=w+P;w<P;){var J=p[w++];R[W++]=J>>16&255,R[W++]=J>>8&255,R[W++]=J>>0&255}}function Vr(p,w,P,R,W){for(P=w+P;w<P;){var J=p[w++];R[W++]=J>>16&255,R[W++]=J>>8&255,R[W++]=J>>0&255,R[W++]=J>>24&255}}function ur(p,w,P,R,W){for(P=w+P;w<P;){var J=(ee=p[w++])>>16&240|ee>>12&15,ee=ee>>0&240|ee>>28&15;R[W++]=J,R[W++]=ee}}function Tn(p,w,P,R,W){for(P=w+P;w<P;){var J=(ee=p[w++])>>16&248|ee>>13&7,ee=ee>>5&224|ee>>3&31;R[W++]=J,R[W++]=ee}}function Ur(p,w,P,R,W){for(P=w+P;w<P;){var J=p[w++];R[W++]=J>>0&255,R[W++]=J>>8&255,R[W++]=J>>16&255}}function Ut(p,w,P,R,W,J){if(J==0)for(P=w+P;w<P;)Me(R,((J=p[w++])[0]>>24|J[1]>>8&65280|J[2]<<8&16711680|J[3]<<24)>>>0),W+=32;else n(R,W,p,w,P)}function Zn(p,w){V[w][0]=V[p+"0"],V[w][1]=V[p+"1"],V[w][2]=V[p+"2"],V[w][3]=V[p+"3"],V[w][4]=V[p+"4"],V[w][5]=V[p+"5"],V[w][6]=V[p+"6"],V[w][7]=V[p+"7"],V[w][8]=V[p+"8"],V[w][9]=V[p+"9"],V[w][10]=V[p+"10"],V[w][11]=V[p+"11"],V[w][12]=V[p+"12"],V[w][13]=V[p+"13"],V[w][14]=V[p+"0"],V[w][15]=V[p+"0"]}function Lr(p){return p==mc||p==$l||p==tu||p==ru}function ga(){this.eb=[],this.size=this.A=this.fb=0}function At(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Bn(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ga,this.f.kb=new At,this.sd=null}function Xr(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Fr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function ar(p){return alert("todo:WebPSamplerProcessPlane"),p.T}function Or(p,w){var P=p.T,R=w.ba.f.RGBA,W=R.eb,J=R.fb+p.ka*R.A,ee=Fi[w.ba.S],ae=p.y,oe=p.O,ge=p.f,Re=p.N,Ze=p.ea,et=p.W,We=w.cc,yt=w.dc,ft=w.Mc,Be=w.Nc,Ue=p.ka,gt=p.ka+p.T,pt=p.U,vt=pt+1>>1;for(Ue==0?ee(ae,oe,null,null,ge,Re,Ze,et,ge,Re,Ze,et,W,J,null,null,pt):(ee(w.ec,w.fc,ae,oe,We,yt,ft,Be,ge,Re,Ze,et,W,J-R.A,W,J,pt),++P);Ue+2<gt;Ue+=2)We=ge,yt=Re,ft=Ze,Be=et,Re+=p.Rc,et+=p.Rc,J+=2*R.A,ee(ae,(oe+=2*p.fa)-p.fa,ae,oe,We,yt,ft,Be,ge,Re,Ze,et,W,J-R.A,W,J,pt);return oe+=p.fa,p.j+gt<p.o?(n(w.ec,w.fc,ae,oe,pt),n(w.cc,w.dc,ge,Re,vt),n(w.Mc,w.Nc,Ze,et,vt),P--):1&gt||ee(ae,oe,null,null,ge,Re,Ze,et,ge,Re,Ze,et,W,J+R.A,null,null,pt),P}function Ln(p,w,P){var R=p.F,W=[p.J];if(R!=null){var J=p.U,ee=w.ba.S,ae=ee==eu||ee==tu;w=w.ba.f.RGBA;var oe=[0],ge=p.ka;oe[0]=p.T,p.Kb&&(ge==0?--oe[0]:(--ge,W[0]-=p.width),p.j+p.ka+p.T==p.o&&(oe[0]=p.o-p.j-ge));var Re=w.eb;ge=w.fb+ge*w.A,p=tr(R,W[0],p.width,J,oe,Re,ge+(ae?0:3),w.A),t(P==oe),p&&Lr(ee)&&Wt(Re,ge,ae,J,oe,w.A)}return 0}function Jr(p){var w=p.ma,P=w.ba.S,R=11>P,W=P==bl||P==Zc||P==eu||P==An||P==12||Lr(P);if(w.memory=null,w.Ib=null,w.Jb=null,w.Nd=null,!yl(w.Oa,p,W?11:12))return 0;if(W&&Lr(P)&&Nt(),p.da)alert("todo:use_scaling");else{if(R){if(w.Ib=ar,p.Kb){if(P=p.U+1>>1,w.memory=i(p.U+2*P),w.memory==null)return 0;w.ec=w.memory,w.fc=0,w.cc=w.ec,w.dc=w.fc+p.U,w.Mc=w.cc,w.Nc=w.dc+P,w.Ib=Or,Nt()}}else alert("todo:EmitYUV");W&&(w.Jb=Ln,R&&Ye())}if(R&&!Ba){for(p=0;256>p;++p)Oi[p]=89858*(p-128)+Ks>>Mo,Ii[p]=-22014*(p-128)+Ks,wc[p]=-45773*(p-128),Kl[p]=113618*(p-128)+Ks>>Mo;for(p=wn;p<_n;++p)w=76283*(p-16)+Ks>>Mo,$u[p-wn]=Qa(w,255),Sh[p-wn]=Qa(w+8>>4,15);Ba=1}return 1}function ln(p){var w=p.ma,P=p.U,R=p.T;return t(!(1&p.ka)),0>=P||0>=R?0:(P=w.Ib(p,w),w.Jb!=null&&w.Jb(p,w,P),w.Dc+=P,1)}function Sn(p){p.ma.memory=null}function Gt(p,w,P,R){return Ee(p,8)!=47?0:(w[0]=Ee(p,14)+1,P[0]=Ee(p,14)+1,R[0]=Ee(p,1),Ee(p,3)!=0?0:!p.h)}function yn(p,w){if(4>p)return p+1;var P=p-2>>1;return(2+(1&p)<<P)+Ee(w,P)+1}function wr(p,w){return 120<w?w-120:1<=(P=((P=Ap[w-1])>>4)*p+(8-(15&P)))?P:1;var P}function Dr(p,w,P){var R=M(P),W=p[w+=255&R].g-8;return 0<W&&(H(P,P.u+8),R=M(P),w+=p[w].value,w+=R&(1<<W)-1),H(P,P.u+p[w].g),p[w].value}function nn(p,w,P){return P.g+=p.g,P.value+=p.value<<w>>>0,t(8>=P.g),p.g}function Qr(p,w,P){var R=p.xc;return t((w=R==0?0:p.vc[p.md*(P>>R)+(w>>R)])<p.Wb),p.Ya[w]}function X(p,w,P,R){var W=p.ab,J=p.c*w,ee=p.C;w=ee+w;var ae=P,oe=R;for(R=p.Ta,P=p.Ua;0<W--;){var ge=p.gc[W],Re=ee,Ze=w,et=ae,We=oe,yt=(oe=R,ae=P,ge.Ea);switch(t(Re<Ze),t(Ze<=ge.nc),ge.hc){case 2:Ws(et,We,(Ze-Re)*yt,oe,ae);break;case 0:var ft=Re,Be=Ze,Ue=oe,gt=ae,pt=(Yt=ge).Ea;ft==0&&(fi(et,We,null,null,1,Ue,gt),gr(et,We+1,0,0,pt-1,Ue,gt+1),We+=pt,gt+=pt,++ft);for(var vt=1<<Yt.b,Zt=vt-1,Kt=qt(pt,Yt.b),_r=Yt.K,Yt=Yt.w+(ft>>Yt.b)*Kt;ft<Be;){var cn=_r,un=Yt,rn=1;for(os(et,We,Ue,gt-pt,1,Ue,gt);rn<pt;){var Hr=(rn&~Zt)+vt;Hr>pt&&(Hr=pt),(0,L[cn[un++]>>8&15])(et,We+ +rn,Ue,gt+rn-pt,Hr-rn,Ue,gt+rn),rn=Hr}We+=pt,gt+=pt,++ft&Zt||(Yt+=Kt)}Ze!=ge.nc&&n(oe,ae-yt,oe,ae+(Ze-Re-1)*yt,yt);break;case 1:for(yt=et,Be=We,pt=(et=ge.Ea)-(gt=et&~(Ue=(We=1<<ge.b)-1)),ft=qt(et,ge.b),vt=ge.K,ge=ge.w+(Re>>ge.b)*ft;Re<Ze;){for(Zt=vt,Kt=ge,_r=new Et,Yt=Be+gt,cn=Be+et;Be<Yt;)mr(Zt[Kt++],_r),j(_r,yt,Be,We,oe,ae),Be+=We,ae+=We;Be<cn&&(mr(Zt[Kt++],_r),j(_r,yt,Be,pt,oe,ae),Be+=pt,ae+=pt),++Re&Ue||(ge+=ft)}break;case 3:if(et==oe&&We==ae&&0<ge.b){for(Be=oe,et=yt=ae+(Ze-Re)*yt-(gt=(Ze-Re)*qt(ge.Ea,ge.b)),We=oe,Ue=ae,ft=[],gt=(pt=gt)-1;0<=gt;--gt)ft[gt]=We[Ue+gt];for(gt=pt-1;0<=gt;--gt)Be[et+gt]=ft[gt];$n(ge,Re,Ze,oe,yt,oe,ae)}else $n(ge,Re,Ze,et,We,oe,ae)}ae=R,oe=P}oe!=P&&n(R,P,ae,oe,J)}function be(p,w){var P=p.V,R=p.Ba+p.c*p.C,W=w-p.C;if(t(w<=p.l.o),t(16>=W),0<W){var J=p.l,ee=p.Ta,ae=p.Ua,oe=J.width;if(X(p,W,P,R),W=ae=[ae],t((P=p.C)<(R=w)),t(J.v<J.va),R>J.o&&(R=J.o),P<J.j){var ge=J.j-P;P=J.j,W[0]+=ge*oe}if(P>=R?P=0:(W[0]+=4*J.v,J.ka=P-J.j,J.U=J.va-J.v,J.T=R-P,P=1),P){if(ae=ae[0],11>(P=p.ca).S){var Re=P.f.RGBA,Ze=(R=P.S,W=J.U,J=J.T,ge=Re.eb,Re.A),et=J;for(Re=Re.fb+p.Ma*Re.A;0<et--;){var We=ee,yt=ae,ft=W,Be=ge,Ue=Re;switch(R){case Bu:q(We,yt,ft,Be,Ue);break;case bl:Z(We,yt,ft,Be,Ue);break;case mc:Z(We,yt,ft,Be,Ue),Wt(Be,Ue,0,ft,1,0);break;case yh:De(We,yt,ft,Be,Ue);break;case Zc:Ut(We,yt,ft,Be,Ue,1);break;case $l:Ut(We,yt,ft,Be,Ue,1),Wt(Be,Ue,0,ft,1,0);break;case eu:Ut(We,yt,ft,Be,Ue,0);break;case tu:Ut(We,yt,ft,Be,Ue,0),Wt(Be,Ue,1,ft,1,0);break;case An:ve(We,yt,ft,Be,Ue);break;case ru:ve(We,yt,ft,Be,Ue),er(Be,Ue,ft,1,0);break;case Uu:Ce(We,yt,ft,Be,Ue);break;default:t(0)}ae+=oe,Re+=Ze}p.Ma+=J}else alert("todo:EmitRescaledRowsYUVA");t(p.Ma<=P.height)}}p.C=w,t(p.C<=p.i)}function fe(p){var w;if(0<p.ua)return 0;for(w=0;w<p.Wb;++w){var P=p.Ya[w].G,R=p.Ya[w].H;if(0<P[1][R[1]+0].g||0<P[2][R[2]+0].g||0<P[3][R[3]+0].g)return 0}return 1}function he(p,w,P,R,W,J){if(p.Z!=0){var ee=p.qd,ae=p.rd;for(t(ei[p.Z]!=null);w<P;++w)ei[p.Z](ee,ae,R,W,R,W,J),ee=R,ae=W,W+=J;p.qd=ee,p.rd=ae}}function _e(p,w){var P=p.l.ma,R=P.Z==0||P.Z==1?p.l.j:p.C;if(R=p.C<R?R:p.C,t(w<=p.l.o),w>R){var W=p.l.width,J=P.ca,ee=P.tb+W*R,ae=p.V,oe=p.Ba+p.c*R,ge=p.gc;t(p.ab==1),t(ge[0].hc==3),v(ge[0],R,w,ae,oe,J,ee),he(P,R,w,J,ee,W)}p.C=p.Ma=w}function ke(p,w,P,R,W,J,ee){var ae=p.$/R,oe=p.$%R,ge=p.m,Re=p.s,Ze=P+p.$,et=Ze;W=P+R*W;var We=P+R*J,yt=280+Re.ua,ft=p.Pb?ae:16777216,Be=0<Re.ua?Re.Wa:null,Ue=Re.wc,gt=Ze<We?Qr(Re,oe,ae):null;t(p.C<J),t(We<=W);var pt=!1;e:for(;;){for(;pt||Ze<We;){var vt=0;if(ae>=ft){var Zt=Ze-P;t((ft=p).Pb),ft.wd=ft.m,ft.xd=Zt,0<ft.s.ua&&Je(ft.s.Wa,ft.s.vb),ft=ae+qu}if(oe&Ue||(gt=Qr(Re,oe,ae)),t(gt!=null),gt.Qb&&(w[Ze]=gt.qb,pt=!0),!pt)if(ie(ge),gt.jc){vt=ge,Zt=w;var Kt=Ze,_r=gt.pd[M(vt)&Br-1];t(gt.jc),256>_r.g?(H(vt,vt.u+_r.g),Zt[Kt]=_r.value,vt=0):(H(vt,vt.u+_r.g-256),t(256<=_r.value),vt=_r.value),vt==0&&(pt=!0)}else vt=Dr(gt.G[0],gt.H[0],ge);if(ge.h)break;if(pt||256>vt){if(!pt)if(gt.nd)w[Ze]=(gt.qb|vt<<8)>>>0;else{if(ie(ge),pt=Dr(gt.G[1],gt.H[1],ge),ie(ge),Zt=Dr(gt.G[2],gt.H[2],ge),Kt=Dr(gt.G[3],gt.H[3],ge),ge.h)break;w[Ze]=(Kt<<24|pt<<16|vt<<8|Zt)>>>0}if(pt=!1,++Ze,++oe>=R&&(oe=0,++ae,ee!=null&&ae<=J&&!(ae%16)&&ee(p,ae),Be!=null))for(;et<Ze;)vt=w[et++],Be.X[(506832829*vt&4294967295)>>>Be.Mb]=vt}else if(280>vt){if(vt=yn(vt-256,ge),Zt=Dr(gt.G[4],gt.H[4],ge),ie(ge),Zt=wr(R,Zt=yn(Zt,ge)),ge.h)break;if(Ze-P<Zt||W-Ze<vt)break e;for(Kt=0;Kt<vt;++Kt)w[Ze+Kt]=w[Ze+Kt-Zt];for(Ze+=vt,oe+=vt;oe>=R;)oe-=R,++ae,ee!=null&&ae<=J&&!(ae%16)&&ee(p,ae);if(t(Ze<=W),oe&Ue&&(gt=Qr(Re,oe,ae)),Be!=null)for(;et<Ze;)vt=w[et++],Be.X[(506832829*vt&4294967295)>>>Be.Mb]=vt}else{if(!(vt<yt))break e;for(pt=vt-280,t(Be!=null);et<Ze;)vt=w[et++],Be.X[(506832829*vt&4294967295)>>>Be.Mb]=vt;vt=Ze,t(!(pt>>>(Zt=Be).Xa)),w[vt]=Zt.X[pt],pt=!0}pt||t(ge.h==z(ge))}if(p.Pb&&ge.h&&Ze<W)t(p.m.h),p.a=5,p.m=p.wd,p.$=p.xd,0<p.s.ua&&Je(p.s.vb,p.s.Wa);else{if(ge.h)break e;ee?.(p,ae>J?J:ae),p.a=0,p.$=Ze-P}return 1}return p.a=3,0}function Qe(p){t(p!=null),p.vc=null,p.yc=null,p.Ya=null;var w=p.Wa;w!=null&&(w.X=null),p.vb=null,t(p!=null)}function ut(){var p=new gc;return p==null?null:(p.a=0,p.xb=xc,Zn("Predictor","VP8LPredictors"),Zn("Predictor","VP8LPredictors_C"),Zn("PredictorAdd","VP8LPredictorsAdd"),Zn("PredictorAdd","VP8LPredictorsAdd_C"),Ws=yr,j=Qt,q=wt,Z=Vr,ve=ur,Ce=Tn,De=Ur,V.VP8LMapColor32b=jo,V.VP8LMapColor8b=_,p)}function Xe(p,w,P,R,W){var J=1,ee=[p],ae=[w],oe=R.m,ge=R.s,Re=null,Ze=0;e:for(;;){if(P)for(;J&&Ee(oe,1);){var et=ee,We=ae,yt=R,ft=1,Be=yt.m,Ue=yt.gc[yt.ab],gt=Ee(Be,2);if(yt.Oc&1<<gt)J=0;else{switch(yt.Oc|=1<<gt,Ue.hc=gt,Ue.Ea=et[0],Ue.nc=We[0],Ue.K=[null],++yt.ab,t(4>=yt.ab),gt){case 0:case 1:Ue.b=Ee(Be,3)+2,ft=Xe(qt(Ue.Ea,Ue.b),qt(Ue.nc,Ue.b),0,yt,Ue.K),Ue.K=Ue.K[0];break;case 3:var pt,vt=Ee(Be,8)+1,Zt=16<vt?0:4<vt?1:2<vt?2:3;if(et[0]=qt(Ue.Ea,Zt),Ue.b=Zt,pt=ft=Xe(vt,1,0,yt,Ue.K)){var Kt,_r=vt,Yt=Ue,cn=1<<(8>>Yt.b),un=i(cn);if(un==null)pt=0;else{var rn=Yt.K[0],Hr=Yt.w;for(un[0]=Yt.K[0][0],Kt=1;Kt<1*_r;++Kt)un[Kt]=xt(rn[Hr+Kt],un[Kt-1]);for(;Kt<4*cn;++Kt)un[Kt]=0;Yt.K[0]=null,Yt.K[0]=un,pt=1}}ft=pt;break;case 2:break;default:t(0)}J=ft}}if(ee=ee[0],ae=ae[0],J&&Ee(oe,1)&&!(J=1<=(Ze=Ee(oe,4))&&11>=Ze)){R.a=3;break e}var bn;if(bn=J)t:{var kn,Ir,Yn,di=R,sa=ee,wa=ae,mn=Ze,ti=P,ri=di.m,Xn=di.s,ba=[null],Ua=1,Ri=0,Ts=bh[mn];r:for(;;){if(ti&&Ee(ri,1)){var Jn=Ee(ri,3)+2,la=qt(sa,Jn),ls=qt(wa,Jn),Sl=la*ls;if(!Xe(la,ls,0,di,ba))break r;for(ba=ba[0],Xn.xc=Jn,kn=0;kn<Sl;++kn){var Uo=ba[kn]>>8&65535;ba[kn]=Uo,Uo>=Ua&&(Ua=Uo+1)}}if(ri.h)break r;for(Ir=0;5>Ir;++Ir){var vn=Hl[Ir];!Ir&&0<mn&&(vn+=1<<mn),Ri<vn&&(Ri=vn)}var vo=o(Ua*Ts,D),Hu=Ua,Jf=o(Hu,ue);if(Jf==null)var Cs=null;else t(65536>=Hu),Cs=Jf;var Ps=i(Ri);if(Cs==null||Ps==null||vo==null){di.a=1;break r}var Yl=vo;for(kn=Yn=0;kn<Ua;++kn){var Ls=Cs[kn],zo=Ls.G,Xl=Ls.H,bc=0,cs=1,_c=0;for(Ir=0;5>Ir;++Ir){vn=Hl[Ir],zo[Ir]=Yl,Xl[Ir]=Yn,!Ir&&0<mn&&(vn+=1<<mn);a:{var El,qo=vn,kc=di,xo=Ps,Ah=Yl,Qf=Yn,Dn=0,Gs=kc.m,Zf=Ee(Gs,1);if(a(xo,0,0,qo),Zf){var e0=Ee(Gs,1)+1,Vu=Ee(Gs,1),Wu=Ee(Gs,Vu==0?1:8);xo[Wu]=1,e0==2&&(xo[Wu=Ee(Gs,8)]=1);var yo=1}else{var Vn=i(19),ca=Ee(Gs,4)+4;if(19<ca){kc.a=3;var oa=0;break a}for(El=0;El<ca;++El)Vn[Ep[El]]=Ee(Gs,3);var Sc=void 0,$o=void 0,Ec=kc,Lp=Vn,_a=qo,Ku=xo,ou=0,wo=Ec.m,Ys=8,us=o(128,D);n:for(;U(us,0,7,Lp,19);){if(Ee(wo,1)){var lu=2+2*Ee(wo,3);if((Sc=2+Ee(wo,lu))>_a)break n}else Sc=_a;for($o=0;$o<_a&&Sc--;){ie(wo);var Gu=us[0+(127&M(wo))];H(wo,wo.u+Gu.g);var Al=Gu.value;if(16>Al)Ku[$o++]=Al,Al!=0&&(Ys=Al);else{var Nh=Al==16,t0=Al-16,Th=zu[t0],r0=Ee(wo,nu[t0])+Th;if($o+r0>_a)break n;for(var Ch=Nh?Ys:0;0<r0--;)Ku[$o++]=Ch}}ou=1;break n}ou||(Ec.a=3),yo=ou}(yo=yo&&!Gs.h)&&(Dn=U(Ah,Qf,8,xo,qo)),yo&&Dn!=0?oa=Dn:(kc.a=3,oa=0)}if(oa==0)break r;if(cs&&wh[Ir]==1&&(cs=Yl[Yn].g==0),bc+=Yl[Yn].g,Yn+=oa,3>=Ir){var Ac,Yu=Ps[0];for(Ac=1;Ac<vn;++Ac)Ps[Ac]>Yu&&(Yu=Ps[Ac]);_c+=Yu}}if(Ls.nd=cs,Ls.Qb=0,cs&&(Ls.qb=(zo[3][Xl[3]+0].value<<24|zo[1][Xl[1]+0].value<<16|zo[2][Xl[2]+0].value)>>>0,bc==0&&256>zo[0][Xl[0]+0].value&&(Ls.Qb=1,Ls.qb+=zo[0][Xl[0]+0].value<<8)),Ls.jc=!Ls.Qb&&6>_c,Ls.jc){var cu,fs=Ls;for(cu=0;cu<Br;++cu){var Ho=cu,Xs=fs.pd[Ho],Jl=fs.G[0][fs.H[0]+Ho];256<=Jl.value?(Xs.g=Jl.g+256,Xs.value=Jl.value):(Xs.g=0,Xs.value=0,Ho>>=nn(Jl,8,Xs),Ho>>=nn(fs.G[1][fs.H[1]+Ho],16,Xs),Ho>>=nn(fs.G[2][fs.H[2]+Ho],0,Xs),nn(fs.G[3][fs.H[3]+Ho],24,Xs))}}}Xn.vc=ba,Xn.Wb=Ua,Xn.Ya=Cs,Xn.yc=vo,bn=1;break t}bn=0}if(!(J=bn)){R.a=3;break e}if(0<Ze){if(ge.ua=1<<Ze,!Dt(ge.Wa,Ze)){R.a=1,J=0;break e}}else ge.ua=0;var Xu=R,Ju=ee,Ph=ae,Qu=Xu.s,Zu=Qu.xc;if(Xu.c=Ju,Xu.i=Ph,Qu.md=qt(Ju,Zu),Qu.wc=Zu==0?-1:(1<<Zu)-1,P){R.xb=mo;break e}if((Re=i(ee*ae))==null){R.a=1,J=0;break e}J=(J=ke(R,Re,0,ee,ae,ae,null))&&!oe.h;break e}return J?(W!=null?W[0]=Re:(t(Re==null),t(P)),R.$=0,P||Qe(ge)):Qe(ge),J}function rt(p,w){var P=p.c*p.i,R=P+w+16*w;return t(p.c<=w),p.V=i(R),p.V==null?(p.Ta=null,p.Ua=0,p.a=1,0):(p.Ta=p.V,p.Ua=p.Ba+P+w,1)}function nt(p,w){var P=p.C,R=w-P,W=p.V,J=p.Ba+p.c*P;for(t(w<=p.l.o);0<R;){var ee=16<R?16:R,ae=p.l.ma,oe=p.l.width,ge=oe*ee,Re=ae.ca,Ze=ae.tb+oe*P,et=p.Ta,We=p.Ua;X(p,ee,W,J),lr(et,We,Re,Ze,ge),he(ae,P,P+ee,Re,Ze,oe),R-=ee,W+=ee*p.c,P+=ee}t(P==w),p.C=p.Ma=w}function St(){this.ub=this.yd=this.td=this.Rb=0}function zt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function It(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function Lt(){this.Yb=function(){var p=[];return function w(P,R,W){for(var J=W[R],ee=0;ee<J&&(P.push(W.length>R+1?[]:0),!(W.length<R+1));ee++)w(P[ee],R+1,W)}(p,0,[3,11]),p}()}function kt(){this.jb=i(3),this.Wc=l([4,8],Lt),this.Xc=l([4,17],Lt)}function kr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function Kr(){this.ld=this.La=this.dd=this.tc=0}function en(){this.Na=this.la=0}function En(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function ci(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ca(){this.uc=this.M=this.Nb=0,this.wa=Array(new Kr),this.Y=0,this.ya=Array(new ci),this.aa=0,this.l=new Ji}function Ga(){this.y=i(16),this.f=i(8),this.ea=i(8)}function Fn(){this.cb=this.a=0,this.sc="",this.m=new pe,this.Od=new St,this.Kc=new zt,this.ed=new kr,this.Qa=new It,this.Ic=this.$c=this.Aa=0,this.D=new Ca,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,pe),this.ia=0,this.pb=o(4,En),this.Pa=new kt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Ga),this.Hd=0,this.rb=Array(new en),this.sb=0,this.wa=Array(new Kr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new ci),this.L=this.aa=0,this.gd=l([4,2],Kr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Ji(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function pr(){var p=new Fn;return p!=null&&(p.a=0,p.sc="OK",p.cb=0,p.Xb=0,Vl||(Vl=an)),p}function Un(p,w,P){return p.a==0&&(p.a=w,p.sc=P,p.cb=0),0}function Ml(p,w,P){return 3<=P&&p[w+0]==157&&p[w+1]==1&&p[w+2]==42}function Bl(p,w){if(p==null)return 0;if(p.a=0,p.sc="OK",w==null)return Un(p,2,"null VP8Io passed to VP8GetHeaders()");var P=w.data,R=w.w,W=w.ha;if(4>W)return Un(p,7,"Truncated header.");var J=P[R+0]|P[R+1]<<8|P[R+2]<<16,ee=p.Od;if(ee.Rb=!(1&J),ee.td=J>>1&7,ee.yd=J>>4&1,ee.ub=J>>5,3<ee.td)return Un(p,3,"Incorrect keyframe parameters.");if(!ee.yd)return Un(p,4,"Frame not displayable.");R+=3,W-=3;var ae=p.Kc;if(ee.Rb){if(7>W)return Un(p,7,"cannot parse picture header");if(!Ml(P,R,W))return Un(p,3,"Bad code word");ae.c=16383&(P[R+4]<<8|P[R+3]),ae.Td=P[R+4]>>6,ae.i=16383&(P[R+6]<<8|P[R+5]),ae.Ud=P[R+6]>>6,R+=7,W-=7,p.za=ae.c+15>>4,p.Ub=ae.i+15>>4,w.width=ae.c,w.height=ae.i,w.Da=0,w.j=0,w.v=0,w.va=w.width,w.o=w.height,w.da=0,w.ib=w.width,w.hb=w.height,w.U=w.width,w.T=w.height,a((J=p.Pa).jb,0,255,J.jb.length),t((J=p.Qa)!=null),J.Cb=0,J.Bb=0,J.Fb=1,a(J.Zb,0,0,J.Zb.length),a(J.Lb,0,0,J.Lb)}if(ee.ub>W)return Un(p,7,"bad partition length");Te(J=p.m,P,R,ee.ub),R+=ee.ub,W-=ee.ub,ee.Rb&&(ae.Ld=Ae(J),ae.Kd=Ae(J)),ae=p.Qa;var oe,ge=p.Pa;if(t(J!=null),t(ae!=null),ae.Cb=Ae(J),ae.Cb){if(ae.Bb=Ae(J),Ae(J)){for(ae.Fb=Ae(J),oe=0;4>oe;++oe)ae.Zb[oe]=Ae(J)?Le(J,7):0;for(oe=0;4>oe;++oe)ae.Lb[oe]=Ae(J)?Le(J,6):0}if(ae.Bb)for(oe=0;3>oe;++oe)ge.jb[oe]=Ae(J)?Fe(J,8):255}else ae.Bb=0;if(J.Ka)return Un(p,3,"cannot parse segment header");if((ae=p.ed).zd=Ae(J),ae.Tb=Fe(J,6),ae.wb=Fe(J,3),ae.Pc=Ae(J),ae.Pc&&Ae(J)){for(ge=0;4>ge;++ge)Ae(J)&&(ae.vd[ge]=Le(J,6));for(ge=0;4>ge;++ge)Ae(J)&&(ae.od[ge]=Le(J,6))}if(p.L=ae.Tb==0?0:ae.zd?1:2,J.Ka)return Un(p,3,"cannot parse filter header");var Re=W;if(W=oe=R,R=oe+Re,ae=Re,p.Xb=(1<<Fe(p.m,2))-1,Re<3*(ge=p.Xb))P=7;else{for(oe+=3*ge,ae-=3*ge,Re=0;Re<ge;++Re){var Ze=P[W+0]|P[W+1]<<8|P[W+2]<<16;Ze>ae&&(Ze=ae),Te(p.Jc[+Re],P,oe,Ze),oe+=Ze,ae-=Ze,W+=3}Te(p.Jc[+ge],P,oe,ae),P=oe<R?0:5}if(P!=0)return Un(p,P,"cannot parse partitions");for(P=Fe(oe=p.m,7),W=Ae(oe)?Le(oe,4):0,R=Ae(oe)?Le(oe,4):0,ae=Ae(oe)?Le(oe,4):0,ge=Ae(oe)?Le(oe,4):0,oe=Ae(oe)?Le(oe,4):0,Re=p.Qa,Ze=0;4>Ze;++Ze){if(Re.Cb){var et=Re.Zb[Ze];Re.Fb||(et+=P)}else{if(0<Ze){p.pb[Ze]=p.pb[0];continue}et=P}var We=p.pb[Ze];We.Sc[0]=vc[Qa(et+W,127)],We.Sc[1]=au[Qa(et+0,127)],We.Eb[0]=2*vc[Qa(et+R,127)],We.Eb[1]=101581*au[Qa(et+ae,127)]>>16,8>We.Eb[1]&&(We.Eb[1]=8),We.Qc[0]=vc[Qa(et+ge,117)],We.Qc[1]=au[Qa(et+oe,127)],We.lc=et+oe}if(!ee.Rb)return Un(p,4,"Not a key frame.");for(Ae(J),ee=p.Pa,P=0;4>P;++P){for(W=0;8>W;++W)for(R=0;3>R;++R)for(ae=0;11>ae;++ae)ge=de(J,Tp[P][W][R][ae])?Fe(J,8):kh[P][W][R][ae],ee.Wc[P][W].Yb[R][ae]=ge;for(W=0;17>W;++W)ee.Xc[P][W]=ee.Wc[P][Gf[W]]}return p.kc=Ae(J),p.kc&&(p.Bd=Fe(J,8)),p.cb=1}function an(p,w,P,R,W,J,ee){var ae=w[W].Yb[P];for(P=0;16>W;++W){if(!de(p,ae[P+0]))return W;for(;!de(p,ae[P+1]);)if(ae=w[++W].Yb[0],P=0,W==16)return 16;var oe=w[W+1].Yb;if(de(p,ae[P+2])){var ge=p,Re=0;if(de(ge,(et=ae)[(Ze=P)+3]))if(de(ge,et[Ze+6])){for(ae=0,Ze=2*(Re=de(ge,et[Ze+8]))+(et=de(ge,et[Ze+9+Re])),Re=0,et=Wf[Ze];et[ae];++ae)Re+=Re+de(ge,et[ae]);Re+=3+(8<<Ze)}else de(ge,et[Ze+7])?(Re=7+2*de(ge,165),Re+=de(ge,145)):Re=5+de(ge,159);else Re=de(ge,et[Ze+4])?3+de(ge,et[Ze+5]):2;ae=oe[2]}else Re=1,ae=oe[1];oe=ee+Kf[W],0>(ge=p).b&&xe(ge);var Ze,et=ge.b,We=(Ze=ge.Ca>>1)-(ge.I>>et)>>31;--ge.b,ge.Ca+=We,ge.Ca|=1,ge.I-=(Ze+1&We)<<et,J[oe]=((Re^We)-We)*R[(0<W)+0]}return 16}function _i(p){var w=p.rb[p.sb-1];w.la=0,w.Na=0,a(p.zc,0,0,p.zc.length),p.ja=0}function Qi(p,w){if(p==null)return 0;if(w==null)return Un(p,2,"NULL VP8Io parameter in VP8Decode().");if(!p.cb&&!Bl(p,w))return 0;if(t(p.cb),w.ac==null||w.ac(w)){w.ob&&(p.L=0);var P=Gl[p.L];if(p.L==2?(p.yb=0,p.zb=0):(p.yb=w.v-P>>4,p.zb=w.j-P>>4,0>p.yb&&(p.yb=0),0>p.zb&&(p.zb=0)),p.Va=w.o+15+P>>4,p.Hb=w.va+15+P>>4,p.Hb>p.za&&(p.Hb=p.za),p.Va>p.Ub&&(p.Va=p.Ub),0<p.L){var R=p.ed;for(P=0;4>P;++P){var W;if(p.Qa.Cb){var J=p.Qa.Lb[P];p.Qa.Fb||(J+=R.Tb)}else J=R.Tb;for(W=0;1>=W;++W){var ee=p.gd[P][W],ae=J;if(R.Pc&&(ae+=R.vd[0],W&&(ae+=R.od[0])),0<(ae=0>ae?0:63<ae?63:ae)){var oe=ae;0<R.wb&&(oe=4<R.wb?oe>>2:oe>>1)>9-R.wb&&(oe=9-R.wb),1>oe&&(oe=1),ee.dd=oe,ee.tc=2*ae+oe,ee.ld=40<=ae?2:15<=ae?1:0}else ee.tc=0;ee.La=W}}}P=0}else Un(p,6,"Frame setup failed"),P=p.a;if(P=P==0){if(P){p.$c=0,0<p.Aa||(p.Ic=Bo);e:{P=p.Ic,R=4*(oe=p.za);var ge=32*oe,Re=oe+1,Ze=0<p.L?oe*(0<p.Aa?2:1):0,et=(p.Aa==2?2:1)*oe;if((ee=R+832+(W=3*(16*P+Gl[p.L])/2*ge)+(J=p.Fa!=null&&0<p.Fa.length?p.Kc.c*p.Kc.i:0))!=ee)P=0;else{if(ee>p.Vb){if(p.Vb=0,p.Ec=i(ee),p.Fc=0,p.Ec==null){P=Un(p,1,"no memory during frame initialization.");break e}p.Vb=ee}ee=p.Ec,ae=p.Fc,p.Ac=ee,p.Bc=ae,ae+=R,p.Gd=o(ge,Ga),p.Hd=0,p.rb=o(Re+1,en),p.sb=1,p.wa=Ze?o(Ze,Kr):null,p.Y=0,p.D.Nb=0,p.D.wa=p.wa,p.D.Y=p.Y,0<p.Aa&&(p.D.Y+=oe),t(!0),p.oc=ee,p.pc=ae,ae+=832,p.ya=o(et,ci),p.aa=0,p.D.ya=p.ya,p.D.aa=p.aa,p.Aa==2&&(p.D.aa+=oe),p.R=16*oe,p.B=8*oe,oe=(ge=Gl[p.L])*p.R,ge=ge/2*p.B,p.sa=ee,p.ta=ae+oe,p.qa=p.sa,p.ra=p.ta+16*P*p.R+ge,p.Ha=p.qa,p.Ia=p.ra+8*P*p.B+ge,p.$c=0,ae+=W,p.mb=J?ee:null,p.nb=J?ae:null,t(ae+J<=p.Fc+p.Vb),_i(p),a(p.Ac,p.Bc,0,R),P=1}}if(P){if(w.ka=0,w.y=p.sa,w.O=p.ta,w.f=p.qa,w.N=p.ra,w.ea=p.Ha,w.Vd=p.Ia,w.fa=p.R,w.Rc=p.B,w.F=null,w.J=0,!go){for(P=-255;255>=P;++P)tn[255+P]=0>P?-P:P;for(P=-1020;1020>=P;++P)br[1020+P]=-128>P?-128:127<P?127:P;for(P=-112;112>=P;++P)Gn[112+P]=-16>P?-16:15<P?15:P;for(P=-255;510>=P;++P)Hn[255+P]=0>P?0:255<P?255:P;go=1}ze=sn,Ve=so,Ke=Ms,Ie=Co,qe=Po,Ne=hl,Ge=Bs,$e=qn,at=ks,st=Io,ot=Us,ht=uo,Tt=zs,Mt=fo,Ct=as,Rt=Ni,Vt=Ja,Ft=gl,Ns[0]=Si,Ns[1]=dl,Ns[2]=ts,Ns[3]=Xa,Ns[4]=Ei,Ns[5]=ja,Ns[6]=oo,Ns[7]=lo,Ns[8]=pl,Ns[9]=Lo,hi[0]=Ya,hi[1]=pc,hi[2]=zn,hi[3]=ki,hi[4]=Cn,hi[5]=es,hi[6]=gn,Li[0]=ui,Li[1]=Ul,Li[2]=Fo,Li[3]=rs,Li[4]=Oo,Li[5]=bs,Li[6]=zl,P=1}else P=0}P&&(P=function(We,yt){for(We.M=0;We.M<We.Va;++We.M){var ft,Be=We.Jc[We.M&We.Xb],Ue=We.m,gt=We;for(ft=0;ft<gt.za;++ft){var pt=Ue,vt=gt,Zt=vt.Ac,Kt=vt.Bc+4*ft,_r=vt.zc,Yt=vt.ya[vt.aa+ft];if(vt.Qa.Bb?Yt.$b=de(pt,vt.Pa.jb[0])?2+de(pt,vt.Pa.jb[2]):de(pt,vt.Pa.jb[1]):Yt.$b=0,vt.kc&&(Yt.Ad=de(pt,vt.Bd)),Yt.Za=!de(pt,145)+0,Yt.Za){var cn=Yt.Ob,un=0;for(vt=0;4>vt;++vt){var rn,Hr=_r[0+vt];for(rn=0;4>rn;++rn){Hr=Np[Zt[Kt+rn]][Hr];for(var bn=_h[de(pt,Hr[0])];0<bn;)bn=_h[2*bn+de(pt,Hr[bn])];Hr=-bn,Zt[Kt+rn]=Hr}n(cn,un,Zt,Kt,4),un+=4,_r[0+vt]=Hr}}else Hr=de(pt,156)?de(pt,128)?1:3:de(pt,163)?2:0,Yt.Ob[0]=Hr,a(Zt,Kt,Hr,4),a(_r,0,Hr,4);Yt.Dd=de(pt,142)?de(pt,114)?de(pt,183)?1:3:2:0}if(gt.m.Ka)return Un(We,7,"Premature end-of-partition0 encountered.");for(;We.ja<We.za;++We.ja){if(gt=Be,pt=(Ue=We).rb[Ue.sb-1],Zt=Ue.rb[Ue.sb+Ue.ja],ft=Ue.ya[Ue.aa+Ue.ja],Kt=Ue.kc?ft.Ad:0)pt.la=Zt.la=0,ft.Za||(pt.Na=Zt.Na=0),ft.Hc=0,ft.Gc=0,ft.ia=0;else{var kn,Ir;if(pt=Zt,Zt=gt,Kt=Ue.Pa.Xc,_r=Ue.ya[Ue.aa+Ue.ja],Yt=Ue.pb[_r.$b],vt=_r.ad,cn=0,un=Ue.rb[Ue.sb-1],Hr=rn=0,a(vt,cn,0,384),_r.Za)var Yn=0,di=Kt[3];else{bn=i(16);var sa=pt.Na+un.Na;if(sa=Vl(Zt,Kt[1],sa,Yt.Eb,0,bn,0),pt.Na=un.Na=(0<sa)+0,1<sa)ze(bn,0,vt,cn);else{var wa=bn[0]+3>>3;for(bn=0;256>bn;bn+=16)vt[cn+bn]=wa}Yn=1,di=Kt[0]}var mn=15&pt.la,ti=15&un.la;for(bn=0;4>bn;++bn){var ri=1&ti;for(wa=Ir=0;4>wa;++wa)mn=mn>>1|(ri=(sa=Vl(Zt,di,sa=ri+(1&mn),Yt.Sc,Yn,vt,cn))>Yn)<<7,Ir=Ir<<2|(3<sa?3:1<sa?2:vt[cn+0]!=0),cn+=16;mn>>=4,ti=ti>>1|ri<<7,rn=(rn<<8|Ir)>>>0}for(di=mn,Yn=ti>>4,kn=0;4>kn;kn+=2){for(Ir=0,mn=pt.la>>4+kn,ti=un.la>>4+kn,bn=0;2>bn;++bn){for(ri=1&ti,wa=0;2>wa;++wa)sa=ri+(1&mn),mn=mn>>1|(ri=0<(sa=Vl(Zt,Kt[2],sa,Yt.Qc,0,vt,cn)))<<3,Ir=Ir<<2|(3<sa?3:1<sa?2:vt[cn+0]!=0),cn+=16;mn>>=2,ti=ti>>1|ri<<5}Hr|=Ir<<4*kn,di|=mn<<4<<kn,Yn|=(240&ti)<<kn}pt.la=di,un.la=Yn,_r.Hc=rn,_r.Gc=Hr,_r.ia=43690&Hr?0:Yt.ia,Kt=!(rn|Hr)}if(0<Ue.L&&(Ue.wa[Ue.Y+Ue.ja]=Ue.gd[ft.$b][ft.Za],Ue.wa[Ue.Y+Ue.ja].La|=!Kt),gt.Ka)return Un(We,7,"Premature end-of-file encountered.")}if(_i(We),Ue=yt,gt=1,ft=(Be=We).D,pt=0<Be.L&&Be.M>=Be.zb&&Be.M<=Be.Va,Be.Aa==0)e:{if(ft.M=Be.M,ft.uc=pt,xl(Be,ft),gt=1,ft=(Ir=Be.D).Nb,pt=(Hr=Gl[Be.L])*Be.R,Zt=Hr/2*Be.B,bn=16*ft*Be.R,wa=8*ft*Be.B,Kt=Be.sa,_r=Be.ta-pt+bn,Yt=Be.qa,vt=Be.ra-Zt+wa,cn=Be.Ha,un=Be.Ia-Zt+wa,ti=(mn=Ir.M)==0,rn=mn>=Be.Va-1,Be.Aa==2&&xl(Be,Ir),Ir.uc)for(ri=(sa=Be).D.M,t(sa.D.uc),Ir=sa.yb;Ir<sa.Hb;++Ir){Yn=Ir,di=ri;var Xn=(ba=(vn=sa).D).Nb;kn=vn.R;var ba=ba.wa[ba.Y+Yn],Ua=vn.sa,Ri=vn.ta+16*Xn*kn+16*Yn,Ts=ba.dd,Jn=ba.tc;if(Jn!=0)if(t(3<=Jn),vn.L==1)0<Yn&&Rt(Ua,Ri,kn,Jn+4),ba.La&&Ft(Ua,Ri,kn,Jn),0<di&&Ct(Ua,Ri,kn,Jn+4),ba.La&&Vt(Ua,Ri,kn,Jn);else{var la=vn.B,ls=vn.qa,Sl=vn.ra+8*Xn*la+8*Yn,Uo=vn.Ha,vn=vn.Ia+8*Xn*la+8*Yn;Xn=ba.ld,0<Yn&&($e(Ua,Ri,kn,Jn+4,Ts,Xn),st(ls,Sl,Uo,vn,la,Jn+4,Ts,Xn)),ba.La&&(ht(Ua,Ri,kn,Jn,Ts,Xn),Mt(ls,Sl,Uo,vn,la,Jn,Ts,Xn)),0<di&&(Ge(Ua,Ri,kn,Jn+4,Ts,Xn),at(ls,Sl,Uo,vn,la,Jn+4,Ts,Xn)),ba.La&&(ot(Ua,Ri,kn,Jn,Ts,Xn),Tt(ls,Sl,Uo,vn,la,Jn,Ts,Xn))}}if(Be.ia&&alert("todo:DitherRow"),Ue.put!=null){if(Ir=16*mn,mn=16*(mn+1),ti?(Ue.y=Be.sa,Ue.O=Be.ta+bn,Ue.f=Be.qa,Ue.N=Be.ra+wa,Ue.ea=Be.Ha,Ue.W=Be.Ia+wa):(Ir-=Hr,Ue.y=Kt,Ue.O=_r,Ue.f=Yt,Ue.N=vt,Ue.ea=cn,Ue.W=un),rn||(mn-=Hr),mn>Ue.o&&(mn=Ue.o),Ue.F=null,Ue.J=null,Be.Fa!=null&&0<Be.Fa.length&&Ir<mn&&(Ue.J=Ro(Be,Ue,Ir,mn-Ir),Ue.F=Be.mb,Ue.F==null&&Ue.F.length==0)){gt=Un(Be,3,"Could not decode alpha data.");break e}Ir<Ue.j&&(Hr=Ue.j-Ir,Ir=Ue.j,t(!(1&Hr)),Ue.O+=Be.R*Hr,Ue.N+=Be.B*(Hr>>1),Ue.W+=Be.B*(Hr>>1),Ue.F!=null&&(Ue.J+=Ue.width*Hr)),Ir<mn&&(Ue.O+=Ue.v,Ue.N+=Ue.v>>1,Ue.W+=Ue.v>>1,Ue.F!=null&&(Ue.J+=Ue.v),Ue.ka=Ir-Ue.j,Ue.U=Ue.va-Ue.v,Ue.T=mn-Ir,gt=Ue.put(Ue))}ft+1!=Be.Ic||rn||(n(Be.sa,Be.ta-pt,Kt,_r+16*Be.R,pt),n(Be.qa,Be.ra-Zt,Yt,vt+8*Be.B,Zt),n(Be.Ha,Be.Ia-Zt,cn,un+8*Be.B,Zt))}if(!gt)return Un(We,6,"Output aborted.")}return 1}(p,w)),w.bc!=null&&w.bc(w),P&=1}return P?(p.cb=0,P):0}function aa(p,w,P,R,W){W=p[w+P+32*R]+(W>>3),p[w+P+32*R]=-256&W?0>W?0:255:W}function io(p,w,P,R,W,J){aa(p,w,0,P,R+W),aa(p,w,1,P,R+J),aa(p,w,2,P,R-J),aa(p,w,3,P,R-W)}function Pa(p){return(20091*p>>16)+p}function ws(p,w,P,R){var W,J=0,ee=i(16);for(W=0;4>W;++W){var ae=p[w+0]+p[w+8],oe=p[w+0]-p[w+8],ge=(35468*p[w+4]>>16)-Pa(p[w+12]),Re=Pa(p[w+4])+(35468*p[w+12]>>16);ee[J+0]=ae+Re,ee[J+1]=oe+ge,ee[J+2]=oe-ge,ee[J+3]=ae-Re,J+=4,w++}for(W=J=0;4>W;++W)ae=(p=ee[J+0]+4)+ee[J+8],oe=p-ee[J+8],ge=(35468*ee[J+4]>>16)-Pa(ee[J+12]),aa(P,R,0,0,ae+(Re=Pa(ee[J+4])+(35468*ee[J+12]>>16))),aa(P,R,1,0,oe+ge),aa(P,R,2,0,oe-ge),aa(P,R,3,0,ae-Re),J++,R+=32}function hl(p,w,P,R){var W=p[w+0]+4,J=35468*p[w+4]>>16,ee=Pa(p[w+4]),ae=35468*p[w+1]>>16;io(P,R,0,W+ee,p=Pa(p[w+1]),ae),io(P,R,1,W+J,p,ae),io(P,R,2,W-J,p,ae),io(P,R,3,W-ee,p,ae)}function so(p,w,P,R,W){ws(p,w,P,R),W&&ws(p,w+16,P,R+4)}function Ms(p,w,P,R){Ve(p,w+0,P,R,1),Ve(p,w+32,P,R+128,1)}function Co(p,w,P,R){var W;for(p=p[w+0]+4,W=0;4>W;++W)for(w=0;4>w;++w)aa(P,R,w,W,p)}function Po(p,w,P,R){p[w+0]&&Ie(p,w+0,P,R),p[w+16]&&Ie(p,w+16,P,R+4),p[w+32]&&Ie(p,w+32,P,R+128),p[w+48]&&Ie(p,w+48,P,R+128+4)}function sn(p,w,P,R){var W,J=i(16);for(W=0;4>W;++W){var ee=p[w+0+W]+p[w+12+W],ae=p[w+4+W]+p[w+8+W],oe=p[w+4+W]-p[w+8+W],ge=p[w+0+W]-p[w+12+W];J[0+W]=ee+ae,J[8+W]=ee-ae,J[4+W]=ge+oe,J[12+W]=ge-oe}for(W=0;4>W;++W)ee=(p=J[0+4*W]+3)+J[3+4*W],ae=J[1+4*W]+J[2+4*W],oe=J[1+4*W]-J[2+4*W],ge=p-J[3+4*W],P[R+0]=ee+ae>>3,P[R+16]=ge+oe>>3,P[R+32]=ee-ae>>3,P[R+48]=ge-oe>>3,R+=64}function Gr(p,w,P){var R,W=w-32,J=ya,ee=255-p[W-1];for(R=0;R<P;++R){var ae,oe=J,ge=ee+p[w-1];for(ae=0;ae<P;++ae)p[w+ae]=oe[ge+p[W+ae]];w+=32}}function dl(p,w){Gr(p,w,4)}function Ul(p,w){Gr(p,w,8)}function pc(p,w){Gr(p,w,16)}function zn(p,w){var P;for(P=0;16>P;++P)n(p,w+32*P,p,w-32,16)}function ki(p,w){var P;for(P=16;0<P;--P)a(p,w,p[w-1],16),w+=32}function Zi(p,w,P){var R;for(R=0;16>R;++R)a(w,P+32*R,p,16)}function Ya(p,w){var P,R=16;for(P=0;16>P;++P)R+=p[w-1+32*P]+p[w+P-32];Zi(R>>5,p,w)}function Cn(p,w){var P,R=8;for(P=0;16>P;++P)R+=p[w-1+32*P];Zi(R>>4,p,w)}function es(p,w){var P,R=8;for(P=0;16>P;++P)R+=p[w+P-32];Zi(R>>4,p,w)}function gn(p,w){Zi(128,p,w)}function fr(p,w,P){return p+2*w+P+2>>2}function ts(p,w){var P,R=w-32;for(R=new Uint8Array([fr(p[R-1],p[R+0],p[R+1]),fr(p[R+0],p[R+1],p[R+2]),fr(p[R+1],p[R+2],p[R+3]),fr(p[R+2],p[R+3],p[R+4])]),P=0;4>P;++P)n(p,w+32*P,R,0,R.length)}function Xa(p,w){var P=p[w-1],R=p[w-1+32],W=p[w-1+64],J=p[w-1+96];Me(p,w+0,16843009*fr(p[w-1-32],P,R)),Me(p,w+32,16843009*fr(P,R,W)),Me(p,w+64,16843009*fr(R,W,J)),Me(p,w+96,16843009*fr(W,J,J))}function Si(p,w){var P,R=4;for(P=0;4>P;++P)R+=p[w+P-32]+p[w-1+32*P];for(R>>=3,P=0;4>P;++P)a(p,w+32*P,R,4)}function Ei(p,w){var P=p[w-1+0],R=p[w-1+32],W=p[w-1+64],J=p[w-1-32],ee=p[w+0-32],ae=p[w+1-32],oe=p[w+2-32],ge=p[w+3-32];p[w+0+96]=fr(R,W,p[w-1+96]),p[w+1+96]=p[w+0+64]=fr(P,R,W),p[w+2+96]=p[w+1+64]=p[w+0+32]=fr(J,P,R),p[w+3+96]=p[w+2+64]=p[w+1+32]=p[w+0+0]=fr(ee,J,P),p[w+3+64]=p[w+2+32]=p[w+1+0]=fr(ae,ee,J),p[w+3+32]=p[w+2+0]=fr(oe,ae,ee),p[w+3+0]=fr(ge,oe,ae)}function oo(p,w){var P=p[w+1-32],R=p[w+2-32],W=p[w+3-32],J=p[w+4-32],ee=p[w+5-32],ae=p[w+6-32],oe=p[w+7-32];p[w+0+0]=fr(p[w+0-32],P,R),p[w+1+0]=p[w+0+32]=fr(P,R,W),p[w+2+0]=p[w+1+32]=p[w+0+64]=fr(R,W,J),p[w+3+0]=p[w+2+32]=p[w+1+64]=p[w+0+96]=fr(W,J,ee),p[w+3+32]=p[w+2+64]=p[w+1+96]=fr(J,ee,ae),p[w+3+64]=p[w+2+96]=fr(ee,ae,oe),p[w+3+96]=fr(ae,oe,oe)}function ja(p,w){var P=p[w-1+0],R=p[w-1+32],W=p[w-1+64],J=p[w-1-32],ee=p[w+0-32],ae=p[w+1-32],oe=p[w+2-32],ge=p[w+3-32];p[w+0+0]=p[w+1+64]=J+ee+1>>1,p[w+1+0]=p[w+2+64]=ee+ae+1>>1,p[w+2+0]=p[w+3+64]=ae+oe+1>>1,p[w+3+0]=oe+ge+1>>1,p[w+0+96]=fr(W,R,P),p[w+0+64]=fr(R,P,J),p[w+0+32]=p[w+1+96]=fr(P,J,ee),p[w+1+32]=p[w+2+96]=fr(J,ee,ae),p[w+2+32]=p[w+3+96]=fr(ee,ae,oe),p[w+3+32]=fr(ae,oe,ge)}function lo(p,w){var P=p[w+0-32],R=p[w+1-32],W=p[w+2-32],J=p[w+3-32],ee=p[w+4-32],ae=p[w+5-32],oe=p[w+6-32],ge=p[w+7-32];p[w+0+0]=P+R+1>>1,p[w+1+0]=p[w+0+64]=R+W+1>>1,p[w+2+0]=p[w+1+64]=W+J+1>>1,p[w+3+0]=p[w+2+64]=J+ee+1>>1,p[w+0+32]=fr(P,R,W),p[w+1+32]=p[w+0+96]=fr(R,W,J),p[w+2+32]=p[w+1+96]=fr(W,J,ee),p[w+3+32]=p[w+2+96]=fr(J,ee,ae),p[w+3+64]=fr(ee,ae,oe),p[w+3+96]=fr(ae,oe,ge)}function Lo(p,w){var P=p[w-1+0],R=p[w-1+32],W=p[w-1+64],J=p[w-1+96];p[w+0+0]=P+R+1>>1,p[w+2+0]=p[w+0+32]=R+W+1>>1,p[w+2+32]=p[w+0+64]=W+J+1>>1,p[w+1+0]=fr(P,R,W),p[w+3+0]=p[w+1+32]=fr(R,W,J),p[w+3+32]=p[w+1+64]=fr(W,J,J),p[w+3+64]=p[w+2+64]=p[w+0+96]=p[w+1+96]=p[w+2+96]=p[w+3+96]=J}function pl(p,w){var P=p[w-1+0],R=p[w-1+32],W=p[w-1+64],J=p[w-1+96],ee=p[w-1-32],ae=p[w+0-32],oe=p[w+1-32],ge=p[w+2-32];p[w+0+0]=p[w+2+32]=P+ee+1>>1,p[w+0+32]=p[w+2+64]=R+P+1>>1,p[w+0+64]=p[w+2+96]=W+R+1>>1,p[w+0+96]=J+W+1>>1,p[w+3+0]=fr(ae,oe,ge),p[w+2+0]=fr(ee,ae,oe),p[w+1+0]=p[w+3+32]=fr(P,ee,ae),p[w+1+32]=p[w+3+64]=fr(R,P,ee),p[w+1+64]=p[w+3+96]=fr(W,R,P),p[w+1+96]=fr(J,W,R)}function Fo(p,w){var P;for(P=0;8>P;++P)n(p,w+32*P,p,w-32,8)}function rs(p,w){var P;for(P=0;8>P;++P)a(p,w,p[w-1],8),w+=32}function Ai(p,w,P){var R;for(R=0;8>R;++R)a(w,P+32*R,p,8)}function ui(p,w){var P,R=8;for(P=0;8>P;++P)R+=p[w+P-32]+p[w-1+32*P];Ai(R>>4,p,w)}function bs(p,w){var P,R=4;for(P=0;8>P;++P)R+=p[w+P-32];Ai(R>>3,p,w)}function Oo(p,w){var P,R=4;for(P=0;8>P;++P)R+=p[w-1+32*P];Ai(R>>3,p,w)}function zl(p,w){Ai(128,p,w)}function ns(p,w,P){var R=p[w-P],W=p[w+0],J=3*(W-R)+Pn[1020+p[w-2*P]-p[w+P]],ee=Pi[112+(J+4>>3)];p[w-P]=ya[255+R+Pi[112+(J+3>>3)]],p[w+0]=ya[255+W-ee]}function _s(p,w,P,R){var W=p[w+0],J=p[w+P];return As[255+p[w-2*P]-p[w-P]]>R||As[255+J-W]>R}function co(p,w,P,R){return 4*As[255+p[w-P]-p[w+0]]+As[255+p[w-2*P]-p[w+P]]<=R}function ql(p,w,P,R,W){var J=p[w-3*P],ee=p[w-2*P],ae=p[w-P],oe=p[w+0],ge=p[w+P],Re=p[w+2*P],Ze=p[w+3*P];return 4*As[255+ae-oe]+As[255+ee-ge]>R?0:As[255+p[w-4*P]-J]<=W&&As[255+J-ee]<=W&&As[255+ee-ae]<=W&&As[255+Ze-Re]<=W&&As[255+Re-ge]<=W&&As[255+ge-oe]<=W}function as(p,w,P,R){var W=2*R+1;for(R=0;16>R;++R)co(p,w+R,P,W)&&ns(p,w+R,P)}function Ni(p,w,P,R){var W=2*R+1;for(R=0;16>R;++R)co(p,w+R*P,1,W)&&ns(p,w+R*P,1)}function Ja(p,w,P,R){var W;for(W=3;0<W;--W)as(p,w+=4*P,P,R)}function gl(p,w,P,R){var W;for(W=3;0<W;--W)Ni(p,w+=4,P,R)}function Ti(p,w,P,R,W,J,ee,ae){for(J=2*J+1;0<W--;){if(ql(p,w,P,J,ee))if(_s(p,w,P,ae))ns(p,w,P);else{var oe=p,ge=w,Re=P,Ze=oe[ge-2*Re],et=oe[ge-Re],We=oe[ge+0],yt=oe[ge+Re],ft=oe[ge+2*Re],Be=27*(gt=Pn[1020+3*(We-et)+Pn[1020+Ze-yt]])+63>>7,Ue=18*gt+63>>7,gt=9*gt+63>>7;oe[ge-3*Re]=ya[255+oe[ge-3*Re]+gt],oe[ge-2*Re]=ya[255+Ze+Ue],oe[ge-Re]=ya[255+et+Be],oe[ge+0]=ya[255+We-Be],oe[ge+Re]=ya[255+yt-Ue],oe[ge+2*Re]=ya[255+ft-gt]}w+=R}}function ma(p,w,P,R,W,J,ee,ae){for(J=2*J+1;0<W--;){if(ql(p,w,P,J,ee))if(_s(p,w,P,ae))ns(p,w,P);else{var oe=p,ge=w,Re=P,Ze=oe[ge-Re],et=oe[ge+0],We=oe[ge+Re],yt=Pi[112+((ft=3*(et-Ze))+4>>3)],ft=Pi[112+(ft+3>>3)],Be=yt+1>>1;oe[ge-2*Re]=ya[255+oe[ge-2*Re]+Be],oe[ge-Re]=ya[255+Ze+ft],oe[ge+0]=ya[255+et-yt],oe[ge+Re]=ya[255+We-Be]}w+=R}}function Bs(p,w,P,R,W,J){Ti(p,w,P,1,16,R,W,J)}function qn(p,w,P,R,W,J){Ti(p,w,1,P,16,R,W,J)}function Us(p,w,P,R,W,J){var ee;for(ee=3;0<ee;--ee)ma(p,w+=4*P,P,1,16,R,W,J)}function uo(p,w,P,R,W,J){var ee;for(ee=3;0<ee;--ee)ma(p,w+=4,1,P,16,R,W,J)}function ks(p,w,P,R,W,J,ee,ae){Ti(p,w,W,1,8,J,ee,ae),Ti(P,R,W,1,8,J,ee,ae)}function Io(p,w,P,R,W,J,ee,ae){Ti(p,w,1,W,8,J,ee,ae),Ti(P,R,1,W,8,J,ee,ae)}function zs(p,w,P,R,W,J,ee,ae){ma(p,w+4*W,W,1,8,J,ee,ae),ma(P,R+4*W,W,1,8,J,ee,ae)}function fo(p,w,P,R,W,J,ee,ae){ma(p,w+4,1,W,8,J,ee,ae),ma(P,R+4,1,W,8,J,ee,ae)}function Ci(){this.ba=new Bn,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Fr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function On(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Ss(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function ho(){this.ua=0,this.Wa=new we,this.vb=new we,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new ue,this.yc=new D}function gc(){this.xb=this.a=0,this.l=new Ji,this.ca=new Bn,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new C,this.Pb=0,this.wd=new C,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new ho,this.ab=0,this.gc=o(4,Ss),this.Oc=0}function qs(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Ji,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Es(p,w,P,R,W,J,ee){for(p=p==null?0:p[w+0],w=0;w<ee;++w)W[J+w]=p+P[R+w]&255,p=W[J+w]}function ml(p,w,P,R,W,J,ee){var ae;if(p==null)Es(null,null,P,R,W,J,ee);else for(ae=0;ae<ee;++ae)W[J+ae]=p[w+ae]+P[R+ae]&255}function is(p,w,P,R,W,J,ee){if(p==null)Es(null,null,P,R,W,J,ee);else{var ae,oe=p[w+0],ge=oe,Re=oe;for(ae=0;ae<ee;++ae)ge=Re+(oe=p[w+ae])-ge,Re=P[R+ae]+(-256&ge?0>ge?0:255:ge)&255,ge=oe,W[J+ae]=Re}}function Ro(p,w,P,R){var W=w.width,J=w.o;if(t(p!=null&&w!=null),0>P||0>=R||P+R>J)return null;if(!p.Cc){if(p.ga==null){var ee;if(p.ga=new qs,(ee=p.ga==null)||(ee=w.width*w.o,t(p.Gb.length==0),p.Gb=i(ee),p.Uc=0,p.Gb==null?ee=0:(p.mb=p.Gb,p.nb=p.Uc,p.rc=null,ee=1),ee=!ee),!ee){ee=p.ga;var ae=p.Fa,oe=p.P,ge=p.qc,Re=p.mb,Ze=p.nb,et=oe+1,We=ge-1,yt=ee.l;if(t(ae!=null&&Re!=null&&w!=null),ei[0]=null,ei[1]=Es,ei[2]=ml,ei[3]=is,ee.ca=Re,ee.tb=Ze,ee.c=w.width,ee.i=w.height,t(0<ee.c&&0<ee.i),1>=ge)w=0;else if(ee.$a=ae[oe+0]>>0&3,ee.Z=ae[oe+0]>>2&3,ee.Lc=ae[oe+0]>>4&3,oe=ae[oe+0]>>6&3,0>ee.$a||1<ee.$a||4<=ee.Z||1<ee.Lc||oe)w=0;else if(yt.put=ln,yt.ac=Jr,yt.bc=Sn,yt.ma=ee,yt.width=w.width,yt.height=w.height,yt.Da=w.Da,yt.v=w.v,yt.va=w.va,yt.j=w.j,yt.o=w.o,ee.$a)e:{t(ee.$a==1),w=ut();t:for(;;){if(w==null){w=0;break e}if(t(ee!=null),ee.mc=w,w.c=ee.c,w.i=ee.i,w.l=ee.l,w.l.ma=ee,w.l.width=ee.c,w.l.height=ee.i,w.a=0,me(w.m,ae,et,We),!Xe(ee.c,ee.i,1,w,null)||(w.ab==1&&w.gc[0].hc==3&&fe(w.s)?(ee.ic=1,ae=w.c*w.i,w.Ta=null,w.Ua=0,w.V=i(ae),w.Ba=0,w.V==null?(w.a=1,w=0):w=1):(ee.ic=0,w=rt(w,ee.c)),!w))break t;w=1;break e}ee.mc=null,w=0}else w=We>=ee.c*ee.i;ee=!w}if(ee)return null;p.ga.Lc!=1?p.Ga=0:R=J-P}t(p.ga!=null),t(P+R<=J);e:{if(w=(ae=p.ga).c,J=ae.l.o,ae.$a==0){if(et=p.rc,We=p.Vc,yt=p.Fa,oe=p.P+1+P*w,ge=p.mb,Re=p.nb+P*w,t(oe<=p.P+p.qc),ae.Z!=0)for(t(ei[ae.Z]!=null),ee=0;ee<R;++ee)ei[ae.Z](et,We,yt,oe,ge,Re,w),et=ge,We=Re,Re+=w,oe+=w;else for(ee=0;ee<R;++ee)n(ge,Re,yt,oe,w),et=ge,We=Re,Re+=w,oe+=w;p.rc=et,p.Vc=We}else{if(t(ae.mc!=null),w=P+R,t((ee=ae.mc)!=null),t(w<=ee.i),ee.C>=w)w=1;else if(ae.ic||Ye(),ae.ic){ae=ee.V,et=ee.Ba,We=ee.c;var ft=ee.i,Be=(yt=1,oe=ee.$/We,ge=ee.$%We,Re=ee.m,Ze=ee.s,ee.$),Ue=We*ft,gt=We*w,pt=Ze.wc,vt=Be<gt?Qr(Ze,ge,oe):null;t(Be<=Ue),t(w<=ft),t(fe(Ze));t:for(;;){for(;!Re.h&&Be<gt;){if(ge&pt||(vt=Qr(Ze,ge,oe)),t(vt!=null),ie(Re),256>(ft=Dr(vt.G[0],vt.H[0],Re)))ae[et+Be]=ft,++Be,++ge>=We&&(ge=0,++oe<=w&&!(oe%16)&&_e(ee,oe));else{if(!(280>ft)){yt=0;break t}ft=yn(ft-256,Re);var Zt,Kt=Dr(vt.G[4],vt.H[4],Re);if(ie(Re),!(Be>=(Kt=wr(We,Kt=yn(Kt,Re)))&&Ue-Be>=ft)){yt=0;break t}for(Zt=0;Zt<ft;++Zt)ae[et+Be+Zt]=ae[et+Be+Zt-Kt];for(Be+=ft,ge+=ft;ge>=We;)ge-=We,++oe<=w&&!(oe%16)&&_e(ee,oe);Be<gt&&ge&pt&&(vt=Qr(Ze,ge,oe))}t(Re.h==z(Re))}_e(ee,oe>w?w:oe);break t}!yt||Re.h&&Be<Ue?(yt=0,ee.a=Re.h?5:3):ee.$=Be,w=yt}else w=ke(ee,ee.V,ee.Ba,ee.c,ee.i,w,nt);if(!w){R=0;break e}}P+R>=J&&(p.Cc=1),R=1}if(!R)return null;if(p.Cc&&((R=p.ga)!=null&&(R.mc=null),p.ga=null,0<p.Ga))return alert("todo:WebPDequantizeLevels"),null}return p.nb+P*W}function S(p,w,P,R,W,J){for(;0<W--;){var ee,ae=p,oe=w+(P?1:0),ge=p,Re=w+(P?0:3);for(ee=0;ee<R;++ee){var Ze=ge[Re+4*ee];Ze!=255&&(Ze*=32897,ae[oe+4*ee+0]=ae[oe+4*ee+0]*Ze>>23,ae[oe+4*ee+1]=ae[oe+4*ee+1]*Ze>>23,ae[oe+4*ee+2]=ae[oe+4*ee+2]*Ze>>23)}w+=J}}function G(p,w,P,R,W){for(;0<R--;){var J;for(J=0;J<P;++J){var ee=p[w+2*J+0],ae=15&(ge=p[w+2*J+1]),oe=4369*ae,ge=(240&ge|ge>>4)*oe>>16;p[w+2*J+0]=(240&ee|ee>>4)*oe>>16&240|(15&ee|ee<<4)*oe>>16>>4&15,p[w+2*J+1]=240&ge|ae}w+=W}}function Se(p,w,P,R,W,J,ee,ae){var oe,ge,Re=255;for(ge=0;ge<W;++ge){for(oe=0;oe<R;++oe){var Ze=p[w+oe];J[ee+4*oe]=Ze,Re&=Ze}w+=P,ee+=ae}return Re!=255}function Oe(p,w,P,R,W){var J;for(J=0;J<W;++J)P[R+J]=p[w+J]>>8}function Ye(){Wt=S,er=G,tr=Se,lr=Oe}function dt(p,w,P){V[p]=function(R,W,J,ee,ae,oe,ge,Re,Ze,et,We,yt,ft,Be,Ue,gt,pt){var vt,Zt=pt-1>>1,Kt=ae[oe+0]|ge[Re+0]<<16,_r=Ze[et+0]|We[yt+0]<<16;t(R!=null);var Yt=3*Kt+_r+131074>>2;for(w(R[W+0],255&Yt,Yt>>16,ft,Be),J!=null&&(Yt=3*_r+Kt+131074>>2,w(J[ee+0],255&Yt,Yt>>16,Ue,gt)),vt=1;vt<=Zt;++vt){var cn=ae[oe+vt]|ge[Re+vt]<<16,un=Ze[et+vt]|We[yt+vt]<<16,rn=Kt+cn+_r+un+524296,Hr=rn+2*(cn+_r)>>3;Yt=Hr+Kt>>1,Kt=(rn=rn+2*(Kt+un)>>3)+cn>>1,w(R[W+2*vt-1],255&Yt,Yt>>16,ft,Be+(2*vt-1)*P),w(R[W+2*vt-0],255&Kt,Kt>>16,ft,Be+(2*vt-0)*P),J!=null&&(Yt=rn+_r>>1,Kt=Hr+un>>1,w(J[ee+2*vt-1],255&Yt,Yt>>16,Ue,gt+(2*vt-1)*P),w(J[ee+2*vt+0],255&Kt,Kt>>16,Ue,gt+(2*vt+0)*P)),Kt=cn,_r=un}1&pt||(Yt=3*Kt+_r+131074>>2,w(R[W+pt-1],255&Yt,Yt>>16,ft,Be+(pt-1)*P),J!=null&&(Yt=3*_r+Kt+131074>>2,w(J[ee+pt-1],255&Yt,Yt>>16,Ue,gt+(pt-1)*P)))}}function Nt(){Fi[Bu]=Cp,Fi[bl]=_l,Fi[yh]=Pp,Fi[Zc]=yc,Fi[eu]=Wl,Fi[An]=iu,Fi[Uu]=Yf,Fi[mc]=_l,Fi[$l]=yc,Fi[tu]=Wl,Fi[ru]=iu}function Xt(p){return p&-16384?0>p?0:255:p>>kl}function hr(p,w){return Xt((19077*p>>8)+(26149*w>>8)-14234)}function jr(p,w,P){return Xt((19077*p>>8)-(6419*w>>8)-(13320*P>>8)+8708)}function Ar(p,w){return Xt((19077*p>>8)+(33050*w>>8)-17685)}function Yr(p,w,P,R,W){R[W+0]=hr(p,P),R[W+1]=jr(p,w,P),R[W+2]=Ar(p,w)}function In(p,w,P,R,W){R[W+0]=Ar(p,w),R[W+1]=jr(p,w,P),R[W+2]=hr(p,P)}function Rn(p,w,P,R,W){var J=jr(p,w,P);w=J<<3&224|Ar(p,w)>>3,R[W+0]=248&hr(p,P)|J>>5,R[W+1]=w}function ea(p,w,P,R,W){var J=240&Ar(p,w)|15;R[W+0]=240&hr(p,P)|jr(p,w,P)>>4,R[W+1]=J}function va(p,w,P,R,W){R[W+0]=255,Yr(p,w,P,R,W+1)}function ia(p,w,P,R,W){In(p,w,P,R,W),R[W+3]=255}function ss(p,w,P,R,W){Yr(p,w,P,R,W),R[W+3]=255}function Qa(p,w){return 0>p?0:p>w?w:p}function Za(p,w,P){V[p]=function(R,W,J,ee,ae,oe,ge,Re,Ze){for(var et=Re+(-2&Ze)*P;Re!=et;)w(R[W+0],J[ee+0],ae[oe+0],ge,Re),w(R[W+1],J[ee+0],ae[oe+0],ge,Re+P),W+=2,++ee,++oe,Re+=2*P;1&Ze&&w(R[W+0],J[ee+0],ae[oe+0],ge,Re)}}function $s(p,w,P){return P==0?p==0?w==0?6:5:w==0?4:0:P}function vl(p,w,P,R,W){switch(p>>>30){case 3:Ve(w,P,R,W,0);break;case 2:Ne(w,P,R,W);break;case 1:Ie(w,P,R,W)}}function xl(p,w){var P,R,W=w.M,J=w.Nb,ee=p.oc,ae=p.pc+40,oe=p.oc,ge=p.pc+584,Re=p.oc,Ze=p.pc+600;for(P=0;16>P;++P)ee[ae+32*P-1]=129;for(P=0;8>P;++P)oe[ge+32*P-1]=129,Re[Ze+32*P-1]=129;for(0<W?ee[ae-1-32]=oe[ge-1-32]=Re[Ze-1-32]=129:(a(ee,ae-32-1,127,21),a(oe,ge-32-1,127,9),a(Re,Ze-32-1,127,9)),R=0;R<p.za;++R){var et=w.ya[w.aa+R];if(0<R){for(P=-1;16>P;++P)n(ee,ae+32*P-4,ee,ae+32*P+12,4);for(P=-1;8>P;++P)n(oe,ge+32*P-4,oe,ge+32*P+4,4),n(Re,Ze+32*P-4,Re,Ze+32*P+4,4)}var We=p.Gd,yt=p.Hd+R,ft=et.ad,Be=et.Hc;if(0<W&&(n(ee,ae-32,We[yt].y,0,16),n(oe,ge-32,We[yt].f,0,8),n(Re,Ze-32,We[yt].ea,0,8)),et.Za){var Ue=ee,gt=ae-32+16;for(0<W&&(R>=p.za-1?a(Ue,gt,We[yt].y[15],4):n(Ue,gt,We[yt+1].y,0,4)),P=0;4>P;P++)Ue[gt+128+P]=Ue[gt+256+P]=Ue[gt+384+P]=Ue[gt+0+P];for(P=0;16>P;++P,Be<<=2)Ue=ee,gt=ae+Xf[P],Ns[et.Ob[P]](Ue,gt),vl(Be,ft,16*+P,Ue,gt)}else if(Ue=$s(R,W,et.Ob[0]),hi[Ue](ee,ae),Be!=0)for(P=0;16>P;++P,Be<<=2)vl(Be,ft,16*+P,ee,ae+Xf[P]);for(P=et.Gc,Ue=$s(R,W,et.Dd),Li[Ue](oe,ge),Li[Ue](Re,Ze),Be=ft,Ue=oe,gt=ge,255&(et=P>>0)&&(170&et?Ke(Be,256,Ue,gt):qe(Be,256,Ue,gt)),et=Re,Be=Ze,255&(P>>=8)&&(170&P?Ke(ft,320,et,Be):qe(ft,320,et,Be)),W<p.Ub-1&&(n(We[yt].y,0,ee,ae+480,16),n(We[yt].f,0,oe,ge+224,8),n(We[yt].ea,0,Re,Ze+224,8)),P=8*J*p.B,We=p.sa,yt=p.ta+16*R+16*J*p.R,ft=p.qa,et=p.ra+8*R+P,Be=p.Ha,Ue=p.Ia+8*R+P,P=0;16>P;++P)n(We,yt+P*p.R,ee,ae+32*P,16);for(P=0;8>P;++P)n(ft,et+P*p.B,oe,ge+32*P,8),n(Be,Ue+P*p.B,Re,Ze+32*P,8)}}function Do(p,w,P,R,W,J,ee,ae,oe){var ge=[0],Re=[0],Ze=0,et=oe!=null?oe.kd:0,We=oe??new On;if(p==null||12>P)return 7;We.data=p,We.w=w,We.ha=P,w=[w],P=[P],We.gb=[We.gb];e:{var yt=w,ft=P,Be=We.gb;if(t(p!=null),t(ft!=null),t(Be!=null),Be[0]=0,12<=ft[0]&&!r(p,yt[0],"RIFF")){if(r(p,yt[0]+8,"WEBP")){Be=3;break e}var Ue=bt(p,yt[0]+4);if(12>Ue||4294967286<Ue){Be=3;break e}if(et&&Ue>ft[0]-8){Be=7;break e}Be[0]=Ue,yt[0]+=12,ft[0]-=12}Be=0}if(Be!=0)return Be;for(Ue=0<We.gb[0],P=P[0];;){e:{var gt=p;ft=w,Be=P;var pt=ge,vt=Re,Zt=yt=[0];if((Yt=Ze=[Ze])[0]=0,8>Be[0])Be=7;else{if(!r(gt,ft[0],"VP8X")){if(bt(gt,ft[0]+4)!=10){Be=3;break e}if(18>Be[0]){Be=7;break e}var Kt=bt(gt,ft[0]+8),_r=1+se(gt,ft[0]+12);if(2147483648<=_r*(gt=1+se(gt,ft[0]+15))){Be=3;break e}Zt!=null&&(Zt[0]=Kt),pt!=null&&(pt[0]=_r),vt!=null&&(vt[0]=gt),ft[0]+=18,Be[0]-=18,Yt[0]=1}Be=0}}if(Ze=Ze[0],yt=yt[0],Be!=0)return Be;if(ft=!!(2&yt),!Ue&&Ze)return 3;if(J!=null&&(J[0]=!!(16&yt)),ee!=null&&(ee[0]=ft),ae!=null&&(ae[0]=0),ee=ge[0],yt=Re[0],Ze&&ft&&oe==null){Be=0;break}if(4>P){Be=7;break}if(Ue&&Ze||!Ue&&!Ze&&!r(p,w[0],"ALPH")){P=[P],We.na=[We.na],We.P=[We.P],We.Sa=[We.Sa];e:{Kt=p,Be=w,Ue=P;var Yt=We.gb;pt=We.na,vt=We.P,Zt=We.Sa,_r=22,t(Kt!=null),t(Ue!=null),gt=Be[0];var cn=Ue[0];for(t(pt!=null),t(Zt!=null),pt[0]=null,vt[0]=null,Zt[0]=0;;){if(Be[0]=gt,Ue[0]=cn,8>cn){Be=7;break e}var un=bt(Kt,gt+4);if(4294967286<un){Be=3;break e}var rn=8+un+1&-2;if(_r+=rn,0<Yt&&_r>Yt){Be=3;break e}if(!r(Kt,gt,"VP8 ")||!r(Kt,gt,"VP8L")){Be=0;break e}if(cn[0]<rn){Be=7;break e}r(Kt,gt,"ALPH")||(pt[0]=Kt,vt[0]=gt+8,Zt[0]=un),gt+=rn,cn-=rn}}if(P=P[0],We.na=We.na[0],We.P=We.P[0],We.Sa=We.Sa[0],Be!=0)break}P=[P],We.Ja=[We.Ja],We.xa=[We.xa];e:if(Yt=p,Be=w,Ue=P,pt=We.gb[0],vt=We.Ja,Zt=We.xa,Kt=Be[0],gt=!r(Yt,Kt,"VP8 "),_r=!r(Yt,Kt,"VP8L"),t(Yt!=null),t(Ue!=null),t(vt!=null),t(Zt!=null),8>Ue[0])Be=7;else{if(gt||_r){if(Yt=bt(Yt,Kt+4),12<=pt&&Yt>pt-12){Be=3;break e}if(et&&Yt>Ue[0]-8){Be=7;break e}vt[0]=Yt,Be[0]+=8,Ue[0]-=8,Zt[0]=_r}else Zt[0]=5<=Ue[0]&&Yt[Kt+0]==47&&!(Yt[Kt+4]>>5),vt[0]=Ue[0];Be=0}if(P=P[0],We.Ja=We.Ja[0],We.xa=We.xa[0],w=w[0],Be!=0)break;if(4294967286<We.Ja)return 3;if(ae==null||ft||(ae[0]=We.xa?2:1),ee=[ee],yt=[yt],We.xa){if(5>P){Be=7;break}ae=ee,et=yt,ft=J,p==null||5>P?p=0:5<=P&&p[w+0]==47&&!(p[w+4]>>5)?(Ue=[0],Yt=[0],pt=[0],me(vt=new C,p,w,P),Gt(vt,Ue,Yt,pt)?(ae!=null&&(ae[0]=Ue[0]),et!=null&&(et[0]=Yt[0]),ft!=null&&(ft[0]=pt[0]),p=1):p=0):p=0}else{if(10>P){Be=7;break}ae=yt,p==null||10>P||!Ml(p,w+3,P-3)?p=0:(et=p[w+0]|p[w+1]<<8|p[w+2]<<16,ft=16383&(p[w+7]<<8|p[w+6]),p=16383&(p[w+9]<<8|p[w+8]),1&et||3<(et>>1&7)||!(et>>4&1)||et>>5>=We.Ja||!ft||!p?p=0:(ee&&(ee[0]=ft),ae&&(ae[0]=p),p=1))}if(!p||(ee=ee[0],yt=yt[0],Ze&&(ge[0]!=ee||Re[0]!=yt)))return 3;oe!=null&&(oe[0]=We,oe.offset=w-oe.w,t(4294967286>w-oe.w),t(oe.offset==oe.ha-P));break}return Be==0||Be==7&&Ze&&oe==null?(J!=null&&(J[0]|=We.na!=null&&0<We.na.length),R!=null&&(R[0]=ee),W!=null&&(W[0]=yt),0):Be}function yl(p,w,P){var R=w.width,W=w.height,J=0,ee=0,ae=R,oe=W;if(w.Da=p!=null&&0<p.Da,w.Da&&(ae=p.cd,oe=p.bd,J=p.v,ee=p.j,11>P||(J&=-2,ee&=-2),0>J||0>ee||0>=ae||0>=oe||J+ae>R||ee+oe>W))return 0;if(w.v=J,w.j=ee,w.va=J+ae,w.o=ee+oe,w.U=ae,w.T=oe,w.da=p!=null&&0<p.da,w.da){if(!mt(ae,oe,P=[p.ib],J=[p.hb]))return 0;w.ib=P[0],w.hb=J[0]}return w.ob=p!=null&&p.ob,w.Kb=p==null||!p.Sd,w.da&&(w.ob=w.ib<3*R/4&&w.hb<3*W/4,w.Kb=0),1}function Hs(p){if(p==null)return 2;if(11>p.S){var w=p.f.RGBA;w.fb+=(p.height-1)*w.A,w.A=-w.A}else w=p.f.kb,p=p.height,w.O+=(p-1)*w.fa,w.fa=-w.fa,w.N+=(p-1>>1)*w.Ab,w.Ab=-w.Ab,w.W+=(p-1>>1)*w.Db,w.Db=-w.Db,w.F!=null&&(w.J+=(p-1)*w.lb,w.lb=-w.lb);return 0}function Ma(p,w,P,R){if(R==null||0>=p||0>=w)return 2;if(P!=null){if(P.Da){var W=P.cd,J=P.bd,ee=-2&P.v,ae=-2&P.j;if(0>ee||0>ae||0>=W||0>=J||ee+W>p||ae+J>w)return 2;p=W,w=J}if(P.da){if(!mt(p,w,W=[P.ib],J=[P.hb]))return 2;p=W[0],w=J[0]}}R.width=p,R.height=w;e:{var oe=R.width,ge=R.height;if(p=R.S,0>=oe||0>=ge||!(p>=Bu&&13>p))p=2;else{if(0>=R.Rd&&R.sd==null){ee=J=W=w=0;var Re=(ae=oe*su[p])*ge;if(11>p||(J=(ge+1)/2*(w=(oe+1)/2),p==12&&(ee=(W=oe)*ge)),(ge=i(Re+2*J+ee))==null){p=1;break e}R.sd=ge,11>p?((oe=R.f.RGBA).eb=ge,oe.fb=0,oe.A=ae,oe.size=Re):((oe=R.f.kb).y=ge,oe.O=0,oe.fa=ae,oe.Fd=Re,oe.f=ge,oe.N=0+Re,oe.Ab=w,oe.Cd=J,oe.ea=ge,oe.W=0+Re+J,oe.Db=w,oe.Ed=J,p==12&&(oe.F=ge,oe.J=0+Re+2*J),oe.Tc=ee,oe.lb=W)}if(w=1,W=R.S,J=R.width,ee=R.height,W>=Bu&&13>W)if(11>W)p=R.f.RGBA,w&=(ae=Math.abs(p.A))*(ee-1)+J<=p.size,w&=ae>=J*su[W],w&=p.eb!=null;else{p=R.f.kb,ae=(J+1)/2,Re=(ee+1)/2,oe=Math.abs(p.fa),ge=Math.abs(p.Ab);var Ze=Math.abs(p.Db),et=Math.abs(p.lb),We=et*(ee-1)+J;w&=oe*(ee-1)+J<=p.Fd,w&=ge*(Re-1)+ae<=p.Cd,w=(w&=Ze*(Re-1)+ae<=p.Ed)&oe>=J&ge>=ae&Ze>=ae,w&=p.y!=null,w&=p.f!=null,w&=p.ea!=null,W==12&&(w&=et>=J,w&=We<=p.Tc,w&=p.F!=null)}else w=0;p=w?0:2}}return p!=0||P!=null&&P.fd&&(p=Hs(R)),p}var Br=64,Vs=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],xa=24,wl=32,po=8,La=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];_t("Predictor0","PredictorAdd0"),V.Predictor0=function(){return 4278190080},V.Predictor1=function(p){return p},V.Predictor2=function(p,w,P){return w[P+0]},V.Predictor3=function(p,w,P){return w[P+1]},V.Predictor4=function(p,w,P){return w[P-1]},V.Predictor5=function(p,w,P){return Bt(Bt(p,w[P+1]),w[P+0])},V.Predictor6=function(p,w,P){return Bt(p,w[P-1])},V.Predictor7=function(p,w,P){return Bt(p,w[P+0])},V.Predictor8=function(p,w,P){return Bt(w[P-1],w[P+0])},V.Predictor9=function(p,w,P){return Bt(w[P+0],w[P+1])},V.Predictor10=function(p,w,P){return Bt(Bt(p,w[P-1]),Bt(w[P+0],w[P+1]))},V.Predictor11=function(p,w,P){var R=w[P+0];return 0>=cr(R>>24&255,p>>24&255,(w=w[P-1])>>24&255)+cr(R>>16&255,p>>16&255,w>>16&255)+cr(R>>8&255,p>>8&255,w>>8&255)+cr(255&R,255&p,255&w)?R:p},V.Predictor12=function(p,w,P){var R=w[P+0];return(Jt((p>>24&255)+(R>>24&255)-((w=w[P-1])>>24&255))<<24|Jt((p>>16&255)+(R>>16&255)-(w>>16&255))<<16|Jt((p>>8&255)+(R>>8&255)-(w>>8&255))<<8|Jt((255&p)+(255&R)-(255&w)))>>>0},V.Predictor13=function(p,w,P){var R=w[P-1];return(nr((p=Bt(p,w[P+0]))>>24&255,R>>24&255)<<24|nr(p>>16&255,R>>16&255)<<16|nr(p>>8&255,R>>8&255)<<8|nr(p>>0&255,R>>0&255))>>>0};var fi=V.PredictorAdd0;V.PredictorAdd1=gr,_t("Predictor2","PredictorAdd2"),_t("Predictor3","PredictorAdd3"),_t("Predictor4","PredictorAdd4"),_t("Predictor5","PredictorAdd5"),_t("Predictor6","PredictorAdd6"),_t("Predictor7","PredictorAdd7"),_t("Predictor8","PredictorAdd8"),_t("Predictor9","PredictorAdd9"),_t("Predictor10","PredictorAdd10"),_t("Predictor11","PredictorAdd11"),_t("Predictor12","PredictorAdd12"),_t("Predictor13","PredictorAdd13");var os=V.PredictorAdd2;$t("ColorIndexInverseTransform","MapARGB","32b",function(p){return p>>8&255},function(p){return p}),$t("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(p){return p},function(p){return p>>8&255});var Ws,$n=V.ColorIndexInverseTransform,jo=V.MapARGB,v=V.VP8LColorIndexInverseTransformAlpha,_=V.MapAlpha,L=V.VP8LPredictorsAdd=[];L.length=16,(V.VP8LPredictors=[]).length=16,(V.VP8LPredictorsAdd_C=[]).length=16,(V.VP8LPredictors_C=[]).length=16;var j,q,Z,ve,Ce,De,ze,Ve,Ne,Ke,Ie,qe,Ge,$e,at,st,ot,ht,Tt,Mt,Ct,Rt,Vt,Ft,Wt,er,tr,lr,tn=i(511),br=i(2041),Gn=i(225),Hn=i(767),go=0,Pn=br,Pi=Gn,ya=Hn,As=tn,Bu=0,bl=1,yh=2,Zc=3,eu=4,An=5,Uu=6,mc=7,$l=8,tu=9,ru=10,nu=[2,3,7],zu=[3,3,11],Hl=[280,256,256,256,40],wh=[0,1,1,1,0],Ep=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Ap=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],bh=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],qu=8,vc=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],au=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Vl=null,Wf=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Kf=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],_h=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],kh=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Np=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Tp=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Gf=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],hi=[],Ns=[],Li=[],mo=1,xc=2,ei=[],Fi=[];dt("UpsampleRgbLinePair",Yr,3),dt("UpsampleBgrLinePair",In,3),dt("UpsampleRgbaLinePair",ss,4),dt("UpsampleBgraLinePair",ia,4),dt("UpsampleArgbLinePair",va,4),dt("UpsampleRgba4444LinePair",ea,2),dt("UpsampleRgb565LinePair",Rn,2);var Cp=V.UpsampleRgbLinePair,Pp=V.UpsampleBgrLinePair,_l=V.UpsampleRgbaLinePair,yc=V.UpsampleBgraLinePair,Wl=V.UpsampleArgbLinePair,iu=V.UpsampleRgba4444LinePair,Yf=V.UpsampleRgb565LinePair,Mo=16,Ks=1<<Mo-1,wn=-227,_n=482,kl=6,Ba=0,Oi=i(256),Kl=i(256),wc=i(256),Ii=i(256),$u=i(_n-wn),Sh=i(_n-wn);Za("YuvToRgbRow",Yr,3),Za("YuvToBgrRow",In,3),Za("YuvToRgbaRow",ss,4),Za("YuvToBgraRow",ia,4),Za("YuvToArgbRow",va,4),Za("YuvToRgba4444Row",ea,2),Za("YuvToRgb565Row",Rn,2);var Xf=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Gl=[0,2,8],Eh=[8,7,6,4,4,2,2,2,1,1,1,1],Bo=1;this.WebPDecodeRGBA=function(p,w,P,R,W){var J=bl,ee=new Ci,ae=new Bn;ee.ba=ae,ae.S=J,ae.width=[ae.width],ae.height=[ae.height];var oe=ae.width,ge=ae.height,Re=new Xr;if(Re==null||p==null)var Ze=2;else t(Re!=null),Ze=Do(p,w,P,Re.width,Re.height,Re.Pd,Re.Qd,Re.format,null);if(Ze!=0?oe=0:(oe!=null&&(oe[0]=Re.width[0]),ge!=null&&(ge[0]=Re.height[0]),oe=1),oe){ae.width=ae.width[0],ae.height=ae.height[0],R!=null&&(R[0]=ae.width),W!=null&&(W[0]=ae.height);e:{if(R=new Ji,(W=new On).data=p,W.w=w,W.ha=P,W.kd=1,w=[0],t(W!=null),((p=Do(W.data,W.w,W.ha,null,null,null,w,null,W))==0||p==7)&&w[0]&&(p=4),(w=p)==0){if(t(ee!=null),R.data=W.data,R.w=W.w+W.offset,R.ha=W.ha-W.offset,R.put=ln,R.ac=Jr,R.bc=Sn,R.ma=ee,W.xa){if((p=ut())==null){ee=1;break e}if(function(et,We){var yt=[0],ft=[0],Be=[0];t:for(;;){if(et==null)return 0;if(We==null)return et.a=2,0;if(et.l=We,et.a=0,me(et.m,We.data,We.w,We.ha),!Gt(et.m,yt,ft,Be)){et.a=3;break t}if(et.xb=xc,We.width=yt[0],We.height=ft[0],!Xe(yt[0],ft[0],1,et,null))break t;return 1}return t(et.a!=0),0}(p,R)){if(R=(w=Ma(R.width,R.height,ee.Oa,ee.ba))==0){t:{R=p;r:for(;;){if(R==null){R=0;break t}if(t(R.s.yc!=null),t(R.s.Ya!=null),t(0<R.s.Wb),t((P=R.l)!=null),t((W=P.ma)!=null),R.xb!=0){if(R.ca=W.ba,R.tb=W.tb,t(R.ca!=null),!yl(W.Oa,P,Zc)){R.a=2;break r}if(!rt(R,P.width)||P.da)break r;if((P.da||Lr(R.ca.S))&&Ye(),11>R.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),R.ca.f.kb.F!=null&&Ye()),R.Pb&&0<R.s.ua&&R.s.vb.X==null&&!Dt(R.s.vb,R.s.Wa.Xa)){R.a=1;break r}R.xb=0}if(!ke(R,R.V,R.Ba,R.c,R.i,P.o,be))break r;W.Dc=R.Ma,R=1;break t}t(R.a!=0),R=0}R=!R}R&&(w=p.a)}else w=p.a}else{if((p=new pr)==null){ee=1;break e}if(p.Fa=W.na,p.P=W.P,p.qc=W.Sa,Bl(p,R)){if((w=Ma(R.width,R.height,ee.Oa,ee.ba))==0){if(p.Aa=0,P=ee.Oa,t((W=p)!=null),P!=null){if(0<(oe=0>(oe=P.Md)?0:100<oe?255:255*oe/100)){for(ge=Re=0;4>ge;++ge)12>(Ze=W.pb[ge]).lc&&(Ze.ia=oe*Eh[0>Ze.lc?0:Ze.lc]>>3),Re|=Ze.ia;Re&&(alert("todo:VP8InitRandom"),W.ia=1)}W.Ga=P.Id,100<W.Ga?W.Ga=100:0>W.Ga&&(W.Ga=0)}Qi(p,R)||(w=p.a)}}else w=p.a}w==0&&ee.Oa!=null&&ee.Oa.fd&&(w=Hs(ee.ba))}ee=w}J=ee!=0?null:11>J?ae.f.RGBA.eb:ae.f.kb.y}else J=null;return J};var su=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function f(V,Y){for(var ye="",U=0;U<4;U++)ye+=String.fromCharCode(V[Y++]);return ye}function h(V,Y){return(V[Y+0]<<0|V[Y+1]<<8|V[Y+2]<<16)>>>0}function g(V,Y){return(V[Y+0]<<0|V[Y+1]<<8|V[Y+2]<<16|V[Y+3]<<24)>>>0}new u;var x=[0],m=[0],k=[],b=new u,E=e,N=function(V,Y){var ye={},U=0,D=!1,le=0,ue=0;if(ye.frames=[],!function(M,z,H,ie){for(var xe=0;xe<ie;xe++)if(M[z+xe]!=H.charCodeAt(xe))return!0;return!1}(V,Y,"RIFF",4)){for(g(V,Y+=4),Y+=8;Y<V.length;){var Te=f(V,Y),Fe=g(V,Y+=4);Y+=4;var Le=Fe+(1&Fe);switch(Te){case"VP8 ":case"VP8L":ye.frames[U]===void 0&&(ye.frames[U]={}),(Ee=ye.frames[U]).src_off=D?ue:Y-8,Ee.src_size=le+Fe+8,U++,D&&(D=!1,le=0,ue=0);break;case"VP8X":(Ee=ye.header={}).feature_flags=V[Y];var me=Y+4;Ee.canvas_width=1+h(V,me),me+=3,Ee.canvas_height=1+h(V,me),me+=3;break;case"ALPH":D=!0,le=Le+8,ue=Y-8;break;case"ANIM":(Ee=ye.header).bgcolor=g(V,Y),me=Y+4,Ee.loop_count=(pe=V)[(C=me)+0]<<0|pe[C+1]<<8,me+=2;break;case"ANMF":var ne,Ee;(Ee=ye.frames[U]={}).offset_x=2*h(V,Y),Y+=3,Ee.offset_y=2*h(V,Y),Y+=3,Ee.width=1+h(V,Y),Y+=3,Ee.height=1+h(V,Y),Y+=3,Ee.duration=h(V,Y),Y+=3,ne=V[Y++],Ee.dispose=1&ne,Ee.blend=ne>>1&1}Te!="ANMF"&&(Y+=Le)}var pe,C;return ye}}(E,0);N.response=E,N.rgbaoutput=!0,N.dataurl=!1;var O=N.header?N.header:null,F=N.frames?N.frames:null;if(O){O.loop_counter=O.loop_count,x=[O.canvas_height],m=[O.canvas_width];for(var K=0;K<F.length&&F[K].blend!=0;K++);}var te=F[0],re=b.WebPDecodeRGBA(E,te.src_off,te.src_size,m,x);te.rgba=re,te.imgwidth=m[0],te.imgheight=x[0];for(var B=0;B<m[0]*x[0]*4;B++)k[B]=re[B];return this.width=m,this.height=x,this.data=k,this}(function(e){var t=function(){return typeof lg=="function"},r=function(x,m,k,b){var E=4,N=o;switch(b){case e.image_compression.FAST:E=1,N=i;break;case e.image_compression.MEDIUM:E=6,N=l;break;case e.image_compression.SLOW:E=9,N=u}x=n(x,m,k,N);var O=lg(x,{level:E});return e.__addimage__.arrayBufferToBinaryString(O)},n=function(x,m,k,b){for(var E,N,O,F=x.length/m,K=new Uint8Array(x.length+F),te=h(),re=0;re<F;re+=1){if(O=re*m,E=x.subarray(O,O+m),b)K.set(b(E,k,N),O+re);else{for(var B,V=te.length,Y=[];B<V;B+=1)Y[B]=te[B](E,k,N);var ye=g(Y.concat());K.set(Y[ye],O+re)}N=E}return K},a=function(x){var m=Array.apply([],x);return m.unshift(0),m},i=function(x,m){var k,b=[],E=x.length;b[0]=1;for(var N=0;N<E;N+=1)k=x[N-m]||0,b[N+1]=x[N]-k+256&255;return b},o=function(x,m,k){var b,E=[],N=x.length;E[0]=2;for(var O=0;O<N;O+=1)b=k&&k[O]||0,E[O+1]=x[O]-b+256&255;return E},l=function(x,m,k){var b,E,N=[],O=x.length;N[0]=3;for(var F=0;F<O;F+=1)b=x[F-m]||0,E=k&&k[F]||0,N[F+1]=x[F]+256-(b+E>>>1)&255;return N},u=function(x,m,k){var b,E,N,O,F=[],K=x.length;F[0]=4;for(var te=0;te<K;te+=1)b=x[te-m]||0,E=k&&k[te]||0,N=k&&k[te-m]||0,O=f(b,E,N),F[te+1]=x[te]-O+256&255;return F},f=function(x,m,k){if(x===m&&m===k)return x;var b=Math.abs(m-k),E=Math.abs(x-k),N=Math.abs(x+m-k-k);return b<=E&&b<=N?x:E<=N?m:k},h=function(){return[a,i,o,l,u]},g=function(x){var m=x.map(function(k){return k.reduce(function(b,E){return b+Math.abs(E)},0)});return m.indexOf(Math.min.apply(null,m))};e.processPNG=function(x,m,k,b){var E,N,O,F,K,te,re,B,V,Y,ye,U,D,le,ue,Te=this.decode.FLATE_DECODE,Fe="";if(this.__addimage__.isArrayBuffer(x)&&(x=new Uint8Array(x)),this.__addimage__.isArrayBufferView(x)){if(x=(O=new $k(x)).imgData,N=O.bits,E=O.colorSpace,K=O.colors,[4,6].indexOf(O.colorType)!==-1){if(O.bits===8){V=(B=O.pixelBitlength==32?new Uint32Array(O.decodePixels().buffer):O.pixelBitlength==16?new Uint16Array(O.decodePixels().buffer):new Uint8Array(O.decodePixels().buffer)).length,ye=new Uint8Array(V*O.colors),Y=new Uint8Array(V);var Le,me=O.pixelBitlength-O.bits;for(le=0,ue=0;le<V;le++){for(D=B[le],Le=0;Le<me;)ye[ue++]=D>>>Le&255,Le+=O.bits;Y[le]=D>>>Le&255}}if(O.bits===16){V=(B=new Uint32Array(O.decodePixels().buffer)).length,ye=new Uint8Array(V*(32/O.pixelBitlength)*O.colors),Y=new Uint8Array(V*(32/O.pixelBitlength)),U=O.colors>1,le=0,ue=0;for(var ne=0;le<V;)D=B[le++],ye[ue++]=D>>>0&255,U&&(ye[ue++]=D>>>16&255,D=B[le++],ye[ue++]=D>>>0&255),Y[ne++]=D>>>16&255;N=8}b!==e.image_compression.NONE&&t()?(x=r(ye,O.width*O.colors,O.colors,b),re=r(Y,O.width,1,b)):(x=ye,re=Y,Te=void 0)}if(O.colorType===3&&(E=this.color_spaces.INDEXED,te=O.palette,O.transparency.indexed)){var Ee=O.transparency.indexed,pe=0;for(le=0,V=Ee.length;le<V;++le)pe+=Ee[le];if((pe/=255)===V-1&&Ee.indexOf(0)!==-1)F=[Ee.indexOf(0)];else if(pe!==V){for(B=O.decodePixels(),Y=new Uint8Array(B.length),le=0,V=B.length;le<V;le++)Y[le]=Ee[B[le]];re=r(Y,O.width,1)}}var C=function(M){var z;switch(M){case e.image_compression.FAST:z=11;break;case e.image_compression.MEDIUM:z=13;break;case e.image_compression.SLOW:z=14;break;default:z=12}return z}(b);return Te===this.decode.FLATE_DECODE&&(Fe="/Predictor "+C+" "),Fe+="/Colors "+K+" /BitsPerComponent "+N+" /Columns "+O.width,(this.__addimage__.isArrayBuffer(x)||this.__addimage__.isArrayBufferView(x))&&(x=this.__addimage__.arrayBufferToBinaryString(x)),(re&&this.__addimage__.isArrayBuffer(re)||this.__addimage__.isArrayBufferView(re))&&(re=this.__addimage__.arrayBufferToBinaryString(re)),{alias:k,data:x,index:m,filter:Te,decodeParameters:Fe,transparency:F,palette:te,sMask:re,predictor:C,width:O.width,height:O.height,bitsPerComponent:N,colorSpace:E}}}})(Tr.API),function(e){e.processGIF89A=function(t,r,n,a){var i=new Hk(t),o=i.width,l=i.height,u=[];i.decodeAndBlitFrameRGBA(0,u);var f={data:u,width:o,height:l},h=new C1(100).encode(f,100);return e.processJPEG.call(this,h,r,n,a)},e.processGIF87A=e.processGIF89A}(Tr.API),Xo.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:a,green:n,blue:r,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Xo.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){jn.log("bit decode error:"+r)}},Xo.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,a=0;a<t;a++)for(var i=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*a*4,l=0;l<8&&8*a+l<this.width;l++){var u=this.palette[i>>7-l&1];this.data[o+4*l]=u.blue,this.data[o+4*l+1]=u.green,this.data[o+4*l+2]=u.red,this.data[o+4*l+3]=255}r!==0&&(this.pos+=4-r)}},Xo.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<e;a++){var i=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*a*4,l=i>>4,u=15&i,f=this.palette[l];if(this.data[o]=f.blue,this.data[o+1]=f.green,this.data[o+2]=f.red,this.data[o+3]=255,2*a+1>=this.width)break;f=this.palette[u],this.data[o+4]=f.blue,this.data[o+4+1]=f.green,this.data[o+4+2]=f.red,this.data[o+4+3]=255}t!==0&&(this.pos+=4-t)}},Xo.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+4*n;if(a<this.palette.length){var o=this.palette[a];this.data[i]=o.red,this.data[i+1]=o.green,this.data[i+2]=o.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}e!==0&&(this.pos+=4-e)}},Xo.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<this.width;a++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&t)/t*255|0,l=(i>>5&t)/t*255|0,u=(i>>10&t)/t*255|0,f=i>>15?255:0,h=n*this.width*4+4*a;this.data[h]=u,this.data[h+1]=l,this.data[h+2]=o,this.data[h+3]=f}this.pos+=e}},Xo.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&t)/t*255|0,u=(o>>5&r)/r*255|0,f=(o>>11)/t*255|0,h=a*this.width*4+4*i;this.data[h]=f,this.data[h+1]=u,this.data[h+2]=l,this.data[h+3]=255}this.pos+=e}},Xo.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=i,this.data[o+1]=a,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},Xo.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*r;this.data[l]=i,this.data[l+1]=a,this.data[l+2]=n,this.data[l+3]=o}},Xo.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,a){var i=new Xo(t,!1),o=i.width,l=i.height,u={data:i.getData(),width:o,height:l},f=new C1(100).encode(u,100);return e.processJPEG.call(this,f,r,n,a)}}(Tr.API),I2.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,a){var i=new I2(t),o=i.width,l=i.height,u={data:i.getData(),width:o,height:l},f=new C1(100).encode(u,100);return e.processJPEG.call(this,f,r,n,a)}}(Tr.API),Tr.API.processRGBA=function(e,t,r){for(var n=e.data,a=n.length,i=new Uint8Array(a/4*3),o=new Uint8Array(a/4),l=0,u=0,f=0;f<a;f+=4){var h=n[f],g=n[f+1],x=n[f+2],m=n[f+3];i[l++]=h,i[l++]=g,i[l++]=x,o[u++]=m}var k=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:k,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Tr.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},of=Tr.API,id=of.getCharWidthsArray=function(e,t){var r,n,a=(t=t||{}).font||this.internal.getFont(),i=t.fontSize||this.internal.getFontSize(),o=t.charSpace||this.internal.getCharSpace(),l=t.widths?t.widths:a.metadata.Unicode.widths,u=l.fof?l.fof:1,f=t.kerning?t.kerning:a.metadata.Unicode.kerning,h=f.fof?f.fof:1,g=t.doKerning!==!1,x=0,m=e.length,k=0,b=l[0]||u,E=[];for(r=0;r<m;r++)n=e.charCodeAt(r),typeof a.metadata.widthOfString=="function"?E.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(n))+o*(1e3/i)||0)/1e3):(x=g&&Nn(f[n])==="object"&&!isNaN(parseInt(f[n][k],10))?f[n][k]/h:0,E.push((l[n]||b)/u+x)),k=n;return E},P2=of.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),a=t.charSpace||this.internal.getCharSpace();return of.processArabic&&(e=of.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,a)/r:id.apply(this,arguments).reduce(function(i,o){return i+o},0)},L2=function(e,t,r,n){for(var a=[],i=0,o=e.length,l=0;i!==o&&l+t[i]<r;)l+=t[i],i++;a.push(e.slice(0,i));var u=i;for(l=0;i!==o;)l+t[i]>n&&(a.push(e.slice(u,i)),l=0,u=i),l+=t[i],i++;return u!==i&&a.push(e.slice(u,i)),a},F2=function(e,t,r){r||(r={});var n,a,i,o,l,u,f,h=[],g=[h],x=r.textIndent||0,m=0,k=0,b=e.split(" "),E=id.apply(this,[" ",r])[0];if(u=r.lineIndent===-1?b[0].length+2:r.lineIndent||0){var N=Array(u).join(" "),O=[];b.map(function(K){(K=K.split(/\s*\n/)).length>1?O=O.concat(K.map(function(te,re){return(re&&te.length?`
`:"")+te})):O.push(K[0])}),b=O,u=P2.apply(this,[N,r])}for(i=0,o=b.length;i<o;i++){var F=0;if(n=b[i],u&&n[0]==`
`&&(n=n.substr(1),F=1),x+m+(k=(a=id.apply(this,[n,r])).reduce(function(K,te){return K+te},0))>t||F){if(k>t){for(l=L2.apply(this,[n,a,t-(x+m),t]),h.push(l.shift()),h=[l.pop()];l.length;)g.push([l.shift()]);k=a.slice(n.length-(h[0]?h[0].length:0)).reduce(function(K,te){return K+te},0)}else h=[n];g.push(h),x=k+u,m=E}else h.push(n),x+=m+k,m=E}return f=u?function(K,te){return(te?N:"")+K.join(" ")}:function(K){return K.join(" ")},g.map(f)},of.splitTextToSize=function(e,t,r){var n,a=(r=r||{}).fontSize||this.internal.getFontSize(),i=(function(h){if(h.widths&&h.kerning)return{widths:h.widths,kerning:h.kerning};var g=this.internal.getFont(h.fontName,h.fontStyle);return g.metadata.Unicode?{widths:g.metadata.Unicode.widths||{0:1},kerning:g.metadata.Unicode.kerning||{}}:{font:g.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var o=1*this.internal.scaleFactor*t/a;i.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/a:0,i.lineIndent=r.lineIndent;var l,u,f=[];for(l=0,u=n.length;l<u;l++)f=f.concat(F2.apply(this,[n[l],o,i]));return f},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",r={},n={},a=0;a<t.length;a++)r[t[a]]="0123456789abcdef"[a],n["0123456789abcdef"[a]]=t[a];var i=function(g){return"0x"+parseInt(g,10).toString(16)},o=e.__fontmetrics__.compress=function(g){var x,m,k,b,E=["{"];for(var N in g){if(x=g[N],isNaN(parseInt(N,10))?m="'"+N+"'":(N=parseInt(N,10),m=(m=i(N).slice(2)).slice(0,-1)+n[m.slice(-1)]),typeof x=="number")x<0?(k=i(x).slice(3),b="-"):(k=i(x).slice(2),b=""),k=b+k.slice(0,-1)+n[k.slice(-1)];else{if(Nn(x)!=="object")throw new Error("Don't know what to do with value type "+Nn(x)+".");k=o(x)}E.push(m+k)}return E.push("}"),E.join("")},l=e.__fontmetrics__.uncompress=function(g){if(typeof g!="string")throw new Error("Invalid argument passed to uncompress.");for(var x,m,k,b,E={},N=1,O=E,F=[],K="",te="",re=g.length-1,B=1;B<re;B+=1)(b=g[B])=="'"?x?(k=x.join(""),x=void 0):x=[]:x?x.push(b):b=="{"?(F.push([O,k]),O={},k=void 0):b=="}"?((m=F.pop())[0][m[1]]=O,k=void 0,O=m[0]):b=="-"?N=-1:k===void 0?r.hasOwnProperty(b)?(K+=r[b],k=parseInt(K,16)*N,N=1,K=""):K+=b:r.hasOwnProperty(b)?(te+=r[b],O[k]=parseInt(te,16)*N,N=1,k=void 0,te=""):te+=b;return E},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},f={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},h={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(g){var x=g.font,m=h.Unicode[x.postScriptName];m&&(x.metadata.Unicode={},x.metadata.Unicode.widths=m.widths,x.metadata.Unicode.kerning=m.kerning);var k=f.Unicode[x.postScriptName];k&&(x.metadata.Unicode.encoding=k,x.encoding=k.codePages[0])}])}(Tr.API),function(e){var t=function(r){for(var n=r.length,a=new Uint8Array(n),i=0;i<n;i++)a[i]=r.charCodeAt(i);return a};e.API.events.push(["addFont",function(r){var n=void 0,a=r.font,i=r.instance;if(!a.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(n=i.existsFileInVFS(a.postScriptName)===!1?i.loadFile(a.postScriptName):i.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?t(l):t(b0(l)),o.metadata=e.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(a,n)}}])}(Tr),function(e){function t(){return(Pr.canvg?Promise.resolve(Pr.canvg):M0(()=>import("./index.es-O7ryvdGB.js"),[])).catch(function(r){return Promise.reject(new Error("Could not load canvg: "+r))}).then(function(r){return r.default?r.default:r})}Tr.API.addSvgAsImage=function(r,n,a,i,o,l,u,f){if(isNaN(n)||isNaN(a))throw jn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(o))throw jn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var h=document.createElement("canvas");h.width=i,h.height=o;var g=h.getContext("2d");g.fillStyle="#fff",g.fillRect(0,0,h.width,h.height);var x={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},m=this;return t().then(function(k){return k.fromString(g,r,x)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(k){return k.render(x)}).then(function(){m.addImage(h.toDataURL("image/jpeg",1),n,a,i,o,u,f)})}}(),Tr.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(t,r);return this},Tr.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,a,i,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),u=[],f=0,h=0,g=0;function x(k,b){var E,N=!1;for(E=0;E<k.length;E+=1)k[E]===b&&(N=!0);return N}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var m=l.length;for(g=0;g<m;g+=1)r[l[g]].value=r[l[g]].defaultValue,r[l[g]].explicitSet=!1}if(Nn(e)==="object"){for(a in e)if(i=e[a],x(l,a)&&i!==void 0){if(r[a].type==="boolean"&&typeof i=="boolean")r[a].value=i;else if(r[a].type==="name"&&x(r[a].valueSet,i))r[a].value=i;else if(r[a].type==="integer"&&Number.isInteger(i))r[a].value=i;else if(r[a].type==="array"){for(f=0;f<i.length;f+=1)if(n=!0,i[f].length===1&&typeof i[f][0]=="number")u.push(String(i[f]-1));else if(i[f].length>1){for(h=0;h<i[f].length;h+=1)typeof i[f][h]!="number"&&(n=!1);n===!0&&u.push([i[f][0]-1,i[f][1]-1].join(" "))}r[a].value="["+u.join(" ")+"]"}else r[a].value=r[a].defaultValue;r[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var k,b=[];for(k in r)r[k].explicitSet===!0&&(r[k].type==="name"?b.push("/"+k+" /"+r[k].value):b.push("/"+k+" "+r[k].value));b.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+b.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(n)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),u=unescape(encodeURIComponent("</x:xmpmeta>")),f=i.length+o.length+l.length+a.length+u.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+f+" >>"),this.internal.write("stream"),this.internal.write(a+i+o+l+u),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,a){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(Tr.API),function(e){var t=e.API,r=t.pdfEscape16=function(i,o){for(var l,u=o.metadata.Unicode.widths,f=["","0","00","000","0000"],h=[""],g=0,x=i.length;g<x;++g){if(l=o.metadata.characterToGlyph(i.charCodeAt(g)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=i.charCodeAt(g),u.indexOf(l)==-1&&(u.push(l),u.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return h.join("");l=l.toString(16),h.push(f[4-l.length],l)}return h.join("")},n=function(i){var o,l,u,f,h,g,x;for(h=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,u=[],g=0,x=(l=Object.keys(i).sort(function(m,k){return m-k})).length;g<x;g++)o=l[g],u.length>=100&&(h+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar`,u=[]),i[o]!==void 0&&i[o]!==null&&typeof i[o].toString=="function"&&(f=("0000"+i[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),u.push("<"+o+"><"+f+">"));return u.length&&(h+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar
`),h+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(i){(function(o){var l=o.font,u=o.out,f=o.newObject,h=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="Identity-H"){for(var g=l.metadata.Unicode.widths,x=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),m="",k=0;k<x.length;k++)m+=String.fromCharCode(x[k]);var b=f();h({data:m,addLength1:!0,objectId:b}),u("endobj");var E=f();h({data:n(l.metadata.toUnicode),addLength1:!0,objectId:E}),u("endobj");var N=f();u("<<"),u("/Type /FontDescriptor"),u("/FontName /"+mf(l.fontName)),u("/FontFile2 "+b+" 0 R"),u("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),u("/Flags "+l.metadata.flags),u("/StemV "+l.metadata.stemV),u("/ItalicAngle "+l.metadata.italicAngle),u("/Ascent "+l.metadata.ascender),u("/Descent "+l.metadata.decender),u("/CapHeight "+l.metadata.capHeight),u(">>"),u("endobj");var O=f();u("<<"),u("/Type /Font"),u("/BaseFont /"+mf(l.fontName)),u("/FontDescriptor "+N+" 0 R"),u("/W "+e.API.PDFObject.convert(g)),u("/CIDToGIDMap /Identity"),u("/DW 1000"),u("/Subtype /CIDFontType2"),u("/CIDSystemInfo"),u("<<"),u("/Supplement 0"),u("/Registry (Adobe)"),u("/Ordering ("+l.encoding+")"),u(">>"),u(">>"),u("endobj"),l.objectNumber=f(),u("<<"),u("/Type /Font"),u("/Subtype /Type0"),u("/ToUnicode "+E+" 0 R"),u("/BaseFont /"+mf(l.fontName)),u("/Encoding /"+l.encoding),u("/DescendantFonts ["+O+" 0 R]"),u(">>"),u("endobj"),l.isAlreadyPutted=!0}})(i)}]),t.events.push(["putFont",function(i){(function(o){var l=o.font,u=o.out,f=o.newObject,h=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var g=l.metadata.rawData,x="",m=0;m<g.length;m++)x+=String.fromCharCode(g[m]);var k=f();h({data:x,addLength1:!0,objectId:k}),u("endobj");var b=f();h({data:n(l.metadata.toUnicode),addLength1:!0,objectId:b}),u("endobj");var E=f();u("<<"),u("/Descent "+l.metadata.decender),u("/CapHeight "+l.metadata.capHeight),u("/StemV "+l.metadata.stemV),u("/Type /FontDescriptor"),u("/FontFile2 "+k+" 0 R"),u("/Flags 96"),u("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),u("/FontName /"+mf(l.fontName)),u("/ItalicAngle "+l.metadata.italicAngle),u("/Ascent "+l.metadata.ascender),u(">>"),u("endobj"),l.objectNumber=f();for(var N=0;N<l.metadata.hmtx.widths.length;N++)l.metadata.hmtx.widths[N]=parseInt(l.metadata.hmtx.widths[N]*(1e3/l.metadata.head.unitsPerEm));u("<</Subtype/TrueType/Type/Font/ToUnicode "+b+" 0 R/BaseFont/"+mf(l.fontName)+"/FontDescriptor "+E+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),u("endobj"),l.isAlreadyPutted=!0}})(i)}]);var a=function(i){var o,l=i.text||"",u=i.x,f=i.y,h=i.options||{},g=i.mutex||{},x=g.pdfEscape,m=g.activeFontKey,k=g.fonts,b=m,E="",N=0,O="",F=k[b].encoding;if(k[b].encoding!=="Identity-H")return{text:l,x:u,y:f,options:h,mutex:g};for(O=l,b=m,Array.isArray(l)&&(O=l[0]),N=0;N<O.length;N+=1)k[b].metadata.hasOwnProperty("cmap")&&(o=k[b].metadata.cmap.unicode.codeMap[O[N].charCodeAt(0)]),o||O[N].charCodeAt(0)<256&&k[b].metadata.hasOwnProperty("Unicode")?E+=O[N]:E+="";var K="";return parseInt(b.slice(1))<14||F==="WinAnsiEncoding"?K=x(E,b).split("").map(function(te){return te.charCodeAt(0).toString(16)}).join(""):F==="Identity-H"&&(K=r(E,k[b])),g.isHex=!0,{text:K,x:u,y:f,options:h,mutex:g}};t.events.push(["postProcessText",function(i){var o=i.text||"",l=[],u={text:o,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(o)){var f=0;for(f=0;f<o.length;f+=1)Array.isArray(o[f])&&o[f].length===3?l.push([a(Object.assign({},u,{text:o[f][0]})).text,o[f][1],o[f][2]]):l.push(a(Object.assign({},u,{text:o[f]})).text);i.text=l}else i.text=a(Object.assign({},u,{text:o})).text}])}(Tr),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(Tr.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var a,i,o,l,u,f,h,g=t,x=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],m=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],k={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},b={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},E=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],N=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),O=!1,F=0;this.__bidiEngine__={};var K=function(U){var D=U.charCodeAt(),le=D>>8,ue=b[le];return ue!==void 0?g[256*ue+(255&D)]:le===252||le===253?"AL":N.test(le)?"L":le===8?"R":"N"},te=function(U){for(var D,le=0;le<U.length;le++){if((D=K(U.charAt(le)))==="L")return!1;if(D==="R")return!0}return!1},re=function(U,D,le,ue){var Te,Fe,Le,me,ne=D[ue];switch(ne){case"L":case"R":O=!1;break;case"N":case"AN":break;case"EN":O&&(ne="AN");break;case"AL":O=!0,ne="R";break;case"WS":ne="N";break;case"CS":ue<1||ue+1>=D.length||(Te=le[ue-1])!=="EN"&&Te!=="AN"||(Fe=D[ue+1])!=="EN"&&Fe!=="AN"?ne="N":O&&(Fe="AN"),ne=Fe===Te?Fe:"N";break;case"ES":ne=(Te=ue>0?le[ue-1]:"B")==="EN"&&ue+1<D.length&&D[ue+1]==="EN"?"EN":"N";break;case"ET":if(ue>0&&le[ue-1]==="EN"){ne="EN";break}if(O){ne="N";break}for(Le=ue+1,me=D.length;Le<me&&D[Le]==="ET";)Le++;ne=Le<me&&D[Le]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(me=D.length,Le=ue+1;Le<me&&D[Le]==="NSM";)Le++;if(Le<me){var Ee=U[ue],pe=Ee>=1425&&Ee<=2303||Ee===64286;if(Te=D[Le],pe&&(Te==="R"||Te==="AL")){ne="R";break}}}ne=ue<1||(Te=D[ue-1])==="B"?"N":le[ue-1];break;case"B":O=!1,a=!0,ne=F;break;case"S":i=!0,ne="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":O=!1;break;case"BN":ne="N"}return ne},B=function(U,D,le){var ue=U.split("");return le&&V(ue,le,{hiLevel:F}),ue.reverse(),D&&D.reverse(),ue.join("")},V=function(U,D,le){var ue,Te,Fe,Le,me,ne=-1,Ee=U.length,pe=0,C=[],M=F?m:x,z=[];for(O=!1,a=!1,i=!1,Te=0;Te<Ee;Te++)z[Te]=K(U[Te]);for(Fe=0;Fe<Ee;Fe++){if(me=pe,C[Fe]=re(U,z,C,Fe),ue=240&(pe=M[me][k[C[Fe]]]),pe&=15,D[Fe]=Le=M[pe][5],ue>0)if(ue===16){for(Te=ne;Te<Fe;Te++)D[Te]=1;ne=-1}else ne=-1;if(M[pe][6])ne===-1&&(ne=Fe);else if(ne>-1){for(Te=ne;Te<Fe;Te++)D[Te]=Le;ne=-1}z[Fe]==="B"&&(D[Fe]=0),le.hiLevel|=Le}i&&function(H,ie,xe){for(var Ae=0;Ae<xe;Ae++)if(H[Ae]==="S"){ie[Ae]=F;for(var de=Ae-1;de>=0&&H[de]==="WS";de--)ie[de]=F}}(z,D,Ee)},Y=function(U,D,le,ue,Te){if(!(Te.hiLevel<U)){if(U===1&&F===1&&!a)return D.reverse(),void(le&&le.reverse());for(var Fe,Le,me,ne,Ee=D.length,pe=0;pe<Ee;){if(ue[pe]>=U){for(me=pe+1;me<Ee&&ue[me]>=U;)me++;for(ne=pe,Le=me-1;ne<Le;ne++,Le--)Fe=D[ne],D[ne]=D[Le],D[Le]=Fe,le&&(Fe=le[ne],le[ne]=le[Le],le[Le]=Fe);pe=me}pe++}}},ye=function(U,D,le){var ue=U.split(""),Te={hiLevel:F};return le||(le=[]),V(ue,le,Te),function(Fe,Le,me){if(me.hiLevel!==0&&h)for(var ne,Ee=0;Ee<Fe.length;Ee++)Le[Ee]===1&&(ne=E.indexOf(Fe[Ee]))>=0&&(Fe[Ee]=E[ne+1])}(ue,le,Te),Y(2,ue,D,le,Te),Y(1,ue,D,le,Te),ue.join("")};return this.__bidiEngine__.doBidiReorder=function(U,D,le){if(function(Te,Fe){if(Fe)for(var Le=0;Le<Te.length;Le++)Fe[Le]=Le;l===void 0&&(l=te(Te)),f===void 0&&(f=te(Te))}(U,D),o||!u||f)if(o&&u&&l^f)F=l?1:0,U=B(U,D,le);else if(!o&&u&&f)F=l?1:0,U=ye(U,D,le),U=B(U,D);else if(!o||l||u||f){if(o&&!u&&l^f)U=B(U,D),l?(F=0,U=ye(U,D,le)):(F=1,U=ye(U,D,le),U=B(U,D));else if(o&&l&&!u&&f)F=1,U=ye(U,D,le),U=B(U,D);else if(!o&&!u&&l^f){var ue=h;l?(F=1,U=ye(U,D,le),F=0,h=!1,U=ye(U,D,le),h=ue):(F=0,U=ye(U,D,le),U=B(U,D),F=1,h=!1,U=ye(U,D,le),h=ue,U=B(U,D))}}else F=0,U=ye(U,D,le);else F=l?1:0,U=ye(U,D,le);return U},this.__bidiEngine__.setOptions=function(U){U&&(o=U.isInputVisual,u=U.isOutputVisual,l=U.isInputRtl,f=U.isOutputRtl,h=U.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var a=n.text;n.x,n.y;var i=n.options||{};n.mutex,i.lang;var o=[];if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,r.setOptions(i),Object.prototype.toString.call(a)==="[object Array]"){var l=0;for(o=[],l=0;l<a.length;l+=1)Object.prototype.toString.call(a[l])==="[object Array]"?o.push([r.doBidiReorder(a[l][0]),a[l][1],a[l][2]]):o.push([r.doBidiReorder(a[l])]);n.text=o}else n.text=r.doBidiReorder(a);r.setOptions({isInputVisual:!0})}])}(Tr),Tr.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new Gc(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new iS(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new Vk(this.contents),this.head=new Kk(this),this.name=new Qk(this),this.cmap=new yw(this),this.toUnicode={},this.hhea=new Gk(this),this.maxp=new Zk(this),this.hmtx=new eS(this),this.post=new Xk(this),this.os2=new Yk(this),this.loca=new aS(this),this.glyf=new tS(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,a,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,u,f;for(f=[],o=0,l=(u=this.bbox).length;o<l;o++)t=u[o],f.push(Math.round(t*this.scaleFactor));return f}).call(this),this.stemV=0,this.post.exists?(n=255&(a=this.post.italic_angle),(32768&(r=a>>16))!=0&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var a,i,o,l;for(o=0,i=0,l=(t=""+t).length;0<=l?i<l:i>l;i=0<=l?++i:--i)a=t.charCodeAt(i),o+=this.widthOfGlyph(this.characterToGlyph(a))+n*(1e3/r)||0;return o*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var fl,Gc=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,a;for(a=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)a.push(this.writeByte(t.charCodeAt(r)));return a},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,a,i,o,l,u;return t=this.readByte(),r=this.readByte(),n=this.readByte(),a=this.readByte(),i=this.readByte(),o=this.readByte(),l=this.readByte(),u=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^a)+16777216*(255^i)+65536*(255^o)+256*(255^l)+(255^u)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*a+16777216*i+65536*o+256*l+u},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,a,i;for(i=[],n=0,a=t.length;n<a;n++)r=t[n],i.push(this.writeByte(r));return i},e}(),Vk=function(){var e;function t(r){var n,a,i;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},a=0,i=this.tableCount;0<=i?a<i:a>i;a=0<=i?++a:--a)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,a,i,o,l,u,f,h,g,x,m,k,b;for(b in m=Object.keys(r).length,u=Math.log(2),g=16*Math.floor(Math.log(m)/u),o=Math.floor(g/u),h=16*m-g,(a=new Gc).writeInt(this.scalarType),a.writeShort(m),a.writeShort(g),a.writeShort(o),a.writeShort(h),i=16*m,f=a.pos+i,l=null,k=[],r)for(x=r[b],a.writeString(b),a.writeInt(e(x)),a.writeInt(f),a.writeInt(x.length),k=k.concat(x),b==="head"&&(l=f),f+=x.length;f%4;)k.push(0),f++;return a.write(k),n=2981146554-e(a.data),a.pos=l+8,a.writeUInt32(n),a.data},e=function(r){var n,a,i,o;for(r=ww.call(r);r.length%4;)r.push(0);for(i=new Gc(r),a=0,n=0,o=r.length;n<o;n=n+=4)a+=i.readUInt32();return 4294967295&a},t}(),Wk={}.hasOwnProperty,Rl=function(e,t){for(var r in t)Wk.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};fl=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var Kk=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Rl(t,fl),t.prototype.tag="head",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},t.prototype.encode=function(r){var n;return(n=new Gc).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(r),n.writeShort(this.glyphDataFormat),n.data},t}(),R2=function(){function e(t,r){var n,a,i,o,l,u,f,h,g,x,m,k,b,E,N,O,F;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),g=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(u=0;u<256;++u)this.codeMap[u]=t.readByte();break;case 4:for(m=t.readUInt16(),x=m/2,t.pos+=6,i=function(){var K,te;for(te=[],u=K=0;0<=x?K<x:K>x;u=0<=x?++K:--K)te.push(t.readUInt16());return te}(),t.pos+=2,b=function(){var K,te;for(te=[],u=K=0;0<=x?K<x:K>x;u=0<=x?++K:--K)te.push(t.readUInt16());return te}(),f=function(){var K,te;for(te=[],u=K=0;0<=x?K<x:K>x;u=0<=x?++K:--K)te.push(t.readUInt16());return te}(),h=function(){var K,te;for(te=[],u=K=0;0<=x?K<x:K>x;u=0<=x?++K:--K)te.push(t.readUInt16());return te}(),a=(this.length-t.pos+this.offset)/2,l=function(){var K,te;for(te=[],u=K=0;0<=a?K<a:K>a;u=0<=a?++K:--K)te.push(t.readUInt16());return te}(),u=N=0,F=i.length;N<F;u=++N)for(E=i[u],n=O=k=b[u];k<=E?O<=E:O>=E;n=k<=E?++O:--O)h[u]===0?o=n+f[u]:(o=l[h[u]/2+(n-k)-(x-u)]||0)!==0&&(o+=f[u]),this.codeMap[n]=65535&o}t.pos=g}return e.encode=function(t,r){var n,a,i,o,l,u,f,h,g,x,m,k,b,E,N,O,F,K,te,re,B,V,Y,ye,U,D,le,ue,Te,Fe,Le,me,ne,Ee,pe,C,M,z,H,ie,xe,Ae,de,Me,ct,se;switch(ue=new Gc,o=Object.keys(t).sort(function(bt,Dt){return bt-Dt}),r){case"macroman":for(b=0,E=function(){var bt=[];for(k=0;k<256;++k)bt.push(0);return bt}(),O={0:0},i={},Te=0,ne=o.length;Te<ne;Te++)O[de=t[a=o[Te]]]==null&&(O[de]=++b),i[a]={old:t[a],new:O[t[a]]},E[a]=O[t[a]];return ue.writeUInt16(1),ue.writeUInt16(0),ue.writeUInt32(12),ue.writeUInt16(0),ue.writeUInt16(262),ue.writeUInt16(0),ue.write(E),{charMap:i,subtable:ue.data,maxGlyphID:b+1};case"unicode":for(D=[],g=[],F=0,O={},n={},N=f=null,Fe=0,Ee=o.length;Fe<Ee;Fe++)O[te=t[a=o[Fe]]]==null&&(O[te]=++F),n[a]={old:te,new:O[te]},l=O[te]-a,N!=null&&l===f||(N&&g.push(N),D.push(a),f=l),N=a;for(N&&g.push(N),g.push(65535),D.push(65535),ye=2*(Y=D.length),V=2*Math.pow(Math.log(Y)/Math.LN2,2),x=Math.log(V/2)/Math.LN2,B=2*Y-V,u=[],re=[],m=[],k=Le=0,pe=D.length;Le<pe;k=++Le){if(U=D[k],h=g[k],U===65535){u.push(0),re.push(0);break}if(U-(le=n[U].new)>=32768)for(u.push(0),re.push(2*(m.length+Y-k)),a=me=U;U<=h?me<=h:me>=h;a=U<=h?++me:--me)m.push(n[a].new);else u.push(le-U),re.push(0)}for(ue.writeUInt16(3),ue.writeUInt16(1),ue.writeUInt32(12),ue.writeUInt16(4),ue.writeUInt16(16+8*Y+2*m.length),ue.writeUInt16(0),ue.writeUInt16(ye),ue.writeUInt16(V),ue.writeUInt16(x),ue.writeUInt16(B),xe=0,C=g.length;xe<C;xe++)a=g[xe],ue.writeUInt16(a);for(ue.writeUInt16(0),Ae=0,M=D.length;Ae<M;Ae++)a=D[Ae],ue.writeUInt16(a);for(Me=0,z=u.length;Me<z;Me++)l=u[Me],ue.writeUInt16(l);for(ct=0,H=re.length;ct<H;ct++)K=re[ct],ue.writeUInt16(K);for(se=0,ie=m.length;se<ie;se++)b=m[se],ue.writeUInt16(b);return{charMap:n,subtable:ue.data,maxGlyphID:F+1}}},e}(),yw=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Rl(t,fl),t.prototype.tag="cmap",t.prototype.parse=function(r){var n,a,i;for(r.pos=this.offset,this.version=r.readUInt16(),i=r.readUInt16(),this.tables=[],this.unicode=null,a=0;0<=i?a<i:a>i;a=0<=i?++a:--a)n=new R2(r,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},t.encode=function(r,n){var a,i;return n==null&&(n="macroman"),a=R2.encode(r,n),(i=new Gc).writeUInt16(0),i.writeUInt16(1),a.table=i.data.concat(a.subtable),a},t}(),Gk=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Rl(t,fl),t.prototype.tag="hhea",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},t}(),Yk=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Rl(t,fl),t.prototype.tag="OS/2",t.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=function(){var n,a;for(a=[],n=0;n<10;++n)a.push(r.readByte());return a}(),this.charRange=function(){var n,a;for(a=[],n=0;n<4;++n)a.push(r.readInt());return a}(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=function(){var n,a;for(a=[],n=0;n<2;n=++n)a.push(r.readInt());return a}(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},t}(),Xk=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Rl(t,fl),t.prototype.tag="post",t.prototype.parse=function(r){var n,a,i;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var o;for(a=r.readUInt16(),this.glyphNameIndex=[],o=0;0<=a?o<a:o>a;o=0<=a?++o:--o)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],i=[];r.pos<this.offset+this.length;)n=r.readByte(),i.push(this.names.push(r.readString(n)));return i;case 151552:return a=r.readUInt16(),this.offsets=r.read(a);case 196608:break;case 262144:return this.map=(function(){var l,u,f;for(f=[],o=l=0,u=this.file.maxp.numGlyphs;0<=u?l<u:l>u;o=0<=u?++l:--l)f.push(r.readUInt32());return f}).call(this)}},t}(),Jk=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},Qk=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Rl(t,fl),t.prototype.tag="name",t.prototype.parse=function(r){var n,a,i,o,l,u,f,h,g,x,m;for(r.pos=this.offset,r.readShort(),n=r.readShort(),u=r.readShort(),a=[],o=0;0<=n?o<n:o>n;o=0<=n?++o:--o)a.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+u+r.readShort()});for(f={},o=g=0,x=a.length;g<x;o=++g)i=a[o],r.pos=i.offset,h=r.readString(i.length),l=new Jk(h,i),f[m=i.nameID]==null&&(f[m]=[]),f[i.nameID].push(l);this.strings=f,this.copyright=f[0],this.fontFamily=f[1],this.fontSubfamily=f[2],this.uniqueSubfamily=f[3],this.fontName=f[4],this.version=f[5];try{this.postscriptName=f[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=f[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=f[7],this.manufacturer=f[8],this.designer=f[9],this.description=f[10],this.vendorUrl=f[11],this.designerUrl=f[12],this.license=f[13],this.licenseUrl=f[14],this.preferredFamily=f[15],this.preferredSubfamily=f[17],this.compatibleFull=f[18],this.sampleText=f[19]},t}(),Zk=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Rl(t,fl),t.prototype.tag="maxp",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},t}(),eS=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Rl(t,fl),t.prototype.tag="hmtx",t.prototype.parse=function(r){var n,a,i,o,l,u,f;for(r.pos=this.offset,this.metrics=[],n=0,u=this.file.hhea.numberOfMetrics;0<=u?n<u:n>u;n=0<=u?++n:--n)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var h,g;for(g=[],n=h=0;0<=i?h<i:h>i;n=0<=i?++h:--h)g.push(r.readInt16());return g}(),this.widths=(function(){var h,g,x,m;for(m=[],h=0,g=(x=this.metrics).length;h<g;h++)o=x[h],m.push(o.advance);return m}).call(this),a=this.widths[this.widths.length-1],f=[],n=l=0;0<=i?l<i:l>i;n=0<=i?++l:--l)f.push(this.widths.push(a));return f},t.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},t}(),ww=[].slice,tS=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Rl(t,fl),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(r){var n,a,i,o,l,u,f,h,g,x;return r in this.cache?this.cache[r]:(o=this.file.loca,n=this.file.contents,a=o.indexOf(r),(i=o.lengthOf(r))===0?this.cache[r]=null:(n.pos=this.offset+a,l=(u=new Gc(n.read(i))).readShort(),h=u.readShort(),x=u.readShort(),f=u.readShort(),g=u.readShort(),this.cache[r]=l===-1?new nS(u,h,x,f,g):new rS(u,l,h,x,f,g),this.cache[r]))},t.prototype.encode=function(r,n,a){var i,o,l,u,f;for(l=[],o=[],u=0,f=n.length;u<f;u++)i=r[n[u]],o.push(l.length),i&&(l=l.concat(i.encode(a)));return o.push(l.length),{table:l,offsets:o}},t}(),rS=function(){function e(t,r,n,a,i,o){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=a,this.xMax=i,this.yMax=o,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),nS=function(){function e(t,r,n,a,i){var o,l;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=a,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new Gc(ww.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),aS=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Rl(t,fl),t.prototype.tag="loca",t.prototype.parse=function(r){var n,a;return r.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var i,o;for(o=[],a=0,i=this.length;a<i;a+=2)o.push(2*r.readUInt16());return o}).call(this):(function(){var i,o;for(o=[],a=0,i=this.length;a<i;a+=4)o.push(r.readUInt32());return o}).call(this)},t.prototype.indexOf=function(r){return this.offsets[r]},t.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},t.prototype.encode=function(r,n){for(var a=new Uint32Array(this.offsets.length),i=0,o=0,l=0;l<a.length;++l)if(a[l]=i,o<n.length&&n[o]==l){++o,a[l]=i;var u=this.offsets[l],f=this.offsets[l+1]-u;f>0&&(i+=f)}for(var h=new Array(4*a.length),g=0;g<a.length;++g)h[4*g+3]=255&a[g],h[4*g+2]=(65280&a[g])>>8,h[4*g+1]=(16711680&a[g])>>16,h[4*g]=(4278190080&a[g])>>24;return h},t}(),iS=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,a,i;for(r in a=this.font.cmap.tables[0].codeMap,t={},i=this.subset)n=i[r],t[r]=a[n];return t},e.prototype.glyphsFor=function(t){var r,n,a,i,o,l,u;for(a={},o=0,l=t.length;o<l;o++)a[i=t[o]]=this.font.glyf.glyphFor(i);for(i in r=[],a)(n=a[i])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(i in u=this.glyphsFor(r))n=u[i],a[i]=n;return a},e.prototype.encode=function(t,r){var n,a,i,o,l,u,f,h,g,x,m,k,b,E,N;for(a in n=yw.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(t),m={0:0},N=n.charMap)m[(u=N[a]).old]=u.new;for(k in x=n.maxGlyphID,o)k in m||(m[k]=x++);return h=function(O){var F,K;for(F in K={},O)K[O[F]]=F;return K}(m),g=Object.keys(h).sort(function(O,F){return O-F}),b=function(){var O,F,K;for(K=[],O=0,F=g.length;O<F;O++)l=g[O],K.push(h[l]);return K}(),i=this.font.glyf.encode(o,b,m),f=this.font.loca.encode(i.offsets,b),E={cmap:this.font.cmap.raw(),glyf:i.table,loca:f,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(E["OS/2"]=this.font.os2.raw()),this.font.directory.encode(E)},e}();Tr.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,a,i,o;if(Array.isArray(r))return"["+function(){var l,u,f;for(f=[],l=0,u=r.length;l<u;l++)n=r[l],f.push(t.convert(n));return f}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(a in i=["<<"],r)o=r[a],i.push("/"+a+" "+t.convert(o));return i.push(">>"),i.join(`
`)}return""+r},t}();const bw=e=>{const t=new Tr,r=[3,152,158],n=[31,41,55],a=[156,163,175];t.setFillColor(...r),t.rect(0,0,210,40,"F"),t.setTextColor(255,255,255),t.setFontSize(24),t.setFont("helvetica","bold"),t.text("Agence de Voyage",20,25),t.setTextColor(...n),t.setFontSize(28),t.setFont("helvetica","bold"),t.text("INVOICE",20,60),t.setFontSize(12),t.setFont("helvetica","normal"),t.text(`Invoice Number: ${e.invoiceNumber}`,20,75),t.text(`Date: ${Vc(e.createdAt||new Date().toISOString())}`,20,85),t.text(`Due Date: ${Vc(e.dueDate||new Date().toISOString())}`,20,95),t.setFontSize(10),t.setTextColor(a[0],a[1],a[2]),t.text("123 Travel Street",140,60),t.text("New York, NY 10001",140,70),t.text("Phone: (555) 123-4567",140,80),t.text("Email: info@agencedevoyage.com",140,90);const i={draft:[156,163,175],sent:[3,152,158],paid:[34,197,94],overdue:[239,68,68]};if(t.setFillColor(...i[e.status]||i.draft),t.roundedRect(140,95,30,8,2,2,"F"),t.setTextColor(255,255,255),t.setFontSize(8),t.setFont("helvetica","bold"),t.text(e.status.toUpperCase(),142,100),t.setTextColor(...n),t.setFontSize(14),t.setFont("helvetica","bold"),t.text("Bill To:",20,120),t.setFontSize(12),t.setFont("helvetica","bold"),t.text(e.client?.name||"Unknown Client",20,135),t.setFont("helvetica","normal"),t.text(e.client?.email||"",20,145),e.client?.phone&&t.text(e.client.phone,20,155),e.client?.address){const g=t.splitTextToSize(e.client.address,80);t.text(g,20,165)}t.setFontSize(14),t.setFont("helvetica","bold"),t.text("Agent:",110,120),t.setFontSize(12),t.text(e.agentName,110,135),t.setFont("helvetica","normal"),t.text("Travel Agent",110,145);let o=190;t.setFillColor(249,250,251),t.rect(20,o-10,170,15,"F"),t.setTextColor(...n),t.setFontSize(10),t.setFont("helvetica","bold"),t.text("Description",25,o-2),t.text("Qty",120,o-2),t.text("Unit Price",140,o-2),t.text("Total",170,o-2),t.setFont("helvetica","normal"),o+=10,(e.items||[]).forEach((g,x)=>{o>250&&(t.addPage(),o=30),x%2===0&&(t.setFillColor(249,250,251),t.rect(20,o-8,170,12,"F")),t.setTextColor(...n);const m=t.splitTextToSize(g.description,90);t.text(m,25,o),t.text(g.quantity.toString(),125,o),t.text(Va(g.unitPrice||0),145,o),t.text(Va(g.total),175,o),o+=Math.max(12,m.length*5)}),o+=20,o>230&&(t.addPage(),o=30);const l=130;if(t.setFillColor(249,250,251),t.rect(l-10,o-10,70,50,"F"),t.setTextColor(...n),t.setFontSize(12),t.setFont("helvetica","normal"),t.text("Subtotal:",l,o),t.text(Va(e.subtotal||0),l+40,o),t.text("Tax:",l,o+12),t.text(Va(e.tax||0),l+40,o+12),t.setFont("helvetica","bold"),t.setFontSize(14),t.text("Total:",l,o+28),t.setTextColor(...r),t.text(Va(e.total||0),l+40,o+28),o+=60,o>240&&(t.addPage(),o=30),t.setFillColor(249,250,251),t.rect(20,o-10,170,45,"F"),t.setTextColor(...n),t.setFontSize(14),t.setFont("helvetica","bold"),t.text("Umrah Details",25,o),t.setFontSize(10),t.setFont("helvetica","normal"),e.passportNumber&&t.text(`Passport: ${e.passportNumber}`,25,o+10),e.flightNumber&&t.text(`Flight: ${e.flightNumber}`,25,o+20),e.departureDate&&t.text(`Departure: ${Vc(e.departureDate)}`,25,o+30),e.roomType&&t.text(`Room Type: ${e.roomType}`,110,o+10),e.visaStatus&&t.text(`Visa Status: ${e.visaStatus}`,110,o+20),e.gender&&t.text(`Gender: ${e.gender}`,110,o+30),o+=45,e.notes){o>240&&(t.addPage(),o=30),t.setTextColor(...n),t.setFontSize(12),t.setFont("helvetica","bold"),t.text("Notes:",20,o),t.setFont("helvetica","normal"),t.setFontSize(10);const g=t.splitTextToSize(e.notes,170);t.text(g,20,o+10)}const u=t.internal.pageSize.height;t.setTextColor(...a),t.setFontSize(10),t.setFont("helvetica","normal"),t.text("Thank you for choosing Agence de Voyage!",20,u-30),t.text("For questions about this invoice, please contact us at billing@agencedevoyage.com",20,u-20);const f=e.client?.name||"Client",h=`Invoice_${e.invoiceNumber}_${f.replace(/\s+/g,"_")}.pdf`;t.save(h)},gg=({invoices:e,onView:t,onEdit:r,onDelete:n,title:a="Recent Invoices"})=>{const i=h=>{console.log("View button clicked for invoice:",h.id),t(h)},o=h=>{console.log("Edit button clicked for invoice:",h.id),r(h)},l=h=>{console.log("Delete button clicked for invoice:",h.id),h.id&&n(h.id)},u=h=>{console.log("Download button clicked for invoice:",h.id);try{bw(h)}catch(g){console.error("Error generating PDF:",g),alert("Failed to generate PDF. Please try again.")}},f=h=>{switch(h){case"draft":return A.jsx(eg,{className:"h-4 w-4"});case"sent":return A.jsx(Zg,{className:"h-4 w-4"});case"paid":return A.jsx(Fd,{className:"h-4 w-4"});case"overdue":return A.jsx(op,{className:"h-4 w-4"});default:return A.jsx(qy,{className:"h-4 w-4"})}};return e.length===0?A.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-8 text-center",children:[A.jsx("div",{className:"text-gray-400 mb-4",children:A.jsx("svg",{className:"mx-auto h-12 w-12",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),A.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No invoices found"}),A.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Create your first invoice to get started."})]}):A.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden",children:[A.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:[A.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:a}),A.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[e.length," invoice",e.length!==1?"s":""]})]}),A.jsx("div",{className:"overflow-x-auto",children:A.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[A.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:A.jsxs("tr",{children:[A.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Invoice"}),A.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Client"}),A.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Agent"}),A.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Amount"}),A.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Status"}),A.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Date"}),A.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),A.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:e.map(h=>A.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-150",children:[A.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:A.jsxs("div",{children:[A.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:h.invoiceNumber||`INV-${String(h.id||"").substring(0,8)}`}),A.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Due: ",h.dueDate?Vc(h.dueDate):Vc(h.createdAt)]})]})}),A.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:A.jsxs("div",{className:"flex items-center space-x-3",children:[A.jsx("div",{className:"p-2 rounded-full",style:{backgroundColor:"#f0fdfc"},children:A.jsx(Tu,{className:"h-4 w-4",style:{color:"#03989e"}})}),A.jsxs("div",{children:[A.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:h.client?.name||h.clientName}),A.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:h.client?.email||h.clientEmail})]})]})}),A.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:A.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:h.agentName||"Unknown Agent"})}),A.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:A.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:Va(h.total)})}),A.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:A.jsx("div",{className:"flex items-center space-x-2",children:A.jsxs("span",{className:`inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full ${Xy(h.status)}`,children:[f(h.status),A.jsx("span",{className:"ml-1",children:h.status.charAt(0).toUpperCase()+h.status.slice(1)})]})})}),A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:Vc(h.createdAt)}),A.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:A.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[A.jsx("button",{onClick:g=>{g.preventDefault(),g.stopPropagation(),i(h)},className:"p-2 rounded-lg transition-all duration-150 hover:shadow-md",style:{color:"#03989e",backgroundColor:"transparent"},onMouseEnter:g=>{g.currentTarget.style.backgroundColor="#f0fdfc"},onMouseLeave:g=>{g.currentTarget.style.backgroundColor="transparent"},title:"View & Manage Invoice",children:A.jsx($y,{className:"h-4 w-4"})}),A.jsx("button",{onClick:g=>{g.preventDefault(),g.stopPropagation(),o(h)},className:"text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-all duration-150",title:"Edit Invoice",children:A.jsx(eg,{className:"h-4 w-4"})}),A.jsx("button",{onClick:g=>{g.preventDefault(),g.stopPropagation(),u(h)},className:"text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-300 p-2 rounded-lg hover:bg-green-50 dark:hover:bg-green-900/20 transition-all duration-150",title:"Download PDF",children:A.jsx(Xg,{className:"h-4 w-4"})}),A.jsx("button",{onClick:g=>{g.preventDefault(),g.stopPropagation(),l(h)},className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300 p-2 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 transition-all duration-150",title:"Delete Invoice",children:A.jsx(Rd,{className:"h-4 w-4"})})]})})]},h.id))})]})})]})},sS=({invoice:e,onClose:t,onEdit:r,onStatusUpdate:n})=>{const[a,i]=ce.useState(!1),[o,l]=ce.useState(!1),u=async g=>{if(n){i(!0);try{await n(e.id||"",g)}catch(x){console.error("Error updating status:",x),alert("Failed to update invoice status. Please try again.")}finally{i(!1)}}},f=async()=>{l(!0);try{bw(e)}catch(g){console.error("Error generating PDF:",g),alert("Failed to generate PDF. Please try again.")}finally{l(!1)}},h=()=>{const g=[];switch(e.status){case"draft":g.push(A.jsxs("button",{onClick:()=>u("sent"),disabled:a,className:"text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors duration-200",style:{backgroundColor:a?"#6b7280":"#03989e",opacity:a?.6:1},onMouseEnter:x=>{a||(x.currentTarget.style.backgroundColor="#027a7f")},onMouseLeave:x=>{a||(x.currentTarget.style.backgroundColor="#03989e")},children:[A.jsx(Zg,{className:"h-4 w-4"}),A.jsx("span",{children:"Send to Client"})]},"send"));break;case"sent":g.push(A.jsxs("button",{onClick:()=>u("paid"),disabled:a,className:"bg-green-600 hover:bg-green-700 disabled:bg-green-400 text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors duration-200",children:[A.jsx(Fd,{className:"h-4 w-4"}),A.jsx("span",{children:"Mark as Paid"})]},"mark-paid")),g.push(A.jsxs("button",{onClick:()=>u("overdue"),disabled:a,className:"bg-red-600 hover:bg-red-700 disabled:bg-red-400 text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors duration-200",children:[A.jsx(op,{className:"h-4 w-4"}),A.jsx("span",{children:"Mark Overdue"})]},"mark-overdue"));break;case"overdue":g.push(A.jsxs("button",{onClick:()=>u("paid"),disabled:a,className:"bg-green-600 hover:bg-green-700 disabled:bg-green-400 text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors duration-200",children:[A.jsx(Fd,{className:"h-4 w-4"}),A.jsx("span",{children:"Mark as Paid"})]},"mark-paid"));break}return g};return A.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:A.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[A.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200 dark:border-gray-700",children:[A.jsxs("div",{children:[A.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Invoice Details"}),A.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:e.invoiceNumber})]}),A.jsxs("div",{className:"flex items-center space-x-2",children:[n&&h(),A.jsxs("button",{onClick:r,className:"text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors duration-200",style:{backgroundColor:"#03989e"},onMouseEnter:g=>{g.currentTarget.style.backgroundColor="#027a7f"},onMouseLeave:g=>{g.currentTarget.style.backgroundColor="#03989e"},children:[A.jsx(eg,{className:"h-4 w-4"}),A.jsx("span",{children:"Edit"})]}),A.jsxs("button",{onClick:f,disabled:o,className:"bg-green-600 hover:bg-green-700 disabled:bg-green-400 text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors duration-200",children:[A.jsx(Xg,{className:"h-4 w-4"}),A.jsx("span",{children:o?"Generating...":"Download PDF"})]}),A.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 p-2 rounded-lg transition-colors duration-200",children:A.jsx(em,{className:"h-6 w-6"})})]})]}),A.jsxs("div",{className:"p-8",children:[A.jsxs("div",{className:"flex justify-between items-start mb-8",children:[A.jsxs("div",{children:[A.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"INVOICE"}),A.jsxs("div",{className:"space-y-1",children:[A.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Invoice Number: ",A.jsx("span",{className:"font-medium",children:e.invoiceNumber})]}),A.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Date: ",A.jsx("span",{className:"font-medium",children:Vc(e.createdAt||"")})]}),A.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Due Date: ",A.jsx("span",{className:"font-medium",children:Vc(e.dueDate||"")})]})]})]}),A.jsxs("div",{className:"text-right",children:[A.jsx("div",{className:"text-white px-4 py-2 rounded-lg inline-block mb-4",style:{backgroundColor:"#03989e"},children:A.jsx("h2",{className:"text-lg font-bold",children:"Agence de Voyage"})}),A.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[A.jsx("p",{children:"123 Travel Street"}),A.jsx("p",{children:"New York, NY 10001"}),A.jsx("p",{children:"Phone: (555) 123-4567"}),A.jsx("p",{children:"Email: info@agencedevoyage.com"})]})]})]}),A.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-8",children:[A.jsxs("div",{children:[A.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3 flex items-center space-x-2",children:[A.jsx(Tu,{className:"h-5 w-5",style:{color:"#03989e"}}),A.jsx("span",{children:"Bill To:"})]}),A.jsxs("div",{className:"border p-4 rounded-lg",style:{backgroundColor:"#f0fdfc",borderColor:"#99f6e4"},children:[A.jsx("p",{className:"font-bold text-gray-900 dark:text-white text-lg",children:e.client?.name||e.clientName||"Unknown Client"}),A.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:e.client?.email||e.clientEmail||""}),e.client?.phone&&A.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:e.client.phone}),(e.client?.address||e.notes)&&A.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:e.client?.address||""})]})]}),A.jsxs("div",{children:[A.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Agent & Status:"}),A.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[A.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:e.agentName}),A.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Travel Agent"}),A.jsx("div",{className:"mt-3",children:A.jsx("span",{className:`inline-flex px-3 py-1 text-sm font-semibold rounded-full ${Xy(e.status)}`,children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})}),n&&A.jsxs("div",{className:"mt-4 p-3 border rounded-lg",style:{backgroundColor:"#f0fdfc",borderColor:"#99f6e4"},children:[A.jsx("h4",{className:"text-sm font-medium mb-2",style:{color:"#164e63"},children:"Status Management:"}),A.jsxs("div",{className:"text-xs space-y-1",style:{color:"#155e75"},children:[e.status==="draft"&&A.jsx("p",{children:' Click "Send to Client" when ready to send this invoice'}),e.status==="sent"&&A.jsxs(A.Fragment,{children:[A.jsx("p",{children:' Click "Mark as Paid" when client pays'}),A.jsx("p",{children:' Click "Mark Overdue" if payment is late'})]}),e.status==="overdue"&&A.jsx("p",{children:' Click "Mark as Paid" when client finally pays'}),e.status==="paid"&&A.jsx("p",{children:" Invoice is fully paid - no action needed"})]})]})]})]})]}),A.jsx("div",{className:"mb-8 p-4 border rounded-lg",style:{backgroundColor:"#f0fdfc",borderColor:"#99f6e4"},children:A.jsxs("div",{className:"flex items-center space-x-3",children:[A.jsx("div",{className:"p-2 rounded-full",style:{backgroundColor:"#ccfbf1"},children:A.jsx(Tu,{className:"h-5 w-5",style:{color:"#03989e"}})}),A.jsxs("div",{children:[A.jsxs("p",{className:"text-sm font-medium",style:{color:"#164e63"},children:["Invoice created for client: ",A.jsx("span",{className:"font-bold text-lg",children:e.client?.name||e.clientName||"Unknown"})]}),A.jsxs("p",{className:"text-xs",style:{color:"#155e75"},children:["Agent ",e.agentName||"Unknown Agent"," created this invoice for the above client"]})]})]})}),A.jsxs("div",{className:"mb-8",children:[A.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Services & Items"}),A.jsx("div",{className:"overflow-x-auto",children:A.jsxs("table",{className:"w-full border border-gray-200 dark:border-gray-700 rounded-lg",children:[A.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:A.jsxs("tr",{children:[A.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700 dark:text-gray-300",children:"Description"}),A.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-700 dark:text-gray-300",children:"Qty"}),A.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-700 dark:text-gray-300",children:"Unit Price"}),A.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-700 dark:text-gray-300",children:"Total"})]})}),A.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:e.items?.map(g=>A.jsxs("tr",{children:[A.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 dark:text-white",children:g.description}),A.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 dark:text-white text-center",children:g.quantity}),A.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 dark:text-white text-right",children:Va(g.unitPrice||0)}),A.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900 dark:text-white text-right",children:Va(g.total||0)})]},g.id))})]})})]}),A.jsx("div",{className:"flex justify-end mb-8",children:A.jsx("div",{className:"w-full max-w-sm",children:A.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 p-6 rounded-lg",children:A.jsxs("div",{className:"space-y-3",children:[A.jsxs("div",{className:"flex justify-between",children:[A.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Subtotal:"}),A.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:Va(e.subtotal||0)})]}),A.jsxs("div",{className:"flex justify-between",children:[A.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Tax:"}),A.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:Va(e.tax||0)})]}),A.jsx("div",{className:"border-t dark:border-gray-600 pt-3",children:A.jsxs("div",{className:"flex justify-between",children:[A.jsx("span",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Total:"}),A.jsx("span",{className:"text-lg font-bold",style:{color:"#03989e"},children:Va(e.total)})]})})]})})})}),e.notes&&A.jsxs("div",{className:"mb-8",children:[A.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Notes"}),A.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:A.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:e.notes})})]}),A.jsxs("div",{className:"text-center text-sm text-gray-500 dark:text-gray-400 border-t dark:border-gray-700 pt-6",children:[A.jsx("p",{children:"Thank you for choosing Agence de Voyage!"}),A.jsx("p",{children:"For questions about this invoice, please contact us at billing@agencedevoyage.com"})]})]})]})})},oS=({stats:e,onViewAllInvoices:t})=>{const r=[{title:"Total Revenue",value:Va(e.totalRevenue),icon:r3,color:"#10b981",bgColor:"#f0fdf4",textColor:"#059669",clickable:!1},{title:"Total Invoices",value:e.totalInvoices.toString(),icon:j0,color:"#03989e",bgColor:"#f0fdfc",textColor:"#03989e",clickable:!0,onClick:t},{title:"Pending",value:e.pendingInvoices.toString(),icon:qy,color:"#f59e0b",bgColor:"#fffbeb",textColor:"#d97706",clickable:!1},{title:"Paid",value:e.paidInvoices.toString(),icon:Fd,color:"#10b981",bgColor:"#f0fdf4",textColor:"#059669",clickable:!1}];return A.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:r.map((n,a)=>{const i=n.clickable?"button":"div";return A.jsx(i,{onClick:n.clickable?n.onClick:void 0,className:`bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 transition-all duration-300 ${n.clickable?"hover:shadow-xl hover:scale-105 cursor-pointer transform hover:bg-blue-50 dark:hover:bg-blue-900/20":"hover:shadow-xl"}`,children:A.jsxs("div",{className:"flex items-center justify-between",children:[A.jsxs("div",{children:[A.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-1",children:n.title}),A.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:n.value}),n.clickable&&A.jsx("p",{className:"text-xs mt-1 font-medium",style:{color:n.textColor},children:"Click to view all"})]}),A.jsx("div",{className:"p-3 rounded-lg",style:{backgroundColor:n.bgColor},children:A.jsx(n.icon,{className:"h-6 w-6",style:{color:n.textColor}})})]})},a)})})},lS=({invoices:e,onView:t,onEdit:r,onDelete:n,onBack:a})=>{const[i,o]=ce.useState(""),[l,u]=ce.useState("all"),[f,h]=ce.useState("all"),[g,x]=ce.useState("date"),[m,k]=ce.useState("desc"),b=ra.useMemo(()=>{let O=e.filter(F=>{const K=(F.client?.name||"").toLowerCase().includes(i.toLowerCase())||(F.invoiceNumber||"").toLowerCase().includes(i.toLowerCase())||(F.client?.email||"").toLowerCase().includes(i.toLowerCase()),te=l==="all"||F.status===l,re=f==="all"||F.visaStatus===f;return K&&te&&re});return O.sort((F,K)=>{let te=0;switch(g){case"date":te=new Date(F.createdAt).getTime()-new Date(K.createdAt).getTime();break;case"amount":te=F.total-K.total;break;case"client":te=(F.client?.name||"").localeCompare(K.client?.name||"");break}return m==="asc"?te:-te}),O},[e,i,l,f,g,m]),E=ra.useMemo(()=>{const O=b.reduce((te,re)=>te+re.total,0),F=b.filter(te=>te.status==="paid").reduce((te,re)=>te+re.total,0),K=b.filter(te=>te.status==="sent").reduce((te,re)=>te+re.total,0);return{totalInvoices:b.length,totalAmount:O,paidAmount:F,pendingAmount:K}},[b]),N=()=>{alert("Export functionality will be implemented soon.")};return A.jsxs("div",{className:"space-y-6",children:[A.jsxs("div",{className:"flex items-center justify-between",children:[A.jsxs("div",{className:"flex items-center space-x-4",children:[A.jsxs("button",{onClick:a,className:"flex items-center space-x-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 transition-colors duration-200",children:[A.jsx(Uy,{className:"h-5 w-5"}),A.jsx("span",{children:"Back to Dashboard"})]}),A.jsx("div",{className:"h-6 w-px bg-gray-300 dark:bg-gray-600"}),A.jsxs("div",{children:[A.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"All Invoices"}),A.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Manage and view all your invoices"})]})]}),A.jsxs("button",{onClick:N,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors duration-200",children:[A.jsx(Xg,{className:"h-4 w-4"}),A.jsx("span",{children:"Export"})]})]}),A.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[A.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:A.jsxs("div",{className:"flex items-center justify-between",children:[A.jsxs("div",{children:[A.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Invoices"}),A.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:E.totalInvoices})]}),A.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg",children:A.jsx(j0,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})})]})}),A.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:A.jsxs("div",{className:"flex items-center justify-between",children:[A.jsxs("div",{children:[A.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Amount"}),A.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:Va(E.totalAmount)})]}),A.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 p-3 rounded-lg",children:A.jsx(Ef,{className:"h-6 w-6 text-green-600 dark:text-green-400"})})]})}),A.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:A.jsxs("div",{className:"flex items-center justify-between",children:[A.jsxs("div",{children:[A.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Paid Amount"}),A.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:Va(E.paidAmount)})]}),A.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 p-3 rounded-lg",children:A.jsx(Ef,{className:"h-6 w-6 text-green-600 dark:text-green-400"})})]})}),A.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:A.jsxs("div",{className:"flex items-center justify-between",children:[A.jsxs("div",{children:[A.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Pending Amount"}),A.jsx("p",{className:"text-2xl font-bold text-yellow-600 dark:text-yellow-400",children:Va(E.pendingAmount)})]}),A.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded-lg",children:A.jsx(Ef,{className:"h-6 w-6 text-yellow-600 dark:text-yellow-400"})})]})})]}),A.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6",children:[A.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between",children:[A.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 flex-1",children:[A.jsxs("div",{className:"relative flex-1 max-w-md",children:[A.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:A.jsx(Z1,{className:"h-5 w-5 text-gray-400"})}),A.jsx("input",{type:"text",value:i,onChange:O=>o(O.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Search by client name, invoice number, or email..."})]}),A.jsxs("div",{className:"flex items-center space-x-2",children:[A.jsx(i3,{className:"h-5 w-5 text-gray-500"}),A.jsxs("select",{value:l,onChange:O=>u(O.target.value),className:"border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#03989e] focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[A.jsx("option",{value:"all",children:"  ()"}),A.jsx("option",{value:"draft",children:" (Draft)"}),A.jsx("option",{value:"sent",children:" ( )"}),A.jsx("option",{value:"paid",children:" (Paid)"}),A.jsx("option",{value:"overdue",children:"  "})]})]}),A.jsxs("div",{className:"flex items-center space-x-2",children:[A.jsx(j0,{className:"h-5 w-5 text-gray-500"}),A.jsxs("select",{value:f,onChange:O=>h(O.target.value),className:"border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#03989e] focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[A.jsx("option",{value:"all",children:"  "}),A.jsx("option",{value:"Pending",children:"   (Pending)"}),A.jsx("option",{value:"Issued",children:"  (Issued)"})]})]})]}),A.jsxs("div",{className:"flex items-center space-x-4",children:[A.jsxs("div",{className:"flex items-center space-x-2",children:[A.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:" :"}),A.jsxs("select",{value:g,onChange:O=>x(O.target.value),className:"border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#03989e] focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[A.jsx("option",{value:"date",children:""}),A.jsx("option",{value:"amount",children:""}),A.jsx("option",{value:"client",children:" "})]})]}),A.jsx("button",{onClick:()=>k(m==="asc"?"desc":"asc"),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200 text-gray-700 dark:text-gray-300",children:m==="asc"?"":""})]})]}),A.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:A.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Showing ",b.length," of ",e.length," invoices",i&&` matching "${i}"`,l!=="all"&&` with status "${l}"`]})})]}),A.jsx(gg,{invoices:b,onView:t,onEdit:r,onDelete:n,title:"All Invoices"}),b.length===0&&e.length>0&&A.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-8 text-center",children:[A.jsx("div",{className:"text-gray-400 mb-4",children:A.jsx(Z1,{className:"mx-auto h-12 w-12"})}),A.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No invoices found"}),A.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Try adjusting your search terms or filters to find what you're looking for."}),A.jsx("button",{onClick:()=>{o(""),u("all")},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors duration-200",children:"Clear Filters"})]})]})};function hp(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function cS(e,t,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(h){try{f(n.next(h))}catch(g){o(g)}}function u(h){try{f(n.throw(h))}catch(g){o(g)}}function f(h){h.done?i(h.value):a(h.value).then(l,u)}f((n=n.apply(e,t||[])).next())})}const uS=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class om extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class fS extends om{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class D2 extends om{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class j2 extends om{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var mg;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(mg||(mg={}));class hS{constructor(t,{headers:r={},customFetch:n,region:a=mg.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=uS(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return cS(this,arguments,void 0,function*(r,n={}){var a;let i,o;try{const{headers:l,method:u,body:f,signal:h,timeout:g}=n;let x={},{region:m}=n;m||(m=this.region);const k=new URL(`${this.url}/${r}`);m&&m!=="any"&&(x["x-region"]=m,k.searchParams.set("forceFunctionRegion",m));let b;f&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&f instanceof Blob||f instanceof ArrayBuffer?(x["Content-Type"]="application/octet-stream",b=f):typeof f=="string"?(x["Content-Type"]="text/plain",b=f):typeof FormData<"u"&&f instanceof FormData?b=f:(x["Content-Type"]="application/json",b=JSON.stringify(f)):f&&typeof f!="string"&&!(typeof Blob<"u"&&f instanceof Blob)&&!(f instanceof ArrayBuffer)&&!(typeof FormData<"u"&&f instanceof FormData)?b=JSON.stringify(f):b=f;let E=h;g&&(o=new AbortController,i=setTimeout(()=>o.abort(),g),h?(E=o.signal,h.addEventListener("abort",()=>o.abort())):E=o.signal);const N=yield this.fetch(k.toString(),{method:u||"POST",headers:Object.assign(Object.assign(Object.assign({},x),this.headers),l),body:b,signal:E}).catch(te=>{throw new fS(te)}),O=N.headers.get("x-relay-error");if(O&&O==="true")throw new D2(N);if(!N.ok)throw new j2(N);let F=((a=N.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),K;return F==="application/json"?K=yield N.json():F==="application/octet-stream"||F==="application/pdf"?K=yield N.blob():F==="text/event-stream"?K=N:F==="multipart/form-data"?K=yield N.formData():K=yield N.text(),{data:K,error:null,response:N}}catch(l){return{data:null,error:l,response:l instanceof j2||l instanceof D2?l.context:void 0}}finally{i&&clearTimeout(i)}})}}var dS=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},pS=class{constructor(e){var t,r,n;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,this.urlLengthLimit=(n=e.urlLengthLimit)!==null&&n!==void 0?n:8e3,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{let o=null,l=null,u=null,f=i.status,h=i.statusText;if(i.ok){var g,x;if(r.method!=="HEAD"){var m;const N=await i.text();N===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((m=r.headers.get("Accept"))===null||m===void 0)&&m.includes("application/vnd.pgrst.plan+text"))?l=N:l=JSON.parse(N))}const b=(g=r.headers.get("Prefer"))===null||g===void 0?void 0:g.match(/count=(exact|planned|estimated)/),E=(x=i.headers.get("content-range"))===null||x===void 0?void 0:x.split("/");b&&E&&E.length>1&&(u=parseInt(E[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(l)&&(l.length>1?(o={code:"PGRST116",details:`Results contain ${l.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},l=null,u=null,f=406,h="Not Acceptable"):l.length===1?l=l[0]:l=null)}else{var k;const b=await i.text();try{o=JSON.parse(b),Array.isArray(o)&&i.status===404&&(l=[],o=null,f=200,h="OK")}catch{i.status===404&&b===""?(f=204,h="No Content"):o={message:b}}if(o&&r.isMaybeSingle&&(!(o==null||(k=o.details)===null||k===void 0)&&k.includes("0 rows"))&&(o=null,f=200,h="OK"),o&&r.shouldThrowOnError)throw new dS(o)}return{error:o,data:l,count:u,status:f,statusText:h}});return this.shouldThrowOnError||(a=a.catch(i=>{var o;let l="",u="",f="";const h=i?.cause;if(h){var g,x,m,k;const N=(g=h?.message)!==null&&g!==void 0?g:"",O=(x=h?.code)!==null&&x!==void 0?x:"";l=`${(m=i?.name)!==null&&m!==void 0?m:"FetchError"}: ${i?.message}`,l+=`

Caused by: ${(k=h?.name)!==null&&k!==void 0?k:"Error"}: ${N}`,O&&(l+=` (${O})`),h?.stack&&(l+=`
${h.stack}`)}else{var b;l=(b=i?.stack)!==null&&b!==void 0?b:""}const E=this.url.toString().length;return i?.name==="AbortError"||i?.code==="ABORT_ERR"?(f="",u="Request was aborted (timeout or manual cancellation)",E>this.urlLengthLimit&&(u+=`. Note: Your request URL is ${E} characters, which may exceed server limits. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [many IDs])), consider using an RPC function to pass values server-side.`)):(h?.name==="HeadersOverflowError"||h?.code==="UND_ERR_HEADERS_OVERFLOW")&&(f="",u="HTTP headers exceeded server limits (typically 16KB)",E>this.urlLengthLimit&&(u+=`. Your request URL is ${E} characters. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [200+ IDs])), consider using an RPC function instead.`)),{error:{message:`${(o=i?.name)!==null&&o!==void 0?o:"FetchError"}: ${i?.message}`,details:l,hint:u,code:f},data:null,count:null,status:0,statusText:""}})),a.then(e,t)}returns(){return this}overrideTypes(){return this}},gS=class extends pS{select(e){let t=!1;const r=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:a=n}={}){const i=a?`${a}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n>"u"?"offset":`${n}.offset`,i=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${e}`),this.url.searchParams.set(i,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:a=!1,format:i="text"}={}){var o;const l=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,a?"wal":null].filter(Boolean).join("|"),u=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${u}"; options=${l};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const M2=new RegExp("[,()]");var vf=class extends gS{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&M2.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&M2.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let a="";n==="plain"?a="pl":n==="phrase"?a="ph":n==="websearch"&&(a="w");const i=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${a}fts${i}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},mS=class{constructor(e,{headers:t={},schema:r,fetch:n,urlLengthLimit:a=8e3}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=n,this.urlLengthLimit=a}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:r=!1,count:n}=t??{},a=r?"HEAD":"GET";let i=!1;const o=(e??"*").split("").map(f=>/\s/.test(f)&&!i?"":(f==='"'&&(i=!i),f)).join(""),{url:l,headers:u}=this.cloneRequestState();return l.searchParams.set("select",o),n&&u.append("Prefer",`count=${n}`),new vf({method:a,url:l,headers:u,schema:this.schema,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}insert(e,{count:t,defaultToNull:r=!0}={}){var n;const a="POST",{url:i,headers:o}=this.cloneRequestState();if(t&&o.append("Prefer",`count=${t}`),r||o.append("Prefer","missing=default"),Array.isArray(e)){const l=e.reduce((u,f)=>u.concat(Object.keys(f)),[]);if(l.length>0){const u=[...new Set(l)].map(f=>`"${f}"`);i.searchParams.set("columns",u.join(","))}}return new vf({method:a,url:i,headers:o,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch,urlLengthLimit:this.urlLengthLimit})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:a=!0}={}){var i;const o="POST",{url:l,headers:u}=this.cloneRequestState();if(u.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&l.searchParams.set("on_conflict",t),n&&u.append("Prefer",`count=${n}`),a||u.append("Prefer","missing=default"),Array.isArray(e)){const f=e.reduce((h,g)=>h.concat(Object.keys(g)),[]);if(f.length>0){const h=[...new Set(f)].map(g=>`"${g}"`);l.searchParams.set("columns",h.join(","))}}return new vf({method:o,url:l,headers:u,schema:this.schema,body:e,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch,urlLengthLimit:this.urlLengthLimit})}update(e,{count:t}={}){var r;const n="PATCH",{url:a,headers:i}=this.cloneRequestState();return t&&i.append("Prefer",`count=${t}`),new vf({method:n,url:a,headers:i,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch,urlLengthLimit:this.urlLengthLimit})}delete({count:e}={}){var t;const r="DELETE",{url:n,headers:a}=this.cloneRequestState();return e&&a.append("Prefer",`count=${e}`),new vf({method:r,url:n,headers:a,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch,urlLengthLimit:this.urlLengthLimit})}};function U0(e){"@babel/helpers - typeof";return U0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U0(e)}function vS(e,t){if(U0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(U0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xS(e){var t=vS(e,"string");return U0(t)=="symbol"?t:t+""}function yS(e,t,r){return(t=xS(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function B2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function sd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?B2(Object(r),!0).forEach(function(n){yS(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var wS=class _w{constructor(t,{headers:r={},schema:n,fetch:a,timeout:i,urlLengthLimit:o=8e3}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.urlLengthLimit=o;const l=a??globalThis.fetch;i!==void 0&&i>0?this.fetch=(u,f)=>{const h=new AbortController,g=setTimeout(()=>h.abort(),i),x=f?.signal;if(x){if(x.aborted)return clearTimeout(g),l(u,f);const m=()=>{clearTimeout(g),h.abort()};return x.addEventListener("abort",m,{once:!0}),l(u,sd(sd({},f),{},{signal:h.signal})).finally(()=>{clearTimeout(g),x.removeEventListener("abort",m)})}return l(u,sd(sd({},f),{},{signal:h.signal})).finally(()=>clearTimeout(g))}:this.fetch=l}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new mS(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}schema(t){return new _w(this.url,{headers:this.headers,schema:t,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}rpc(t,r={},{head:n=!1,get:a=!1,count:i}={}){var o;let l;const u=new URL(`${this.url}/rpc/${t}`);let f;const h=m=>m!==null&&typeof m=="object"&&(!Array.isArray(m)||m.some(h)),g=n&&Object.values(r).some(h);g?(l="POST",f=r):n||a?(l=n?"HEAD":"GET",Object.entries(r).filter(([m,k])=>k!==void 0).map(([m,k])=>[m,Array.isArray(k)?`{${k.join(",")}}`:`${k}`]).forEach(([m,k])=>{u.searchParams.append(m,k)})):(l="POST",f=r);const x=new Headers(this.headers);return g?x.set("Prefer",i?`count=${i},return=minimal`:"return=minimal"):i&&x.set("Prefer",`count=${i}`),new vf({method:l,url:u,headers:x,schema:this.schemaName,body:f,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch,urlLengthLimit:this.urlLengthLimit})}};class bS{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const n=r.versions;if(n&&n.node){const a=n.node,i=parseInt(a.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const _S="2.95.3",kS=`realtime-js/${_S}`,SS="1.0.0",kw="2.0.0",U2=kw,vg=1e4,ES=1e3,AS=100;var jc;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(jc||(jc={}));var qa;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(qa||(qa={}));var rl;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(rl||(rl={}));var xg;(function(e){e.websocket="websocket"})(xg||(xg={}));var wu;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(wu||(wu={}));class NS{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n;const a=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,a)}_encodeJsonUserBroadcastPush(t){var r,n;const a=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},o=new TextEncoder().encode(JSON.stringify(a)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(t,r,n){var a,i;const o=t.topic,l=(a=t.ref)!==null&&a!==void 0?a:"",u=(i=t.join_ref)!==null&&i!==void 0?i:"",f=t.payload.event,h=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},g=Object.keys(h).length===0?"":JSON.stringify(h);if(u.length>255)throw new Error(`joinRef length ${u.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`ref length ${l.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`userEvent length ${f.length} exceeds maximum of 255`);if(g.length>255)throw new Error(`metadata length ${g.length} exceeds maximum of 255`);const x=this.USER_BROADCAST_PUSH_META_LENGTH+u.length+l.length+o.length+f.length+g.length,m=new ArrayBuffer(this.HEADER_LENGTH+x);let k=new DataView(m),b=0;k.setUint8(b++,this.KINDS.userBroadcastPush),k.setUint8(b++,u.length),k.setUint8(b++,l.length),k.setUint8(b++,o.length),k.setUint8(b++,f.length),k.setUint8(b++,g.length),k.setUint8(b++,r),Array.from(u,N=>k.setUint8(b++,N.charCodeAt(0))),Array.from(l,N=>k.setUint8(b++,N.charCodeAt(0))),Array.from(o,N=>k.setUint8(b++,N.charCodeAt(0))),Array.from(f,N=>k.setUint8(b++,N.charCodeAt(0))),Array.from(g,N=>k.setUint8(b++,N.charCodeAt(0)));var E=new Uint8Array(m.byteLength+n.byteLength);return E.set(new Uint8Array(m),0),E.set(new Uint8Array(n),m.byteLength),E.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[a,i,o,l,u]=n;return r({join_ref:a,ref:i,topic:o,event:l,payload:u})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),a=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,a)}}_decodeUserBroadcast(t,r,n){const a=r.getUint8(1),i=r.getUint8(2),o=r.getUint8(3),l=r.getUint8(4);let u=this.HEADER_LENGTH+4;const f=n.decode(t.slice(u,u+a));u=u+a;const h=n.decode(t.slice(u,u+i));u=u+i;const g=n.decode(t.slice(u,u+o));u=u+o;const x=t.slice(u,t.byteLength),m=l===this.JSON_ENCODING?JSON.parse(n.decode(x)):x,k={type:this.BROADCAST_EVENT,event:h,payload:m};return o>0&&(k.meta=JSON.parse(g)),{join_ref:null,ref:null,topic:f,event:this.BROADCAST_EVENT,payload:k}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([n])=>r.includes(n)))}}class Sw{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Wn;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Wn||(Wn={}));const z2=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((i,o)=>(i[o]=TS(o,e,t,a),i),{}):{}},TS=(e,t,r,n)=>{const a=t.find(l=>l.name===e),i=a?.type,o=r[e];return i&&!n.includes(i)?Ew(i,o):yg(o)},Ew=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return FS(t,r)}switch(e){case Wn.bool:return CS(t);case Wn.float4:case Wn.float8:case Wn.int2:case Wn.int4:case Wn.int8:case Wn.numeric:case Wn.oid:return PS(t);case Wn.json:case Wn.jsonb:return LS(t);case Wn.timestamp:return OS(t);case Wn.abstime:case Wn.date:case Wn.daterange:case Wn.int4range:case Wn.int8range:case Wn.money:case Wn.reltime:case Wn.text:case Wn.time:case Wn.timestamptz:case Wn.timetz:case Wn.tsrange:case Wn.tstzrange:return yg(t);default:return yg(t)}},yg=e=>e,CS=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},PS=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},LS=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},FS=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const o=e.slice(1,r);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>Ew(t,l))}return e},OS=e=>typeof e=="string"?e.replace(" ","T"):e,Aw=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class P1{constructor(t,r,n={},a=vg){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var q2;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(q2||(q2={}));class _0{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=_0.syncState(this.state,a,i,o),this.pendingDiffs.forEach(u=>{this.state=_0.syncDiff(this.state,u,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},a=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=_0.syncDiff(this.state,a,i,o),l())}),this.onJoin((a,i,o)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:o})}),this.onLeave((a,i,o)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const i=this.cloneDeep(t),o=this.transformState(r),l={},u={};return this.map(i,(f,h)=>{o[f]||(u[f]=h)}),this.map(o,(f,h)=>{const g=i[f];if(g){const x=h.map(E=>E.presence_ref),m=g.map(E=>E.presence_ref),k=h.filter(E=>m.indexOf(E.presence_ref)<0),b=g.filter(E=>x.indexOf(E.presence_ref)<0);k.length>0&&(l[f]=k),b.length>0&&(u[f]=b)}else l[f]=h}),this.syncDiff(i,{joins:l,leaves:u},n,a)}static syncDiff(t,r,n,a){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(i,(l,u)=>{var f;const h=(f=t[l])!==null&&f!==void 0?f:[];if(t[l]=this.cloneDeep(u),h.length>0){const g=t[l].map(m=>m.presence_ref),x=h.filter(m=>g.indexOf(m.presence_ref)<0);t[l].unshift(...x)}n(l,h,u)}),this.map(o,(l,u)=>{let f=t[l];if(!f)return;const h=u.map(g=>g.presence_ref);f=f.filter(g=>h.indexOf(g.presence_ref)<0),t[l]=f,a(l,f,u),f.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var $2;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})($2||($2={}));var k0;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(k0||(k0={}));var rc;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(rc||(rc={}));class kf{constructor(t,r={config:{}},n){var a,i;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=qa.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new P1(this,rl.join,this.params,this.timeout),this.rejoinTimer=new Sw(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=qa.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=qa.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=qa.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=qa.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=qa.errored,this.rejoinTimer.scheduleTimeout())}),this._on(rl.reply,{},(o,l)=>{this._trigger(this._replyEventName(l),o)}),this.presence=new _0(this),this.broadcastEndpointURL=Aw(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,a,i;if(this.socket.isConnected()||this.socket.connect(),this.state==qa.closed){const{config:{broadcast:o,presence:l,private:u}}=this.params,f=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(m=>m.filter))!==null&&a!==void 0?a:[],h=!!this.bindings[k0.PRESENCE]&&this.bindings[k0.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,g={},x={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:h}),postgres_changes:f,private:u};this.socket.accessTokenValue&&(g.access_token=this.socket.accessTokenValue),this._onError(m=>t?.(rc.CHANNEL_ERROR,m)),this._onClose(()=>t?.(rc.CLOSED)),this.updateJoinPayload(Object.assign({config:x},g)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:m})=>{var k;if(this.socket._isManualToken()||this.socket.setAuth(),m===void 0){t?.(rc.SUBSCRIBED);return}else{const b=this.bindings.postgres_changes,E=(k=b?.length)!==null&&k!==void 0?k:0,N=[];for(let O=0;O<E;O++){const F=b[O],{filter:{event:K,schema:te,table:re,filter:B}}=F,V=m&&m[O];if(V&&V.event===K&&kf.isFilterValueEqual(V.schema,te)&&kf.isFilterValueEqual(V.table,re)&&kf.isFilterValueEqual(V.filter,B))N.push(Object.assign(Object.assign({},F),{id:V.id}));else{this.unsubscribe(),this.state=qa.errored,t?.(rc.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=N,t&&t(rc.SUBSCRIBED);return}}).receive("error",m=>{this.state=qa.errored,t?.(rc.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{t?.(rc.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===qa.joined&&t===k0.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var a;if(r==null)return Promise.reject("Payload is required for httpSend()");const i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(a=n.timeout)!==null&&a!==void 0?a:this.timeout);if(l.status===202)return{success:!0};let u=l.statusText;try{const f=await l.json();u=f.error||f.message||u}catch{}return Promise.reject(new Error(u))}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:o}=t,l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const u={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const f=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=f.body)===null||a===void 0?void 0:a.cancel()),f.ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,u;const f=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((u=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||u===void 0)&&u.ack)&&i("ok"),f.receive("ok",()=>i("ok")),f.receive("error",()=>i("error")),f.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=qa.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(rl.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new P1(this,rl.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=qa.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const a=new AbortController,i=setTimeout(()=>a.abort(),n),o=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(i),o}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new P1(this,t,r,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>AS){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,i;const o=t.toLocaleLowerCase(),{close:l,error:u,leave:f,join:h}=rl;if(n&&[l,u,f,h].indexOf(o)>=0&&n!==this._joinRef())return;let x=this._onMessage(o,r,n);if(r&&!x)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(m=>{var k,b,E;return((k=m.filter)===null||k===void 0?void 0:k.event)==="*"||((E=(b=m.filter)===null||b===void 0?void 0:b.event)===null||E===void 0?void 0:E.toLocaleLowerCase())===o}).map(m=>m.callback(x,n)):(i=this.bindings[o])===null||i===void 0||i.filter(m=>{var k,b,E,N,O,F;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in m){const K=m.id,te=(k=m.filter)===null||k===void 0?void 0:k.event;return K&&((b=r.ids)===null||b===void 0?void 0:b.includes(K))&&(te==="*"||te?.toLocaleLowerCase()===((E=r.data)===null||E===void 0?void 0:E.type.toLocaleLowerCase()))}else{const K=(O=(N=m?.filter)===null||N===void 0?void 0:N.event)===null||O===void 0?void 0:O.toLocaleLowerCase();return K==="*"||K===((F=r?.event)===null||F===void 0?void 0:F.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===o}).map(m=>{if(typeof x=="object"&&"ids"in x){const k=x.data,{schema:b,table:E,commit_timestamp:N,type:O,errors:F}=k;x=Object.assign(Object.assign({},{schema:b,table:E,commit_timestamp:N,eventType:O,new:{},old:{},errors:F}),this._getPayloadRecords(k))}m.callback(x,n)})}_isClosed(){return this.state===qa.closed}_isJoined(){return this.state===qa.joined}_isJoining(){return this.state===qa.joining}_isLeaving(){return this.state===qa.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),i={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&kf.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(rl.close,{},t)}_onError(t){this._on(rl.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=qa.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=z2(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=z2(t.columns,t.old_record)),r}}const L1=()=>{},od={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},IS=[1e3,2e3,5e3,1e4],RS=1e4,DS=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class jS{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=vg,this.transport=null,this.heartbeatIntervalMs=od.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=L1,this.ref=0,this.reconnectTimer=null,this.vsn=U2,this.logger=L1,this.conn=null,this.sendBuffer=[],this.serializer=new NS,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=a=>a?(...i)=>a(...i):(...i)=>fetch(...i),!(!((n=r?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${xg.websocket}`,this.httpEndpoint=Aw(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=bS.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return r==="ok"&&this._remove(t),this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case jc.connecting:return wu.Connecting;case jc.open:return wu.Open;case jc.closing:return wu.Closing;default:return wu.Closed}}isConnected(){return this.connectionState()===wu.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(i=>i.topic===n);if(a)return a;{const i=new kf(`realtime:${t}`,r,this);return this.channels.push(i),i}}push(t){const{topic:r,event:n,payload:a,ref:i}=t,o=()=>{this.encode(t,l=>{var u;(u=this.conn)===null||u===void 0||u.send(l)})};this.log("push",`${r} ${n} (${i})`,a),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(ES,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},od.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const f=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",f)}catch(h){this.log("error","error in heartbeat callback",h)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:n,event:a,payload:i,ref:o}=r,l=o?`(${o})`:"",u=i.status||"";this.log("receive",`${u} ${n} ${a} ${l}`.trim(),i),this.channels.filter(f=>f._isMember(n)).forEach(f=>f._trigger(a,i,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===jc.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===jc.open||this.conn.readyState===jc.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t);try{this.heartbeatCallback("error")}catch(r){this.log("error","error in heartbeat callback",r)}}_triggerChanError(){this.channels.forEach(t=>t._trigger(rl.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([DS],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,n=!1;if(t)r=t,n=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(a){this.log("error","Error fetching access token from callback",a),r=this.accessTokenValue}else r=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(a=>{const i={access_token:r,version:kS};r&&a.updateJoinPayload(i),a.joinedOnce&&a._isJoined()&&a._push(rl.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new Sw(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},od.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,a,i,o,l,u,f,h,g,x,m;switch(this.transport=(r=t?.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t?.timeout)!==null&&n!==void 0?n:vg,this.heartbeatIntervalMs=(a=t?.heartbeatIntervalMs)!==null&&a!==void 0?a:od.HEARTBEAT_INTERVAL,this.worker=(i=t?.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=t?.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=t?.heartbeatCallback)!==null&&l!==void 0?l:L1,this.vsn=(u=t?.vsn)!==null&&u!==void 0?u:U2,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(f=t?.reconnectAfterMs)!==null&&f!==void 0?f:k=>IS[k-1]||RS,this.vsn){case SS:this.encode=(h=t?.encode)!==null&&h!==void 0?h:(k,b)=>b(JSON.stringify(k)),this.decode=(g=t?.decode)!==null&&g!==void 0?g:(k,b)=>b(JSON.parse(k));break;case kw:this.encode=(x=t?.encode)!==null&&x!==void 0?x:this.serializer.encode.bind(this.serializer),this.decode=(m=t?.decode)!==null&&m!==void 0?m:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}var z0=class extends Error{constructor(e,t){super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&t.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function MS(e,t,r){const n=new URL(t,e);if(r)for(const[a,i]of Object.entries(r))i!==void 0&&n.searchParams.set(a,i);return n.toString()}async function BS(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function US(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:a,body:i,headers:o}){const l=MS(e.baseUrl,n,a),u=await BS(e.auth),f=await t(l,{method:r,headers:{...i?{"Content-Type":"application/json"}:{},...u,...o},body:i?JSON.stringify(i):void 0}),h=await f.text(),g=(f.headers.get("content-type")||"").includes("application/json"),x=g&&h?JSON.parse(h):h;if(!f.ok){const m=g?x:void 0,k=m?.error;throw new z0(k?.message??`Request failed with status ${f.status}`,{status:f.status,icebergType:k?.type,icebergCode:k?.code,details:m})}return{status:f.status,headers:f.headers,data:x}}}}function ld(e){return e.join("")}var zS=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:ld(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${ld(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ld(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${ld(e.namespace)}`}),!0}catch(t){if(t instanceof z0&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof z0&&r.status===409)return;throw r}}};function lf(e){return e.join("")}var qS=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${lf(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${lf(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${lf(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${lf(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String(t?.purge??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${lf(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${lf(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof z0&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof z0&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},$S=class{constructor(e){let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=US({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=e.accessDelegation?.join(","),this.namespaceOps=new zS(this.client,t),this.tableOps=new qS(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},dp=class extends Error{constructor(e,t="storage",r,n){super(e),this.__isStorageError=!0,this.namespace=t,this.name=t==="vectors"?"StorageVectorsError":"StorageError",this.status=r,this.statusCode=n}};function pp(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var cd=class extends dp{constructor(e,t,r,n="storage"){super(e,n,t,r),this.name=n==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Nw=class extends dp{constructor(e,t,r="storage"){super(e,r),this.name=r==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=t}};const HS=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),VS=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},wg=e=>{if(Array.isArray(e))return e.map(r=>wg(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[a]=wg(n)}),t},WS=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function q0(e){"@babel/helpers - typeof";return q0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q0(e)}function KS(e,t){if(q0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(q0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function GS(e){var t=KS(e,"string");return q0(t)=="symbol"?t:t+""}function YS(e,t,r){return(t=GS(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function H2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Cr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?H2(Object(r),!0).forEach(function(n){YS(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const V2=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},XS=async(e,t,r,n)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!r?.noResolveJson){const a=e,i=a.status||500;if(typeof a.json=="function")a.json().then(o=>{const l=o?.statusCode||o?.code||i+"";t(new cd(V2(o),i,l,n))}).catch(()=>{if(n==="vectors"){const o=i+"";t(new cd(a.statusText||`HTTP ${i} error`,i,o,n))}else{const o=i+"";t(new cd(a.statusText||`HTTP ${i} error`,i,o,n))}});else{const o=i+"";t(new cd(a.statusText||`HTTP ${i} error`,i,o,n))}}else t(new Nw(V2(e),e,n))},JS=(e,t,r,n)=>{const a={method:e,headers:t?.headers||{}};return e==="GET"||e==="HEAD"||!n?Cr(Cr({},a),r):(VS(n)?(a.headers=Cr({"Content-Type":"application/json"},t?.headers),a.body=JSON.stringify(n)):a.body=n,t?.duplex&&(a.duplex=t.duplex),Cr(Cr({},a),r))};async function d0(e,t,r,n,a,i,o){return new Promise((l,u)=>{e(r,JS(t,n,a,i)).then(f=>{if(!f.ok)throw f;if(n?.noResolveJson)return f;if(o==="vectors"){const h=f.headers.get("content-type");if(f.headers.get("content-length")==="0"||f.status===204)return{};if(!h||!h.includes("application/json"))return{}}return f.json()}).then(f=>l(f)).catch(f=>XS(f,u,n,o))})}function Tw(e="storage"){return{get:async(t,r,n,a)=>d0(t,"GET",r,n,a,void 0,e),post:async(t,r,n,a,i)=>d0(t,"POST",r,a,i,n,e),put:async(t,r,n,a,i)=>d0(t,"PUT",r,a,i,n,e),head:async(t,r,n,a)=>d0(t,"HEAD",r,Cr(Cr({},n),{},{noResolveJson:!0}),a,void 0,e),remove:async(t,r,n,a,i)=>d0(t,"DELETE",r,a,i,n,e)}}const QS=Tw("storage"),{get:$0,post:tl,put:bg,head:ZS,remove:lm}=QS,to=Tw("vectors");var Uf=class{constructor(e,t={},r,n="storage"){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.fetch=HS(r),this.namespace=n}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(e){var t=this;try{return{data:await e(),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(pp(r))return{data:null,error:r};throw r}}},eE=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(pp(t))return{data:null,error:t};throw t}}};let Cw;Cw=Symbol.toStringTag;var tE=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[Cw]="BlobDownloadBuilder",this.promise=null}asStream(){return new eE(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(pp(t))return{data:null,error:t};throw t}}};const rE={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},W2={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var nE=class extends Uf{constructor(e,t={},r,n){super(e,t,n,"storage"),this.bucketId=r}async uploadOrUpdate(e,t,r,n){var a=this;return a.handleOperation(async()=>{let i;const o=Cr(Cr({},W2),n);let l=Cr(Cr({},a.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const u=o.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),u&&i.append("metadata",a.encodeMetadata(u)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.has("cacheControl")||i.append("cacheControl",o.cacheControl),u&&!i.has("metadata")&&i.append("metadata",a.encodeMetadata(u))):(i=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,u&&(l["x-metadata"]=a.toBase64(a.encodeMetadata(u))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!o.duplex&&(o.duplex="half")),n?.headers&&(l=Cr(Cr({},l),n.headers));const f=a._removeEmptyFolders(t),h=a._getFinalPath(f),g=await(e=="PUT"?bg:tl)(a.fetch,`${a.url}/object/${h}`,i,Cr({headers:l},o?.duplex?{duplex:o.duplex}:{}));return{path:f,id:g.Id,fullPath:g.Key}})}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,n){var a=this;const i=a._removeEmptyFolders(e),o=a._getFinalPath(i),l=new URL(a.url+`/object/upload/sign/${o}`);return l.searchParams.set("token",t),a.handleOperation(async()=>{let u;const f=Cr({upsert:W2.upsert},n),h=Cr(Cr({},a.headers),{"x-upsert":String(f.upsert)});return typeof Blob<"u"&&r instanceof Blob?(u=new FormData,u.append("cacheControl",f.cacheControl),u.append("",r)):typeof FormData<"u"&&r instanceof FormData?(u=r,u.append("cacheControl",f.cacheControl)):(u=r,h["cache-control"]=`max-age=${f.cacheControl}`,h["content-type"]=f.contentType),{path:i,fullPath:(await bg(a.fetch,l.toString(),u,{headers:h})).Key}})}async createSignedUploadUrl(e,t){var r=this;return r.handleOperation(async()=>{let n=r._getFinalPath(e);const a=Cr({},r.headers);t?.upsert&&(a["x-upsert"]="true");const i=await tl(r.fetch,`${r.url}/object/upload/sign/${n}`,{},{headers:a}),o=new URL(r.url+i.url),l=o.searchParams.get("token");if(!l)throw new dp("No token returned by API");return{signedUrl:o.toString(),path:e,token:l}})}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var n=this;return n.handleOperation(async()=>await tl(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:n.headers}))}async copy(e,t,r){var n=this;return n.handleOperation(async()=>({path:(await tl(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:n.headers})).Key}))}async createSignedUrl(e,t,r){var n=this;return n.handleOperation(async()=>{let a=n._getFinalPath(e),i=await tl(n.fetch,`${n.url}/object/sign/${a}`,Cr({expiresIn:t},r?.transform?{transform:r.transform}:{}),{headers:n.headers});const o=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{signedUrl:encodeURI(`${n.url}${i.signedURL}${o}`)}})}async createSignedUrls(e,t,r){var n=this;return n.handleOperation(async()=>{const a=await tl(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:t,paths:e},{headers:n.headers}),i=r?.download?`&download=${r.download===!0?"":r.download}`:"";return a.map(o=>Cr(Cr({},o),{},{signedUrl:o.signedURL?encodeURI(`${n.url}${o.signedURL}${i}`):null}))})}download(e,t,r){const n=typeof t?.transform<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString(t?.transform||{}),i=a?`?${a}`:"",o=this._getFinalPath(e),l=()=>$0(this.fetch,`${this.url}/${n}/${o}${i}`,{headers:this.headers,noResolveJson:!0},r);return new tE(l,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);return t.handleOperation(async()=>wg(await $0(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})))}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await ZS(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(pp(n)&&n instanceof Nw){const a=n.originalError;if([400,404].includes(a?.status))return{data:!1,error:n}}throw n}}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],a=t?.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&n.push(a);const i=typeof t?.transform<"u"?"render/image":"object",o=this.transformOptsToQueryString(t?.transform||{});o!==""&&n.push(o);let l=n.join("&");return l!==""&&(l=`?${l}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${r}${l}`)}}}async remove(e){var t=this;return t.handleOperation(async()=>await lm(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}))}async list(e,t,r){var n=this;return n.handleOperation(async()=>{const a=Cr(Cr(Cr({},rE),t),{},{prefix:e||""});return await tl(n.fetch,`${n.url}/object/list/${n.bucketId}`,a,{headers:n.headers},r)})}async listV2(e,t){var r=this;return r.handleOperation(async()=>{const n=Cr({},e);return await tl(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,n,{headers:r.headers},t)})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const aE="2.95.3",lh={"X-Client-Info":`storage-js/${aE}`};var iE=class extends Uf{constructor(e,t={},r,n){const a=new URL(e);n?.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase."));const i=a.href.replace(/\/$/,""),o=Cr(Cr({},lh),t);super(i,o,r,"storage")}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const r=t.listBucketOptionsToQueryString(e);return await $0(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers})})}async getBucket(e){var t=this;return t.handleOperation(async()=>await $0(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}))}async createBucket(e,t={public:!1}){var r=this;return r.handleOperation(async()=>await tl(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async updateBucket(e,t){var r=this;return r.handleOperation(async()=>await bg(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async emptyBucket(e){var t=this;return t.handleOperation(async()=>await tl(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await lm(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},sE=class extends Uf{constructor(e,t={},r){const n=e.replace(/\/$/,""),a=Cr(Cr({},lh),t);super(n,a,r,"storage")}async createBucket(e){var t=this;return t.handleOperation(async()=>await tl(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}))}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const r=new URLSearchParams;e?.limit!==void 0&&r.set("limit",e.limit.toString()),e?.offset!==void 0&&r.set("offset",e.offset.toString()),e?.sortColumn&&r.set("sortColumn",e.sortColumn),e?.sortOrder&&r.set("sortOrder",e.sortOrder),e?.search&&r.set("search",e.search);const n=r.toString(),a=n?`${t.url}/bucket?${n}`:`${t.url}/bucket`;return await $0(t.fetch,a,{headers:t.headers})})}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await lm(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}from(e){var t=this;if(!WS(e))throw new dp("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new $S({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(a,i){const o=a[i];return typeof o!="function"?o:async(...l)=>{try{return{data:await o.apply(a,l),error:null}}catch(u){if(n)throw u;return{data:null,error:u}}}}})}},oE=class extends Uf{constructor(e,t={},r){const n=e.replace(/\/$/,""),a=Cr(Cr({},lh),{},{"Content-Type":"application/json"},t);super(n,a,r,"vectors")}async createIndex(e){var t=this;return t.handleOperation(async()=>await to.post(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{})}async getIndex(e,t){var r=this;return r.handleOperation(async()=>await to.post(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}))}async listIndexes(e){var t=this;return t.handleOperation(async()=>await to.post(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}))}async deleteIndex(e,t){var r=this;return r.handleOperation(async()=>await to.post(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{})}},lE=class extends Uf{constructor(e,t={},r){const n=e.replace(/\/$/,""),a=Cr(Cr({},lh),{},{"Content-Type":"application/json"},t);super(n,a,r,"vectors")}async putVectors(e){var t=this;if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return t.handleOperation(async()=>await to.post(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{})}async getVectors(e){var t=this;return t.handleOperation(async()=>await to.post(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}))}async listVectors(e){var t=this;if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return t.handleOperation(async()=>await to.post(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}))}async queryVectors(e){var t=this;return t.handleOperation(async()=>await to.post(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}))}async deleteVectors(e){var t=this;if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return t.handleOperation(async()=>await to.post(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{})}},cE=class extends Uf{constructor(e,t={},r){const n=e.replace(/\/$/,""),a=Cr(Cr({},lh),{},{"Content-Type":"application/json"},t);super(n,a,r,"vectors")}async createBucket(e){var t=this;return t.handleOperation(async()=>await to.post(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}async getBucket(e){var t=this;return t.handleOperation(async()=>await to.post(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}))}async listBuckets(e={}){var t=this;return t.handleOperation(async()=>await to.post(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await to.post(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}},uE=class extends cE{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new fE(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},fE=class extends oE{constructor(e,t,r,n){super(e,t,n),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,Cr(Cr({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,Cr(Cr({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new hE(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},hE=class extends lE{constructor(e,t,r,n,a){super(e,t,a),this.vectorBucketName=r,this.indexName=n}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,Cr(Cr({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,Cr(Cr({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,Cr(Cr({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,Cr(Cr({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,Cr(Cr({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},dE=class extends iE{constructor(e,t={},r,n){super(e,t,r,n)}from(e){return new nE(this.url,this.headers,e,this.fetch)}get vectors(){return new uE(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new sE(this.url+"/iceberg",this.headers,this.fetch)}};const Pw="2.95.3",xf=30*1e3,_g=3,F1=_g*xf,pE="http://localhost:9999",gE="supabase.auth.token",mE={"X-Client-Info":`gotrue-js/${Pw}`},kg="X-Supabase-Api-Version",Lw={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},vE=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,xE=10*60*1e3;class H0 extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function xr(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class yE extends H0{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function wE(e){return xr(e)&&e.name==="AuthApiError"}class bu extends H0{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class hc extends H0{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class Qs extends hc{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function O1(e){return xr(e)&&e.name==="AuthSessionMissingError"}class cf extends hc{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ud extends hc{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class fd extends hc{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function bE(e){return xr(e)&&e.name==="AuthImplicitGrantRedirectError"}class K2 extends hc{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class _E extends hc{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Sg extends hc{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function I1(e){return xr(e)&&e.name==="AuthRetryableFetchError"}class G2 extends hc{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Eg extends hc{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Md="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Y2=` 	
\r=`.split(""),kE=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Y2.length;t+=1)e[Y2[t].charCodeAt(0)]=-2;for(let t=0;t<Md.length;t+=1)e[Md[t].charCodeAt(0)]=t;return e})();function X2(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Md[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Md[n]),t.queuedBits-=6}}function Fw(e,t,r){const n=kE[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function J2(e){const t=[],r=o=>{t.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=o=>{AE(o,n,r)};for(let o=0;o<e.length;o+=1)Fw(e.charCodeAt(o),a,i);return t.join("")}function SE(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function EE(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}SE(n,t)}}function AE(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if((e>>7-n&1)===0){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Pf(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)Fw(e.charCodeAt(a),r,n);return new Uint8Array(t)}function NE(e){const t=[];return EE(e,r=>t.push(r)),new Uint8Array(t)}function ku(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>X2(a,r,n)),X2(null,r,n),t.join("")}function TE(e){return Math.round(Date.now()/1e3)+e}function CE(){return Symbol("auth-callback")}const vi=()=>typeof window<"u"&&typeof document<"u",gu={tested:!1,writable:!1},Ow=()=>{if(!vi())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(gu.tested)return gu.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),gu.tested=!0,gu.writable=!0}catch{gu.tested=!0,gu.writable=!1}return gu.writable};function PE(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,i)=>{t[i]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const Iw=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),LE=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",yf=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},mu=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},mi=async(e,t)=>{await e.removeItem(t)};class gp{constructor(){this.promise=new gp.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}gp.promiseConstructor=Promise;function hd(e){const t=e.split(".");if(t.length!==3)throw new Eg("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!vE.test(t[n]))throw new Eg("JWT not in base64url format");return{header:JSON.parse(J2(t[0])),payload:JSON.parse(J2(t[1])),signature:Pf(t[2]),raw:{header:t[0],payload:t[1]}}}async function FE(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function OE(e,t){return new Promise((n,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await e(i);if(!t(i,null,o)){n(o);return}}catch(o){if(!t(i,o)){a(o);return}}})()})}function IE(e){return("0"+e.toString(16)).substr(-2)}function RE(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let i=0;i<56;i++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,IE).join("")}async function DE(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function jE(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await DE(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function uf(e,t,r=!1){const n=RE();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await yf(e,`${t}-code-verifier`,a);const i=await jE(n);return[i,n===i?"plain":"s256"]}const ME=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function BE(e){const t=e.headers.get(kg);if(!t||!t.match(ME))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function UE(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function zE(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const qE=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ff(e){if(!qE.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function R1(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function $E(e,t){return new Proxy(e,{get:(r,n,a)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const i=n.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,a)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,a)}})}function Q2(e){return JSON.parse(JSON.stringify(e))}const xu=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),HE=[502,503,504];async function Z2(e){var t;if(!LE(e))throw new Sg(xu(e),0);if(HE.includes(e.status))throw new Sg(xu(e),e.status);let r;try{r=await e.json()}catch(i){throw new bu(xu(i),i)}let n;const a=BE(e);if(a&&a.getTime()>=Lw["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new G2(xu(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Qs}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new G2(xu(r),e.status,r.weak_password.reasons);throw new yE(xu(r),e.status||500,n)}const VE=(e,t,r,n)=>{const a={method:e,headers:t?.headers||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function Nr(e,t,r,n){var a;const i=Object.assign({},n?.headers);i[kg]||(i[kg]=Lw["2024-01-01"].name),n?.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const o=(a=n?.query)!==null&&a!==void 0?a:{};n?.redirectTo&&(o.redirect_to=n.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",u=await WE(e,t,r+l,{headers:i,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(u):{data:Object.assign({},u),error:null}}async function WE(e,t,r,n,a,i){const o=VE(t,n,a,i);let l;try{l=await e(r,Object.assign({},o))}catch(u){throw console.error(u),new Sg(xu(u),0)}if(l.ok||await Z2(l),n?.noResolveJson)return l;try{return await l.json()}catch(u){await Z2(u)}}function Zo(e){var t;let r=null;YE(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=TE(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function ex(e){const t=Zo(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Uc(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function KE(e){return{data:e,error:null}}function GE(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i}=e,o=hp(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i},u=Object.assign({},o);return{data:{properties:l,user:u},error:null}}function tx(e){return e}function YE(e){return e.access_token&&e.refresh_token&&e.expires_in}const D1=["global","local","others"];class XE{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=Iw(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=D1[0]){if(D1.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${D1.join(", ")}`);try{return await Nr(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(xr(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Nr(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Uc})}catch(n){if(xr(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=hp(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n?.newEmail,delete a.newEmail),await Nr(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:GE,redirectTo:r?.redirectTo})}catch(r){if(xr(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Nr(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Uc})}catch(r){if(xr(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,i,o,l,u;try{const f={nextPage:null,lastPage:0,total:0},h=await Nr(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=t?.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:tx});if(h.error)throw h.error;const g=await h.json(),x=(o=h.headers.get("x-total-count"))!==null&&o!==void 0?o:0,m=(u=(l=h.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&u!==void 0?u:[];return m.length>0&&(m.forEach(k=>{const b=parseInt(k.split(";")[0].split("=")[1].substring(0,1)),E=JSON.parse(k.split(";")[1].split("=")[1]);f[`${E}Page`]=b}),f.total=parseInt(x)),{data:Object.assign(Object.assign({},g),f),error:null}}catch(f){if(xr(f))return{data:{users:[]},error:f};throw f}}async getUserById(t){ff(t);try{return await Nr(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Uc})}catch(r){if(xr(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){ff(t);try{return await Nr(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Uc})}catch(n){if(xr(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){ff(t);try{return await Nr(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Uc})}catch(n){if(xr(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){ff(t.userId);try{const{data:r,error:n}=await Nr(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(xr(r))return{data:null,error:r};throw r}}async _deleteFactor(t){ff(t.userId),ff(t.id);try{return{data:await Nr(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(xr(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,a,i,o,l,u;try{const f={nextPage:null,lastPage:0,total:0},h=await Nr(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=t?.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:tx});if(h.error)throw h.error;const g=await h.json(),x=(o=h.headers.get("x-total-count"))!==null&&o!==void 0?o:0,m=(u=(l=h.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&u!==void 0?u:[];return m.length>0&&(m.forEach(k=>{const b=parseInt(k.split(";")[0].split("=")[1].substring(0,1)),E=JSON.parse(k.split(";")[1].split("=")[1]);f[`${E}Page`]=b}),f.total=parseInt(x)),{data:Object.assign(Object.assign({},g),f),error:null}}catch(f){if(xr(f))return{data:{clients:[]},error:f};throw f}}async _createOAuthClient(t){try{return await Nr(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(xr(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await Nr(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(xr(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await Nr(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(xr(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await Nr(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(xr(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await Nr(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(xr(r))return{data:null,error:r};throw r}}}function rx(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const hf={debug:!!(globalThis&&Ow()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Rw extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class JE extends Rw{}async function QE(e,t,r){hf.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),hf.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){hf.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{hf.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw hf.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new JE(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(hf.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function ZE(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Dw(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function eA(e){return parseInt(e,16)}function tA(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function rA(e){var t;const{chainId:r,domain:n,expirationTime:a,issuedAt:i=new Date,nonce:o,notBefore:l,requestId:u,resources:f,scheme:h,uri:g,version:x}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!g)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(x!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${x}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const m=Dw(e.address),k=h?`${h}://${n}`:n,b=e.statement?`${e.statement}
`:"",E=`${k} wants you to sign in with your Ethereum account:
${m}

${b}`;let N=`URI: ${g}
Version: ${x}
Chain ID: ${r}${o?`
Nonce: ${o}`:""}
Issued At: ${i.toISOString()}`;if(a&&(N+=`
Expiration Time: ${a.toISOString()}`),l&&(N+=`
Not Before: ${l.toISOString()}`),u&&(N+=`
Request ID: ${u}`),f){let O=`
Resources:`;for(const F of f){if(!F||typeof F!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${F}`);O+=`
- ${F}`}N+=O}return`${E}
${N}`}class Da extends Error{constructor({message:t,code:r,cause:n,name:a}){var i;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(i=a??(n instanceof Error?n.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=r}}class Bd extends Da{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function nA({error:e,options:t}){var r,n,a;const{publicKey:i}=t;if(!i)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Da({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Da({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=i.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Da({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((a=i.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Da({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Da({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Da({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return i.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new Da({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Da({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const o=window.location.hostname;if(jw(o)){if(i.rp.id!==o)return new Da({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Da({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new Da({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Da({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Da({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function aA({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Da({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Da({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(jw(n)){if(r.rpId!==n)return new Da({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Da({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Da({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Da({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class iA{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const sA=new iA;function oA(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,a=hp(e,["challenge","user","excludeCredentials"]),i=Pf(t).buffer,o=Object.assign(Object.assign({},r),{id:Pf(r.id).buffer}),l=Object.assign(Object.assign({},a),{challenge:i,user:o});if(n&&n.length>0){l.excludeCredentials=new Array(n.length);for(let u=0;u<n.length;u++){const f=n[u];l.excludeCredentials[u]=Object.assign(Object.assign({},f),{id:Pf(f.id).buffer,type:f.type||"public-key",transports:f.transports})}}return l}function lA(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=hp(e,["challenge","allowCredentials"]),a=Pf(t).buffer,i=Object.assign(Object.assign({},n),{challenge:a});if(r&&r.length>0){i.allowCredentials=new Array(r.length);for(let o=0;o<r.length;o++){const l=r[o];i.allowCredentials[o]=Object.assign(Object.assign({},l),{id:Pf(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return i}function cA(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:ku(new Uint8Array(e.response.attestationObject)),clientDataJSON:ku(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function uA(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),a=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:ku(new Uint8Array(a.authenticatorData)),clientDataJSON:ku(new Uint8Array(a.clientDataJSON)),signature:ku(new Uint8Array(a.signature)),userHandle:a.userHandle?ku(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function jw(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function nx(){var e,t;return!!(vi()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.get)=="function")}async function fA(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Bd("Browser returned unexpected credential type",t)}:{data:null,error:new Bd("Empty credential response",t)}}catch(t){return{data:null,error:nA({error:t,options:e})}}}async function hA(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Bd("Browser returned unexpected credential type",t)}:{data:null,error:new Bd("Empty credential response",t)}}catch(t){return{data:null,error:aA({error:t,options:e})}}}const dA={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},pA={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Ud(...e){const t=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),r=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),n={};for(const a of e)if(a)for(const i in a){const o=a[i];if(o!==void 0)if(Array.isArray(o))n[i]=o;else if(r(o))n[i]=o;else if(t(o)){const l=n[i];t(l)?n[i]=Ud(l,o):n[i]=Ud(o)}else n[i]=o}return n}function gA(e,t){return Ud(dA,e,t||{})}function mA(e,t){return Ud(pA,e,t||{})}class vA{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:a},i){var o;try{const{data:l,error:u}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!l)return{data:null,error:u};const f=a??sA.createNewAbortSignal();if(l.webauthn.type==="create"){const{user:h}=l.webauthn.credential_options.publicKey;if(!h.name){const g=n;if(g)h.name=`${h.id}:${g}`;else{const m=(await this.client.getUser()).data.user,k=((o=m?.user_metadata)===null||o===void 0?void 0:o.name)||m?.email||m?.id||"User";h.name=`${h.id}:${k}`}}h.displayName||(h.displayName=h.name)}switch(l.webauthn.type){case"create":{const h=gA(l.webauthn.credential_options.publicKey,i?.create),{data:g,error:x}=await fA({publicKey:h,signal:f});return g?{data:{factorId:t,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:g}},error:null}:{data:null,error:x}}case"request":{const h=mA(l.webauthn.credential_options.publicKey,i?.request),{data:g,error:x}=await hA(Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:h,signal:f}));return g?{data:{factorId:t,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:g}},error:null}:{data:null,error:x}}}}catch(l){return xr(l)?{data:null,error:l}:{data:null,error:new bu("Unexpected error in challenge",l)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},i){if(!r)return{data:null,error:new H0("rpId is required for WebAuthn authentication")};try{if(!nx())return{data:null,error:new bu("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:a},{request:i});if(!o)return{data:null,error:l};const{webauthn:u}=o;return this._verify({factorId:t,challengeId:o.challengeId,webauthn:{type:u.type,rpId:r,rpOrigins:n,credential_response:u.credential_response}})}catch(o){return xr(o)?{data:null,error:o}:{data:null,error:new bu("Unexpected error in authenticate",o)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},i){if(!r)return{data:null,error:new H0("rpId is required for WebAuthn registration")};try{if(!nx())return{data:null,error:new bu("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this._enroll({friendlyName:t});if(!o)return await this.client.mfa.listFactors().then(h=>{var g;return(g=h.data)===null||g===void 0?void 0:g.all.find(x=>x.factor_type==="webauthn"&&x.friendly_name===t&&x.status!=="unverified")}).then(h=>h?this.client.mfa.unenroll({factorId:h?.id}):void 0),{data:null,error:l};const{data:u,error:f}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:a},{create:i});return u?this._verify({factorId:o.id,challengeId:u.challengeId,webauthn:{rpId:r,rpOrigins:n,type:u.webauthn.type,credential_response:u.webauthn.credential_response}}):{data:null,error:f}}catch(o){return xr(o)?{data:null,error:o}:{data:null,error:new bu("Unexpected error in register",o)}}}}ZE();const xA={url:pE,storageKey:gE,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:mE,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function ax(e,t,r){return await r()}const df={};class V0{get jwks(){var t,r;return(r=(t=df[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){df[this.storageKey]=Object.assign(Object.assign({},df[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=df[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){df[this.storageKey]=Object.assign(Object.assign({},df[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},xA),t);if(this.storageKey=i.storageKey,this.instanceID=(r=V0.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,V0.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&vi()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new XE({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=Iw(i.fetch),this.lock=i.lock||ax,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,this.lockAcquireTimeout=i.lockAcquireTimeout,i.lock?this.lock=i.lock:this.persistSession&&vi()&&(!((n=globalThis?.navigator)===null||n===void 0)&&n.locks)?this.lock=QE:this.lock=ax,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new vA(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:Ow()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=rx(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=rx(this.memoryStorage)),vi()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o);try{await this._notifyAllSubscribers(o.data.event,o.data.session,!1)}catch(l){this._debug("#broadcastChannel","error",l)}})}this.initialize().catch(o=>{this._debug("#initialize()","error",o)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Pw}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(vi()&&(r=PE(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),vi()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),bE(i)){const u=(t=i.details)===null||t===void 0?void 0:t.code;if(u==="identity_already_exists"||u==="identity_not_found"||u==="single_identity_not_deletable")return{error:i}}return{error:i}}const{session:o,redirectType:l}=a;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return xr(r)?this._returnResult({error:r}):this._returnResult({error:new bu("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const i=await Nr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t?.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t?.options)===null||a===void 0?void 0:a.captchaToken}},xform:Zo}),{data:o,error:l}=i;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const u=o.session,f=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",u)),this._returnResult({data:{user:f,session:u},error:null})}catch(i){if(xr(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(t){var r,n,a;try{let i;if("email"in t){const{email:h,password:g,options:x}=t;let m=null,k=null;this.flowType==="pkce"&&([m,k]=await uf(this.storage,this.storageKey)),i=await Nr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:x?.emailRedirectTo,body:{email:h,password:g,data:(r=x?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:x?.captchaToken},code_challenge:m,code_challenge_method:k},xform:Zo})}else if("phone"in t){const{phone:h,password:g,options:x}=t;i=await Nr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:g,data:(n=x?.data)!==null&&n!==void 0?n:{},channel:(a=x?.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:x?.captchaToken}},xform:Zo})}else throw new ud("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return await mi(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:l});const u=o.session,f=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",u)),this._returnResult({data:{user:f,session:u},error:null})}catch(i){if(await mi(this.storage,`${this.storageKey}-code-verifier`),xr(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:o,options:l}=t;r=await Nr(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:ex})}else if("phone"in t){const{phone:i,password:o,options:l}=t;r=await Nr(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:ex})}else throw new ud("You must provide either an email or phone number and a password");const{data:n,error:a}=r;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!n||!n.session||!n.user){const i=new cf;return this._returnResult({data:{user:null,session:null},error:i})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(xr(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,a,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,a,i,o,l,u,f,h,g,x;let m,k;if("message"in t)m=t.message,k=t.signature;else{const{chain:b,wallet:E,statement:N,options:O}=t;let F;if(vi())if(typeof E=="object")F=E;else{const Y=window;if("ethereum"in Y&&typeof Y.ethereum=="object"&&"request"in Y.ethereum&&typeof Y.ethereum.request=="function")F=Y.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof E!="object"||!O?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");F=E}const K=new URL((r=O?.url)!==null&&r!==void 0?r:window.location.href),te=await F.request({method:"eth_requestAccounts"}).then(Y=>Y).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!te||te.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const re=Dw(te[0]);let B=(n=O?.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!B){const Y=await F.request({method:"eth_chainId"});B=eA(Y)}const V={domain:K.host,address:re,statement:N,uri:K.href,version:"1",chainId:B,nonce:(a=O?.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(o=(i=O?.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(l=O?.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(u=O?.signInWithEthereum)===null||u===void 0?void 0:u.notBefore,requestId:(f=O?.signInWithEthereum)===null||f===void 0?void 0:f.requestId,resources:(h=O?.signInWithEthereum)===null||h===void 0?void 0:h.resources};m=rA(V),k=await F.request({method:"personal_sign",params:[tA(m),re]})}try{const{data:b,error:E}=await Nr(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:m,signature:k},!((g=t.options)===null||g===void 0)&&g.captchaToken?{gotrue_meta_security:{captcha_token:(x=t.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:Zo});if(E)throw E;if(!b||!b.session||!b.user){const N=new cf;return this._returnResult({data:{user:null,session:null},error:N})}return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:Object.assign({},b),error:E})}catch(b){if(xr(b))return this._returnResult({data:{user:null,session:null},error:b});throw b}}async signInWithSolana(t){var r,n,a,i,o,l,u,f,h,g,x,m;let k,b;if("message"in t)k=t.message,b=t.signature;else{const{chain:E,wallet:N,statement:O,options:F}=t;let K;if(vi())if(typeof N=="object")K=N;else{const re=window;if("solana"in re&&typeof re.solana=="object"&&("signIn"in re.solana&&typeof re.solana.signIn=="function"||"signMessage"in re.solana&&typeof re.solana.signMessage=="function"))K=re.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof N!="object"||!F?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");K=N}const te=new URL((r=F?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in K&&K.signIn){const re=await K.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},F?.signInWithSolana),{version:"1",domain:te.host,uri:te.href}),O?{statement:O}:null));let B;if(Array.isArray(re)&&re[0]&&typeof re[0]=="object")B=re[0];else if(re&&typeof re=="object"&&"signedMessage"in re&&"signature"in re)B=re;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in B&&"signature"in B&&(typeof B.signedMessage=="string"||B.signedMessage instanceof Uint8Array)&&B.signature instanceof Uint8Array)k=typeof B.signedMessage=="string"?B.signedMessage:new TextDecoder().decode(B.signedMessage),b=B.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in K)||typeof K.signMessage!="function"||!("publicKey"in K)||typeof K!="object"||!K.publicKey||!("toBase58"in K.publicKey)||typeof K.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");k=[`${te.host} wants you to sign in with your Solana account:`,K.publicKey.toBase58(),...O?["",O,""]:[""],"Version: 1",`URI: ${te.href}`,`Issued At: ${(a=(n=F?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=F?.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${F.signInWithSolana.notBefore}`]:[],...!((o=F?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${F.signInWithSolana.expirationTime}`]:[],...!((l=F?.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${F.signInWithSolana.chainId}`]:[],...!((u=F?.signInWithSolana)===null||u===void 0)&&u.nonce?[`Nonce: ${F.signInWithSolana.nonce}`]:[],...!((f=F?.signInWithSolana)===null||f===void 0)&&f.requestId?[`Request ID: ${F.signInWithSolana.requestId}`]:[],...!((g=(h=F?.signInWithSolana)===null||h===void 0?void 0:h.resources)===null||g===void 0)&&g.length?["Resources",...F.signInWithSolana.resources.map(B=>`- ${B}`)]:[]].join(`
`);const re=await K.signMessage(new TextEncoder().encode(k),"utf8");if(!re||!(re instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");b=re}}try{const{data:E,error:N}=await Nr(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:k,signature:ku(b)},!((x=t.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(m=t.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:Zo});if(N)throw N;if(!E||!E.session||!E.user){const O=new cf;return this._returnResult({data:{user:null,session:null},error:O})}return E.session&&(await this._saveSession(E.session),await this._notifyAllSubscribers("SIGNED_IN",E.session)),this._returnResult({data:Object.assign({},E),error:N})}catch(E){if(xr(E))return this._returnResult({data:{user:null,session:null},error:E});throw E}}async _exchangeCodeForSession(t){const r=await mu(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{if(!n&&this.flowType==="pkce")throw new _E;const{data:i,error:o}=await Nr(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Zo});if(await mi(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!i||!i.session||!i.user){const l=new cf;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:o})}catch(i){if(await mi(this.storage,`${this.storageKey}-code-verifier`),xr(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:i,nonce:o}=t,l=await Nr(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:Zo}),{data:u,error:f}=l;if(f)return this._returnResult({data:{user:null,session:null},error:f});if(!u||!u.session||!u.user){const h=new cf;return this._returnResult({data:{user:null,session:null},error:h})}return u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),this._returnResult({data:u,error:f})}catch(r){if(xr(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,a,i,o;try{if("email"in t){const{email:l,options:u}=t;let f=null,h=null;this.flowType==="pkce"&&([f,h]=await uf(this.storage,this.storageKey));const{error:g}=await Nr(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=u?.data)!==null&&r!==void 0?r:{},create_user:(n=u?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:u?.captchaToken},code_challenge:f,code_challenge_method:h},redirectTo:u?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:g})}if("phone"in t){const{phone:l,options:u}=t,{data:f,error:h}=await Nr(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(a=u?.data)!==null&&a!==void 0?a:{},create_user:(i=u?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:u?.captchaToken},channel:(o=u?.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:f?.message_id},error:h})}throw new ud("You must provide either an email or phone number.")}catch(l){if(await mi(this.storage,`${this.storageKey}-code-verifier`),xr(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(t){var r,n;try{let a,i;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:l}=await Nr(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:Zo});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const u=o.session,f=o.user;return u?.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",u)),this._returnResult({data:{user:f,session:u},error:null})}catch(a){if(xr(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(t){var r,n,a,i,o;try{let l=null,u=null;this.flowType==="pkce"&&([l,u]=await uf(this.storage,this.storageKey));const f=await Nr(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t?.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:u}),headers:this.headers,xform:KE});return!((i=f.data)===null||i===void 0)&&i.url&&vi()&&!(!((o=t.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(f.data.url),this._returnResult(f)}catch(l){if(await mi(this.storage,`${this.storageKey}-code-verifier`),xr(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Qs;const{error:a}=await Nr(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(t){if(xr(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:i}=t,{error:o}=await Nr(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:i?.captchaToken}},redirectTo:i?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in t){const{phone:n,type:a,options:i}=t,{data:o,error:l}=await Nr(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:i?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o?.message_id},error:l})}throw new ud("You must provide either an email or phone number and a type")}catch(r){if(xr(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await mu(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<F1:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const o=await mu(this.userStorage,this.storageKey+"-user");o?.user?t.user=o.user:t.user=R1()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};t.user=$E(t.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await Nr(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Uc}):await this._useSession(async r=>{var n,a,i;const{data:o,error:l}=r;if(l)throw l;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Qs}:await Nr(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=o.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:Uc})})}catch(r){if(xr(r))return O1(r)&&(await this._removeSession(),await mi(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:i}=n;if(i)throw i;if(!a.session)throw new Qs;const o=a.session;let l=null,u=null;this.flowType==="pkce"&&t.email!=null&&([l,u]=await uf(this.storage,this.storageKey));const{data:f,error:h}=await Nr(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:u}),jwt:o.access_token,xform:Uc});if(h)throw h;return o.user=f.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(n){if(await mi(this.storage,`${this.storageKey}-code-verifier`),xr(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Qs;const r=Date.now()/1e3;let n=r,a=!0,i=null;const{payload:o}=hd(t.access_token);if(o.exp&&(n=o.exp,a=n<=r),a){const{data:l,error:u}=await this._callRefreshToken(t.refresh_token);if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:u}=await this._getUser(t.access_token);if(u)return this._returnResult({data:{user:null,session:null},error:u});i={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(r){if(xr(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:o,error:l}=r;if(l)throw l;t=(n=o.session)!==null&&n!==void 0?n:void 0}if(!t?.refresh_token)throw new Qs;const{data:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(xr(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!vi())throw new fd("No browser detected.");if(t.error||t.error_description||t.error_code)throw new fd(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new K2("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new fd("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new K2("No code detected.");const{data:O,error:F}=await this._exchangeCodeForSession(t.code);if(F)throw F;const K=new URL(window.location.href);return K.searchParams.delete("code"),window.history.replaceState(window.history.state,"",K.toString()),{data:{session:O.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:i,refresh_token:o,expires_in:l,expires_at:u,token_type:f}=t;if(!i||!l||!o||!f)throw new fd("No session defined in URL");const h=Math.round(Date.now()/1e3),g=parseInt(l);let x=h+g;u&&(x=parseInt(u));const m=x-h;m*1e3<=xf&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${g}s`);const k=x-g;h-k>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",k,x,h):h-k<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",k,x,h);const{data:b,error:E}=await this._getUser(i);if(E)throw E;const N={provider_token:n,provider_refresh_token:a,access_token:i,expires_in:g,expires_at:x,refresh_token:o,token_type:f,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:N,redirectType:t.type},error:null})}catch(n){if(xr(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await mu(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i&&!O1(i))return this._returnResult({error:i});const o=(n=a.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:l}=await this.admin.signOut(o,t);if(l&&!(wE(l)&&(l.status===404||l.status===401||l.status===403)||O1(l)))return this._returnResult({error:l})}return t!=="others"&&(await this._removeSession(),await mi(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=CE(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:i},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await uf(this.storage,this.storageKey,!0));try{return await Nr(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(await mi(this.storage,`${this.storageKey}-code-verifier`),xr(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(xr(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:a}=await this._useSession(async i=>{var o,l,u,f,h;const{data:g,error:x}=i;if(x)throw x;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(u=t.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return await Nr(this.fetch,"GET",m,{headers:this.headers,jwt:(h=(f=g.session)===null||f===void 0?void 0:f.access_token)!==null&&h!==void 0?h:void 0})});if(a)throw a;return vi()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n?.url),this._returnResult({data:{provider:t.provider,url:n?.url},error:null})}catch(n){if(xr(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:a,data:{session:i}}=r;if(a)throw a;const{options:o,provider:l,token:u,access_token:f,nonce:h}=t,g=await Nr(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=i?.access_token)!==null&&n!==void 0?n:void 0,body:{provider:l,id_token:u,access_token:f,nonce:h,link_identity:!0,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:Zo}),{data:x,error:m}=g;return m?this._returnResult({data:{user:null,session:null},error:m}):!x||!x.session||!x.user?this._returnResult({data:{user:null,session:null},error:new cf}):(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("USER_UPDATED",x.session)),this._returnResult({data:x,error:m}))}catch(a){if(await mi(this.storage,`${this.storageKey}-code-verifier`),xr(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:i,error:o}=r;if(o)throw o;return await Nr(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(xr(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await OE(async a=>(a>0&&await FE(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await Nr(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Zo})),(a,i)=>{const o=200*Math.pow(2,a);return i&&I1(i)&&Date.now()+o-n<xf})}catch(n){if(this._debug(r,"error",n),xr(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),vi()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await mu(this.storage,this.storageKey);if(a&&this.userStorage){let o=await mu(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:a.user},await yf(this.userStorage,this.storageKey+"-user",o)),a.user=(t=o?.user)!==null&&t!==void 0?t:R1()}else if(a&&!a.user&&!a.user){const o=await mu(this.storage,this.storageKey+"-user");o&&o?.user?(a.user=o.user,await mi(this.storage,this.storageKey+"-user"),await yf(this.storage,this.storageKey,a)):a.user=R1()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const i=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<F1;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${F1}s`),i){if(this.autoRefreshToken&&a.refresh_token){const{error:o}=await this._callRefreshToken(a.refresh_token);o&&(console.error(o),I1(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(a.access_token);!l&&o?.user?(a.user=o.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Qs;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new gp;const{data:i,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!i.session)throw new Qs;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={data:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(a,"error",i),xr(i)){const o={data:null,error:i};return I1(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(u){i.push(u)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await mi(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await yf(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const i=Q2(a);await yf(this.storage,this.storageKey,i)}else{const a=Q2(r);await yf(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await mi(this.storage,this.storageKey),await mi(this.storage,this.storageKey+"-code-verifier"),await mi(this.storage,this.storageKey+"-user"),this.userStorage&&await mi(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&vi()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),xf);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/xf);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${xf}ms, refresh threshold is ${_g} ticks`),a<=_g&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Rw)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!vi()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(t){this._debug("#visibilityChangedCallback","error",t)}},window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n?.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,o]=await uf(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});a.push(l.toString())}if(n?.queryParams){const i=new URLSearchParams(n.queryParams);a.push(i.toString())}return n?.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;return i?this._returnResult({data:null,error:i}):await Nr(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(xr(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:i,error:o}=r;if(o)return this._returnResult({data:null,error:o});const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:u,error:f}=await Nr(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token});return f?this._returnResult({data:null,error:f}):(t.factorType==="totp"&&u.type==="totp"&&(!((a=u?.totp)===null||a===void 0)&&a.qr_code)&&(u.totp.qr_code=`data:image/svg+xml;utf-8,${u.totp.qr_code}`),this._returnResult({data:u,error:null}))})}catch(r){if(xr(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?cA(t.webauthn.credential_response):uA(t.webauthn.credential_response)})}:{code:t.code}),{data:l,error:u}=await Nr(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:o,headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token});return u?this._returnResult({data:null,error:u}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:u}))})}catch(r){if(xr(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=await Nr(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token});if(o.error)return o;const{data:l}=o;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:oA(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:lA(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(xr(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const a={all:[],phone:[],totp:[],webauthn:[]};for(const i of(t=r?.factors)!==null&&t!==void 0?t:[])a.all.push(i),i.status==="verified"&&a[i.factor_type].push(i);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(t){var r,n,a,i;if(t)try{const{payload:m}=hd(t);let k=null;m.aal&&(k=m.aal);let b=k;const{data:{user:E},error:N}=await this.getUser(t);if(N)return this._returnResult({data:null,error:N});((n=(r=E?.factors)===null||r===void 0?void 0:r.filter(K=>K.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(b="aal2");const F=m.amr||[];return{data:{currentLevel:k,nextLevel:b,currentAuthenticationMethods:F},error:null}}catch(m){if(xr(m))return this._returnResult({data:null,error:m});throw m}const{data:{session:o},error:l}=await this.getSession();if(l)return this._returnResult({data:null,error:l});if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:u}=hd(o.access_token);let f=null;u.aal&&(f=u.aal);let h=f;((i=(a=o.user.factors)===null||a===void 0?void 0:a.filter(m=>m.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(h="aal2");const x=u.amr||[];return{data:{currentLevel:f,nextLevel:h,currentAuthenticationMethods:x},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:a}=r;return a?this._returnResult({data:null,error:a}):n?await Nr(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new Qs})})}catch(r){if(xr(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:a},error:i}=n;if(i)return this._returnResult({data:null,error:i});if(!a)return this._returnResult({data:null,error:new Qs});const o=await Nr(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&vi()&&!r?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(n){if(xr(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:a},error:i}=n;if(i)return this._returnResult({data:null,error:i});if(!a)return this._returnResult({data:null,error:new Qs});const o=await Nr(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&vi()&&!r?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(n){if(xr(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?await Nr(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new Qs})})}catch(t){if(xr(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:n},error:a}=r;return a?this._returnResult({data:null,error:a}):n?(await Nr(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Qs})})}catch(r){if(xr(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(l=>l.kid===t);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(l=>l.kid===t),n&&this.jwks_cached_at+xE>a)return n;const{data:i,error:o}=await Nr(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=a,n=i.keys.find(l=>l.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:m,error:k}=await this.getSession();if(k||!m.session)return this._returnResult({data:null,error:k});n=m.session.access_token}const{header:a,payload:i,signature:o,raw:{header:l,payload:u}}=hd(n);r?.allowExpired||UE(i.exp);const f=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!f){const{error:m}=await this.getUser(n);if(m)throw m;return{data:{claims:i,header:a,signature:o},error:null}}const h=zE(a.alg),g=await crypto.subtle.importKey("jwk",f,h,!0,["verify"]);if(!await crypto.subtle.verify(h,g,o,NE(`${l}.${u}`)))throw new Eg("Invalid JWT signature");return{data:{claims:i,header:a,signature:o},error:null}}catch(n){if(xr(n))return this._returnResult({data:null,error:n});throw n}}}V0.nextInstanceID={};const yA=V0,wA="2.95.3";let m0="";typeof Deno<"u"?m0="deno":typeof document<"u"?m0="web":typeof navigator<"u"&&navigator.product==="ReactNative"?m0="react-native":m0="node";const bA={"X-Client-Info":`supabase-js-${m0}/${wA}`},_A={headers:bA},kA={schema:"public"},SA={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},EA={};function W0(e){"@babel/helpers - typeof";return W0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W0(e)}function AA(e,t){if(W0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(W0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function NA(e){var t=AA(e,"string");return W0(t)=="symbol"?t:t+""}function TA(e,t,r){return(t=NA(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ix(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ha(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ix(Object(r),!0).forEach(function(n){TA(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ix(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const CA=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),PA=()=>Headers,LA=(e,t,r)=>{const n=CA(r),a=PA();return async(i,o)=>{var l;const u=(l=await t())!==null&&l!==void 0?l:e;let f=new a(o?.headers);return f.has("apikey")||f.set("apikey",e),f.has("Authorization")||f.set("Authorization",`Bearer ${u}`),n(i,ha(ha({},o),{},{headers:f}))}};function FA(e){return e.endsWith("/")?e:e+"/"}function OA(e,t){var r,n;const{db:a,auth:i,realtime:o,global:l}=e,{db:u,auth:f,realtime:h,global:g}=t,x={db:ha(ha({},u),a),auth:ha(ha({},f),i),realtime:ha(ha({},h),o),storage:{},global:ha(ha(ha({},g),l),{},{headers:ha(ha({},(r=g?.headers)!==null&&r!==void 0?r:{}),(n=l?.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?x.accessToken=e.accessToken:delete x.accessToken,x}function IA(e){const t=e?.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(FA(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var RA=class extends yA{constructor(e){super(e)}},DA=class{constructor(e,t,r){var n,a;this.supabaseUrl=e,this.supabaseKey=t;const i=IA(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const o=`sb-${i.hostname.split(".")[0]}-auth-token`,l={db:kA,realtime:EA,auth:ha(ha({},SA),{},{storageKey:o}),global:_A},u=OA(r??{},l);if(this.storageKey=(n=u.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(a=u.global.headers)!==null&&a!==void 0?a:{},u.accessToken)this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(h,g)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(g)} is not possible`)}});else{var f;this.auth=this._initSupabaseAuthClient((f=u.auth)!==null&&f!==void 0?f:{},this.headers,u.global.fetch)}this.fetch=LA(t,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(ha({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(h=>this.realtime.setAuth(h)).catch(h=>console.warn("Failed to set initial Realtime auth token:",h)),this.rest=new wS(new URL("rest/v1",i).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch,timeout:u.db.timeout,urlLengthLimit:u.db.urlLengthLimit}),this.storage=new dE(this.storageUrl.href,this.headers,this.fetch,r?.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new hS(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:n}=await e.auth.getSession();return(t=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:a,storageKey:i,flowType:o,lock:l,debug:u,throwOnError:f},h,g){const x={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new RA({url:this.authUrl.href,headers:ha(ha({},x),h),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:a,flowType:o,lock:l,debug:u,throwOnError:f,fetch:g,hasCustomAuthorizationHeader:Object.keys(this.headers).some(m=>m.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new jS(this.realtimeUrl.href,ha(ha({},e),{},{params:ha(ha({},{apikey:this.supabaseKey}),e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t?.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const jA=(e,t,r)=>new DA(e,t,r);function MA(){if(typeof window<"u")return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}MA()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const BA="https://viwnlfduyhnxtypkrzea.supabase.co",UA="sb_publishable_XZZehI5j_V52mDqJ2PDc-Q_K5eConXh",Sa=jA(BA,UA),$i={async getInvoices(){const{data:e,error:t}=await Sa.from("invoices").select("*, items(*), clients(*)");if(t)throw t;return e.map(this.mapInvoiceFromDb)},async getInvoice(e){const{data:t,error:r}=await Sa.from("invoices").select("*, items(*), clients(*)").eq("id",e).single();return r?null:this.mapInvoiceFromDb(t)},async createInvoice(e){let t=e.client?.id;!t&&e.client&&(t=(await this.createClient(e.client)).id);const{data:r,error:n}=await Sa.from("invoices").insert({client_id:t,agent_id:e.agentId,invoice_number:e.invoiceNumber,status:e.status,due_date:e.dueDate&&!isNaN(Date.parse(e.dueDate))?new Date(e.dueDate).toISOString():new Date().toISOString(),subtotal:e.subtotal,tax:e.tax,total:e.total,notes:e.notes,passport_number:e.passportNumber,gender:e.gender,flight_number:e.flightNumber,room_type:e.roomType,visa_status:e.visaStatus,departure_date:e.departureDate&&!isNaN(Date.parse(e.departureDate))?new Date(e.departureDate).toISOString():null,date_of_birth:e.dateOfBirth&&!isNaN(Date.parse(e.dateOfBirth))?new Date(e.dateOfBirth).toISOString():null,created_at:new Date().toISOString()}).select().single();if(n)throw n;if(t&&(e.passportNumber||e.gender||e.dateOfBirth)&&await this.updateClient(t,{passportNumber:e.passportNumber,gender:e.gender,dateOfBirth:e.dateOfBirth}),e.items&&e.items.length>0){const a=e.items.map(o=>({invoice_id:r.id,description:o.description,quantity:o.quantity,unit_price:o.unitPrice})),{error:i}=await Sa.from("items").insert(a);if(i)throw i}return this.getInvoice(r.id)},async updateInvoice(e,t){const{error:r}=await Sa.from("invoices").update({status:t.status,due_date:t.dueDate&&!isNaN(Date.parse(t.dueDate))?new Date(t.dueDate).toISOString():void 0,subtotal:t.subtotal,tax:t.tax,total:t.total,notes:t.notes,passport_number:t.passportNumber,gender:t.gender,flight_number:t.flightNumber,room_type:t.roomType,visa_status:t.visaStatus,departure_date:t.departureDate&&!isNaN(Date.parse(t.departureDate))?new Date(t.departureDate).toISOString():null,date_of_birth:t.dateOfBirth&&!isNaN(Date.parse(t.dateOfBirth))?new Date(t.dateOfBirth).toISOString():null}).eq("id",e);if(r)throw r;if(t.client?.id&&(t.passportNumber||t.gender||t.dateOfBirth)&&await this.updateClient(t.client.id,{passportNumber:t.passportNumber,gender:t.gender,dateOfBirth:t.dateOfBirth}),t.items){await Sa.from("items").delete().eq("invoice_id",e);const n=t.items.map(a=>({invoice_id:e,description:a.description,quantity:a.quantity,unit_price:a.unitPrice}));await Sa.from("items").insert(n)}return this.getInvoice(e)},async deleteInvoice(e){const{data:t}=await Sa.from("invoices").select("client_id").eq("id",e).single(),r=t?.client_id,{error:n}=await Sa.from("invoices").delete().eq("id",e);if(n)throw n;if(r){const{count:a,error:i}=await Sa.from("invoices").select("*",{count:"exact",head:!0}).eq("client_id",r);!i&&a===0&&await Sa.from("clients").delete().eq("id",r)}},async getClients(){const{data:e,error:t}=await Sa.from("clients").select("*");if(t)throw t;return e.map(this.mapClientFromDb)},async createClient(e){const{data:t,error:r}=await Sa.from("clients").insert({name:e.name,email:e.email||`${e.name?.replace(/\s+/g,".").toLowerCase()||"unknown"}@example.com`,phone:e.phone,address:e.address,passport_number:e.passportNumber,gender:e.gender,date_of_birth:e.dateOfBirth&&e.dateOfBirth.trim()!==""?e.dateOfBirth:null}).select().single();if(r)throw r;return this.mapClientFromDb(t)},async bulkCreateClients(e){const t=e.map(a=>({name:a.name,email:a.email||`${a.name?.replace(/\s+/g,".").toLowerCase()||"unknown"}@example.com`,phone:a.phone,address:a.address,passport_number:a.passportNumber,gender:a.gender,date_of_birth:a.dateOfBirth&&a.dateOfBirth.trim()!==""?a.dateOfBirth:null})),{data:r,error:n}=await Sa.from("clients").insert(t).select();if(n)throw n;return r.map(this.mapClientFromDb)},async updateClient(e,t){const{data:r,error:n}=await Sa.from("clients").update({name:t.name,email:t.email,phone:t.phone,address:t.address,passport_number:t.passportNumber,gender:t.gender,date_of_birth:t.dateOfBirth&&t.dateOfBirth.trim()!==""?t.dateOfBirth:void 0}).eq("id",e).select().single();if(n)throw n;return this.mapClientFromDb(r)},mapInvoiceFromDb(e){const t=Array.isArray(e.clients)?e.clients[0]:e.clients;return{id:e.id,invoiceNumber:e.invoice_number,clientName:t?.name||"Unknown",clientEmail:t?.email||"",client:t?$i.mapClientFromDb(t):void 0,agentId:e.agent_id,status:e.status,dueDate:e.due_date,subtotal:e.subtotal,tax:e.tax,total:e.total,notes:e.notes,createdAt:e.created_at,passportNumber:e.passport_number,gender:e.gender,flightNumber:e.flight_number,roomType:e.room_type,visaStatus:e.visa_status,departureDate:e.departure_date,dateOfBirth:e.date_of_birth,items:e.items?.map(r=>({id:r.id,description:r.description,quantity:r.quantity,unitPrice:r.unit_price,total:r.quantity*r.unit_price,invoiceId:r.invoice_id}))||[]}},mapClientFromDb(e){return{id:e.id,name:e.name,email:e.email,phone:e.phone,address:e.address,passportNumber:e.passport_number,gender:e.gender,dateOfBirth:e.date_of_birth}},async getRooms(){const{data:e,error:t}=await Sa.from("rooms").select(`
                *,
                assignments:room_assignments(
                    *,
                    client:clients(*)
                )
            `);if(t)throw t;return e.map(this.mapRoomFromDb)},async createRoom(e){const{data:t,error:r}=await Sa.from("rooms").insert({hotel_name:e.hotelName,city:e.city,type:e.type,capacity:e.capacity,floor_number:e.floorNumber,room_number:e.roomNumber}).select().single();if(r)throw r;return this.mapRoomFromDb(t)},async deleteRoom(e){const{error:t}=await Sa.from("rooms").delete().eq("id",e);if(t)throw t},async assignClientToRoom(e,t){await Sa.from("room_assignments").delete().eq("client_id",t);const{error:r}=await Sa.from("room_assignments").insert({room_id:e,client_id:t});if(r)throw r},async removeClientFromRoom(e){const{error:t}=await Sa.from("room_assignments").delete().eq("client_id",e);if(t)throw t},mapRoomFromDb(e){const t=e.assignments?.map(r=>({id:r.id,roomId:r.room_id,clientId:r.client_id,assignedAt:r.assigned_at,client:r.client?$i.mapClientFromDb(r.client):void 0}))||[];return{id:e.id,hotelName:e.hotel_name,city:e.city||"Makkah",type:e.type,capacity:e.capacity,floorNumber:e.floor_number,roomNumber:e.room_number,createdAt:e.created_at,assignments:t,currentOccupancy:t.length}}};function zA(e){const[t,r]=ce.useState([]),[n,a]=ce.useState(!0),[i,o]=ce.useState(null),l=ce.useCallback(async()=>{a(!0);try{let g=await $i.getInvoices();e&&(g=g.filter(x=>x.agentId===e)),g.sort((x,m)=>new Date(m.createdAt).getTime()-new Date(x.createdAt).getTime()),r(g),o(null)}catch(g){console.error("Error fetching invoices:",g),o(g.message||"Failed to fetch invoices"),r([])}finally{a(!1)}},[e]);return ce.useEffect(()=>{l()},[l]),{invoices:t,isLoading:n,error:i,createInvoice:async(g,x)=>{try{const m={...g,items:x};await $i.createInvoice(m),await l()}catch(m){throw new Error(m.message||"Failed to create invoice")}},updateInvoice:async(g,x,m)=>{try{const k={...x,items:m};await $i.updateInvoice(g,k),await l()}catch(k){throw new Error(k.message||"Failed to update invoice")}},deleteInvoice:async g=>{try{await $i.deleteInvoice(g),await l()}catch(x){throw new Error(x.message||"Failed to delete invoice")}},refetch:l}}function qA(){const[e,t]=ce.useState([]),[r,n]=ce.useState(!0),[a,i]=ce.useState(null),o=ce.useCallback(async()=>{n(!0);try{const{defaultAgents:l}=await M0(async()=>{const{defaultAgents:u}=await Promise.resolve().then(()=>GA);return{defaultAgents:u}},void 0);t(l),i(null)}catch(l){console.error("Error fetching agents:",l),i(l.message||"Failed to fetch agents"),t([])}finally{n(!1)}},[]);return ce.useEffect(()=>{o()},[o]),{agents:e,isLoading:r,error:a,refetch:o}}function $A(e){const[t,r]=ce.useState({totalInvoices:0,paidInvoices:0,unpaidInvoices:0,pendingInvoices:0,totalRevenue:0,recentInvoices:[]}),[n,a]=ce.useState(!0),[i,o]=ce.useState(null),l=ce.useCallback(async()=>{a(!0);try{let u=await $i.getInvoices();e&&(u=u.filter(x=>x.agentId===e));const f=u.filter(x=>x.status==="paid"),h=u.filter(x=>x.status==="sent"||x.status==="draft"),g=u.filter(x=>x.status==="overdue");r({totalInvoices:u.length,paidInvoices:f.length,unpaidInvoices:g.length,pendingInvoices:h.length,totalRevenue:f.reduce((x,m)=>x+m.total,0),recentInvoices:u.slice(0,5)}),o(null)}catch(u){o(u.message||"Failed to fetch dashboard stats")}finally{a(!1)}},[e]);return ce.useEffect(()=>{l()},[l]),{stats:t,isLoading:n,error:i,refetch:l}}function HA(e){const[t,r]=ce.useState([]),[n,a]=ce.useState(!0),[i,o]=ce.useState(null),l=ce.useCallback(async()=>{a(!0);try{const u=new Date;u.setHours(0,0,0,0);let h=(await $i.getInvoices()).filter(g=>new Date(g.createdAt)>=u);e&&(h=h.filter(g=>g.agentId===e)),r(h),o(null)}catch(u){o(u.message||"Failed to fetch today's invoices")}finally{a(!1)}},[e]);return ce.useEffect(()=>{l()},[l]),{invoices:t,isLoading:n,error:i,refetch:l}}var Td={exports:{}},VA=Td.exports,sx;function WA(){return sx||(sx=1,function(e,t){(function(r,n){e.exports=n()})(VA,function(){var r=function(v,_){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(L,j){L.__proto__=j}||function(L,j){for(var q in j)Object.prototype.hasOwnProperty.call(j,q)&&(L[q]=j[q])})(v,_)},n=function(){return(n=Object.assign||function(v){for(var _,L=1,j=arguments.length;L<j;L++)for(var q in _=arguments[L])Object.prototype.hasOwnProperty.call(_,q)&&(v[q]=_[q]);return v}).apply(this,arguments)};function a(v,_,L){for(var j,q=0,Z=_.length;q<Z;q++)!j&&q in _||((j=j||Array.prototype.slice.call(_,0,q))[q]=_[q]);return v.concat(j||Array.prototype.slice.call(_))}var i=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:b_,o=Object.keys,l=Array.isArray;function u(v,_){return typeof _!="object"||o(_).forEach(function(L){v[L]=_[L]}),v}typeof Promise>"u"||i.Promise||(i.Promise=Promise);var f=Object.getPrototypeOf,h={}.hasOwnProperty;function g(v,_){return h.call(v,_)}function x(v,_){typeof _=="function"&&(_=_(f(v))),(typeof Reflect>"u"?o:Reflect.ownKeys)(_).forEach(function(L){k(v,L,_[L])})}var m=Object.defineProperty;function k(v,_,L,j){m(v,_,u(L&&g(L,"get")&&typeof L.get=="function"?{get:L.get,set:L.set,configurable:!0}:{value:L,configurable:!0,writable:!0},j))}function b(v){return{from:function(_){return v.prototype=Object.create(_.prototype),k(v.prototype,"constructor",v),{extend:x.bind(null,v.prototype)}}}}var E=Object.getOwnPropertyDescriptor,N=[].slice;function O(v,_,L){return N.call(v,_,L)}function F(v,_){return _(v)}function K(v){if(!v)throw new Error("Assertion Failed")}function te(v){i.setImmediate?setImmediate(v):setTimeout(v,0)}function re(v,_){if(typeof _=="string"&&g(v,_))return v[_];if(!_)return v;if(typeof _!="string"){for(var L=[],j=0,q=_.length;j<q;++j){var Z=re(v,_[j]);L.push(Z)}return L}var ve=_.indexOf(".");if(ve!==-1){var Ce=v[_.substr(0,ve)];return Ce==null?void 0:re(Ce,_.substr(ve+1))}}function B(v,_,L){if(v&&_!==void 0&&!("isFrozen"in Object&&Object.isFrozen(v)))if(typeof _!="string"&&"length"in _){K(typeof L!="string"&&"length"in L);for(var j=0,q=_.length;j<q;++j)B(v,_[j],L[j])}else{var Z,ve,Ce=_.indexOf(".");Ce!==-1?(Z=_.substr(0,Ce),(ve=_.substr(Ce+1))===""?L===void 0?l(v)&&!isNaN(parseInt(Z))?v.splice(Z,1):delete v[Z]:v[Z]=L:B(Ce=!(Ce=v[Z])||!g(v,Z)?v[Z]={}:Ce,ve,L)):L===void 0?l(v)&&!isNaN(parseInt(_))?v.splice(_,1):delete v[_]:v[_]=L}}function V(v){var _,L={};for(_ in v)g(v,_)&&(L[_]=v[_]);return L}var Y=[].concat;function ye(v){return Y.apply([],v)}var gr="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(ye([8,16,32,64].map(function(v){return["Int","Uint","Float"].map(function(_){return _+v+"Array"})}))).filter(function(v){return i[v]}),U=new Set(gr.map(function(v){return i[v]})),D=null;function le(v){return D=new WeakMap,v=function _(L){if(!L||typeof L!="object")return L;var j=D.get(L);if(j)return j;if(l(L)){j=[],D.set(L,j);for(var q=0,Z=L.length;q<Z;++q)j.push(_(L[q]))}else if(U.has(L.constructor))j=L;else{var ve,Ce=f(L);for(ve in j=Ce===Object.prototype?{}:Object.create(Ce),D.set(L,j),L)g(L,ve)&&(j[ve]=_(L[ve]))}return j}(v),D=null,v}var ue={}.toString;function Te(v){return ue.call(v).slice(8,-1)}var Fe=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Le=typeof Fe=="symbol"?function(v){var _;return v!=null&&(_=v[Fe])&&_.apply(v)}:function(){return null};function me(v,_){return _=v.indexOf(_),0<=_&&v.splice(_,1),0<=_}var ne={};function Ee(v){var _,L,j,q;if(arguments.length===1){if(l(v))return v.slice();if(this===ne&&typeof v=="string")return[v];if(q=Le(v)){for(L=[];!(j=q.next()).done;)L.push(j.value);return L}if(v==null)return[v];if(typeof(_=v.length)!="number")return[v];for(L=new Array(_);_--;)L[_]=v[_];return L}for(_=arguments.length,L=new Array(_);_--;)L[_]=arguments[_];return L}var pe=typeof Symbol<"u"?function(v){return v[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},cr=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],xa=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(cr),C={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function M(v,_){this.name=v,this.message=_}function z(v,_){return v+". Errors: "+Object.keys(_).map(function(L){return _[L].toString()}).filter(function(L,j,q){return q.indexOf(L)===j}).join(`
`)}function H(v,_,L,j){this.failures=_,this.failedKeys=j,this.successCount=L,this.message=z(v,_)}function ie(v,_){this.name="BulkError",this.failures=Object.keys(_).map(function(L){return _[L]}),this.failuresByPos=_,this.message=z(v,this.failures)}b(M).from(Error).extend({toString:function(){return this.name+": "+this.message}}),b(H).from(M),b(ie).from(M);var xe=xa.reduce(function(v,_){return v[_]=_+"Error",v},{}),Ae=M,de=xa.reduce(function(v,_){var L=_+"Error";function j(q,Z){this.name=L,q?typeof q=="string"?(this.message="".concat(q).concat(Z?`
 `+Z:""),this.inner=Z||null):typeof q=="object"&&(this.message="".concat(q.name," ").concat(q.message),this.inner=q):(this.message=C[_]||L,this.inner=null)}return b(j).from(Ae),v[_]=j,v},{});de.Syntax=SyntaxError,de.Type=TypeError,de.Range=RangeError;var Me=cr.reduce(function(v,_){return v[_+"Error"]=de[_],v},{}),ct=xa.reduce(function(v,_){return["Syntax","Type","Range"].indexOf(_)===-1&&(v[_+"Error"]=de[_]),v},{});function se(){}function bt(v){return v}function Dt(v,_){return v==null||v===bt?_:function(L){return _(v(L))}}function Je(v,_){return function(){v.apply(this,arguments),_.apply(this,arguments)}}function we(v,_){return v===se?_:function(){var L=v.apply(this,arguments);L!==void 0&&(arguments[0]=L);var j=this.onsuccess,q=this.onerror;this.onsuccess=null,this.onerror=null;var Z=_.apply(this,arguments);return j&&(this.onsuccess=this.onsuccess?Je(j,this.onsuccess):j),q&&(this.onerror=this.onerror?Je(q,this.onerror):q),Z!==void 0?Z:L}}function mt(v,_){return v===se?_:function(){v.apply(this,arguments);var L=this.onsuccess,j=this.onerror;this.onsuccess=this.onerror=null,_.apply(this,arguments),L&&(this.onsuccess=this.onsuccess?Je(L,this.onsuccess):L),j&&(this.onerror=this.onerror?Je(j,this.onerror):j)}}function qt(v,_){return v===se?_:function(L){var j=v.apply(this,arguments);u(L,j);var q=this.onsuccess,Z=this.onerror;return this.onsuccess=null,this.onerror=null,L=_.apply(this,arguments),q&&(this.onsuccess=this.onsuccess?Je(q,this.onsuccess):q),Z&&(this.onerror=this.onerror?Je(Z,this.onerror):Z),j===void 0?L===void 0?void 0:L:u(j,L)}}function xt(v,_){return v===se?_:function(){return _.apply(this,arguments)!==!1&&v.apply(this,arguments)}}function _t(v,_){return v===se?_:function(){var L=v.apply(this,arguments);if(L&&typeof L.then=="function"){for(var j=this,q=arguments.length,Z=new Array(q);q--;)Z[q]=arguments[q];return L.then(function(){return _.apply(j,Z)})}return _.apply(this,arguments)}}ct.ModifyError=H,ct.DexieError=M,ct.BulkError=ie;var Et=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Bt(v){Et=v}var Jt={},nr=100,gr=typeof Promise>"u"?[]:function(){var v=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[v,f(v),v];var _=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[_,f(_),v]}(),cr=gr[0],xa=gr[1],gr=gr[2],xa=xa&&xa.then,yr=cr&&cr.constructor,mr=!!gr,Qt=function(v,_){Zn.push([v,_]),wt&&(queueMicrotask(Jr),wt=!1)},$t=!0,wt=!0,Vr=[],ur=[],Tn=bt,Ur={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:se,pgp:!1,env:{},finalize:se},Ut=Ur,Zn=[],Lr=0,ga=[];function At(v){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var _=this._PSD=Ut;if(typeof v!="function"){if(v!==Jt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Fr(this,this._value))}this._state=null,this._value=null,++_.ref,function L(j,q){try{q(function(Z){if(j._state===null){if(Z===j)throw new TypeError("A promise cannot be resolved with itself.");var ve=j._lib&&ln();Z&&typeof Z.then=="function"?L(j,function(Ce,De){Z instanceof At?Z._then(Ce,De):Z.then(Ce,De)}):(j._state=!0,j._value=Z,ar(j)),ve&&Sn()}},Fr.bind(null,j))}catch(Z){Fr(j,Z)}}(this,v)}var Bn={get:function(){var v=Ut,_=be;function L(j,q){var Z=this,ve=!v.global&&(v!==Ut||_!==be),Ce=ve&&!ke(),De=new At(function(ze,Ve){Or(Z,new Xr(St(j,v,ve,Ce),St(q,v,ve,Ce),ze,Ve,v))});return this._consoleTask&&(De._consoleTask=this._consoleTask),De}return L.prototype=Jt,L},set:function(v){k(this,"then",v&&v.prototype===Jt?Bn:{get:function(){return v},set:Bn.set})}};function Xr(v,_,L,j,q){this.onFulfilled=typeof v=="function"?v:null,this.onRejected=typeof _=="function"?_:null,this.resolve=L,this.reject=j,this.psd=q}function Fr(v,_){var L,j;ur.push(_),v._state===null&&(L=v._lib&&ln(),_=Tn(_),v._state=!1,v._value=_,j=v,Vr.some(function(q){return q._value===j._value})||Vr.push(j),ar(v),L&&Sn())}function ar(v){var _=v._listeners;v._listeners=[];for(var L=0,j=_.length;L<j;++L)Or(v,_[L]);var q=v._PSD;--q.ref||q.finalize(),Lr===0&&(++Lr,Qt(function(){--Lr==0&&Gt()},[]))}function Or(v,_){if(v._state!==null){var L=v._state?_.onFulfilled:_.onRejected;if(L===null)return(v._state?_.resolve:_.reject)(v._value);++_.psd.ref,++Lr,Qt(Ln,[L,v,_])}else v._listeners.push(_)}function Ln(v,_,L){try{var j,q=_._value;!_._state&&ur.length&&(ur=[]),j=Et&&_._consoleTask?_._consoleTask.run(function(){return v(q)}):v(q),_._state||ur.indexOf(q)!==-1||function(Z){for(var ve=Vr.length;ve;)if(Vr[--ve]._value===Z._value)return Vr.splice(ve,1)}(_),L.resolve(j)}catch(Z){L.reject(Z)}finally{--Lr==0&&Gt(),--L.psd.ref||L.psd.finalize()}}function Jr(){nt(Ur,function(){ln()&&Sn()})}function ln(){var v=$t;return wt=$t=!1,v}function Sn(){var v,_,L;do for(;0<Zn.length;)for(v=Zn,Zn=[],L=v.length,_=0;_<L;++_){var j=v[_];j[0].apply(null,j[1])}while(0<Zn.length);wt=$t=!0}function Gt(){var v=Vr;Vr=[],v.forEach(function(j){j._PSD.onunhandled.call(null,j._value,j)});for(var _=ga.slice(0),L=_.length;L;)_[--L]()}function yn(v){return new At(Jt,!1,v)}function wr(v,_){var L=Ut;return function(){var j=ln(),q=Ut;try{return Xe(L,!0),v.apply(this,arguments)}catch(Z){_&&_(Z)}finally{Xe(q,!1),j&&Sn()}}}x(At.prototype,{then:Bn,_then:function(v,_){Or(this,new Xr(null,null,v,_,Ut))},catch:function(v){if(arguments.length===1)return this.then(null,v);var _=v,L=arguments[1];return typeof _=="function"?this.then(null,function(j){return(j instanceof _?L:yn)(j)}):this.then(null,function(j){return(j&&j.name===_?L:yn)(j)})},finally:function(v){return this.then(function(_){return At.resolve(v()).then(function(){return _})},function(_){return At.resolve(v()).then(function(){return yn(_)})})},timeout:function(v,_){var L=this;return v<1/0?new At(function(j,q){var Z=setTimeout(function(){return q(new de.Timeout(_))},v);L.then(j,q).finally(clearTimeout.bind(null,Z))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&k(At.prototype,Symbol.toStringTag,"Dexie.Promise"),Ur.env=rt(),x(At,{all:function(){var v=Ee.apply(null,arguments).map(Qe);return new At(function(_,L){v.length===0&&_([]);var j=v.length;v.forEach(function(q,Z){return At.resolve(q).then(function(ve){v[Z]=ve,--j||_(v)},L)})})},resolve:function(v){return v instanceof At?v:v&&typeof v.then=="function"?new At(function(_,L){v.then(_,L)}):new At(Jt,!0,v)},reject:yn,race:function(){var v=Ee.apply(null,arguments).map(Qe);return new At(function(_,L){v.map(function(j){return At.resolve(j).then(_,L)})})},PSD:{get:function(){return Ut},set:function(v){return Ut=v}},totalEchoes:{get:function(){return be}},newPSD:he,usePSD:nt,scheduler:{get:function(){return Qt},set:function(v){Qt=v}},rejectionMapper:{get:function(){return Tn},set:function(v){Tn=v}},follow:function(v,_){return new At(function(L,j){return he(function(q,Z){var ve=Ut;ve.unhandleds=[],ve.onunhandled=Z,ve.finalize=Je(function(){var Ce,De=this;Ce=function(){De.unhandleds.length===0?q():Z(De.unhandleds[0])},ga.push(function ze(){Ce(),ga.splice(ga.indexOf(ze),1)}),++Lr,Qt(function(){--Lr==0&&Gt()},[])},ve.finalize),v()},_,L,j)})}}),yr&&(yr.allSettled&&k(At,"allSettled",function(){var v=Ee.apply(null,arguments).map(Qe);return new At(function(_){v.length===0&&_([]);var L=v.length,j=new Array(L);v.forEach(function(q,Z){return At.resolve(q).then(function(ve){return j[Z]={status:"fulfilled",value:ve}},function(ve){return j[Z]={status:"rejected",reason:ve}}).then(function(){return--L||_(j)})})})}),yr.any&&typeof AggregateError<"u"&&k(At,"any",function(){var v=Ee.apply(null,arguments).map(Qe);return new At(function(_,L){v.length===0&&L(new AggregateError([]));var j=v.length,q=new Array(j);v.forEach(function(Z,ve){return At.resolve(Z).then(function(Ce){return _(Ce)},function(Ce){q[ve]=Ce,--j||L(new AggregateError(q))})})})}),yr.withResolvers&&(At.withResolvers=yr.withResolvers));var Dr={awaits:0,echoes:0,id:0},nn=0,Qr=[],X=0,be=0,fe=0;function he(v,_,L,j){var q=Ut,Z=Object.create(q);return Z.parent=q,Z.ref=0,Z.global=!1,Z.id=++fe,Ur.env,Z.env=mr?{Promise:At,PromiseProp:{value:At,configurable:!0,writable:!0},all:At.all,race:At.race,allSettled:At.allSettled,any:At.any,resolve:At.resolve,reject:At.reject}:{},_&&u(Z,_),++q.ref,Z.finalize=function(){--this.parent.ref||this.parent.finalize()},j=nt(Z,v,L,j),Z.ref===0&&Z.finalize(),j}function _e(){return Dr.id||(Dr.id=++nn),++Dr.awaits,Dr.echoes+=nr,Dr.id}function ke(){return!!Dr.awaits&&(--Dr.awaits==0&&(Dr.id=0),Dr.echoes=Dr.awaits*nr,!0)}function Qe(v){return Dr.echoes&&v&&v.constructor===yr?(_e(),v.then(function(_){return ke(),_},function(_){return ke(),It(_)})):v}function ut(){var v=Qr[Qr.length-1];Qr.pop(),Xe(v,!1)}function Xe(v,_){var L,j=Ut;(_?!Dr.echoes||X++&&v===Ut:!X||--X&&v===Ut)||queueMicrotask(_?(function(q){++be,Dr.echoes&&--Dr.echoes!=0||(Dr.echoes=Dr.awaits=Dr.id=0),Qr.push(Ut),Xe(q,!0)}).bind(null,v):ut),v!==Ut&&(Ut=v,j===Ur&&(Ur.env=rt()),mr&&(L=Ur.env.Promise,_=v.env,(j.global||v.global)&&(Object.defineProperty(i,"Promise",_.PromiseProp),L.all=_.all,L.race=_.race,L.resolve=_.resolve,L.reject=_.reject,_.allSettled&&(L.allSettled=_.allSettled),_.any&&(L.any=_.any))))}function rt(){var v=i.Promise;return mr?{Promise:v,PromiseProp:Object.getOwnPropertyDescriptor(i,"Promise"),all:v.all,race:v.race,allSettled:v.allSettled,any:v.any,resolve:v.resolve,reject:v.reject}:{}}function nt(v,_,L,j,q){var Z=Ut;try{return Xe(v,!0),_(L,j,q)}finally{Xe(Z,!1)}}function St(v,_,L,j){return typeof v!="function"?v:function(){var q=Ut;L&&_e(),Xe(_,!0);try{return v.apply(this,arguments)}finally{Xe(q,!1),j&&queueMicrotask(ke)}}}function zt(v){Promise===yr&&Dr.echoes===0?X===0?v():enqueueNativeMicroTask(v):setTimeout(v,0)}(""+xa).indexOf("[native code]")===-1&&(_e=ke=se);var It=At.reject,Lt="",kt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",kr="String expected.",Kr=[],en="__dbnames",En="readonly",ci="readwrite";function Ca(v,_){return v?_?function(){return v.apply(this,arguments)&&_.apply(this,arguments)}:v:_}var Ga={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Fn(v){return typeof v!="string"||/\./.test(v)?function(_){return _}:function(_){return _[v]===void 0&&v in _&&delete(_=le(_))[v],_}}function Ji(){throw de.Type()}function pr(v,_){try{var L=Un(v),j=Un(_);if(L!==j)return L==="Array"?1:j==="Array"?-1:L==="binary"?1:j==="binary"?-1:L==="string"?1:j==="string"?-1:L==="Date"?1:j!=="Date"?NaN:-1;switch(L){case"number":case"Date":case"string":return _<v?1:v<_?-1:0;case"binary":return function(q,Z){for(var ve=q.length,Ce=Z.length,De=ve<Ce?ve:Ce,ze=0;ze<De;++ze)if(q[ze]!==Z[ze])return q[ze]<Z[ze]?-1:1;return ve===Ce?0:ve<Ce?-1:1}(Ml(v),Ml(_));case"Array":return function(q,Z){for(var ve=q.length,Ce=Z.length,De=ve<Ce?ve:Ce,ze=0;ze<De;++ze){var Ve=pr(q[ze],Z[ze]);if(Ve!==0)return Ve}return ve===Ce?0:ve<Ce?-1:1}(v,_)}}catch{}return NaN}function Un(v){var _=typeof v;return _!="object"?_:ArrayBuffer.isView(v)?"binary":(v=Te(v),v==="ArrayBuffer"?"binary":v)}function Ml(v){return v instanceof Uint8Array?v:ArrayBuffer.isView(v)?new Uint8Array(v.buffer,v.byteOffset,v.byteLength):new Uint8Array(v)}var Bl=(an.prototype._trans=function(v,_,L){var j=this._tx||Ut.trans,q=this.name,Z=Et&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(v==="readonly"?"read":"write"," ").concat(this.name));function ve(ze,Ve,Ne){if(!Ne.schema[q])throw new de.NotFound("Table "+q+" not part of transaction");return _(Ne.idbtrans,Ne)}var Ce=ln();try{var De=j&&j.db._novip===this.db._novip?j===Ut.trans?j._promise(v,ve,L):he(function(){return j._promise(v,ve,L)},{trans:j,transless:Ut.transless||Ut}):function ze(Ve,Ne,Ke,Ie){if(Ve.idbdb&&(Ve._state.openComplete||Ut.letThrough||Ve._vip)){var qe=Ve._createTransaction(Ne,Ke,Ve._dbSchema);try{qe.create(),Ve._state.PR1398_maxLoop=3}catch(Ge){return Ge.name===xe.InvalidState&&Ve.isOpen()&&0<--Ve._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),Ve.close({disableAutoOpen:!1}),Ve.open().then(function(){return ze(Ve,Ne,Ke,Ie)})):It(Ge)}return qe._promise(Ne,function(Ge,$e){return he(function(){return Ut.trans=qe,Ie(Ge,$e,qe)})}).then(function(Ge){if(Ne==="readwrite")try{qe.idbtrans.commit()}catch{}return Ne==="readonly"?Ge:qe._completion.then(function(){return Ge})})}if(Ve._state.openComplete)return It(new de.DatabaseClosed(Ve._state.dbOpenError));if(!Ve._state.isBeingOpened){if(!Ve._state.autoOpen)return It(new de.DatabaseClosed);Ve.open().catch(se)}return Ve._state.dbReadyPromise.then(function(){return ze(Ve,Ne,Ke,Ie)})}(this.db,v,[this.name],ve);return Z&&(De._consoleTask=Z,De=De.catch(function(ze){return console.trace(ze),It(ze)})),De}finally{Ce&&Sn()}},an.prototype.get=function(v,_){var L=this;return v&&v.constructor===Object?this.where(v).first(_):v==null?It(new de.Type("Invalid argument to Table.get()")):this._trans("readonly",function(j){return L.core.get({trans:j,key:v}).then(function(q){return L.hook.reading.fire(q)})}).then(_)},an.prototype.where=function(v){if(typeof v=="string")return new this.db.WhereClause(this,v);if(l(v))return new this.db.WhereClause(this,"[".concat(v.join("+"),"]"));var _=o(v);if(_.length===1)return this.where(_[0]).equals(v[_[0]]);var L=this.schema.indexes.concat(this.schema.primKey).filter(function(Ce){if(Ce.compound&&_.every(function(ze){return 0<=Ce.keyPath.indexOf(ze)})){for(var De=0;De<_.length;++De)if(_.indexOf(Ce.keyPath[De])===-1)return!1;return!0}return!1}).sort(function(Ce,De){return Ce.keyPath.length-De.keyPath.length})[0];if(L&&this.db._maxKey!==Lt){var Z=L.keyPath.slice(0,_.length);return this.where(Z).equals(Z.map(function(De){return v[De]}))}!L&&Et&&console.warn("The query ".concat(JSON.stringify(v)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(_.join("+"),"]"));var j=this.schema.idxByName;function q(Ce,De){return pr(Ce,De)===0}var ve=_.reduce(function(Ne,De){var ze=Ne[0],Ve=Ne[1],Ne=j[De],Ke=v[De];return[ze||Ne,ze||!Ne?Ca(Ve,Ne&&Ne.multi?function(Ie){return Ie=re(Ie,De),l(Ie)&&Ie.some(function(qe){return q(Ke,qe)})}:function(Ie){return q(Ke,re(Ie,De))}):Ve]},[null,null]),Z=ve[0],ve=ve[1];return Z?this.where(Z.name).equals(v[Z.keyPath]).filter(ve):L?this.filter(ve):this.where(_).equals("")},an.prototype.filter=function(v){return this.toCollection().and(v)},an.prototype.count=function(v){return this.toCollection().count(v)},an.prototype.offset=function(v){return this.toCollection().offset(v)},an.prototype.limit=function(v){return this.toCollection().limit(v)},an.prototype.each=function(v){return this.toCollection().each(v)},an.prototype.toArray=function(v){return this.toCollection().toArray(v)},an.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},an.prototype.orderBy=function(v){return new this.db.Collection(new this.db.WhereClause(this,l(v)?"[".concat(v.join("+"),"]"):v))},an.prototype.reverse=function(){return this.toCollection().reverse()},an.prototype.mapToClass=function(v){var _,L=this.db,j=this.name;function q(){return _!==null&&_.apply(this,arguments)||this}(this.schema.mappedClass=v).prototype instanceof Ji&&(function(De,ze){if(typeof ze!="function"&&ze!==null)throw new TypeError("Class extends value "+String(ze)+" is not a constructor or null");function Ve(){this.constructor=De}r(De,ze),De.prototype=ze===null?Object.create(ze):(Ve.prototype=ze.prototype,new Ve)}(q,_=v),Object.defineProperty(q.prototype,"db",{get:function(){return L},enumerable:!1,configurable:!0}),q.prototype.table=function(){return j},v=q);for(var Z=new Set,ve=v.prototype;ve;ve=f(ve))Object.getOwnPropertyNames(ve).forEach(function(De){return Z.add(De)});function Ce(De){if(!De)return De;var ze,Ve=Object.create(v.prototype);for(ze in De)if(!Z.has(ze))try{Ve[ze]=De[ze]}catch{}return Ve}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=Ce,this.hook("reading",Ce),v},an.prototype.defineClass=function(){return this.mapToClass(function(v){u(this,v)})},an.prototype.add=function(v,_){var L=this,j=this.schema.primKey,q=j.auto,Z=j.keyPath,ve=v;return Z&&q&&(ve=Fn(Z)(v)),this._trans("readwrite",function(Ce){return L.core.mutate({trans:Ce,type:"add",keys:_!=null?[_]:null,values:[ve]})}).then(function(Ce){return Ce.numFailures?At.reject(Ce.failures[0]):Ce.lastResult}).then(function(Ce){if(Z)try{B(v,Z,Ce)}catch{}return Ce})},an.prototype.update=function(v,_){return typeof v!="object"||l(v)?this.where(":id").equals(v).modify(_):(v=re(v,this.schema.primKey.keyPath),v===void 0?It(new de.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(v).modify(_))},an.prototype.put=function(v,_){var L=this,j=this.schema.primKey,q=j.auto,Z=j.keyPath,ve=v;return Z&&q&&(ve=Fn(Z)(v)),this._trans("readwrite",function(Ce){return L.core.mutate({trans:Ce,type:"put",values:[ve],keys:_!=null?[_]:null})}).then(function(Ce){return Ce.numFailures?At.reject(Ce.failures[0]):Ce.lastResult}).then(function(Ce){if(Z)try{B(v,Z,Ce)}catch{}return Ce})},an.prototype.delete=function(v){var _=this;return this._trans("readwrite",function(L){return _.core.mutate({trans:L,type:"delete",keys:[v]})}).then(function(L){return L.numFailures?At.reject(L.failures[0]):void 0})},an.prototype.clear=function(){var v=this;return this._trans("readwrite",function(_){return v.core.mutate({trans:_,type:"deleteRange",range:Ga})}).then(function(_){return _.numFailures?At.reject(_.failures[0]):void 0})},an.prototype.bulkGet=function(v){var _=this;return this._trans("readonly",function(L){return _.core.getMany({keys:v,trans:L}).then(function(j){return j.map(function(q){return _.hook.reading.fire(q)})})})},an.prototype.bulkAdd=function(v,_,L){var j=this,q=Array.isArray(_)?_:void 0,Z=(L=L||(q?void 0:_))?L.allKeys:void 0;return this._trans("readwrite",function(ve){var ze=j.schema.primKey,Ce=ze.auto,ze=ze.keyPath;if(ze&&q)throw new de.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(q&&q.length!==v.length)throw new de.InvalidArgument("Arguments objects and keys must have the same length");var De=v.length,ze=ze&&Ce?v.map(Fn(ze)):v;return j.core.mutate({trans:ve,type:"add",keys:q,values:ze,wantResults:Z}).then(function(qe){var Ne=qe.numFailures,Ke=qe.results,Ie=qe.lastResult,qe=qe.failures;if(Ne===0)return Z?Ke:Ie;throw new ie("".concat(j.name,".bulkAdd(): ").concat(Ne," of ").concat(De," operations failed"),qe)})})},an.prototype.bulkPut=function(v,_,L){var j=this,q=Array.isArray(_)?_:void 0,Z=(L=L||(q?void 0:_))?L.allKeys:void 0;return this._trans("readwrite",function(ve){var ze=j.schema.primKey,Ce=ze.auto,ze=ze.keyPath;if(ze&&q)throw new de.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(q&&q.length!==v.length)throw new de.InvalidArgument("Arguments objects and keys must have the same length");var De=v.length,ze=ze&&Ce?v.map(Fn(ze)):v;return j.core.mutate({trans:ve,type:"put",keys:q,values:ze,wantResults:Z}).then(function(qe){var Ne=qe.numFailures,Ke=qe.results,Ie=qe.lastResult,qe=qe.failures;if(Ne===0)return Z?Ke:Ie;throw new ie("".concat(j.name,".bulkPut(): ").concat(Ne," of ").concat(De," operations failed"),qe)})})},an.prototype.bulkUpdate=function(v){var _=this,L=this.core,j=v.map(function(ve){return ve.key}),q=v.map(function(ve){return ve.changes}),Z=[];return this._trans("readwrite",function(ve){return L.getMany({trans:ve,keys:j,cache:"clone"}).then(function(Ce){var De=[],ze=[];v.forEach(function(Ne,Ke){var Ie=Ne.key,qe=Ne.changes,Ge=Ce[Ke];if(Ge){for(var $e=0,at=Object.keys(qe);$e<at.length;$e++){var st=at[$e],ot=qe[st];if(st===_.schema.primKey.keyPath){if(pr(ot,Ie)!==0)throw new de.Constraint("Cannot update primary key in bulkUpdate()")}else B(Ge,st,ot)}Z.push(Ke),De.push(Ie),ze.push(Ge)}});var Ve=De.length;return L.mutate({trans:ve,type:"put",keys:De,values:ze,updates:{keys:j,changeSpecs:q}}).then(function(Ne){var Ke=Ne.numFailures,Ie=Ne.failures;if(Ke===0)return Ve;for(var qe=0,Ge=Object.keys(Ie);qe<Ge.length;qe++){var $e,at=Ge[qe],st=Z[Number(at)];st!=null&&($e=Ie[at],delete Ie[at],Ie[st]=$e)}throw new ie("".concat(_.name,".bulkUpdate(): ").concat(Ke," of ").concat(Ve," operations failed"),Ie)})})})},an.prototype.bulkDelete=function(v){var _=this,L=v.length;return this._trans("readwrite",function(j){return _.core.mutate({trans:j,type:"delete",keys:v})}).then(function(ve){var q=ve.numFailures,Z=ve.lastResult,ve=ve.failures;if(q===0)return Z;throw new ie("".concat(_.name,".bulkDelete(): ").concat(q," of ").concat(L," operations failed"),ve)})},an);function an(){}function _i(v){function _(ve,Ce){if(Ce){for(var De=arguments.length,ze=new Array(De-1);--De;)ze[De-1]=arguments[De];return L[ve].subscribe.apply(null,ze),v}if(typeof ve=="string")return L[ve]}var L={};_.addEventType=Z;for(var j=1,q=arguments.length;j<q;++j)Z(arguments[j]);return _;function Z(ve,Ce,De){if(typeof ve!="object"){var ze;Ce=Ce||xt;var Ve={subscribers:[],fire:De=De||se,subscribe:function(Ne){Ve.subscribers.indexOf(Ne)===-1&&(Ve.subscribers.push(Ne),Ve.fire=Ce(Ve.fire,Ne))},unsubscribe:function(Ne){Ve.subscribers=Ve.subscribers.filter(function(Ke){return Ke!==Ne}),Ve.fire=Ve.subscribers.reduce(Ce,De)}};return L[ve]=_[ve]=Ve}o(ze=ve).forEach(function(Ne){var Ke=ze[Ne];if(l(Ke))Z(Ne,ze[Ne][0],ze[Ne][1]);else{if(Ke!=="asap")throw new de.InvalidArgument("Invalid event config");var Ie=Z(Ne,bt,function(){for(var qe=arguments.length,Ge=new Array(qe);qe--;)Ge[qe]=arguments[qe];Ie.subscribers.forEach(function($e){te(function(){$e.apply(null,Ge)})})})}})}}function Qi(v,_){return b(_).from({prototype:v}),_}function aa(v,_){return!(v.filter||v.algorithm||v.or)&&(_?v.justLimit:!v.replayFilter)}function io(v,_){v.filter=Ca(v.filter,_)}function Pa(v,_,L){var j=v.replayFilter;v.replayFilter=j?function(){return Ca(j(),_())}:_,v.justLimit=L&&!j}function ws(v,_){if(v.isPrimKey)return _.primaryKey;var L=_.getIndexByKeyPath(v.index);if(!L)throw new de.Schema("KeyPath "+v.index+" on object store "+_.name+" is not indexed");return L}function hl(v,_,L){var j=ws(v,_.schema);return _.openCursor({trans:L,values:!v.keysOnly,reverse:v.dir==="prev",unique:!!v.unique,query:{index:j,range:v.range}})}function so(v,_,L,j){var q=v.replayFilter?Ca(v.filter,v.replayFilter()):v.filter;if(v.or){var Z={},ve=function(Ce,De,ze){var Ve,Ne;q&&!q(De,ze,function(Ke){return De.stop(Ke)},function(Ke){return De.fail(Ke)})||((Ne=""+(Ve=De.primaryKey))=="[object ArrayBuffer]"&&(Ne=""+new Uint8Array(Ve)),g(Z,Ne)||(Z[Ne]=!0,_(Ce,De,ze)))};return Promise.all([v.or._iterate(ve,L),Ms(hl(v,j,L),v.algorithm,ve,!v.keysOnly&&v.valueMapper)])}return Ms(hl(v,j,L),Ca(v.algorithm,q),_,!v.keysOnly&&v.valueMapper)}function Ms(v,_,L,j){var q=wr(j?function(Z,ve,Ce){return L(j(Z),ve,Ce)}:L);return v.then(function(Z){if(Z)return Z.start(function(){var ve=function(){return Z.continue()};_&&!_(Z,function(Ce){return ve=Ce},function(Ce){Z.stop(Ce),ve=se},function(Ce){Z.fail(Ce),ve=se})||q(Z.value,Z,function(Ce){return ve=Ce}),ve()})})}var Co=(Po.prototype.execute=function(v){var _=this["@@propmod"];if(_.add!==void 0){var L=_.add;if(l(L))return a(a([],l(v)?v:[],!0),L).sort();if(typeof L=="number")return(Number(v)||0)+L;if(typeof L=="bigint")try{return BigInt(v)+L}catch{return BigInt(0)+L}throw new TypeError("Invalid term ".concat(L))}if(_.remove!==void 0){var j=_.remove;if(l(j))return l(v)?v.filter(function(q){return!j.includes(q)}).sort():[];if(typeof j=="number")return Number(v)-j;if(typeof j=="bigint")try{return BigInt(v)-j}catch{return BigInt(0)-j}throw new TypeError("Invalid subtrahend ".concat(j))}return L=(L=_.replacePrefix)===null||L===void 0?void 0:L[0],L&&typeof v=="string"&&v.startsWith(L)?_.replacePrefix[1]+v.substring(L.length):v},Po);function Po(v){this["@@propmod"]=v}var sn=(Gr.prototype._read=function(v,_){var L=this._ctx;return L.error?L.table._trans(null,It.bind(null,L.error)):L.table._trans("readonly",v).then(_)},Gr.prototype._write=function(v){var _=this._ctx;return _.error?_.table._trans(null,It.bind(null,_.error)):_.table._trans("readwrite",v,"locked")},Gr.prototype._addAlgorithm=function(v){var _=this._ctx;_.algorithm=Ca(_.algorithm,v)},Gr.prototype._iterate=function(v,_){return so(this._ctx,v,_,this._ctx.table.core)},Gr.prototype.clone=function(v){var _=Object.create(this.constructor.prototype),L=Object.create(this._ctx);return v&&u(L,v),_._ctx=L,_},Gr.prototype.raw=function(){return this._ctx.valueMapper=null,this},Gr.prototype.each=function(v){var _=this._ctx;return this._read(function(L){return so(_,v,L,_.table.core)})},Gr.prototype.count=function(v){var _=this;return this._read(function(L){var j=_._ctx,q=j.table.core;if(aa(j,!0))return q.count({trans:L,query:{index:ws(j,q.schema),range:j.range}}).then(function(ve){return Math.min(ve,j.limit)});var Z=0;return so(j,function(){return++Z,!1},L,q).then(function(){return Z})}).then(v)},Gr.prototype.sortBy=function(v,_){var L=v.split(".").reverse(),j=L[0],q=L.length-1;function Z(De,ze){return ze?Z(De[L[ze]],ze-1):De[j]}var ve=this._ctx.dir==="next"?1:-1;function Ce(De,ze){return pr(Z(De,q),Z(ze,q))*ve}return this.toArray(function(De){return De.sort(Ce)}).then(_)},Gr.prototype.toArray=function(v){var _=this;return this._read(function(L){var j=_._ctx;if(j.dir==="next"&&aa(j,!0)&&0<j.limit){var q=j.valueMapper,Z=ws(j,j.table.core.schema);return j.table.core.query({trans:L,limit:j.limit,values:!0,query:{index:Z,range:j.range}}).then(function(Ce){return Ce=Ce.result,q?Ce.map(q):Ce})}var ve=[];return so(j,function(Ce){return ve.push(Ce)},L,j.table.core).then(function(){return ve})},v)},Gr.prototype.offset=function(v){var _=this._ctx;return v<=0||(_.offset+=v,aa(_)?Pa(_,function(){var L=v;return function(j,q){return L===0||(L===1?--L:q(function(){j.advance(L),L=0}),!1)}}):Pa(_,function(){var L=v;return function(){return--L<0}})),this},Gr.prototype.limit=function(v){return this._ctx.limit=Math.min(this._ctx.limit,v),Pa(this._ctx,function(){var _=v;return function(L,j,q){return--_<=0&&j(q),0<=_}},!0),this},Gr.prototype.until=function(v,_){return io(this._ctx,function(L,j,q){return!v(L.value)||(j(q),_)}),this},Gr.prototype.first=function(v){return this.limit(1).toArray(function(_){return _[0]}).then(v)},Gr.prototype.last=function(v){return this.reverse().first(v)},Gr.prototype.filter=function(v){var _;return io(this._ctx,function(L){return v(L.value)}),(_=this._ctx).isMatch=Ca(_.isMatch,v),this},Gr.prototype.and=function(v){return this.filter(v)},Gr.prototype.or=function(v){return new this.db.WhereClause(this._ctx.table,v,this)},Gr.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Gr.prototype.desc=function(){return this.reverse()},Gr.prototype.eachKey=function(v){var _=this._ctx;return _.keysOnly=!_.isMatch,this.each(function(L,j){v(j.key,j)})},Gr.prototype.eachUniqueKey=function(v){return this._ctx.unique="unique",this.eachKey(v)},Gr.prototype.eachPrimaryKey=function(v){var _=this._ctx;return _.keysOnly=!_.isMatch,this.each(function(L,j){v(j.primaryKey,j)})},Gr.prototype.keys=function(v){var _=this._ctx;_.keysOnly=!_.isMatch;var L=[];return this.each(function(j,q){L.push(q.key)}).then(function(){return L}).then(v)},Gr.prototype.primaryKeys=function(v){var _=this._ctx;if(_.dir==="next"&&aa(_,!0)&&0<_.limit)return this._read(function(j){var q=ws(_,_.table.core.schema);return _.table.core.query({trans:j,values:!1,limit:_.limit,query:{index:q,range:_.range}})}).then(function(j){return j.result}).then(v);_.keysOnly=!_.isMatch;var L=[];return this.each(function(j,q){L.push(q.primaryKey)}).then(function(){return L}).then(v)},Gr.prototype.uniqueKeys=function(v){return this._ctx.unique="unique",this.keys(v)},Gr.prototype.firstKey=function(v){return this.limit(1).keys(function(_){return _[0]}).then(v)},Gr.prototype.lastKey=function(v){return this.reverse().firstKey(v)},Gr.prototype.distinct=function(){var v=this._ctx,v=v.index&&v.table.schema.idxByName[v.index];if(!v||!v.multi)return this;var _={};return io(this._ctx,function(q){var j=q.primaryKey.toString(),q=g(_,j);return _[j]=!0,!q}),this},Gr.prototype.modify=function(v){var _=this,L=this._ctx;return this._write(function(j){var q,Z,ve;ve=typeof v=="function"?v:(q=o(v),Z=q.length,function($e){for(var at=!1,st=0;st<Z;++st){var ot=q[st],ht=v[ot],Tt=re($e,ot);ht instanceof Co?(B($e,ot,ht.execute(Tt)),at=!0):Tt!==ht&&(B($e,ot,ht),at=!0)}return at});var Ce=L.table.core,Ne=Ce.schema.primaryKey,De=Ne.outbound,ze=Ne.extractKey,Ve=200,Ne=_.db._options.modifyChunkSize;Ne&&(Ve=typeof Ne=="object"?Ne[Ce.name]||Ne["*"]||200:Ne);function Ke($e,ot){var st=ot.failures,ot=ot.numFailures;qe+=$e-ot;for(var ht=0,Tt=o(st);ht<Tt.length;ht++){var Mt=Tt[ht];Ie.push(st[Mt])}}var Ie=[],qe=0,Ge=[];return _.clone().primaryKeys().then(function($e){function at(ot){var ht=Math.min(Ve,$e.length-ot);return Ce.getMany({trans:j,keys:$e.slice(ot,ot+ht),cache:"immutable"}).then(function(Tt){for(var Mt=[],Ct=[],Rt=De?[]:null,Vt=[],Ft=0;Ft<ht;++Ft){var Wt=Tt[Ft],er={value:le(Wt),primKey:$e[ot+Ft]};ve.call(er,er.value,er)!==!1&&(er.value==null?Vt.push($e[ot+Ft]):De||pr(ze(Wt),ze(er.value))===0?(Ct.push(er.value),De&&Rt.push($e[ot+Ft])):(Vt.push($e[ot+Ft]),Mt.push(er.value)))}return Promise.resolve(0<Mt.length&&Ce.mutate({trans:j,type:"add",values:Mt}).then(function(tr){for(var lr in tr.failures)Vt.splice(parseInt(lr),1);Ke(Mt.length,tr)})).then(function(){return(0<Ct.length||st&&typeof v=="object")&&Ce.mutate({trans:j,type:"put",keys:Rt,values:Ct,criteria:st,changeSpec:typeof v!="function"&&v,isAdditionalChunk:0<ot}).then(function(tr){return Ke(Ct.length,tr)})}).then(function(){return(0<Vt.length||st&&v===dl)&&Ce.mutate({trans:j,type:"delete",keys:Vt,criteria:st,isAdditionalChunk:0<ot}).then(function(tr){return Ke(Vt.length,tr)})}).then(function(){return $e.length>ot+ht&&at(ot+Ve)})})}var st=aa(L)&&L.limit===1/0&&(typeof v!="function"||v===dl)&&{index:L.index,range:L.range};return at(0).then(function(){if(0<Ie.length)throw new H("Error modifying one or more objects",Ie,qe,Ge);return $e.length})})})},Gr.prototype.delete=function(){var v=this._ctx,_=v.range;return aa(v)&&(v.isPrimKey||_.type===3)?this._write(function(L){var j=v.table.core.schema.primaryKey,q=_;return v.table.core.count({trans:L,query:{index:j,range:q}}).then(function(Z){return v.table.core.mutate({trans:L,type:"deleteRange",range:q}).then(function(ve){var Ce=ve.failures;if(ve.lastResult,ve.results,ve=ve.numFailures,ve)throw new H("Could not delete some values",Object.keys(Ce).map(function(De){return Ce[De]}),Z-ve);return Z-ve})})}):this.modify(dl)},Gr);function Gr(){}var dl=function(v,_){return _.value=null};function Ul(v,_){return v<_?-1:v===_?0:1}function pc(v,_){return _<v?-1:v===_?0:1}function zn(v,_,L){return v=v instanceof es?new v.Collection(v):v,v._ctx.error=new(L||TypeError)(_),v}function ki(v){return new v.Collection(v,function(){return Cn("")}).limit(0)}function Zi(v,_,L,j){var q,Z,ve,Ce,De,ze,Ve,Ne=L.length;if(!L.every(function(qe){return typeof qe=="string"}))return zn(v,kr);function Ke(qe){q=qe==="next"?function($e){return $e.toUpperCase()}:function($e){return $e.toLowerCase()},Z=qe==="next"?function($e){return $e.toLowerCase()}:function($e){return $e.toUpperCase()},ve=qe==="next"?Ul:pc;var Ge=L.map(function($e){return{lower:Z($e),upper:q($e)}}).sort(function($e,at){return ve($e.lower,at.lower)});Ce=Ge.map(function($e){return $e.upper}),De=Ge.map(function($e){return $e.lower}),Ve=(ze=qe)==="next"?"":j}Ke("next"),v=new v.Collection(v,function(){return Ya(Ce[0],De[Ne-1]+j)}),v._ondirectionchange=function(qe){Ke(qe)};var Ie=0;return v._addAlgorithm(function(qe,Ge,$e){var at=qe.key;if(typeof at!="string")return!1;var st=Z(at);if(_(st,De,Ie))return!0;for(var ot=null,ht=Ie;ht<Ne;++ht){var Tt=function(Mt,Ct,Rt,Vt,Ft,Wt){for(var er=Math.min(Mt.length,Vt.length),tr=-1,lr=0;lr<er;++lr){var tn=Ct[lr];if(tn!==Vt[lr])return Ft(Mt[lr],Rt[lr])<0?Mt.substr(0,lr)+Rt[lr]+Rt.substr(lr+1):Ft(Mt[lr],Vt[lr])<0?Mt.substr(0,lr)+Vt[lr]+Rt.substr(lr+1):0<=tr?Mt.substr(0,tr)+Ct[tr]+Rt.substr(tr+1):null;Ft(Mt[lr],tn)<0&&(tr=lr)}return er<Vt.length&&Wt==="next"?Mt+Rt.substr(Mt.length):er<Mt.length&&Wt==="prev"?Mt.substr(0,Rt.length):tr<0?null:Mt.substr(0,tr)+Vt[tr]+Rt.substr(tr+1)}(at,st,Ce[ht],De[ht],ve,ze);Tt===null&&ot===null?Ie=ht+1:(ot===null||0<ve(ot,Tt))&&(ot=Tt)}return Ge(ot!==null?function(){qe.continue(ot+Ve)}:$e),!1}),v}function Ya(v,_,L,j){return{type:2,lower:v,upper:_,lowerOpen:L,upperOpen:j}}function Cn(v){return{type:1,lower:v,upper:v}}var es=(Object.defineProperty(gn.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),gn.prototype.between=function(v,_,L,j){L=L!==!1,j=j===!0;try{return 0<this._cmp(v,_)||this._cmp(v,_)===0&&(L||j)&&(!L||!j)?ki(this):new this.Collection(this,function(){return Ya(v,_,!L,!j)})}catch{return zn(this,kt)}},gn.prototype.equals=function(v){return v==null?zn(this,kt):new this.Collection(this,function(){return Cn(v)})},gn.prototype.above=function(v){return v==null?zn(this,kt):new this.Collection(this,function(){return Ya(v,void 0,!0)})},gn.prototype.aboveOrEqual=function(v){return v==null?zn(this,kt):new this.Collection(this,function(){return Ya(v,void 0,!1)})},gn.prototype.below=function(v){return v==null?zn(this,kt):new this.Collection(this,function(){return Ya(void 0,v,!1,!0)})},gn.prototype.belowOrEqual=function(v){return v==null?zn(this,kt):new this.Collection(this,function(){return Ya(void 0,v)})},gn.prototype.startsWith=function(v){return typeof v!="string"?zn(this,kr):this.between(v,v+Lt,!0,!0)},gn.prototype.startsWithIgnoreCase=function(v){return v===""?this.startsWith(v):Zi(this,function(_,L){return _.indexOf(L[0])===0},[v],Lt)},gn.prototype.equalsIgnoreCase=function(v){return Zi(this,function(_,L){return _===L[0]},[v],"")},gn.prototype.anyOfIgnoreCase=function(){var v=Ee.apply(ne,arguments);return v.length===0?ki(this):Zi(this,function(_,L){return L.indexOf(_)!==-1},v,"")},gn.prototype.startsWithAnyOfIgnoreCase=function(){var v=Ee.apply(ne,arguments);return v.length===0?ki(this):Zi(this,function(_,L){return L.some(function(j){return _.indexOf(j)===0})},v,Lt)},gn.prototype.anyOf=function(){var v=this,_=Ee.apply(ne,arguments),L=this._cmp;try{_.sort(L)}catch{return zn(this,kt)}if(_.length===0)return ki(this);var j=new this.Collection(this,function(){return Ya(_[0],_[_.length-1])});j._ondirectionchange=function(Z){L=Z==="next"?v._ascending:v._descending,_.sort(L)};var q=0;return j._addAlgorithm(function(Z,ve,Ce){for(var De=Z.key;0<L(De,_[q]);)if(++q===_.length)return ve(Ce),!1;return L(De,_[q])===0||(ve(function(){Z.continue(_[q])}),!1)}),j},gn.prototype.notEqual=function(v){return this.inAnyRange([[-1/0,v],[v,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},gn.prototype.noneOf=function(){var v=Ee.apply(ne,arguments);if(v.length===0)return new this.Collection(this);try{v.sort(this._ascending)}catch{return zn(this,kt)}var _=v.reduce(function(L,j){return L?L.concat([[L[L.length-1][1],j]]):[[-1/0,j]]},null);return _.push([v[v.length-1],this.db._maxKey]),this.inAnyRange(_,{includeLowers:!1,includeUppers:!1})},gn.prototype.inAnyRange=function(at,_){var L=this,j=this._cmp,q=this._ascending,Z=this._descending,ve=this._min,Ce=this._max;if(at.length===0)return ki(this);if(!at.every(function(st){return st[0]!==void 0&&st[1]!==void 0&&q(st[0],st[1])<=0}))return zn(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",de.InvalidArgument);var De=!_||_.includeLowers!==!1,ze=_&&_.includeUppers===!0,Ve,Ne=q;function Ke(st,ot){return Ne(st[0],ot[0])}try{(Ve=at.reduce(function(st,ot){for(var ht=0,Tt=st.length;ht<Tt;++ht){var Mt=st[ht];if(j(ot[0],Mt[1])<0&&0<j(ot[1],Mt[0])){Mt[0]=ve(Mt[0],ot[0]),Mt[1]=Ce(Mt[1],ot[1]);break}}return ht===Tt&&st.push(ot),st},[])).sort(Ke)}catch{return zn(this,kt)}var Ie=0,qe=ze?function(st){return 0<q(st,Ve[Ie][1])}:function(st){return 0<=q(st,Ve[Ie][1])},Ge=De?function(st){return 0<Z(st,Ve[Ie][0])}:function(st){return 0<=Z(st,Ve[Ie][0])},$e=qe,at=new this.Collection(this,function(){return Ya(Ve[0][0],Ve[Ve.length-1][1],!De,!ze)});return at._ondirectionchange=function(st){Ne=st==="next"?($e=qe,q):($e=Ge,Z),Ve.sort(Ke)},at._addAlgorithm(function(st,ot,ht){for(var Tt,Mt=st.key;$e(Mt);)if(++Ie===Ve.length)return ot(ht),!1;return!qe(Tt=Mt)&&!Ge(Tt)||(L._cmp(Mt,Ve[Ie][1])===0||L._cmp(Mt,Ve[Ie][0])===0||ot(function(){Ne===q?st.continue(Ve[Ie][0]):st.continue(Ve[Ie][1])}),!1)}),at},gn.prototype.startsWithAnyOf=function(){var v=Ee.apply(ne,arguments);return v.every(function(_){return typeof _=="string"})?v.length===0?ki(this):this.inAnyRange(v.map(function(_){return[_,_+Lt]})):zn(this,"startsWithAnyOf() only works with strings")},gn);function gn(){}function fr(v){return wr(function(_){return ts(_),v(_.target.error),!1})}function ts(v){v.stopPropagation&&v.stopPropagation(),v.preventDefault&&v.preventDefault()}var Xa="storagemutated",Si="x-storagemutated-1",Ei=_i(null,Xa),oo=(ja.prototype._lock=function(){return K(!Ut.global),++this._reculock,this._reculock!==1||Ut.global||(Ut.lockOwnerFor=this),this},ja.prototype._unlock=function(){if(K(!Ut.global),--this._reculock==0)for(Ut.global||(Ut.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var v=this._blockedFuncs.shift();try{nt(v[1],v[0])}catch{}}return this},ja.prototype._locked=function(){return this._reculock&&Ut.lockOwnerFor!==this},ja.prototype.create=function(v){var _=this;if(!this.mode)return this;var L=this.db.idbdb,j=this.db._state.dbOpenError;if(K(!this.idbtrans),!v&&!L)switch(j&&j.name){case"DatabaseClosedError":throw new de.DatabaseClosed(j);case"MissingAPIError":throw new de.MissingAPI(j.message,j);default:throw new de.OpenFailed(j)}if(!this.active)throw new de.TransactionInactive;return K(this._completion._state===null),(v=this.idbtrans=v||(this.db.core||L).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=wr(function(q){ts(q),_._reject(v.error)}),v.onabort=wr(function(q){ts(q),_.active&&_._reject(new de.Abort(v.error)),_.active=!1,_.on("abort").fire(q)}),v.oncomplete=wr(function(){_.active=!1,_._resolve(),"mutatedParts"in v&&Ei.storagemutated.fire(v.mutatedParts)}),this},ja.prototype._promise=function(v,_,L){var j=this;if(v==="readwrite"&&this.mode!=="readwrite")return It(new de.ReadOnly("Transaction is readonly"));if(!this.active)return It(new de.TransactionInactive);if(this._locked())return new At(function(Z,ve){j._blockedFuncs.push([function(){j._promise(v,_,L).then(Z,ve)},Ut])});if(L)return he(function(){var Z=new At(function(ve,Ce){j._lock();var De=_(ve,Ce,j);De&&De.then&&De.then(ve,Ce)});return Z.finally(function(){return j._unlock()}),Z._lib=!0,Z});var q=new At(function(Z,ve){var Ce=_(Z,ve,j);Ce&&Ce.then&&Ce.then(Z,ve)});return q._lib=!0,q},ja.prototype._root=function(){return this.parent?this.parent._root():this},ja.prototype.waitFor=function(v){var _,L=this._root(),j=At.resolve(v);L._waitingFor?L._waitingFor=L._waitingFor.then(function(){return j}):(L._waitingFor=j,L._waitingQueue=[],_=L.idbtrans.objectStore(L.storeNames[0]),function Z(){for(++L._spinCount;L._waitingQueue.length;)L._waitingQueue.shift()();L._waitingFor&&(_.get(-1/0).onsuccess=Z)}());var q=L._waitingFor;return new At(function(Z,ve){j.then(function(Ce){return L._waitingQueue.push(wr(Z.bind(null,Ce)))},function(Ce){return L._waitingQueue.push(wr(ve.bind(null,Ce)))}).finally(function(){L._waitingFor===q&&(L._waitingFor=null)})})},ja.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new de.Abort))},ja.prototype.table=function(v){var _=this._memoizedTables||(this._memoizedTables={});if(g(_,v))return _[v];var L=this.schema[v];if(!L)throw new de.NotFound("Table "+v+" not part of transaction");return L=new this.db.Table(v,L,this),L.core=this.db.core.table(v),_[v]=L},ja);function ja(){}function lo(v,_,L,j,q,Z,ve){return{name:v,keyPath:_,unique:L,multi:j,auto:q,compound:Z,src:(L&&!ve?"&":"")+(j?"*":"")+(q?"++":"")+Lo(_)}}function Lo(v){return typeof v=="string"?v:v?"["+[].join.call(v,"+")+"]":""}function pl(v,_,L){return{name:v,primKey:_,indexes:L,mappedClass:null,idxByName:(j=function(q){return[q.name,q]},L.reduce(function(q,Z,ve){return ve=j(Z,ve),ve&&(q[ve[0]]=ve[1]),q},{}))};var j}var Fo=function(v){try{return v.only([[]]),Fo=function(){return[[]]},[[]]}catch{return Fo=function(){return Lt},Lt}};function rs(v){return v==null?function(){}:typeof v=="string"?(_=v).split(".").length===1?function(L){return L[_]}:function(L){return re(L,_)}:function(L){return re(L,v)};var _}function Ai(v){return[].slice.call(v)}var ui=0;function bs(v){return v==null?":id":typeof v=="string"?v:"[".concat(v.join("+"),"]")}function Oo(v,_,De){function j($e){if($e.type===3)return null;if($e.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var Ie=$e.lower,qe=$e.upper,Ge=$e.lowerOpen,$e=$e.upperOpen;return Ie===void 0?qe===void 0?null:_.upperBound(qe,!!$e):qe===void 0?_.lowerBound(Ie,!!Ge):_.bound(Ie,qe,!!Ge,!!$e)}function q(Ke){var Ie,qe=Ke.name;return{name:qe,schema:Ke,mutate:function(Ge){var $e=Ge.trans,at=Ge.type,st=Ge.keys,ot=Ge.values,ht=Ge.range;return new Promise(function(Tt,Mt){Tt=wr(Tt);var Ct=$e.objectStore(qe),Rt=Ct.keyPath==null,Vt=at==="put"||at==="add";if(!Vt&&at!=="delete"&&at!=="deleteRange")throw new Error("Invalid operation type: "+at);var Ft,Wt=(st||ot||{length:1}).length;if(st&&ot&&st.length!==ot.length)throw new Error("Given keys array must have same length as given values array.");if(Wt===0)return Tt({numFailures:0,failures:{},results:[],lastResult:void 0});function er(Pn){++tn,ts(Pn)}var tr=[],lr=[],tn=0;if(at==="deleteRange"){if(ht.type===4)return Tt({numFailures:tn,failures:lr,results:[],lastResult:void 0});ht.type===3?tr.push(Ft=Ct.clear()):tr.push(Ft=Ct.delete(j(ht)))}else{var Rt=Vt?Rt?[ot,st]:[ot,null]:[st,null],br=Rt[0],Gn=Rt[1];if(Vt)for(var Hn=0;Hn<Wt;++Hn)tr.push(Ft=Gn&&Gn[Hn]!==void 0?Ct[at](br[Hn],Gn[Hn]):Ct[at](br[Hn])),Ft.onerror=er;else for(Hn=0;Hn<Wt;++Hn)tr.push(Ft=Ct[at](br[Hn])),Ft.onerror=er}function go(Pn){Pn=Pn.target.result,tr.forEach(function(Pi,ya){return Pi.error!=null&&(lr[ya]=Pi.error)}),Tt({numFailures:tn,failures:lr,results:at==="delete"?st:tr.map(function(Pi){return Pi.result}),lastResult:Pn})}Ft.onerror=function(Pn){er(Pn),go(Pn)},Ft.onsuccess=go})},getMany:function(Ge){var $e=Ge.trans,at=Ge.keys;return new Promise(function(st,ot){st=wr(st);for(var ht,Tt=$e.objectStore(qe),Mt=at.length,Ct=new Array(Mt),Rt=0,Vt=0,Ft=function(tr){tr=tr.target,Ct[tr._pos]=tr.result,++Vt===Rt&&st(Ct)},Wt=fr(ot),er=0;er<Mt;++er)at[er]!=null&&((ht=Tt.get(at[er]))._pos=er,ht.onsuccess=Ft,ht.onerror=Wt,++Rt);Rt===0&&st(Ct)})},get:function(Ge){var $e=Ge.trans,at=Ge.key;return new Promise(function(st,ot){st=wr(st);var ht=$e.objectStore(qe).get(at);ht.onsuccess=function(Tt){return st(Tt.target.result)},ht.onerror=fr(ot)})},query:(Ie=ze,function(Ge){return new Promise(function($e,at){$e=wr($e);var st,ot,ht,Rt=Ge.trans,Tt=Ge.values,Mt=Ge.limit,Ft=Ge.query,Ct=Mt===1/0?void 0:Mt,Vt=Ft.index,Ft=Ft.range,Rt=Rt.objectStore(qe),Vt=Vt.isPrimaryKey?Rt:Rt.index(Vt.name),Ft=j(Ft);if(Mt===0)return $e({result:[]});Ie?((Ct=Tt?Vt.getAll(Ft,Ct):Vt.getAllKeys(Ft,Ct)).onsuccess=function(Wt){return $e({result:Wt.target.result})},Ct.onerror=fr(at)):(st=0,ot=!Tt&&"openKeyCursor"in Vt?Vt.openKeyCursor(Ft):Vt.openCursor(Ft),ht=[],ot.onsuccess=function(Wt){var er=ot.result;return er?(ht.push(Tt?er.value:er.primaryKey),++st===Mt?$e({result:ht}):void er.continue()):$e({result:ht})},ot.onerror=fr(at))})}),openCursor:function(Ge){var $e=Ge.trans,at=Ge.values,st=Ge.query,ot=Ge.reverse,ht=Ge.unique;return new Promise(function(Tt,Mt){Tt=wr(Tt);var Vt=st.index,Ct=st.range,Rt=$e.objectStore(qe),Rt=Vt.isPrimaryKey?Rt:Rt.index(Vt.name),Vt=ot?ht?"prevunique":"prev":ht?"nextunique":"next",Ft=!at&&"openKeyCursor"in Rt?Rt.openKeyCursor(j(Ct),Vt):Rt.openCursor(j(Ct),Vt);Ft.onerror=fr(Mt),Ft.onsuccess=wr(function(Wt){var er,tr,lr,tn,br=Ft.result;br?(br.___id=++ui,br.done=!1,er=br.continue.bind(br),tr=(tr=br.continuePrimaryKey)&&tr.bind(br),lr=br.advance.bind(br),tn=function(){throw new Error("Cursor not stopped")},br.trans=$e,br.stop=br.continue=br.continuePrimaryKey=br.advance=function(){throw new Error("Cursor not started")},br.fail=wr(Mt),br.next=function(){var Gn=this,Hn=1;return this.start(function(){return Hn--?Gn.continue():Gn.stop()}).then(function(){return Gn})},br.start=function(Gn){function Hn(){if(Ft.result)try{Gn()}catch(Pn){br.fail(Pn)}else br.done=!0,br.start=function(){throw new Error("Cursor behind last entry")},br.stop()}var go=new Promise(function(Pn,Pi){Pn=wr(Pn),Ft.onerror=fr(Pi),br.fail=Pi,br.stop=function(ya){br.stop=br.continue=br.continuePrimaryKey=br.advance=tn,Pn(ya)}});return Ft.onsuccess=wr(function(Pn){Ft.onsuccess=Hn,Hn()}),br.continue=er,br.continuePrimaryKey=tr,br.advance=lr,Hn(),go},Tt(br)):Tt(null)},Mt)})},count:function(Ge){var $e=Ge.query,at=Ge.trans,st=$e.index,ot=$e.range;return new Promise(function(ht,Tt){var Mt=at.objectStore(qe),Ct=st.isPrimaryKey?Mt:Mt.index(st.name),Mt=j(ot),Ct=Mt?Ct.count(Mt):Ct.count();Ct.onsuccess=wr(function(Rt){return ht(Rt.target.result)}),Ct.onerror=fr(Tt)})}}}var Z,ve,Ce,Ve=(ve=De,Ce=Ai((Z=v).objectStoreNames),{schema:{name:Z.name,tables:Ce.map(function(Ke){return ve.objectStore(Ke)}).map(function(Ke){var Ie=Ke.keyPath,$e=Ke.autoIncrement,qe=l(Ie),Ge={},$e={name:Ke.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:Ie==null,compound:qe,keyPath:Ie,autoIncrement:$e,unique:!0,extractKey:rs(Ie)},indexes:Ai(Ke.indexNames).map(function(at){return Ke.index(at)}).map(function(ht){var st=ht.name,ot=ht.unique,Tt=ht.multiEntry,ht=ht.keyPath,Tt={name:st,compound:l(ht),keyPath:ht,unique:ot,multiEntry:Tt,extractKey:rs(ht)};return Ge[bs(ht)]=Tt}),getIndexByKeyPath:function(at){return Ge[bs(at)]}};return Ge[":id"]=$e.primaryKey,Ie!=null&&(Ge[bs(Ie)]=$e.primaryKey),$e})},hasGetAll:0<Ce.length&&"getAll"in ve.objectStore(Ce[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),De=Ve.schema,ze=Ve.hasGetAll,Ve=De.tables.map(q),Ne={};return Ve.forEach(function(Ke){return Ne[Ke.name]=Ke}),{stack:"dbcore",transaction:v.transaction.bind(v),table:function(Ke){if(!Ne[Ke])throw new Error("Table '".concat(Ke,"' not found"));return Ne[Ke]},MIN_KEY:-1/0,MAX_KEY:Fo(_),schema:De}}function zl(v,_,L,j){var q=L.IDBKeyRange;return L.indexedDB,{dbcore:(j=Oo(_,q,j),v.dbcore.reduce(function(Z,ve){return ve=ve.create,n(n({},Z),ve(Z))},j))}}function ns(v,j){var L=j.db,j=zl(v._middlewares,L,v._deps,j);v.core=j.dbcore,v.tables.forEach(function(q){var Z=q.name;v.core.schema.tables.some(function(ve){return ve.name===Z})&&(q.core=v.core.table(Z),v[Z]instanceof v.Table&&(v[Z].core=q.core))})}function _s(v,_,L,j){L.forEach(function(q){var Z=j[q];_.forEach(function(ve){var Ce=function De(ze,Ve){return E(ze,Ve)||(ze=f(ze))&&De(ze,Ve)}(ve,q);(!Ce||"value"in Ce&&Ce.value===void 0)&&(ve===v.Transaction.prototype||ve instanceof v.Transaction?k(ve,q,{get:function(){return this.table(q)},set:function(De){m(this,q,{value:De,writable:!0,configurable:!0,enumerable:!0})}}):ve[q]=new v.Table(q,Z))})})}function co(v,_){_.forEach(function(L){for(var j in L)L[j]instanceof v.Table&&delete L[j]})}function ql(v,_){return v._cfg.version-_._cfg.version}function as(v,_,L,j){var q=v._dbSchema;L.objectStoreNames.contains("$meta")&&!q.$meta&&(q.$meta=pl("$meta",Us("")[0],[]),v._storeNames.push("$meta"));var Z=v._createTransaction("readwrite",v._storeNames,q);Z.create(L),Z._completion.catch(j);var ve=Z._reject.bind(Z),Ce=Ut.transless||Ut;he(function(){return Ut.trans=Z,Ut.transless=Ce,_!==0?(ns(v,L),ze=_,((De=Z).storeNames.includes("$meta")?De.table("$meta").get("version").then(function(Ve){return Ve??ze}):At.resolve(ze)).then(function(Ve){return Ke=Ve,Ie=Z,qe=L,Ge=[],Ve=(Ne=v)._versions,$e=Ne._dbSchema=Bs(0,Ne.idbdb,qe),(Ve=Ve.filter(function(at){return at._cfg.version>=Ke})).length!==0?(Ve.forEach(function(at){Ge.push(function(){var st=$e,ot=at._cfg.dbschema;qn(Ne,st,qe),qn(Ne,ot,qe),$e=Ne._dbSchema=ot;var ht=Ja(st,ot);ht.add.forEach(function(Vt){gl(qe,Vt[0],Vt[1].primKey,Vt[1].indexes)}),ht.change.forEach(function(Vt){if(Vt.recreate)throw new de.Upgrade("Not yet support for changing primary key");var Ft=qe.objectStore(Vt.name);Vt.add.forEach(function(Wt){return ma(Ft,Wt)}),Vt.change.forEach(function(Wt){Ft.deleteIndex(Wt.name),ma(Ft,Wt)}),Vt.del.forEach(function(Wt){return Ft.deleteIndex(Wt)})});var Tt=at._cfg.contentUpgrade;if(Tt&&at._cfg.version>Ke){ns(Ne,qe),Ie._memoizedTables={};var Mt=V(ot);ht.del.forEach(function(Vt){Mt[Vt]=st[Vt]}),co(Ne,[Ne.Transaction.prototype]),_s(Ne,[Ne.Transaction.prototype],o(Mt),Mt),Ie.schema=Mt;var Ct,Rt=pe(Tt);return Rt&&_e(),ht=At.follow(function(){var Vt;(Ct=Tt(Ie))&&Rt&&(Vt=ke.bind(null,null),Ct.then(Vt,Vt))}),Ct&&typeof Ct.then=="function"?At.resolve(Ct):ht.then(function(){return Ct})}}),Ge.push(function(st){var ot,ht,Tt=at._cfg.dbschema;ot=Tt,ht=st,[].slice.call(ht.db.objectStoreNames).forEach(function(Mt){return ot[Mt]==null&&ht.db.deleteObjectStore(Mt)}),co(Ne,[Ne.Transaction.prototype]),_s(Ne,[Ne.Transaction.prototype],Ne._storeNames,Ne._dbSchema),Ie.schema=Ne._dbSchema}),Ge.push(function(st){Ne.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(Ne.idbdb.version/10)===at._cfg.version?(Ne.idbdb.deleteObjectStore("$meta"),delete Ne._dbSchema.$meta,Ne._storeNames=Ne._storeNames.filter(function(ot){return ot!=="$meta"})):st.objectStore("$meta").put(at._cfg.version,"version"))})}),function at(){return Ge.length?At.resolve(Ge.shift()(Ie.idbtrans)).then(at):At.resolve()}().then(function(){Ti($e,qe)})):At.resolve();var Ne,Ke,Ie,qe,Ge,$e}).catch(ve)):(o(q).forEach(function(Ve){gl(L,Ve,q[Ve].primKey,q[Ve].indexes)}),ns(v,L),void At.follow(function(){return v.on.populate.fire(Z)}).catch(ve));var De,ze})}function Ni(v,_){Ti(v._dbSchema,_),_.db.version%10!=0||_.objectStoreNames.contains("$meta")||_.db.createObjectStore("$meta").add(Math.ceil(_.db.version/10-1),"version");var L=Bs(0,v.idbdb,_);qn(v,v._dbSchema,_);for(var j=0,q=Ja(L,v._dbSchema).change;j<q.length;j++){var Z=function(ve){if(ve.change.length||ve.recreate)return console.warn("Unable to patch indexes of table ".concat(ve.name," because it has changes on the type of index or primary key.")),{value:void 0};var Ce=_.objectStore(ve.name);ve.add.forEach(function(De){Et&&console.debug("Dexie upgrade patch: Creating missing index ".concat(ve.name,".").concat(De.src)),ma(Ce,De)})}(q[j]);if(typeof Z=="object")return Z.value}}function Ja(v,_){var L,j={del:[],add:[],change:[]};for(L in v)_[L]||j.del.push(L);for(L in _){var q=v[L],Z=_[L];if(q){var ve={name:L,def:Z,recreate:!1,del:[],add:[],change:[]};if(""+(q.primKey.keyPath||"")!=""+(Z.primKey.keyPath||"")||q.primKey.auto!==Z.primKey.auto)ve.recreate=!0,j.change.push(ve);else{var Ce=q.idxByName,De=Z.idxByName,ze=void 0;for(ze in Ce)De[ze]||ve.del.push(ze);for(ze in De){var Ve=Ce[ze],Ne=De[ze];Ve?Ve.src!==Ne.src&&ve.change.push(Ne):ve.add.push(Ne)}(0<ve.del.length||0<ve.add.length||0<ve.change.length)&&j.change.push(ve)}}else j.add.push([L,Z])}return j}function gl(v,_,L,j){var q=v.db.createObjectStore(_,L.keyPath?{keyPath:L.keyPath,autoIncrement:L.auto}:{autoIncrement:L.auto});return j.forEach(function(Z){return ma(q,Z)}),q}function Ti(v,_){o(v).forEach(function(L){_.db.objectStoreNames.contains(L)||(Et&&console.debug("Dexie: Creating missing table",L),gl(_,L,v[L].primKey,v[L].indexes))})}function ma(v,_){v.createIndex(_.name,_.keyPath,{unique:_.unique,multiEntry:_.multi})}function Bs(v,_,L){var j={};return O(_.objectStoreNames,0).forEach(function(q){for(var Z=L.objectStore(q),ve=lo(Lo(ze=Z.keyPath),ze||"",!0,!1,!!Z.autoIncrement,ze&&typeof ze!="string",!0),Ce=[],De=0;De<Z.indexNames.length;++De){var Ve=Z.index(Z.indexNames[De]),ze=Ve.keyPath,Ve=lo(Ve.name,ze,!!Ve.unique,!!Ve.multiEntry,!1,ze&&typeof ze!="string",!1);Ce.push(Ve)}j[q]=pl(q,ve,Ce)}),j}function qn(v,_,L){for(var j=L.db.objectStoreNames,q=0;q<j.length;++q){var Z=j[q],ve=L.objectStore(Z);v._hasGetAll="getAll"in ve;for(var Ce=0;Ce<ve.indexNames.length;++Ce){var De=ve.indexNames[Ce],ze=ve.index(De).keyPath,Ve=typeof ze=="string"?ze:"["+O(ze).join("+")+"]";!_[Z]||(ze=_[Z].idxByName[Ve])&&(ze.name=De,delete _[Z].idxByName[Ve],_[Z].idxByName[De]=ze)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&i.WorkerGlobalScope&&i instanceof i.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(v._hasGetAll=!1)}function Us(v){return v.split(",").map(function(_,L){var j=(_=_.trim()).replace(/([&*]|\+\+)/g,""),q=/^\[/.test(j)?j.match(/^\[(.*)\]$/)[1].split("+"):j;return lo(j,q||null,/\&/.test(_),/\*/.test(_),/\+\+/.test(_),l(q),L===0)})}var uo=(ks.prototype._parseStoresSpec=function(v,_){o(v).forEach(function(L){if(v[L]!==null){var j=Us(v[L]),q=j.shift();if(q.unique=!0,q.multi)throw new de.Schema("Primary key cannot be multi-valued");j.forEach(function(Z){if(Z.auto)throw new de.Schema("Only primary key can be marked as autoIncrement (++)");if(!Z.keyPath)throw new de.Schema("Index must have a name and cannot be an empty string")}),_[L]=pl(L,q,j)}})},ks.prototype.stores=function(L){var _=this.db;this._cfg.storesSource=this._cfg.storesSource?u(this._cfg.storesSource,L):L;var L=_._versions,j={},q={};return L.forEach(function(Z){u(j,Z._cfg.storesSource),q=Z._cfg.dbschema={},Z._parseStoresSpec(j,q)}),_._dbSchema=q,co(_,[_._allTables,_,_.Transaction.prototype]),_s(_,[_._allTables,_,_.Transaction.prototype,this._cfg.tables],o(q),q),_._storeNames=o(q),this},ks.prototype.upgrade=function(v){return this._cfg.contentUpgrade=_t(this._cfg.contentUpgrade||se,v),this},ks);function ks(){}function Io(v,_){var L=v._dbNamesDB;return L||(L=v._dbNamesDB=new Ma(en,{addons:[],indexedDB:v,IDBKeyRange:_})).version(1).stores({dbnames:"name"}),L.table("dbnames")}function zs(v){return v&&typeof v.databases=="function"}function fo(v){return he(function(){return Ut.letThrough=!0,v()})}function Ci(v){return!("from"in v)}var On=function(v,_){if(!this){var L=new On;return v&&"d"in v&&u(L,v),L}u(this,arguments.length?{d:1,from:v,to:1<arguments.length?_:v}:{d:0})};function Ss(v,_,L){var j=pr(_,L);if(!isNaN(j)){if(0<j)throw RangeError();if(Ci(v))return u(v,{from:_,to:L,d:1});var q=v.l,j=v.r;if(pr(L,v.from)<0)return q?Ss(q,_,L):v.l={from:_,to:L,d:1,l:null,r:null},Es(v);if(0<pr(_,v.to))return j?Ss(j,_,L):v.r={from:_,to:L,d:1,l:null,r:null},Es(v);pr(_,v.from)<0&&(v.from=_,v.l=null,v.d=j?j.d+1:1),0<pr(L,v.to)&&(v.to=L,v.r=null,v.d=v.l?v.l.d+1:1),L=!v.r,q&&!v.l&&ho(v,q),j&&L&&ho(v,j)}}function ho(v,_){Ci(_)||function L(j,De){var Z=De.from,ve=De.to,Ce=De.l,De=De.r;Ss(j,Z,ve),Ce&&L(j,Ce),De&&L(j,De)}(v,_)}function gc(v,_){var L=qs(_),j=L.next();if(j.done)return!1;for(var q=j.value,Z=qs(v),ve=Z.next(q.from),Ce=ve.value;!j.done&&!ve.done;){if(pr(Ce.from,q.to)<=0&&0<=pr(Ce.to,q.from))return!0;pr(q.from,Ce.from)<0?q=(j=L.next(Ce.from)).value:Ce=(ve=Z.next(q.from)).value}return!1}function qs(v){var _=Ci(v)?null:{s:0,n:v};return{next:function(L){for(var j=0<arguments.length;_;)switch(_.s){case 0:if(_.s=1,j)for(;_.n.l&&pr(L,_.n.from)<0;)_={up:_,n:_.n.l,s:1};else for(;_.n.l;)_={up:_,n:_.n.l,s:1};case 1:if(_.s=2,!j||pr(L,_.n.to)<=0)return{value:_.n,done:!1};case 2:if(_.n.r){_.s=3,_={up:_,n:_.n.r,s:0};continue}case 3:_=_.up}return{done:!0}}}}function Es(v){var _,L,j=(((_=v.r)===null||_===void 0?void 0:_.d)||0)-(((L=v.l)===null||L===void 0?void 0:L.d)||0),q=1<j?"r":j<-1?"l":"";q&&(_=q=="r"?"l":"r",L=n({},v),j=v[q],v.from=j.from,v.to=j.to,v[q]=j[q],L[q]=j[_],(v[_]=L).d=ml(L)),v.d=ml(v)}function ml(L){var _=L.r,L=L.l;return(_?L?Math.max(_.d,L.d):_.d:L?L.d:0)+1}function is(v,_){return o(_).forEach(function(L){v[L]?ho(v[L],_[L]):v[L]=function j(q){var Z,ve,Ce={};for(Z in q)g(q,Z)&&(ve=q[Z],Ce[Z]=!ve||typeof ve!="object"||U.has(ve.constructor)?ve:j(ve));return Ce}(_[L])}),v}function Ro(v,_){return v.all||_.all||Object.keys(v).some(function(L){return _[L]&&gc(_[L],v[L])})}x(On.prototype,((xa={add:function(v){return ho(this,v),this},addKey:function(v){return Ss(this,v,v),this},addKeys:function(v){var _=this;return v.forEach(function(L){return Ss(_,L,L)}),this},hasKey:function(v){var _=qs(this).next(v).value;return _&&pr(_.from,v)<=0&&0<=pr(_.to,v)}})[Fe]=function(){return qs(this)},xa));var S={},G={},Se=!1;function Oe(v){is(G,v),Se||(Se=!0,setTimeout(function(){Se=!1,Ye(G,!(G={}))},0))}function Ye(v,_){_===void 0&&(_=!1);var L=new Set;if(v.all)for(var j=0,q=Object.values(S);j<q.length;j++)dt(ve=q[j],v,L,_);else for(var Z in v){var ve,Ce=/^idb\:\/\/(.*)\/(.*)\//.exec(Z);Ce&&(Z=Ce[1],Ce=Ce[2],(ve=S["idb://".concat(Z,"/").concat(Ce)])&&dt(ve,v,L,_))}L.forEach(function(De){return De()})}function dt(v,_,L,j){for(var q=[],Z=0,ve=Object.entries(v.queries.query);Z<ve.length;Z++){for(var Ce=ve[Z],De=Ce[0],ze=[],Ve=0,Ne=Ce[1];Ve<Ne.length;Ve++){var Ke=Ne[Ve];Ro(_,Ke.obsSet)?Ke.subscribers.forEach(function($e){return L.add($e)}):j&&ze.push(Ke)}j&&q.push([De,ze])}if(j)for(var Ie=0,qe=q;Ie<qe.length;Ie++){var Ge=qe[Ie],De=Ge[0],ze=Ge[1];v.queries.query[De]=ze}}function Nt(v){var _=v._state,L=v._deps.indexedDB;if(_.isBeingOpened||v.idbdb)return _.dbReadyPromise.then(function(){return _.dbOpenError?It(_.dbOpenError):v});_.isBeingOpened=!0,_.dbOpenError=null,_.openComplete=!1;var j=_.openCanceller,q=Math.round(10*v.verno),Z=!1;function ve(){if(_.openCanceller!==j)throw new de.DatabaseClosed("db.open() was cancelled")}function Ce(){return new At(function(Ke,Ie){if(ve(),!L)throw new de.MissingAPI;var qe=v.name,Ge=_.autoSchema||!q?L.open(qe):L.open(qe,q);if(!Ge)throw new de.MissingAPI;Ge.onerror=fr(Ie),Ge.onblocked=wr(v._fireOnBlocked),Ge.onupgradeneeded=wr(function($e){var at;Ve=Ge.transaction,_.autoSchema&&!v._options.allowEmptyDB?(Ge.onerror=ts,Ve.abort(),Ge.result.close(),(at=L.deleteDatabase(qe)).onsuccess=at.onerror=wr(function(){Ie(new de.NoSuchDatabase("Database ".concat(qe," doesnt exist")))})):(Ve.onerror=fr(Ie),$e=$e.oldVersion>Math.pow(2,62)?0:$e.oldVersion,Ne=$e<1,v.idbdb=Ge.result,Z&&Ni(v,Ve),as(v,$e/10,Ve,Ie))},Ie),Ge.onsuccess=wr(function(){Ve=null;var $e,at,st,ot,ht,Tt=v.idbdb=Ge.result,Mt=O(Tt.objectStoreNames);if(0<Mt.length)try{var Ct=Tt.transaction((ot=Mt).length===1?ot[0]:ot,"readonly");if(_.autoSchema)at=Tt,st=Ct,($e=v).verno=at.version/10,st=$e._dbSchema=Bs(0,at,st),$e._storeNames=O(at.objectStoreNames,0),_s($e,[$e._allTables],o(st),st);else if(qn(v,v._dbSchema,Ct),((ht=Ja(Bs(0,(ht=v).idbdb,Ct),ht._dbSchema)).add.length||ht.change.some(function(Rt){return Rt.add.length||Rt.change.length}))&&!Z)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Tt.close(),q=Tt.version+1,Z=!0,Ke(Ce());ns(v,Ct)}catch{}Kr.push(v),Tt.onversionchange=wr(function(Rt){_.vcFired=!0,v.on("versionchange").fire(Rt)}),Tt.onclose=wr(function(Rt){v.on("close").fire(Rt)}),Ne&&(ht=v._deps,Ct=qe,Tt=ht.indexedDB,ht=ht.IDBKeyRange,zs(Tt)||Ct===en||Io(Tt,ht).put({name:Ct}).catch(se)),Ke()},Ie)}).catch(function(Ke){switch(Ke?.name){case"UnknownError":if(0<_.PR1398_maxLoop)return _.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),Ce();break;case"VersionError":if(0<q)return q=0,Ce()}return At.reject(Ke)})}var De,ze=_.dbReadyResolve,Ve=null,Ne=!1;return At.race([j,(typeof navigator>"u"?At.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(Ke){function Ie(){return indexedDB.databases().finally(Ke)}De=setInterval(Ie,100),Ie()}).finally(function(){return clearInterval(De)}):Promise.resolve()).then(Ce)]).then(function(){return ve(),_.onReadyBeingFired=[],At.resolve(fo(function(){return v.on.ready.fire(v.vip)})).then(function Ke(){if(0<_.onReadyBeingFired.length){var Ie=_.onReadyBeingFired.reduce(_t,se);return _.onReadyBeingFired=[],At.resolve(fo(function(){return Ie(v.vip)})).then(Ke)}})}).finally(function(){_.openCanceller===j&&(_.onReadyBeingFired=null,_.isBeingOpened=!1)}).catch(function(Ke){_.dbOpenError=Ke;try{Ve&&Ve.abort()}catch{}return j===_.openCanceller&&v._close(),It(Ke)}).finally(function(){_.openComplete=!0,ze()}).then(function(){var Ke;return Ne&&(Ke={},v.tables.forEach(function(Ie){Ie.schema.indexes.forEach(function(qe){qe.name&&(Ke["idb://".concat(v.name,"/").concat(Ie.name,"/").concat(qe.name)]=new On(-1/0,[[[]]]))}),Ke["idb://".concat(v.name,"/").concat(Ie.name,"/")]=Ke["idb://".concat(v.name,"/").concat(Ie.name,"/:dels")]=new On(-1/0,[[[]]])}),Ei(Xa).fire(Ke),Ye(Ke,!0)),v})}function Xt(v){function _(Z){return v.next(Z)}var L=q(_),j=q(function(Z){return v.throw(Z)});function q(Z){return function(De){var Ce=Z(De),De=Ce.value;return Ce.done?De:De&&typeof De.then=="function"?De.then(L,j):l(De)?Promise.all(De).then(L,j):L(De)}}return q(_)()}function hr(v,_,L){for(var j=l(v)?v.slice():[v],q=0;q<L;++q)j.push(_);return j}var jr={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(v){return n(n({},v),{table:function(_){var L=v.table(_),j=L.schema,q={},Z=[];function ve(Ne,Ke,Ie){var qe=bs(Ne),Ge=q[qe]=q[qe]||[],$e=Ne==null?0:typeof Ne=="string"?1:Ne.length,at=0<Ke,at=n(n({},Ie),{name:at?"".concat(qe,"(virtual-from:").concat(Ie.name,")"):Ie.name,lowLevelIndex:Ie,isVirtual:at,keyTail:Ke,keyLength:$e,extractKey:rs(Ne),unique:!at&&Ie.unique});return Ge.push(at),at.isPrimaryKey||Z.push(at),1<$e&&ve($e===2?Ne[0]:Ne.slice(0,$e-1),Ke+1,Ie),Ge.sort(function(st,ot){return st.keyTail-ot.keyTail}),at}_=ve(j.primaryKey.keyPath,0,j.primaryKey),q[":id"]=[_];for(var Ce=0,De=j.indexes;Ce<De.length;Ce++){var ze=De[Ce];ve(ze.keyPath,0,ze)}function Ve(Ne){var Ke,Ie=Ne.query.index;return Ie.isVirtual?n(n({},Ne),{query:{index:Ie.lowLevelIndex,range:(Ke=Ne.query.range,Ie=Ie.keyTail,{type:Ke.type===1?2:Ke.type,lower:hr(Ke.lower,Ke.lowerOpen?v.MAX_KEY:v.MIN_KEY,Ie),lowerOpen:!0,upper:hr(Ke.upper,Ke.upperOpen?v.MIN_KEY:v.MAX_KEY,Ie),upperOpen:!0})}}):Ne}return n(n({},L),{schema:n(n({},j),{primaryKey:_,indexes:Z,getIndexByKeyPath:function(Ne){return(Ne=q[bs(Ne)])&&Ne[0]}}),count:function(Ne){return L.count(Ve(Ne))},query:function(Ne){return L.query(Ve(Ne))},openCursor:function(Ne){var Ke=Ne.query.index,Ie=Ke.keyTail,qe=Ke.isVirtual,Ge=Ke.keyLength;return qe?L.openCursor(Ve(Ne)).then(function(at){return at&&$e(at)}):L.openCursor(Ne);function $e(at){return Object.create(at,{continue:{value:function(st){st!=null?at.continue(hr(st,Ne.reverse?v.MAX_KEY:v.MIN_KEY,Ie)):Ne.unique?at.continue(at.key.slice(0,Ge).concat(Ne.reverse?v.MIN_KEY:v.MAX_KEY,Ie)):at.continue()}},continuePrimaryKey:{value:function(st,ot){at.continuePrimaryKey(hr(st,v.MAX_KEY,Ie),ot)}},primaryKey:{get:function(){return at.primaryKey}},key:{get:function(){var st=at.key;return Ge===1?st[0]:st.slice(0,Ge)}},value:{get:function(){return at.value}}})}}})}})}};function Ar(v,_,L,j){return L=L||{},j=j||"",o(v).forEach(function(q){var Z,ve,Ce;g(_,q)?(Z=v[q],ve=_[q],typeof Z=="object"&&typeof ve=="object"&&Z&&ve?(Ce=Te(Z))!==Te(ve)?L[j+q]=_[q]:Ce==="Object"?Ar(Z,ve,L,j+q+"."):Z!==ve&&(L[j+q]=_[q]):Z!==ve&&(L[j+q]=_[q])):L[j+q]=void 0}),o(_).forEach(function(q){g(v,q)||(L[j+q]=_[q])}),L}function Yr(v,_){return _.type==="delete"?_.keys:_.keys||_.values.map(v.extractKey)}var In={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(v){return n(n({},v),{table:function(_){var L=v.table(_),j=L.schema.primaryKey;return n(n({},L),{mutate:function(q){var Z=Ut.trans,ve=Z.table(_).hook,Ce=ve.deleting,De=ve.creating,ze=ve.updating;switch(q.type){case"add":if(De.fire===se)break;return Z._promise("readwrite",function(){return Ve(q)},!0);case"put":if(De.fire===se&&ze.fire===se)break;return Z._promise("readwrite",function(){return Ve(q)},!0);case"delete":if(Ce.fire===se)break;return Z._promise("readwrite",function(){return Ve(q)},!0);case"deleteRange":if(Ce.fire===se)break;return Z._promise("readwrite",function(){return function Ne(Ke,Ie,qe){return L.query({trans:Ke,values:!1,query:{index:j,range:Ie},limit:qe}).then(function(Ge){var $e=Ge.result;return Ve({type:"delete",keys:$e,trans:Ke}).then(function(at){return 0<at.numFailures?Promise.reject(at.failures[0]):$e.length<qe?{failures:[],numFailures:0,lastResult:void 0}:Ne(Ke,n(n({},Ie),{lower:$e[$e.length-1],lowerOpen:!0}),qe)})})}(q.trans,q.range,1e4)},!0)}return L.mutate(q);function Ve(Ne){var Ke,Ie,qe,Ge=Ut.trans,$e=Ne.keys||Yr(j,Ne);if(!$e)throw new Error("Keys missing");return(Ne=Ne.type==="add"||Ne.type==="put"?n(n({},Ne),{keys:$e}):n({},Ne)).type!=="delete"&&(Ne.values=a([],Ne.values)),Ne.keys&&(Ne.keys=a([],Ne.keys)),Ke=L,qe=$e,((Ie=Ne).type==="add"?Promise.resolve([]):Ke.getMany({trans:Ie.trans,keys:qe,cache:"immutable"})).then(function(at){var st=$e.map(function(ot,ht){var Tt,Mt,Ct,Rt=at[ht],Vt={onerror:null,onsuccess:null};return Ne.type==="delete"?Ce.fire.call(Vt,ot,Rt,Ge):Ne.type==="add"||Rt===void 0?(Tt=De.fire.call(Vt,ot,Ne.values[ht],Ge),ot==null&&Tt!=null&&(Ne.keys[ht]=ot=Tt,j.outbound||B(Ne.values[ht],j.keyPath,ot))):(Tt=Ar(Rt,Ne.values[ht]),(Mt=ze.fire.call(Vt,Tt,ot,Rt,Ge))&&(Ct=Ne.values[ht],Object.keys(Mt).forEach(function(Ft){g(Ct,Ft)?Ct[Ft]=Mt[Ft]:B(Ct,Ft,Mt[Ft])}))),Vt});return L.mutate(Ne).then(function(ot){for(var ht=ot.failures,Tt=ot.results,Mt=ot.numFailures,ot=ot.lastResult,Ct=0;Ct<$e.length;++Ct){var Rt=(Tt||$e)[Ct],Vt=st[Ct];Rt==null?Vt.onerror&&Vt.onerror(ht[Ct]):Vt.onsuccess&&Vt.onsuccess(Ne.type==="put"&&at[Ct]?Ne.values[Ct]:Rt)}return{failures:ht,results:Tt,numFailures:Mt,lastResult:ot}}).catch(function(ot){return st.forEach(function(ht){return ht.onerror&&ht.onerror(ot)}),Promise.reject(ot)})})}}})}})}};function Rn(v,_,L){try{if(!_||_.keys.length<v.length)return null;for(var j=[],q=0,Z=0;q<_.keys.length&&Z<v.length;++q)pr(_.keys[q],v[Z])===0&&(j.push(L?le(_.values[q]):_.values[q]),++Z);return j.length===v.length?j:null}catch{return null}}var ea={stack:"dbcore",level:-1,create:function(v){return{table:function(_){var L=v.table(_);return n(n({},L),{getMany:function(j){if(!j.cache)return L.getMany(j);var q=Rn(j.keys,j.trans._cache,j.cache==="clone");return q?At.resolve(q):L.getMany(j).then(function(Z){return j.trans._cache={keys:j.keys,values:j.cache==="clone"?le(Z):Z},Z})},mutate:function(j){return j.type!=="add"&&(j.trans._cache=null),L.mutate(j)}})}}}};function va(v,_){return v.trans.mode==="readonly"&&!!v.subscr&&!v.trans.explicit&&v.trans.db._options.cache!=="disabled"&&!_.schema.primaryKey.outbound}function ia(v,_){switch(v){case"query":return _.values&&!_.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var ss={stack:"dbcore",level:0,name:"Observability",create:function(v){var _=v.schema.name,L=new On(v.MIN_KEY,v.MAX_KEY);return n(n({},v),{transaction:function(j,q,Z){if(Ut.subscr&&q!=="readonly")throw new de.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Ut.querier));return v.transaction(j,q,Z)},table:function(j){var q=v.table(j),Z=q.schema,ve=Z.primaryKey,Ne=Z.indexes,Ce=ve.extractKey,De=ve.outbound,ze=ve.autoIncrement&&Ne.filter(function(Ie){return Ie.compound&&Ie.keyPath.includes(ve.keyPath)}),Ve=n(n({},q),{mutate:function(Ie){function qe(Ft){return Ft="idb://".concat(_,"/").concat(j,"/").concat(Ft),ot[Ft]||(ot[Ft]=new On)}var Ge,$e,at,st=Ie.trans,ot=Ie.mutatedParts||(Ie.mutatedParts={}),ht=qe(""),Tt=qe(":dels"),Mt=Ie.type,Vt=Ie.type==="deleteRange"?[Ie.range]:Ie.type==="delete"?[Ie.keys]:Ie.values.length<50?[Yr(ve,Ie).filter(function(Ft){return Ft}),Ie.values]:[],Ct=Vt[0],Rt=Vt[1],Vt=Ie.trans._cache;return l(Ct)?(ht.addKeys(Ct),(Vt=Mt==="delete"||Ct.length===Rt.length?Rn(Ct,Vt):null)||Tt.addKeys(Ct),(Vt||Rt)&&(Ge=qe,$e=Vt,at=Rt,Z.indexes.forEach(function(Ft){var Wt=Ge(Ft.name||"");function er(lr){return lr!=null?Ft.extractKey(lr):null}function tr(lr){return Ft.multiEntry&&l(lr)?lr.forEach(function(tn){return Wt.addKey(tn)}):Wt.addKey(lr)}($e||at).forEach(function(lr,Gn){var br=$e&&er($e[Gn]),Gn=at&&er(at[Gn]);pr(br,Gn)!==0&&(br!=null&&tr(br),Gn!=null&&tr(Gn))})}))):Ct?(Rt={from:(Rt=Ct.lower)!==null&&Rt!==void 0?Rt:v.MIN_KEY,to:(Rt=Ct.upper)!==null&&Rt!==void 0?Rt:v.MAX_KEY},Tt.add(Rt),ht.add(Rt)):(ht.add(L),Tt.add(L),Z.indexes.forEach(function(Ft){return qe(Ft.name).add(L)})),q.mutate(Ie).then(function(Ft){return!Ct||Ie.type!=="add"&&Ie.type!=="put"||(ht.addKeys(Ft.results),ze&&ze.forEach(function(Wt){for(var er=Ie.values.map(function(br){return Wt.extractKey(br)}),tr=Wt.keyPath.findIndex(function(br){return br===ve.keyPath}),lr=0,tn=Ft.results.length;lr<tn;++lr)er[lr][tr]=Ft.results[lr];qe(Wt.name).addKeys(er)})),st.mutatedParts=is(st.mutatedParts||{},ot),Ft})}}),Ne=function(qe){var Ge=qe.query,qe=Ge.index,Ge=Ge.range;return[qe,new On((qe=Ge.lower)!==null&&qe!==void 0?qe:v.MIN_KEY,(Ge=Ge.upper)!==null&&Ge!==void 0?Ge:v.MAX_KEY)]},Ke={get:function(Ie){return[ve,new On(Ie.key)]},getMany:function(Ie){return[ve,new On().addKeys(Ie.keys)]},count:Ne,query:Ne,openCursor:Ne};return o(Ke).forEach(function(Ie){Ve[Ie]=function(qe){var Ge=Ut.subscr,$e=!!Ge,at=va(Ut,q)&&ia(Ie,qe)?qe.obsSet={}:Ge;if($e){var st=function(Rt){return Rt="idb://".concat(_,"/").concat(j,"/").concat(Rt),at[Rt]||(at[Rt]=new On)},ot=st(""),ht=st(":dels"),Ge=Ke[Ie](qe),$e=Ge[0],Ge=Ge[1];if((Ie==="query"&&$e.isPrimaryKey&&!qe.values?ht:st($e.name||"")).add(Ge),!$e.isPrimaryKey){if(Ie!=="count"){var Tt=Ie==="query"&&De&&qe.values&&q.query(n(n({},qe),{values:!1}));return q[Ie].apply(this,arguments).then(function(Rt){if(Ie==="query"){if(De&&qe.values)return Tt.then(function(er){return er=er.result,ot.addKeys(er),Rt});var Vt=qe.values?Rt.result.map(Ce):Rt.result;(qe.values?ot:ht).addKeys(Vt)}else if(Ie==="openCursor"){var Ft=Rt,Wt=qe.values;return Ft&&Object.create(Ft,{key:{get:function(){return ht.addKey(Ft.primaryKey),Ft.key}},primaryKey:{get:function(){var er=Ft.primaryKey;return ht.addKey(er),er}},value:{get:function(){return Wt&&ot.addKey(Ft.primaryKey),Ft.value}}})}return Rt})}ht.add(L)}}return q[Ie].apply(this,arguments)}}),Ve}})}};function Qa(v,_,L){if(L.numFailures===0)return _;if(_.type==="deleteRange")return null;var j=_.keys?_.keys.length:"values"in _&&_.values?_.values.length:1;return L.numFailures===j?null:(_=n({},_),l(_.keys)&&(_.keys=_.keys.filter(function(q,Z){return!(Z in L.failures)})),"values"in _&&l(_.values)&&(_.values=_.values.filter(function(q,Z){return!(Z in L.failures)})),_)}function Za(v,_){return L=v,((j=_).lower===void 0||(j.lowerOpen?0<pr(L,j.lower):0<=pr(L,j.lower)))&&(v=v,(_=_).upper===void 0||(_.upperOpen?pr(v,_.upper)<0:pr(v,_.upper)<=0));var L,j}function $s(v,_,Ke,j,q,Z){if(!Ke||Ke.length===0)return v;var ve=_.query.index,Ce=ve.multiEntry,De=_.query.range,ze=j.schema.primaryKey.extractKey,Ve=ve.extractKey,Ne=(ve.lowLevelIndex||ve).extractKey,Ke=Ke.reduce(function(Ie,qe){var Ge=Ie,$e=[];if(qe.type==="add"||qe.type==="put")for(var at=new On,st=qe.values.length-1;0<=st;--st){var ot,ht=qe.values[st],Tt=ze(ht);at.hasKey(Tt)||(ot=Ve(ht),(Ce&&l(ot)?ot.some(function(Ft){return Za(Ft,De)}):Za(ot,De))&&(at.addKey(Tt),$e.push(ht)))}switch(qe.type){case"add":var Mt=new On().addKeys(_.values?Ie.map(function(Wt){return ze(Wt)}):Ie),Ge=Ie.concat(_.values?$e.filter(function(Wt){return Wt=ze(Wt),!Mt.hasKey(Wt)&&(Mt.addKey(Wt),!0)}):$e.map(function(Wt){return ze(Wt)}).filter(function(Wt){return!Mt.hasKey(Wt)&&(Mt.addKey(Wt),!0)}));break;case"put":var Ct=new On().addKeys(qe.values.map(function(Wt){return ze(Wt)}));Ge=Ie.filter(function(Wt){return!Ct.hasKey(_.values?ze(Wt):Wt)}).concat(_.values?$e:$e.map(function(Wt){return ze(Wt)}));break;case"delete":var Rt=new On().addKeys(qe.keys);Ge=Ie.filter(function(Wt){return!Rt.hasKey(_.values?ze(Wt):Wt)});break;case"deleteRange":var Vt=qe.range;Ge=Ie.filter(function(Wt){return!Za(ze(Wt),Vt)})}return Ge},v);return Ke===v?v:(Ke.sort(function(Ie,qe){return pr(Ne(Ie),Ne(qe))||pr(ze(Ie),ze(qe))}),_.limit&&_.limit<1/0&&(Ke.length>_.limit?Ke.length=_.limit:v.length===_.limit&&Ke.length<_.limit&&(q.dirty=!0)),Z?Object.freeze(Ke):Ke)}function vl(v,_){return pr(v.lower,_.lower)===0&&pr(v.upper,_.upper)===0&&!!v.lowerOpen==!!_.lowerOpen&&!!v.upperOpen==!!_.upperOpen}function xl(v,_){return function(L,j,q,Z){if(L===void 0)return j!==void 0?-1:0;if(j===void 0)return 1;if((j=pr(L,j))===0){if(q&&Z)return 0;if(q)return 1;if(Z)return-1}return j}(v.lower,_.lower,v.lowerOpen,_.lowerOpen)<=0&&0<=function(L,j,q,Z){if(L===void 0)return j!==void 0?1:0;if(j===void 0)return-1;if((j=pr(L,j))===0){if(q&&Z)return 0;if(q)return-1;if(Z)return 1}return j}(v.upper,_.upper,v.upperOpen,_.upperOpen)}function Do(v,_,L,j){v.subscribers.add(L),j.addEventListener("abort",function(){var q,Z;v.subscribers.delete(L),v.subscribers.size===0&&(q=v,Z=_,setTimeout(function(){q.subscribers.size===0&&me(Z,q)},3e3))})}var yl={stack:"dbcore",level:0,name:"Cache",create:function(v){var _=v.schema.name;return n(n({},v),{transaction:function(L,j,q){var Z,ve,Ce=v.transaction(L,j,q);return j==="readwrite"&&(ve=(Z=new AbortController).signal,q=function(De){return function(){if(Z.abort(),j==="readwrite"){for(var ze=new Set,Ve=0,Ne=L;Ve<Ne.length;Ve++){var Ke=Ne[Ve],Ie=S["idb://".concat(_,"/").concat(Ke)];if(Ie){var qe=v.table(Ke),Ge=Ie.optimisticOps.filter(function(Wt){return Wt.trans===Ce});if(Ce._explicit&&De&&Ce.mutatedParts)for(var $e=0,at=Object.values(Ie.queries.query);$e<at.length;$e++)for(var st=0,ot=(Mt=at[$e]).slice();st<ot.length;st++)Ro((Ct=ot[st]).obsSet,Ce.mutatedParts)&&(me(Mt,Ct),Ct.subscribers.forEach(function(Wt){return ze.add(Wt)}));else if(0<Ge.length){Ie.optimisticOps=Ie.optimisticOps.filter(function(Wt){return Wt.trans!==Ce});for(var ht=0,Tt=Object.values(Ie.queries.query);ht<Tt.length;ht++)for(var Mt,Ct,Rt,Vt=0,Ft=(Mt=Tt[ht]).slice();Vt<Ft.length;Vt++)(Ct=Ft[Vt]).res!=null&&Ce.mutatedParts&&(De&&!Ct.dirty?(Rt=Object.isFrozen(Ct.res),Rt=$s(Ct.res,Ct.req,Ge,qe,Ct,Rt),Ct.dirty?(me(Mt,Ct),Ct.subscribers.forEach(function(Wt){return ze.add(Wt)})):Rt!==Ct.res&&(Ct.res=Rt,Ct.promise=At.resolve({result:Rt}))):(Ct.dirty&&me(Mt,Ct),Ct.subscribers.forEach(function(Wt){return ze.add(Wt)})))}}}ze.forEach(function(Wt){return Wt()})}}},Ce.addEventListener("abort",q(!1),{signal:ve}),Ce.addEventListener("error",q(!1),{signal:ve}),Ce.addEventListener("complete",q(!0),{signal:ve})),Ce},table:function(L){var j=v.table(L),q=j.schema.primaryKey;return n(n({},j),{mutate:function(Z){var ve=Ut.trans;if(q.outbound||ve.db._options.cache==="disabled"||ve.explicit||ve.idbtrans.mode!=="readwrite")return j.mutate(Z);var Ce=S["idb://".concat(_,"/").concat(L)];return Ce?(ve=j.mutate(Z),Z.type!=="add"&&Z.type!=="put"||!(50<=Z.values.length||Yr(q,Z).some(function(De){return De==null}))?(Ce.optimisticOps.push(Z),Z.mutatedParts&&Oe(Z.mutatedParts),ve.then(function(De){0<De.numFailures&&(me(Ce.optimisticOps,Z),(De=Qa(0,Z,De))&&Ce.optimisticOps.push(De),Z.mutatedParts&&Oe(Z.mutatedParts))}),ve.catch(function(){me(Ce.optimisticOps,Z),Z.mutatedParts&&Oe(Z.mutatedParts)})):ve.then(function(De){var ze=Qa(0,n(n({},Z),{values:Z.values.map(function(Ve,Ne){var Ke;return De.failures[Ne]?Ve:(Ve=(Ke=q.keyPath)!==null&&Ke!==void 0&&Ke.includes(".")?le(Ve):n({},Ve),B(Ve,q.keyPath,De.results[Ne]),Ve)})}),De);Ce.optimisticOps.push(ze),queueMicrotask(function(){return Z.mutatedParts&&Oe(Z.mutatedParts)})}),ve):j.mutate(Z)},query:function(Z){if(!va(Ut,j)||!ia("query",Z))return j.query(Z);var ve=((ze=Ut.trans)===null||ze===void 0?void 0:ze.db._options.cache)==="immutable",Ne=Ut,Ce=Ne.requery,De=Ne.signal,ze=function(qe,Ge,$e,at){var st=S["idb://".concat(qe,"/").concat(Ge)];if(!st)return[];if(!(Ge=st.queries[$e]))return[null,!1,st,null];var ot=Ge[(at.query?at.query.index.name:null)||""];if(!ot)return[null,!1,st,null];switch($e){case"query":var ht=ot.find(function(Tt){return Tt.req.limit===at.limit&&Tt.req.values===at.values&&vl(Tt.req.query.range,at.query.range)});return ht?[ht,!0,st,ot]:[ot.find(function(Tt){return("limit"in Tt.req?Tt.req.limit:1/0)>=at.limit&&(!at.values||Tt.req.values)&&xl(Tt.req.query.range,at.query.range)}),!1,st,ot];case"count":return ht=ot.find(function(Tt){return vl(Tt.req.query.range,at.query.range)}),[ht,!!ht,st,ot]}}(_,L,"query",Z),Ve=ze[0],Ne=ze[1],Ke=ze[2],Ie=ze[3];return Ve&&Ne?Ve.obsSet=Z.obsSet:(Ne=j.query(Z).then(function(qe){var Ge=qe.result;if(Ve&&(Ve.res=Ge),ve){for(var $e=0,at=Ge.length;$e<at;++$e)Object.freeze(Ge[$e]);Object.freeze(Ge)}else qe.result=le(Ge);return qe}).catch(function(qe){return Ie&&Ve&&me(Ie,Ve),Promise.reject(qe)}),Ve={obsSet:Z.obsSet,promise:Ne,subscribers:new Set,type:"query",req:Z,dirty:!1},Ie?Ie.push(Ve):(Ie=[Ve],(Ke=Ke||(S["idb://".concat(_,"/").concat(L)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[Z.query.index.name||""]=Ie)),Do(Ve,Ie,Ce,De),Ve.promise.then(function(qe){return{result:$s(qe.result,Z,Ke?.optimisticOps,j,Ve,ve)}})}})}})}};function Hs(v,_){return new Proxy(v,{get:function(L,j,q){return j==="db"?_:Reflect.get(L,j,q)}})}var Ma=(Br.prototype.version=function(v){if(isNaN(v)||v<.1)throw new de.Type("Given version is not a positive number");if(v=Math.round(10*v)/10,this.idbdb||this._state.isBeingOpened)throw new de.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,v);var _=this._versions,L=_.filter(function(j){return j._cfg.version===v})[0];return L||(L=new this.Version(v),_.push(L),_.sort(ql),L.stores({}),this._state.autoSchema=!1,L)},Br.prototype._whenReady=function(v){var _=this;return this.idbdb&&(this._state.openComplete||Ut.letThrough||this._vip)?v():new At(function(L,j){if(_._state.openComplete)return j(new de.DatabaseClosed(_._state.dbOpenError));if(!_._state.isBeingOpened){if(!_._state.autoOpen)return void j(new de.DatabaseClosed);_.open().catch(se)}_._state.dbReadyPromise.then(L,j)}).then(v)},Br.prototype.use=function(v){var _=v.stack,L=v.create,j=v.level,q=v.name;return q&&this.unuse({stack:_,name:q}),v=this._middlewares[_]||(this._middlewares[_]=[]),v.push({stack:_,create:L,level:j??10,name:q}),v.sort(function(Z,ve){return Z.level-ve.level}),this},Br.prototype.unuse=function(v){var _=v.stack,L=v.name,j=v.create;return _&&this._middlewares[_]&&(this._middlewares[_]=this._middlewares[_].filter(function(q){return j?q.create!==j:!!L&&q.name!==L})),this},Br.prototype.open=function(){var v=this;return nt(Ur,function(){return Nt(v)})},Br.prototype._close=function(){var v=this._state,_=Kr.indexOf(this);if(0<=_&&Kr.splice(_,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}v.isBeingOpened||(v.dbReadyPromise=new At(function(L){v.dbReadyResolve=L}),v.openCanceller=new At(function(L,j){v.cancelOpen=j}))},Br.prototype.close=function(L){var _=(L===void 0?{disableAutoOpen:!0}:L).disableAutoOpen,L=this._state;_?(L.isBeingOpened&&L.cancelOpen(new de.DatabaseClosed),this._close(),L.autoOpen=!1,L.dbOpenError=new de.DatabaseClosed):(this._close(),L.autoOpen=this._options.autoOpen||L.isBeingOpened,L.openComplete=!1,L.dbOpenError=null)},Br.prototype.delete=function(v){var _=this;v===void 0&&(v={disableAutoOpen:!0});var L=0<arguments.length&&typeof arguments[0]!="object",j=this._state;return new At(function(q,Z){function ve(){_.close(v);var Ce=_._deps.indexedDB.deleteDatabase(_.name);Ce.onsuccess=wr(function(){var De,ze,Ve;De=_._deps,ze=_.name,Ve=De.indexedDB,De=De.IDBKeyRange,zs(Ve)||ze===en||Io(Ve,De).delete(ze).catch(se),q()}),Ce.onerror=fr(Z),Ce.onblocked=_._fireOnBlocked}if(L)throw new de.InvalidArgument("Invalid closeOptions argument to db.delete()");j.isBeingOpened?j.dbReadyPromise.then(ve):ve()})},Br.prototype.backendDB=function(){return this.idbdb},Br.prototype.isOpen=function(){return this.idbdb!==null},Br.prototype.hasBeenClosed=function(){var v=this._state.dbOpenError;return v&&v.name==="DatabaseClosed"},Br.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Br.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Br.prototype,"tables",{get:function(){var v=this;return o(this._allTables).map(function(_){return v._allTables[_]})},enumerable:!1,configurable:!0}),Br.prototype.transaction=function(){var v=(function(_,L,j){var q=arguments.length;if(q<2)throw new de.InvalidArgument("Too few arguments");for(var Z=new Array(q-1);--q;)Z[q-1]=arguments[q];return j=Z.pop(),[_,ye(Z),j]}).apply(this,arguments);return this._transaction.apply(this,v)},Br.prototype._transaction=function(v,_,L){var j=this,q=Ut.trans;q&&q.db===this&&v.indexOf("!")===-1||(q=null);var Z,ve,Ce=v.indexOf("?")!==-1;v=v.replace("!","").replace("?","");try{if(ve=_.map(function(ze){if(ze=ze instanceof j.Table?ze.name:ze,typeof ze!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return ze}),v=="r"||v===En)Z=En;else{if(v!="rw"&&v!=ci)throw new de.InvalidArgument("Invalid transaction mode: "+v);Z=ci}if(q){if(q.mode===En&&Z===ci){if(!Ce)throw new de.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");q=null}q&&ve.forEach(function(ze){if(q&&q.storeNames.indexOf(ze)===-1){if(!Ce)throw new de.SubTransaction("Table "+ze+" not included in parent transaction.");q=null}}),Ce&&q&&!q.active&&(q=null)}}catch(ze){return q?q._promise(null,function(Ve,Ne){Ne(ze)}):It(ze)}var De=(function ze(Ve,Ne,Ke,Ie,qe){return At.resolve().then(function(){var Ge=Ut.transless||Ut,$e=Ve._createTransaction(Ne,Ke,Ve._dbSchema,Ie);if($e.explicit=!0,Ge={trans:$e,transless:Ge},Ie)$e.idbtrans=Ie.idbtrans;else try{$e.create(),$e.idbtrans._explicit=!0,Ve._state.PR1398_maxLoop=3}catch(ot){return ot.name===xe.InvalidState&&Ve.isOpen()&&0<--Ve._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),Ve.close({disableAutoOpen:!1}),Ve.open().then(function(){return ze(Ve,Ne,Ke,null,qe)})):It(ot)}var at,st=pe(qe);return st&&_e(),Ge=At.follow(function(){var ot;(at=qe.call($e,$e))&&(st?(ot=ke.bind(null,null),at.then(ot,ot)):typeof at.next=="function"&&typeof at.throw=="function"&&(at=Xt(at)))},Ge),(at&&typeof at.then=="function"?At.resolve(at).then(function(ot){return $e.active?ot:It(new de.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):Ge.then(function(){return at})).then(function(ot){return Ie&&$e._resolve(),$e._completion.then(function(){return ot})}).catch(function(ot){return $e._reject(ot),It(ot)})})}).bind(null,this,Z,ve,q,L);return q?q._promise(Z,De,"lock"):Ut.trans?nt(Ut.transless,function(){return j._whenReady(De)}):this._whenReady(De)},Br.prototype.table=function(v){if(!g(this._allTables,v))throw new de.InvalidTable("Table ".concat(v," does not exist"));return this._allTables[v]},Br);function Br(v,_){var L=this;this._middlewares={},this.verno=0;var j=Br.dependencies;this._options=_=n({addons:Br.addons,autoOpen:!0,indexedDB:j.indexedDB,IDBKeyRange:j.IDBKeyRange,cache:"cloned"},_),this._deps={indexedDB:_.indexedDB,IDBKeyRange:_.IDBKeyRange},j=_.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var q,Z,ve,Ce,De,ze={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:se,dbReadyPromise:null,cancelOpen:se,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:_.autoOpen};ze.dbReadyPromise=new At(function(Ne){ze.dbReadyResolve=Ne}),ze.openCanceller=new At(function(Ne,Ke){ze.cancelOpen=Ke}),this._state=ze,this.name=v,this.on=_i(this,"populate","blocked","versionchange","close",{ready:[_t,se]}),this.on.ready.subscribe=F(this.on.ready.subscribe,function(Ne){return function(Ke,Ie){Br.vip(function(){var qe,Ge=L._state;Ge.openComplete?(Ge.dbOpenError||At.resolve().then(Ke),Ie&&Ne(Ke)):Ge.onReadyBeingFired?(Ge.onReadyBeingFired.push(Ke),Ie&&Ne(Ke)):(Ne(Ke),qe=L,Ie||Ne(function $e(){qe.on.ready.unsubscribe(Ke),qe.on.ready.unsubscribe($e)}))})}}),this.Collection=(q=this,Qi(sn.prototype,function(at,$e){this.db=q;var Ie=Ga,qe=null;if($e)try{Ie=$e()}catch(st){qe=st}var Ge=at._ctx,$e=Ge.table,at=$e.hook.reading.fire;this._ctx={table:$e,index:Ge.index,isPrimKey:!Ge.index||$e.schema.primKey.keyPath&&Ge.index===$e.schema.primKey.name,range:Ie,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:qe,or:Ge.or,valueMapper:at!==bt?at:null}})),this.Table=(Z=this,Qi(Bl.prototype,function(Ne,Ke,Ie){this.db=Z,this._tx=Ie,this.name=Ne,this.schema=Ke,this.hook=Z._allTables[Ne]?Z._allTables[Ne].hook:_i(null,{creating:[we,se],reading:[Dt,bt],updating:[qt,se],deleting:[mt,se]})})),this.Transaction=(ve=this,Qi(oo.prototype,function(Ne,Ke,Ie,qe,Ge){var $e=this;this.db=ve,this.mode=Ne,this.storeNames=Ke,this.schema=Ie,this.chromeTransactionDurability=qe,this.idbtrans=null,this.on=_i(this,"complete","error","abort"),this.parent=Ge||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new At(function(at,st){$e._resolve=at,$e._reject=st}),this._completion.then(function(){$e.active=!1,$e.on.complete.fire()},function(at){var st=$e.active;return $e.active=!1,$e.on.error.fire(at),$e.parent?$e.parent._reject(at):st&&$e.idbtrans&&$e.idbtrans.abort(),It(at)})})),this.Version=(Ce=this,Qi(uo.prototype,function(Ne){this.db=Ce,this._cfg={version:Ne,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(De=this,Qi(es.prototype,function(Ne,Ke,Ie){if(this.db=De,this._ctx={table:Ne,index:Ke===":id"?null:Ke,or:Ie},this._cmp=this._ascending=pr,this._descending=function(qe,Ge){return pr(Ge,qe)},this._max=function(qe,Ge){return 0<pr(qe,Ge)?qe:Ge},this._min=function(qe,Ge){return pr(qe,Ge)<0?qe:Ge},this._IDBKeyRange=De._deps.IDBKeyRange,!this._IDBKeyRange)throw new de.MissingAPI})),this.on("versionchange",function(Ne){0<Ne.newVersion?console.warn("Another connection wants to upgrade database '".concat(L.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(L.name,"'. Closing db now to resume the delete request.")),L.close({disableAutoOpen:!1})}),this.on("blocked",function(Ne){!Ne.newVersion||Ne.newVersion<Ne.oldVersion?console.warn("Dexie.delete('".concat(L.name,"') was blocked")):console.warn("Upgrade '".concat(L.name,"' blocked by other connection holding version ").concat(Ne.oldVersion/10))}),this._maxKey=Fo(_.IDBKeyRange),this._createTransaction=function(Ne,Ke,Ie,qe){return new L.Transaction(Ne,Ke,Ie,L._options.chromeTransactionDurability,qe)},this._fireOnBlocked=function(Ne){L.on("blocked").fire(Ne),Kr.filter(function(Ke){return Ke.name===L.name&&Ke!==L&&!Ke._state.vcFired}).map(function(Ke){return Ke.on("versionchange").fire(Ne)})},this.use(ea),this.use(yl),this.use(ss),this.use(jr),this.use(In);var Ve=new Proxy(this,{get:function(Ne,Ke,Ie){if(Ke==="_vip")return!0;if(Ke==="table")return function(Ge){return Hs(L.table(Ge),Ve)};var qe=Reflect.get(Ne,Ke,Ie);return qe instanceof Bl?Hs(qe,Ve):Ke==="tables"?qe.map(function(Ge){return Hs(Ge,Ve)}):Ke==="_createTransaction"?function(){return Hs(qe.apply(this,arguments),Ve)}:qe}});this.vip=Ve,j.forEach(function(Ne){return Ne(L)})}var Vs,xa=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",wl=(po.prototype.subscribe=function(v,_,L){return this._subscribe(v&&typeof v!="function"?v:{next:v,error:_,complete:L})},po.prototype[xa]=function(){return this},po);function po(v){this._subscribe=v}try{Vs={indexedDB:i.indexedDB||i.mozIndexedDB||i.webkitIndexedDB||i.msIndexedDB,IDBKeyRange:i.IDBKeyRange||i.webkitIDBKeyRange}}catch{Vs={indexedDB:null,IDBKeyRange:null}}function La(v){var _,L=!1,j=new wl(function(q){var Z=pe(v),ve,Ce=!1,De={},ze={},Ve={get closed(){return Ce},unsubscribe:function(){Ce||(Ce=!0,ve&&ve.abort(),Ne&&Ei.storagemutated.unsubscribe(Ie))}};q.start&&q.start(Ve);var Ne=!1,Ke=function(){return zt(qe)},Ie=function(Ge){is(De,Ge),Ro(ze,De)&&Ke()},qe=function(){var Ge,$e,at;!Ce&&Vs.indexedDB&&(De={},Ge={},ve&&ve.abort(),ve=new AbortController,at=function(st){var ot=ln();try{Z&&_e();var ht=he(v,st);return ht=Z?ht.finally(ke):ht}finally{ot&&Sn()}}($e={subscr:Ge,signal:ve.signal,requery:Ke,querier:v,trans:null}),Promise.resolve(at).then(function(st){L=!0,_=st,Ce||$e.signal.aborted||(De={},function(ot){for(var ht in ot)if(g(ot,ht))return;return 1}(ze=Ge)||Ne||(Ei(Xa,Ie),Ne=!0),zt(function(){return!Ce&&q.next&&q.next(st)}))},function(st){L=!1,["DatabaseClosedError","AbortError"].includes(st?.name)||Ce||zt(function(){Ce||q.error&&q.error(st)})}))};return setTimeout(Ke,0),Ve});return j.hasValue=function(){return L},j.getValue=function(){return _},j}var fi=Ma;function os(v){var _=$n;try{$n=!0,Ei.storagemutated.fire(v),Ye(v,!0)}finally{$n=_}}x(fi,n(n({},ct),{delete:function(v){return new fi(v,{addons:[]}).delete()},exists:function(v){return new fi(v,{addons:[]}).open().then(function(_){return _.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(v){try{return _=fi.dependencies,L=_.indexedDB,_=_.IDBKeyRange,(zs(L)?Promise.resolve(L.databases()).then(function(j){return j.map(function(q){return q.name}).filter(function(q){return q!==en})}):Io(L,_).toCollection().primaryKeys()).then(v)}catch{return It(new de.MissingAPI)}var _,L},defineClass:function(){return function(v){u(this,v)}},ignoreTransaction:function(v){return Ut.trans?nt(Ut.transless,v):v()},vip:fo,async:function(v){return function(){try{var _=Xt(v.apply(this,arguments));return _&&typeof _.then=="function"?_:At.resolve(_)}catch(L){return It(L)}}},spawn:function(v,_,L){try{var j=Xt(v.apply(L,_||[]));return j&&typeof j.then=="function"?j:At.resolve(j)}catch(q){return It(q)}},currentTransaction:{get:function(){return Ut.trans||null}},waitFor:function(v,_){return _=At.resolve(typeof v=="function"?fi.ignoreTransaction(v):v).timeout(_||6e4),Ut.trans?Ut.trans.waitFor(_):_},Promise:At,debug:{get:function(){return Et},set:function(v){Bt(v)}},derive:b,extend:u,props:x,override:F,Events:_i,on:Ei,liveQuery:La,extendObservabilitySet:is,getByKeyPath:re,setByKeyPath:B,delByKeyPath:function(v,_){typeof _=="string"?B(v,_,void 0):"length"in _&&[].map.call(_,function(L){B(v,L,void 0)})},shallowClone:V,deepClone:le,getObjectDiff:Ar,cmp:pr,asap:te,minKey:-1/0,addons:[],connections:Kr,errnames:xe,dependencies:Vs,cache:S,semVer:"4.0.11",version:"4.0.11".split(".").map(function(v){return parseInt(v)}).reduce(function(v,_,L){return v+_/Math.pow(10,2*L)})})),fi.maxKey=Fo(fi.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Ei(Xa,function(v){$n||(v=new CustomEvent(Si,{detail:v}),$n=!0,dispatchEvent(v),$n=!1)}),addEventListener(Si,function(v){v=v.detail,$n||os(v)}));var Ws,$n=!1,jo=function(){};return typeof BroadcastChannel<"u"&&((jo=function(){(Ws=new BroadcastChannel(Si)).onmessage=function(v){return v.data&&os(v.data)}})(),typeof Ws.unref=="function"&&Ws.unref(),Ei(Xa,function(v){$n||Ws.postMessage(v)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(v){if(!Ma.disableBfCache&&v.persisted){Et&&console.debug("Dexie: handling persisted pagehide"),Ws?.close();for(var _=0,L=Kr;_<L.length;_++)L[_].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(v){!Ma.disableBfCache&&v.persisted&&(Et&&console.debug("Dexie: handling persisted pageshow"),jo(),os({all:new On(-1/0,[[]])}))})),At.rejectionMapper=function(v,_){return!v||v instanceof M||v instanceof TypeError||v instanceof SyntaxError||!v.name||!Me[v.name]?v:(_=new Me[v.name](_||v.message,v),"stack"in v&&k(_,"stack",{get:function(){return this.inner.stack}}),_)},Bt(Et),n(Ma,Object.freeze({__proto__:null,Dexie:Ma,liveQuery:La,Entity:Ji,cmp:pr,PropModification:Co,replacePrefix:function(v,_){return new Co({replacePrefix:[v,_]})},add:function(v){return new Co({add:v})},remove:function(v){return new Co({remove:v})},default:Ma,RangeSet:On,mergeRanges:ho,rangesOverlap:gc}),{default:Ma}),Ma})}(Td)),Td.exports}var KA=WA();const Ag=ky(KA),ox=Symbol.for("Dexie"),zd=globalThis[ox]||(globalThis[ox]=Ag);if(Ag.semVer!==zd.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Ag.semVer} and ${zd.semVer}`);const{liveQuery:YI,mergeRanges:XI,rangesOverlap:JI,RangeSet:QI,cmp:ZI,Entity:eR,PropModification:tR,replacePrefix:rR,add:nR,remove:aR}=zd,Mw=[{id:"a1111111-1111-1111-1111-111111111111",name:"Ibrahim Fatmi",email:"brahim@fatmi.com",role:"agent",department:"Management"}],Bw={"brahim@fatmi.com":"Ibrahim1972"},GA=Object.freeze(Object.defineProperty({__proto__:null,defaultAgents:Mw,defaultPasswords:Bw},Symbol.toStringTag,{value:"Module"}));class Uw extends zd{agents;invoices;invoiceItems;settings;constructor(){super("invoice_db"),this.version(5).stores({agents:"id, name, email, role",invoices:"id, agentId, status, createdAt, clientName, *clientEmail, *notes, passportNumber, flightNumber, visaStatus, departureDate, dateOfBirth",invoiceItems:"id, invoiceId",settings:"id, theme, language"}),this.agents.hook("creating",function(t,r){if(!r.id||!r.email||!r.role)throw new Error("Invalid agent data")}),this.invoices.hook("creating",function(t,r){if(!r.agentId||!r.createdAt)throw new Error("Invalid invoice data")})}}const xi=new Uw;async function YA(){try{console.log("Deleting database..."),await xi.delete(),console.log("Database deleted"),localStorage.clear(),console.log("Local storage cleared"),console.log("Reloading page..."),window.location.reload()}catch(e){console.error("Error resetting database:",e)}}async function XA(){try{if(await xi.agents.count()>0){console.log("Database already initialized");return}console.log("Clearing existing data..."),await Promise.all([xi.agents.clear(),xi.invoices.clear(),xi.invoiceItems.clear(),xi.settings.clear()]),console.log("Initializing demo data..."),await Promise.all(Mw.map(n=>xi.agents.add(n)));const t=["draft","sent","paid","overdue"],r=await Promise.all(t.map(n=>xi.invoices.add({id:crypto.randomUUID(),agentId:"a1111111-1111-1111-1111-111111111111",total:Math.floor(Math.random()*5e3)+500,status:n,createdAt:new Date().toISOString(),clientName:`Demo Client (${n})`,clientEmail:"client@example.com",notes:`Demo invoice in ${n} status`})));await Promise.all(r.map(n=>xi.invoiceItems.add({id:crypto.randomUUID(),invoiceId:n,description:"Demo Item",quantity:1,unitPrice:1e3}))),await xi.settings.add({id:"1",theme:"light",language:"fr"}),console.log("Demo data initialized successfully")}catch(e){throw console.error("Failed to initialize demo data:",e),e}}xi.on("ready",async()=>{try{await XA(),console.log("Database ready and initialized")}catch(e){console.error("Failed to initialize database:",e)}});const JA=Object.freeze(Object.defineProperty({__proto__:null,InvoiceDatabase:Uw,db:xi,resetAndInitializeDatabase:YA},Symbol.toStringTag,{value:"Module"})),zw=ce.createContext(void 0),QA=({children:e})=>{const[t,r]=ce.useState(null),[n,a]=ce.useState(!0),[i,o]=ce.useState(null),[l,u]=ce.useState(!1);ce.useEffect(()=>{(async()=>{try{await new Promise(E=>{const N=async()=>{await xi.agents.count()>0?E():setTimeout(N,100)};N()});const b=localStorage.getItem("agent");if(b){const E=JSON.parse(b),N=await xi.agents.where("id").equals(E.id||"").first();N?r(N):localStorage.removeItem("agent")}}catch(b){console.error("Error initializing:",b),o("Failed to initialize application")}finally{u(!0),a(!1)}})()},[]);const m={isAuthenticated:!!t,agentProfile:t,loading:n,error:i,signIn:async(k,b)=>{if(!l)return{error:"Application is still initializing"};try{a(!0),o(null);let E=await xi.agents.where("email").equals(k).first();if(!E)return{error:"Agent not found in database"};const N=Bw[k];return b!==N?{error:"Invalid password"}:!E&&(console.log("Agent not found, retrying after delay..."),await new Promise(O=>setTimeout(O,1e3)),E=await xi.agents.where("email").equals(k).first(),!E)?{error:"Agent not found in database. Please try again."}:(console.log("Found agent:",E),r(E),localStorage.setItem("agent",JSON.stringify(E)),{agent:E})}catch(E){return console.error("Sign in error:",E),{error:"Failed to sign in"}}finally{a(!1)}},signOut:async()=>{try{a(!0),localStorage.removeItem("agent"),r(null);const{resetAndInitializeDatabase:k}=await M0(async()=>{const{resetAndInitializeDatabase:b}=await Promise.resolve().then(()=>JA);return{resetAndInitializeDatabase:b}},void 0);await k()}catch(k){console.error("Sign out error:",k),o("Failed to sign out")}finally{a(!1)}},retryAuth:async()=>{o(null);const k=localStorage.getItem("agent");if(k)try{const b=JSON.parse(k),E=await xi.agents.where("id").equals(b.id||"").first();E?r(E):(localStorage.removeItem("agent"),o("Session expired. Please sign in again."))}catch{o("Failed to restore session")}a(!1)},forceInitComplete:()=>{a(!1),o(null)}};return A.jsx(zw.Provider,{value:m,children:e})},cm=()=>{const e=ce.useContext(zw);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},ZA=()=>{const[e,t]=ce.useState("dashboard"),[r,n]=ce.useState(null),{agentProfile:a,signOut:i}=cm(),o=a?.id,{invoices:l=[],error:u,createInvoice:f,updateInvoice:h,deleteInvoice:g}=zA(o),{stats:x={totalInvoices:0,totalRevenue:0,paidInvoices:0,unpaidInvoices:0,pendingInvoices:0,recentInvoices:[]}}=$A(o),{invoices:m=[]}=HA(o),{agents:k=[],isLoading:b}=qA();if(!a)return A.jsx(td,{title:"Agent Portal",children:A.jsx("div",{className:"flex items-center justify-center h-64",children:A.jsxs("div",{className:"text-center",children:[A.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),A.jsx("p",{className:"text-gray-600",children:"Loading your profile..."})]})})});const E=k.find(V=>V.id===o);if(b&&!E)return A.jsx(td,{title:"Agent Portal",children:A.jsx("div",{className:"flex items-center justify-center h-64",children:A.jsxs("div",{className:"text-center",children:[A.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),A.jsx("p",{className:"text-gray-600",children:"Loading your profile..."})]})})});if(u)return A.jsx(td,{title:"Agent Portal",children:A.jsx("div",{className:"flex items-center justify-center h-64",children:A.jsxs("div",{className:"text-center max-w-md",children:[A.jsx(op,{className:"w-8 h-8 text-red-600 mx-auto mb-4"}),A.jsx("p",{className:"text-red-600 mb-4",children:"Error loading invoices"}),A.jsx("p",{className:"text-sm text-gray-600 mb-4",children:u}),A.jsxs("div",{className:"space-y-2",children:[A.jsx("button",{onClick:()=>window.location.reload(),className:"w-full px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Reload Page"}),A.jsx("p",{className:"text-xs text-gray-500",children:"If the problem persists, check your internet connection"})]})]})})});const N=async V=>{if(!o){alert("You must be logged in to create invoices");return}if(!E){alert("Agent profile not found. Please contact support.");return}try{console.log("Creating invoice for agent:",o,E);const Y={...V,agentId:o,clientName:V.client?.name||V.clientName||"Unknown Client",clientEmail:V.client?.email||V.clientEmail||"",createdAt:new Date().toISOString()};await f(Y,V.items||[]),t("dashboard")}catch(Y){console.error("Error creating invoice:",Y);const ye=Y instanceof Error?Y.message:"Failed to create invoice. Please try again.";alert(ye)}},O=async V=>{if(!r?.id){alert("No invoice selected for update");return}try{console.log("Updating invoice:",r.id,V);const Y={...V,clientName:V.client?.name||V.clientName||"Unknown Client",clientEmail:V.client?.email||V.clientEmail||""};await h(r.id,Y,V.items),t("dashboard"),n(null)}catch(Y){console.error("Error updating invoice:",Y);const ye=Y instanceof Error?Y.message:"Failed to update invoice. Please try again.";alert(ye)}},F=V=>{n(V),t("view")},K=V=>{n(V),t("edit")},te=async V=>{if(window.confirm("Are you sure you want to delete this invoice?"))try{await g(V)}catch(Y){console.error("Error deleting invoice:",Y),alert("Failed to delete invoice. Please try again.")}},re=async(V,Y)=>{try{await h(V,{status:Y}),r&&r.id===V&&n({...r,status:Y})}catch(ye){console.error("Error updating invoice status:",ye),alert("Failed to update invoice status. Please try again.")}},B=()=>{switch(e){case"create":return A.jsx(p2,{onSave:N,onCancel:()=>t("dashboard"),currentAgent:E},"create-invoice");case"edit":return r?A.jsx(p2,{editingInvoice:r,onSave:O,onCancel:()=>t("dashboard"),currentAgent:E},`edit-invoice-${r.id}`):null;case"view":return r?A.jsx(sS,{invoice:r,onEdit:()=>t("edit"),onClose:()=>t("dashboard"),onStatusUpdate:re}):null;case"all-invoices":return A.jsx(lS,{invoices:l,onView:F,onEdit:K,onDelete:te,onBack:()=>t("dashboard")});default:return A.jsxs("div",{className:"space-y-6",children:[A.jsxs("div",{className:"flex justify-between items-center",children:[A.jsxs("div",{children:[A.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:["Welcome, ",E?.name||"Agent"]}),A.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Manage your invoices and track payments"})]}),A.jsxs("div",{className:"flex space-x-4",children:[A.jsxs("button",{onClick:()=>t("create"),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2",children:[A.jsx(Id,{className:"h-4 w-4"}),A.jsx("span",{children:"Create Invoice"})]}),A.jsxs("button",{onClick:i,className:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2",children:[A.jsx(Wy,{className:"h-4 w-4"}),A.jsx("span",{children:"Sign Out"})]})]})]}),A.jsx(oS,{stats:x}),m.length>0&&A.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6",children:[A.jsxs("div",{className:"flex items-center justify-between mb-4",children:[A.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white flex items-center",children:[A.jsx(Ef,{className:"h-5 w-5 mr-2"}),"Today's Invoices"]}),A.jsxs("span",{className:"text-sm text-gray-500",children:[m.length," invoices"]})]}),A.jsx(gg,{invoices:m,onView:F,onEdit:K,onDelete:te,title:"Today's Invoices"})]}),A.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6",children:[A.jsxs("div",{className:"flex items-center justify-between mb-4",children:[A.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white flex items-center",children:[A.jsx(d3,{className:"h-5 w-5 mr-2"}),"Recent Invoices"]}),A.jsx("button",{onClick:()=>t("all-invoices"),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"View All"})]}),A.jsx(gg,{invoices:l.slice(0,5),onView:F,onEdit:K,onDelete:te,title:"Recent Invoices"})]})]})}};return A.jsx(td,{title:"Agent Portal",children:B()})},e6=({onBack:e})=>{const[t,r]=ce.useState(""),[n,a]=ce.useState(""),[i,o]=ce.useState(!1),[l,u]=ce.useState(!1),[f,h]=ce.useState(""),{signIn:g}=cm(),x=async m=>{if(m.preventDefault(),!(!t||!n)){u(!0),h("");try{const k=await g(t,n);k.error&&h(k.error)}catch{h("An unexpected error occurred")}finally{u(!1)}}};return A.jsx("div",{className:"min-h-screen bg-gradient-to-br from-teal-50 via-white to-cyan-50 flex items-center justify-center p-4",children:A.jsxs("div",{className:"max-w-md w-full",children:[e&&A.jsx("div",{className:"mb-6",children:A.jsxs("button",{onClick:e,className:"flex items-center space-x-2 text-gray-600 hover:text-gray-900 transition-colors duration-200",children:[A.jsx(Uy,{className:"h-5 w-5"}),A.jsx("span",{children:"Back"})]})}),A.jsxs("div",{className:"text-center mb-8",children:[A.jsx("div",{className:"bg-primary-500 p-4 rounded-2xl inline-block mb-4 shadow-lg",style:{backgroundColor:"#03989e"},children:A.jsx(Od,{className:"h-8 w-8 text-white"})}),A.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Agence de Voyage Agent Portal"}),A.jsx("p",{className:"text-gray-600",children:"Sign in to your account"})]}),A.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 border border-gray-100",children:[A.jsxs("div",{className:"mb-6",children:[A.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Welcome Back"}),A.jsx("p",{className:"text-gray-600",children:"Enter your credentials to access your dashboard"})]}),f&&A.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:A.jsx("p",{className:"text-red-600 text-sm font-medium",children:f})}),A.jsxs("form",{onSubmit:x,className:"space-y-6",children:[A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),A.jsxs("div",{className:"relative",children:[A.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:A.jsx(c3,{className:"h-5 w-5 text-gray-400"})}),A.jsx("input",{type:"email",value:t,onChange:m=>r(m.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 bg-gray-50 focus:bg-white",style:{"--tw-ring-color":"#03989e"},placeholder:"Enter your email",required:!0})]})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),A.jsxs("div",{className:"relative",children:[A.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:A.jsx(l3,{className:"h-5 w-5 text-gray-400"})}),A.jsx("input",{type:i?"text":"password",value:n,onChange:m=>a(m.target.value),className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 bg-gray-50 focus:bg-white",style:{"--tw-ring-color":"#03989e"},placeholder:"Enter your password",required:!0}),A.jsx("button",{type:"button",onClick:()=>o(!i),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:i?A.jsx(n3,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"}):A.jsx($y,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"})})]})]}),A.jsx("button",{type:"submit",disabled:l||!t||!n,className:"w-full text-white py-3 px-4 rounded-lg font-medium transition-all duration-200 flex items-center justify-center space-x-2 shadow-lg hover:shadow-xl disabled:cursor-not-allowed",style:{backgroundColor:"#03989e",opacity:l||!t||!n?.6:1},onMouseEnter:m=>{!l&&t&&n&&(m.currentTarget.style.backgroundColor="#027a7f")},onMouseLeave:m=>{m.currentTarget.style.backgroundColor="#03989e"},children:l?A.jsxs(A.Fragment,{children:[A.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),A.jsx("span",{children:"Signing in..."})]}):A.jsx("span",{children:"Sign In"})})]})]}),A.jsx("div",{className:"text-center mt-8",children:A.jsx("p",{className:"text-sm text-gray-500",children:" 2025 Agence de Voyage. Secure Agent Portal."})})]})})},qw=({size:e="md",text:t,className:r=""})=>{const n={sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"};return A.jsxs("div",{className:`flex flex-col items-center justify-center space-y-4 ${r}`,children:[A.jsxs("div",{className:"text-center",children:[A.jsx(Jg,{className:`animate-spin text-blue-600 mx-auto ${n[e]} ${t?"mb-2":""}`}),t&&A.jsx("p",{className:"text-gray-600 font-medium",children:t})]}),A.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[A.jsxs("div",{className:"flex items-center space-x-2",children:[A.jsx("div",{className:"h-1.5 w-24 bg-gray-200 rounded-full overflow-hidden",children:A.jsx("div",{className:"h-full bg-blue-600 animate-progress",style:{width:"75%"}})}),A.jsx("span",{className:"text-sm text-gray-500",children:"75%"})]}),A.jsx("button",{onClick:()=>{const a=localStorage.getItem("dev-bypass-auth")==="true";localStorage.setItem("dev-bypass-auth",(!a).toString()),window.location.reload()},className:"text-sm text-blue-600 hover:text-blue-700 underline",children:"Quick Access (Dev Mode)"})]})]})},t6=()=>{const[e,t]=ce.useState(navigator.onLine),[r,n]=ce.useState(!1);return ce.useEffect(()=>{const a=()=>{t(!0),n(!0),setTimeout(()=>n(!1),3e3)},i=()=>{t(!1),n(!0)};return window.addEventListener("online",a),window.addEventListener("offline",i),navigator.onLine||n(!0),()=>{window.removeEventListener("online",a),window.removeEventListener("offline",i)}},[]),r?A.jsx("div",{className:`fixed top-4 right-4 z-50 px-4 py-2 rounded-lg shadow-lg flex items-center gap-2 ${e?"bg-green-500 text-white":"bg-red-500 text-white"}`,children:e?A.jsxs(A.Fragment,{children:[A.jsx(g3,{className:"w-4 h-4"}),A.jsx("span",{className:"text-sm font-medium",children:"Back online"})]}):A.jsxs(A.Fragment,{children:[A.jsx(p3,{className:"w-4 h-4"}),A.jsx("span",{className:"text-sm font-medium",children:"No internet connection"})]})}):null},r6=({onRetry:e,onSkip:t})=>A.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:A.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-8 text-center",children:[A.jsxs("div",{className:"mb-6",children:[A.jsx("div",{className:"mx-auto w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mb-4",children:A.jsx(e3,{className:"h-8 w-8 text-yellow-600"})}),A.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Connection Issue"}),A.jsx("p",{className:"text-gray-600",children:"We're having trouble connecting to the authentication service. This might be due to network issues or server maintenance."})]}),A.jsxs("div",{className:"space-y-3",children:[A.jsxs("button",{onClick:e,className:"w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg flex items-center justify-center space-x-2 transition-colors duration-200",children:[A.jsx(Ky,{className:"h-4 w-4"}),A.jsx("span",{children:"Try Again"})]}),A.jsx("button",{onClick:t,className:"w-full bg-gray-600 hover:bg-gray-700 text-white px-4 py-3 rounded-lg transition-colors duration-200",children:"Proceed to Login"})]}),A.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:A.jsx("p",{className:"text-sm text-gray-500",children:"If this problem persists, please check your internet connection or contact support."})})]})}),n6=()=>{const[e,t]=ce.useState(!1);return ce.useEffect(()=>{localStorage.getItem("dev-bypass-auth"),t(!1)},[]),{isDevelopment:e,enableBypass:()=>{localStorage.setItem("dev-bypass-auth","true"),t(!0)},disableBypass:()=>{localStorage.removeItem("dev-bypass-auth"),t(!1)}}},a6=()=>{const{isAuthenticated:e,loading:t,error:r,forceInitComplete:n,retryAuth:a}=cm();return n6(),ce.useEffect(()=>{document.title="Agent Portal - Invoice Management System"},[]),r&&!t?A.jsx(r6,{onRetry:a,onSkip:()=>n()}):t?A.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:A.jsxs("div",{className:"text-center",children:[A.jsx(qw,{size:"lg",text:"Loading your account..."}),A.jsxs("div",{className:"mt-6 space-y-3",children:[A.jsx("button",{onClick:()=>window.location.reload(),className:"block w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors duration-200",children:"Try Again"}),!1,A.jsx("p",{className:"text-sm text-gray-500 mt-2",children:'If loading takes too long, click "Try Again"'})]})]})}):e?A.jsxs("div",{className:"transition-colors duration-200",children:[A.jsx(t6,{}),A.jsx(ZA,{})]}):A.jsx(e6,{})},i6=()=>{const e=fc(),[t,r]=ce.useState(()=>{const l=localStorage.getItem("nav-position");return l?JSON.parse(l):{x:window.innerWidth-200,y:20}}),[n,a]=ce.useState(!1),i=ce.useRef(null),o=l=>{a(!0),i.current={offsetX:l.clientX-t.x,offsetY:l.clientY-t.y}};return ce.useEffect(()=>{const l=f=>{if(!n||!i.current)return;const h=f.clientX-i.current.offsetX,g=f.clientY-i.current.offsetY,x=Math.max(10,Math.min(h,window.innerWidth-180)),m=Math.max(10,Math.min(g,window.innerHeight-100));r({x,y:m})},u=()=>{n&&(a(!1),localStorage.setItem("nav-position",JSON.stringify(t)))};return n&&(window.addEventListener("mousemove",l),window.addEventListener("mouseup",u)),()=>{window.removeEventListener("mousemove",l),window.removeEventListener("mouseup",u)}},[n,t]),A.jsx("div",{className:"fixed z-[9999] select-none",style:{left:`${t.x}px`,top:`${t.y}px`,cursor:n?"grabbing":"default"},children:A.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl border border-gray-200 dark:border-gray-700 overflow-hidden flex flex-row items-center p-1.5 gap-1 min-w-[160px]",children:[A.jsx("div",{onMouseDown:o,className:"cursor-grab active:cursor-grabbing p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors",title:"  ",children:A.jsx(Hy,{className:"h-4 w-4 text-gray-400"})}),A.jsxs("div",{className:"flex flex-row gap-1 border-l border-gray-100 dark:border-gray-700 ml-1 pl-1",children:[A.jsxs(Ld,{to:"/portal",className:`flex items-center space-x-2 px-3 py-1.5 rounded-lg text-sm transition-all duration-200 ${e.pathname==="/portal"||e.pathname==="/"?"bg-blue-600 text-white shadow-md shadow-blue-200 dark:shadow-none font-medium":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[A.jsx(Tu,{className:"h-4 w-4"}),A.jsx("span",{children:"Dashboard"})]}),A.jsxs(Ld,{to:"/portal/rooming",className:`flex items-center space-x-2 px-3 py-1.5 rounded-lg text-sm transition-all duration-200 ${e.pathname==="/portal/rooming"?"bg-emerald-600 text-white shadow-md shadow-emerald-200 dark:shadow-none font-medium":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[A.jsx(Vy,{className:"h-4 w-4"}),A.jsx("span",{children:"Rooming"})]})]})]})})};class s6 extends ce.Component{constructor(t){super(t),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t,errorInfo:null}}componentDidCatch(t,r){console.error("ErrorBoundary caught an error:",t,r),this.setState({error:t,errorInfo:r})}handleReload=()=>{this.setState({hasError:!1,error:null,errorInfo:null}),window.location.reload()};handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};render(){return this.state.hasError?this.props.fallback?this.props.fallback:A.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:A.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6",children:[A.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto bg-red-100 rounded-full mb-4",children:A.jsx(op,{className:"w-6 h-6 text-red-600"})}),A.jsx("h1",{className:"text-xl font-semibold text-gray-900 text-center mb-2",children:"Something went wrong"}),A.jsx("p",{className:"text-gray-600 text-center mb-6",children:"We're sorry, but something unexpected happened. Please try refreshing the page."}),!1,A.jsxs("div",{className:"flex gap-3",children:[A.jsx("button",{onClick:this.handleReset,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 transition-colors",children:"Try Again"}),A.jsxs("button",{onClick:this.handleReload,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors flex items-center justify-center gap-2",children:[A.jsx(Ky,{className:"w-4 h-4"}),"Reload Page"]})]})]})}):this.props.children}}const mp=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function zf(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function um(e){return"nodeType"in e}function ys(e){var t,r;return e?zf(e)?e:um(e)&&(t=(r=e.ownerDocument)==null?void 0:r.defaultView)!=null?t:window:window}function fm(e){const{Document:t}=ys(e);return e instanceof t}function ch(e){return zf(e)?!1:e instanceof ys(e).HTMLElement}function $w(e){return e instanceof ys(e).SVGElement}function qf(e){return e?zf(e)?e.document:um(e)?fm(e)?e:ch(e)||$w(e)?e.ownerDocument:document:document:document}const cc=mp?ce.useLayoutEffect:ce.useEffect;function vp(e){const t=ce.useRef(e);return cc(()=>{t.current=e}),ce.useCallback(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return t.current==null?void 0:t.current(...n)},[])}function o6(){const e=ce.useRef(null),t=ce.useCallback((n,a)=>{e.current=setInterval(n,a)},[]),r=ce.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,r]}function K0(e,t){t===void 0&&(t=[e]);const r=ce.useRef(e);return cc(()=>{r.current!==e&&(r.current=e)},t),r}function uh(e,t){const r=ce.useRef();return ce.useMemo(()=>{const n=e(r.current);return r.current=n,n},[...t])}function qd(e){const t=vp(e),r=ce.useRef(null),n=ce.useCallback(a=>{a!==r.current&&t?.(a,r.current),r.current=a},[]);return[r,n]}function $d(e){const t=ce.useRef();return ce.useEffect(()=>{t.current=e},[e]),t.current}let j1={};function xp(e,t){return ce.useMemo(()=>{if(t)return t;const r=j1[e]==null?0:j1[e]+1;return j1[e]=r,e+"-"+r},[e,t])}function Hw(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return n.reduce((i,o)=>{const l=Object.entries(o);for(const[u,f]of l){const h=i[u];h!=null&&(i[u]=h+e*f)}return i},{...t})}}const Lf=Hw(1),Hd=Hw(-1);function l6(e){return"clientX"in e&&"clientY"in e}function hm(e){if(!e)return!1;const{KeyboardEvent:t}=ys(e.target);return t&&e instanceof t}function c6(e){if(!e)return!1;const{TouchEvent:t}=ys(e.target);return t&&e instanceof t}function Vd(e){if(c6(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return l6(e)?{x:e.clientX,y:e.clientY}:null}const G0=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[G0.Translate.toString(e),G0.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:n}=e;return t+" "+r+"ms "+n}}}),lx="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function u6(e){return e.matches(lx)?e:e.querySelector(lx)}const f6={display:"none"};function h6(e){let{id:t,value:r}=e;return ra.createElement("div",{id:t,style:f6},r)}function d6(e){let{id:t,announcement:r,ariaLiveType:n="assertive"}=e;const a={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return ra.createElement("div",{id:t,style:a,role:"status","aria-live":n,"aria-atomic":!0},r)}function p6(){const[e,t]=ce.useState("");return{announce:ce.useCallback(n=>{n!=null&&t(n)},[]),announcement:e}}const Vw=ce.createContext(null);function g6(e){const t=ce.useContext(Vw);ce.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function m6(){const[e]=ce.useState(()=>new Set),t=ce.useCallback(n=>(e.add(n),()=>e.delete(n)),[e]);return[ce.useCallback(n=>{let{type:a,event:i}=n;e.forEach(o=>{var l;return(l=o[a])==null?void 0:l.call(o,i)})},[e]),t]}const v6={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},x6={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function y6(e){let{announcements:t=x6,container:r,hiddenTextDescribedById:n,screenReaderInstructions:a=v6}=e;const{announce:i,announcement:o}=p6(),l=xp("DndLiveRegion"),[u,f]=ce.useState(!1);if(ce.useEffect(()=>{f(!0)},[]),g6(ce.useMemo(()=>({onDragStart(g){let{active:x}=g;i(t.onDragStart({active:x}))},onDragMove(g){let{active:x,over:m}=g;t.onDragMove&&i(t.onDragMove({active:x,over:m}))},onDragOver(g){let{active:x,over:m}=g;i(t.onDragOver({active:x,over:m}))},onDragEnd(g){let{active:x,over:m}=g;i(t.onDragEnd({active:x,over:m}))},onDragCancel(g){let{active:x,over:m}=g;i(t.onDragCancel({active:x,over:m}))}}),[i,t])),!u)return null;const h=ra.createElement(ra.Fragment,null,ra.createElement(h6,{id:n,value:a.draggable}),ra.createElement(d6,{id:l,announcement:o}));return r?g0.createPortal(h,r):h}var Ha;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(Ha||(Ha={}));function Wd(){}function w6(e,t){return ce.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function b6(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return ce.useMemo(()=>[...t].filter(n=>n!=null),[...t])}const ll=Object.freeze({x:0,y:0});function _6(e,t){const r=Vd(e);if(!r)return"0 0";const n={x:(r.x-t.left)/t.width*100,y:(r.y-t.top)/t.height*100};return n.x+"% "+n.y+"%"}function k6(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return n-r}function S6(e,t){if(!e||e.length===0)return null;const[r]=e;return r[t]}function E6(e,t){const r=Math.max(t.top,e.top),n=Math.max(t.left,e.left),a=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),o=a-n,l=i-r;if(n<a&&r<i){const u=t.width*t.height,f=e.width*e.height,h=o*l,g=h/(u+f-h);return Number(g.toFixed(4))}return 0}const A6=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const a=[];for(const i of n){const{id:o}=i,l=r.get(o);if(l){const u=E6(l,t);u>0&&a.push({id:o,data:{droppableContainer:i,value:u}})}}return a.sort(k6)};function N6(e,t,r){return{...e,scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1}}function Ww(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:ll}function T6(e){return function(r){for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];return a.reduce((o,l)=>({...o,top:o.top+e*l.y,bottom:o.bottom+e*l.y,left:o.left+e*l.x,right:o.right+e*l.x}),{...r})}}const C6=T6(1);function Kw(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function P6(e,t,r){const n=Kw(t);if(!n)return e;const{scaleX:a,scaleY:i,x:o,y:l}=n,u=e.left-o-(1-a)*parseFloat(r),f=e.top-l-(1-i)*parseFloat(r.slice(r.indexOf(" ")+1)),h=a?e.width/a:e.width,g=i?e.height/i:e.height;return{width:h,height:g,top:f,right:u+h,bottom:f+g,left:u}}const L6={ignoreTransform:!1};function fh(e,t){t===void 0&&(t=L6);let r=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:f,transformOrigin:h}=ys(e).getComputedStyle(e);f&&(r=P6(r,f,h))}const{top:n,left:a,width:i,height:o,bottom:l,right:u}=r;return{top:n,left:a,width:i,height:o,bottom:l,right:u}}function cx(e){return fh(e,{ignoreTransform:!0})}function F6(e){const t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}function O6(e,t){return t===void 0&&(t=ys(e).getComputedStyle(e)),t.position==="fixed"}function I6(e,t){t===void 0&&(t=ys(e).getComputedStyle(e));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(a=>{const i=t[a];return typeof i=="string"?r.test(i):!1})}function dm(e,t){const r=[];function n(a){if(t!=null&&r.length>=t||!a)return r;if(fm(a)&&a.scrollingElement!=null&&!r.includes(a.scrollingElement))return r.push(a.scrollingElement),r;if(!ch(a)||$w(a)||r.includes(a))return r;const i=ys(e).getComputedStyle(a);return a!==e&&I6(a,i)&&r.push(a),O6(a,i)?r:n(a.parentNode)}return e?n(e):r}function Gw(e){const[t]=dm(e,1);return t??null}function M1(e){return!mp||!e?null:zf(e)?e:um(e)?fm(e)||e===qf(e).scrollingElement?window:ch(e)?e:null:null}function Yw(e){return zf(e)?e.scrollX:e.scrollLeft}function Xw(e){return zf(e)?e.scrollY:e.scrollTop}function Ng(e){return{x:Yw(e),y:Xw(e)}}var oi;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(oi||(oi={}));function Jw(e){return!mp||!e?!1:e===document.scrollingElement}function Qw(e){const t={x:0,y:0},r=Jw(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},n={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},a=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,o=e.scrollTop>=n.y,l=e.scrollLeft>=n.x;return{isTop:a,isLeft:i,isBottom:o,isRight:l,maxScroll:n,minScroll:t}}const R6={x:.2,y:.2};function D6(e,t,r,n,a){let{top:i,left:o,right:l,bottom:u}=r;n===void 0&&(n=10),a===void 0&&(a=R6);const{isTop:f,isBottom:h,isLeft:g,isRight:x}=Qw(e),m={x:0,y:0},k={x:0,y:0},b={height:t.height*a.y,width:t.width*a.x};return!f&&i<=t.top+b.height?(m.y=oi.Backward,k.y=n*Math.abs((t.top+b.height-i)/b.height)):!h&&u>=t.bottom-b.height&&(m.y=oi.Forward,k.y=n*Math.abs((t.bottom-b.height-u)/b.height)),!x&&l>=t.right-b.width?(m.x=oi.Forward,k.x=n*Math.abs((t.right-b.width-l)/b.width)):!g&&o<=t.left+b.width&&(m.x=oi.Backward,k.x=n*Math.abs((t.left+b.width-o)/b.width)),{direction:m,speed:k}}function j6(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:o}=window;return{top:0,left:0,right:i,bottom:o,width:i,height:o}}const{top:t,left:r,right:n,bottom:a}=e.getBoundingClientRect();return{top:t,left:r,right:n,bottom:a,width:e.clientWidth,height:e.clientHeight}}function Zw(e){return e.reduce((t,r)=>Lf(t,Ng(r)),ll)}function M6(e){return e.reduce((t,r)=>t+Yw(r),0)}function B6(e){return e.reduce((t,r)=>t+Xw(r),0)}function e5(e,t){if(t===void 0&&(t=fh),!e)return;const{top:r,left:n,bottom:a,right:i}=t(e);Gw(e)&&(a<=0||i<=0||r>=window.innerHeight||n>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const U6=[["x",["left","right"],M6],["y",["top","bottom"],B6]];class pm{constructor(t,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=dm(r),a=Zw(n);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,o,l]of U6)for(const u of o)Object.defineProperty(this,u,{get:()=>{const f=l(n),h=a[i]-f;return this.rect[u]+h},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class S0{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...r)})},this.target=t}add(t,r,n){var a;(a=this.target)==null||a.addEventListener(t,r,n),this.listeners.push([t,r,n])}}function z6(e){const{EventTarget:t}=ys(e);return e instanceof t?e:qf(e)}function B1(e,t){const r=Math.abs(e.x),n=Math.abs(e.y);return typeof t=="number"?Math.sqrt(r**2+n**2)>t:"x"in t&&"y"in t?r>t.x&&n>t.y:"x"in t?r>t.x:"y"in t?n>t.y:!1}var Ao;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Ao||(Ao={}));function ux(e){e.preventDefault()}function q6(e){e.stopPropagation()}var Mn;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(Mn||(Mn={}));const t5={start:[Mn.Space,Mn.Enter],cancel:[Mn.Esc],end:[Mn.Space,Mn.Enter,Mn.Tab]},$6=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case Mn.Right:return{...r,x:r.x+25};case Mn.Left:return{...r,x:r.x-25};case Mn.Down:return{...r,y:r.y+25};case Mn.Up:return{...r,y:r.y-25}}};class r5{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:r}}=t;this.props=t,this.listeners=new S0(qf(r)),this.windowListeners=new S0(ys(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Ao.Resize,this.handleCancel),this.windowListeners.add(Ao.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Ao.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:r}=this.props,n=t.node.current;n&&e5(n),r(ll)}handleKeyDown(t){if(hm(t)){const{active:r,context:n,options:a}=this.props,{keyboardCodes:i=t5,coordinateGetter:o=$6,scrollBehavior:l="smooth"}=a,{code:u}=t;if(i.end.includes(u)){this.handleEnd(t);return}if(i.cancel.includes(u)){this.handleCancel(t);return}const{collisionRect:f}=n.current,h=f?{x:f.left,y:f.top}:ll;this.referenceCoordinates||(this.referenceCoordinates=h);const g=o(t,{active:r,context:n.current,currentCoordinates:h});if(g){const x=Hd(g,h),m={x:0,y:0},{scrollableAncestors:k}=n.current;for(const b of k){const E=t.code,{isTop:N,isRight:O,isLeft:F,isBottom:K,maxScroll:te,minScroll:re}=Qw(b),B=j6(b),V={x:Math.min(E===Mn.Right?B.right-B.width/2:B.right,Math.max(E===Mn.Right?B.left:B.left+B.width/2,g.x)),y:Math.min(E===Mn.Down?B.bottom-B.height/2:B.bottom,Math.max(E===Mn.Down?B.top:B.top+B.height/2,g.y))},Y=E===Mn.Right&&!O||E===Mn.Left&&!F,ye=E===Mn.Down&&!K||E===Mn.Up&&!N;if(Y&&V.x!==g.x){const U=b.scrollLeft+x.x,D=E===Mn.Right&&U<=te.x||E===Mn.Left&&U>=re.x;if(D&&!x.y){b.scrollTo({left:U,behavior:l});return}D?m.x=b.scrollLeft-U:m.x=E===Mn.Right?b.scrollLeft-te.x:b.scrollLeft-re.x,m.x&&b.scrollBy({left:-m.x,behavior:l});break}else if(ye&&V.y!==g.y){const U=b.scrollTop+x.y,D=E===Mn.Down&&U<=te.y||E===Mn.Up&&U>=re.y;if(D&&!x.x){b.scrollTo({top:U,behavior:l});return}D?m.y=b.scrollTop-U:m.y=E===Mn.Down?b.scrollTop-te.y:b.scrollTop-re.y,m.y&&b.scrollBy({top:-m.y,behavior:l});break}}this.handleMove(t,Lf(Hd(g,this.referenceCoordinates),m))}}}handleMove(t,r){const{onMove:n}=this.props;t.preventDefault(),n(r)}handleEnd(t){const{onEnd:r}=this.props;t.preventDefault(),this.detach(),r()}handleCancel(t){const{onCancel:r}=this.props;t.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}r5.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:n=t5,onActivation:a}=t,{active:i}=r;const{code:o}=e.nativeEvent;if(n.start.includes(o)){const l=i.activatorNode.current;return l&&e.target!==l?!1:(e.preventDefault(),a?.({event:e.nativeEvent}),!0)}return!1}}];function fx(e){return!!(e&&"distance"in e)}function hx(e){return!!(e&&"delay"in e)}class gm{constructor(t,r,n){var a;n===void 0&&(n=z6(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=r;const{event:i}=t,{target:o}=i;this.props=t,this.events=r,this.document=qf(o),this.documentListeners=new S0(this.document),this.listeners=new S0(n),this.windowListeners=new S0(ys(o)),this.initialCoordinates=(a=Vd(i))!=null?a:ll,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:r,bypassActivationConstraint:n}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(Ao.Resize,this.handleCancel),this.windowListeners.add(Ao.DragStart,ux),this.windowListeners.add(Ao.VisibilityChange,this.handleCancel),this.windowListeners.add(Ao.ContextMenu,ux),this.documentListeners.add(Ao.Keydown,this.handleKeydown),r){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(hx(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(fx(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,r){const{active:n,onPending:a}=this.props;a(n,t,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:t}=this,{onStart:r}=this.props;t&&(this.activated=!0,this.documentListeners.add(Ao.Click,q6,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Ao.SelectionChange,this.removeTextSelection),r(t))}handleMove(t){var r;const{activated:n,initialCoordinates:a,props:i}=this,{onMove:o,options:{activationConstraint:l}}=i;if(!a)return;const u=(r=Vd(t))!=null?r:ll,f=Hd(a,u);if(!n&&l){if(fx(l)){if(l.tolerance!=null&&B1(f,l.tolerance))return this.handleCancel();if(B1(f,l.distance))return this.handleStart()}if(hx(l)&&B1(f,l.tolerance))return this.handleCancel();this.handlePending(l,f);return}t.cancelable&&t.preventDefault(),o(u)}handleEnd(){const{onAbort:t,onEnd:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleCancel(){const{onAbort:t,onCancel:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleKeydown(t){t.code===Mn.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const H6={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class mm extends gm{constructor(t){const{event:r}=t,n=qf(r.target);super(t,H6,n)}}mm.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return!r.isPrimary||r.button!==0?!1:(n?.({event:r}),!0)}}];const V6={move:{name:"mousemove"},end:{name:"mouseup"}};var Tg;(function(e){e[e.RightClick=2]="RightClick"})(Tg||(Tg={}));class W6 extends gm{constructor(t){super(t,V6,qf(t.event.target))}}W6.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return r.button===Tg.RightClick?!1:(n?.({event:r}),!0)}}];const U1={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class K6 extends gm{constructor(t){super(t,U1)}static setup(){return window.addEventListener(U1.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(U1.move.name,t)};function t(){}}}K6.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;const{touches:a}=r;return a.length>1?!1:(n?.({event:r}),!0)}}];var E0;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(E0||(E0={}));var Kd;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(Kd||(Kd={}));function G6(e){let{acceleration:t,activator:r=E0.Pointer,canScroll:n,draggingRect:a,enabled:i,interval:o=5,order:l=Kd.TreeOrder,pointerCoordinates:u,scrollableAncestors:f,scrollableAncestorRects:h,delta:g,threshold:x}=e;const m=X6({delta:g,disabled:!i}),[k,b]=o6(),E=ce.useRef({x:0,y:0}),N=ce.useRef({x:0,y:0}),O=ce.useMemo(()=>{switch(r){case E0.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case E0.DraggableRect:return a}},[r,a,u]),F=ce.useRef(null),K=ce.useCallback(()=>{const re=F.current;if(!re)return;const B=E.current.x*N.current.x,V=E.current.y*N.current.y;re.scrollBy(B,V)},[]),te=ce.useMemo(()=>l===Kd.TreeOrder?[...f].reverse():f,[l,f]);ce.useEffect(()=>{if(!i||!f.length||!O){b();return}for(const re of te){if(n?.(re)===!1)continue;const B=f.indexOf(re),V=h[B];if(!V)continue;const{direction:Y,speed:ye}=D6(re,V,O,t,x);for(const U of["x","y"])m[U][Y[U]]||(ye[U]=0,Y[U]=0);if(ye.x>0||ye.y>0){b(),F.current=re,k(K,o),E.current=ye,N.current=Y;return}}E.current={x:0,y:0},N.current={x:0,y:0},b()},[t,K,n,b,i,o,JSON.stringify(O),JSON.stringify(m),k,f,te,h,JSON.stringify(x)])}const Y6={x:{[oi.Backward]:!1,[oi.Forward]:!1},y:{[oi.Backward]:!1,[oi.Forward]:!1}};function X6(e){let{delta:t,disabled:r}=e;const n=$d(t);return uh(a=>{if(r||!n||!a)return Y6;const i={x:Math.sign(t.x-n.x),y:Math.sign(t.y-n.y)};return{x:{[oi.Backward]:a.x[oi.Backward]||i.x===-1,[oi.Forward]:a.x[oi.Forward]||i.x===1},y:{[oi.Backward]:a.y[oi.Backward]||i.y===-1,[oi.Forward]:a.y[oi.Forward]||i.y===1}}},[r,t,n])}function J6(e,t){const r=t!=null?e.get(t):void 0,n=r?r.node.current:null;return uh(a=>{var i;return t==null?null:(i=n??a)!=null?i:null},[n,t])}function Q6(e,t){return ce.useMemo(()=>e.reduce((r,n)=>{const{sensor:a}=n,i=a.activators.map(o=>({eventName:o.eventName,handler:t(o.handler,n)}));return[...r,...i]},[]),[e,t])}var Y0;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Y0||(Y0={}));var Cg;(function(e){e.Optimized="optimized"})(Cg||(Cg={}));const dx=new Map;function Z6(e,t){let{dragging:r,dependencies:n,config:a}=t;const[i,o]=ce.useState(null),{frequency:l,measure:u,strategy:f}=a,h=ce.useRef(e),g=E(),x=K0(g),m=ce.useCallback(function(N){N===void 0&&(N=[]),!x.current&&o(O=>O===null?N:O.concat(N.filter(F=>!O.includes(F))))},[x]),k=ce.useRef(null),b=uh(N=>{if(g&&!r)return dx;if(!N||N===dx||h.current!==e||i!=null){const O=new Map;for(let F of e){if(!F)continue;if(i&&i.length>0&&!i.includes(F.id)&&F.rect.current){O.set(F.id,F.rect.current);continue}const K=F.node.current,te=K?new pm(u(K),K):null;F.rect.current=te,te&&O.set(F.id,te)}return O}return N},[e,i,r,g,u]);return ce.useEffect(()=>{h.current=e},[e]),ce.useEffect(()=>{g||m()},[r,g]),ce.useEffect(()=>{i&&i.length>0&&o(null)},[JSON.stringify(i)]),ce.useEffect(()=>{g||typeof l!="number"||k.current!==null||(k.current=setTimeout(()=>{m(),k.current=null},l))},[l,g,m,...n]),{droppableRects:b,measureDroppableContainers:m,measuringScheduled:i!=null};function E(){switch(f){case Y0.Always:return!1;case Y0.BeforeDragging:return r;default:return!r}}}function vm(e,t){return uh(r=>e?r||(typeof t=="function"?t(e):e):null,[t,e])}function eN(e,t){return vm(e,t)}function tN(e){let{callback:t,disabled:r}=e;const n=vp(t),a=ce.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(n)},[n,r]);return ce.useEffect(()=>()=>a?.disconnect(),[a]),a}function yp(e){let{callback:t,disabled:r}=e;const n=vp(t),a=ce.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(n)},[r]);return ce.useEffect(()=>()=>a?.disconnect(),[a]),a}function rN(e){return new pm(fh(e),e)}function px(e,t,r){t===void 0&&(t=rN);const[n,a]=ce.useState(null);function i(){a(u=>{if(!e)return null;if(e.isConnected===!1){var f;return(f=u??r)!=null?f:null}const h=t(e);return JSON.stringify(u)===JSON.stringify(h)?u:h})}const o=tN({callback(u){if(e)for(const f of u){const{type:h,target:g}=f;if(h==="childList"&&g instanceof HTMLElement&&g.contains(e)){i();break}}}}),l=yp({callback:i});return cc(()=>{i(),e?(l?.observe(e),o?.observe(document.body,{childList:!0,subtree:!0})):(l?.disconnect(),o?.disconnect())},[e]),n}function nN(e){const t=vm(e);return Ww(e,t)}const gx=[];function aN(e){const t=ce.useRef(e),r=uh(n=>e?n&&n!==gx&&e&&t.current&&e.parentNode===t.current.parentNode?n:dm(e):gx,[e]);return ce.useEffect(()=>{t.current=e},[e]),r}function iN(e){const[t,r]=ce.useState(null),n=ce.useRef(e),a=ce.useCallback(i=>{const o=M1(i.target);o&&r(l=>l?(l.set(o,Ng(o)),new Map(l)):null)},[]);return ce.useEffect(()=>{const i=n.current;if(e!==i){o(i);const l=e.map(u=>{const f=M1(u);return f?(f.addEventListener("scroll",a,{passive:!0}),[f,Ng(f)]):null}).filter(u=>u!=null);r(l.length?new Map(l):null),n.current=e}return()=>{o(e),o(i)};function o(l){l.forEach(u=>{const f=M1(u);f?.removeEventListener("scroll",a)})}},[a,e]),ce.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,o)=>Lf(i,o),ll):Zw(e):ll,[e,t])}function mx(e,t){t===void 0&&(t=[]);const r=ce.useRef(null);return ce.useEffect(()=>{r.current=null},t),ce.useEffect(()=>{const n=e!==ll;n&&!r.current&&(r.current=e),!n&&r.current&&(r.current=null)},[e]),r.current?Hd(e,r.current):ll}function sN(e){ce.useEffect(()=>{if(!mp)return;const t=e.map(r=>{let{sensor:n}=r;return n.setup==null?void 0:n.setup()});return()=>{for(const r of t)r?.()}},e.map(t=>{let{sensor:r}=t;return r}))}function oN(e,t){return ce.useMemo(()=>e.reduce((r,n)=>{let{eventName:a,handler:i}=n;return r[a]=o=>{i(o,t)},r},{}),[e,t])}function n5(e){return ce.useMemo(()=>e?F6(e):null,[e])}const vx=[];function lN(e,t){t===void 0&&(t=fh);const[r]=e,n=n5(r?ys(r):null),[a,i]=ce.useState(vx);function o(){i(()=>e.length?e.map(u=>Jw(u)?n:new pm(t(u),u)):vx)}const l=yp({callback:o});return cc(()=>{l?.disconnect(),o(),e.forEach(u=>l?.observe(u))},[e]),a}function a5(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return ch(t)?t:e}function cN(e){let{measure:t}=e;const[r,n]=ce.useState(null),a=ce.useCallback(f=>{for(const{target:h}of f)if(ch(h)){n(g=>{const x=t(h);return g?{...g,width:x.width,height:x.height}:x});break}},[t]),i=yp({callback:a}),o=ce.useCallback(f=>{const h=a5(f);i?.disconnect(),h&&i?.observe(h),n(h?t(h):null)},[t,i]),[l,u]=qd(o);return ce.useMemo(()=>({nodeRef:l,rect:r,setRef:u}),[r,l,u])}const uN=[{sensor:mm,options:{}},{sensor:r5,options:{}}],fN={current:{}},Cd={draggable:{measure:cx},droppable:{measure:cx,strategy:Y0.WhileDragging,frequency:Cg.Optimized},dragOverlay:{measure:fh}};class A0 extends Map{get(t){var r;return t!=null&&(r=super.get(t))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:r}=t;return!r})}getNodeFor(t){var r,n;return(r=(n=this.get(t))==null?void 0:n.node.current)!=null?r:void 0}}const hN={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new A0,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Wd},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Cd,measureDroppableContainers:Wd,windowRect:null,measuringScheduled:!1},i5={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Wd,draggableNodes:new Map,over:null,measureDroppableContainers:Wd},hh=ce.createContext(i5),s5=ce.createContext(hN);function dN(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new A0}}}function pN(e,t){switch(t.type){case Ha.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case Ha.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case Ha.DragEnd:case Ha.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Ha.RegisterDroppable:{const{element:r}=t,{id:n}=r,a=new A0(e.droppable.containers);return a.set(n,r),{...e,droppable:{...e.droppable,containers:a}}}case Ha.SetDroppableDisabled:{const{id:r,key:n,disabled:a}=t,i=e.droppable.containers.get(r);if(!i||n!==i.key)return e;const o=new A0(e.droppable.containers);return o.set(r,{...i,disabled:a}),{...e,droppable:{...e.droppable,containers:o}}}case Ha.UnregisterDroppable:{const{id:r,key:n}=t,a=e.droppable.containers.get(r);if(!a||n!==a.key)return e;const i=new A0(e.droppable.containers);return i.delete(r),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function gN(e){let{disabled:t}=e;const{active:r,activatorEvent:n,draggableNodes:a}=ce.useContext(hh),i=$d(n),o=$d(r?.id);return ce.useEffect(()=>{if(!t&&!n&&i&&o!=null){if(!hm(i)||document.activeElement===i.target)return;const l=a.get(o);if(!l)return;const{activatorNode:u,node:f}=l;if(!u.current&&!f.current)return;requestAnimationFrame(()=>{for(const h of[u.current,f.current]){if(!h)continue;const g=u6(h);if(g){g.focus();break}}})}},[n,t,a,o,i]),null}function o5(e,t){let{transform:r,...n}=t;return e!=null&&e.length?e.reduce((a,i)=>i({transform:a,...n}),r):r}function mN(e){return ce.useMemo(()=>({draggable:{...Cd.draggable,...e?.draggable},droppable:{...Cd.droppable,...e?.droppable},dragOverlay:{...Cd.dragOverlay,...e?.dragOverlay}}),[e?.draggable,e?.droppable,e?.dragOverlay])}function vN(e){let{activeNode:t,measure:r,initialRect:n,config:a=!0}=e;const i=ce.useRef(!1),{x:o,y:l}=typeof a=="boolean"?{x:a,y:a}:a;cc(()=>{if(!o&&!l||!t){i.current=!1;return}if(i.current||!n)return;const f=t?.node.current;if(!f||f.isConnected===!1)return;const h=r(f),g=Ww(h,n);if(o||(g.x=0),l||(g.y=0),i.current=!0,Math.abs(g.x)>0||Math.abs(g.y)>0){const x=Gw(f);x&&x.scrollBy({top:g.y,left:g.x})}},[t,o,l,n,r])}const wp=ce.createContext({...ll,scaleX:1,scaleY:1});var Mc;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Mc||(Mc={}));const xN=ce.memo(function(t){var r,n,a,i;let{id:o,accessibility:l,autoScroll:u=!0,children:f,sensors:h=uN,collisionDetection:g=A6,measuring:x,modifiers:m,...k}=t;const b=ce.useReducer(pN,void 0,dN),[E,N]=b,[O,F]=m6(),[K,te]=ce.useState(Mc.Uninitialized),re=K===Mc.Initialized,{draggable:{active:B,nodes:V,translate:Y},droppable:{containers:ye}}=E,U=B!=null?V.get(B):null,D=ce.useRef({initial:null,translated:null}),le=ce.useMemo(()=>{var Xr;return B!=null?{id:B,data:(Xr=U?.data)!=null?Xr:fN,rect:D}:null},[B,U]),ue=ce.useRef(null),[Te,Fe]=ce.useState(null),[Le,me]=ce.useState(null),ne=K0(k,Object.values(k)),Ee=xp("DndDescribedBy",o),pe=ce.useMemo(()=>ye.getEnabled(),[ye]),C=mN(x),{droppableRects:M,measureDroppableContainers:z,measuringScheduled:H}=Z6(pe,{dragging:re,dependencies:[Y.x,Y.y],config:C.droppable}),ie=J6(V,B),xe=ce.useMemo(()=>Le?Vd(Le):null,[Le]),Ae=Bn(),de=eN(ie,C.draggable.measure);vN({activeNode:B!=null?V.get(B):null,config:Ae.layoutShiftCompensation,initialRect:de,measure:C.draggable.measure});const Me=px(ie,C.draggable.measure,de),ct=px(ie?ie.parentElement:null),se=ce.useRef({activatorEvent:null,active:null,activeNode:ie,collisionRect:null,collisions:null,droppableRects:M,draggableNodes:V,draggingNode:null,draggingNodeRect:null,droppableContainers:ye,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),bt=ye.getNodeFor((r=se.current.over)==null?void 0:r.id),Dt=cN({measure:C.dragOverlay.measure}),Je=(n=Dt.nodeRef.current)!=null?n:ie,we=re?(a=Dt.rect)!=null?a:Me:null,mt=!!(Dt.nodeRef.current&&Dt.rect),qt=nN(mt?null:Me),xt=n5(Je?ys(Je):null),_t=aN(re?bt??ie:null),Et=lN(_t),Bt=o5(m,{transform:{x:Y.x-qt.x,y:Y.y-qt.y,scaleX:1,scaleY:1},activatorEvent:Le,active:le,activeNodeRect:Me,containerNodeRect:ct,draggingNodeRect:we,over:se.current.over,overlayNodeRect:Dt.rect,scrollableAncestors:_t,scrollableAncestorRects:Et,windowRect:xt}),Jt=xe?Lf(xe,Y):null,nr=iN(_t),cr=mx(nr),gr=mx(nr,[Me]),yr=Lf(Bt,cr),mr=we?C6(we,Bt):null,Qt=le&&mr?g({active:le,collisionRect:mr,droppableRects:M,droppableContainers:pe,pointerCoordinates:Jt}):null,$t=S6(Qt,"id"),[wt,Vr]=ce.useState(null),ur=mt?Bt:Lf(Bt,gr),Tn=N6(ur,(i=wt?.rect)!=null?i:null,Me),Ur=ce.useRef(null),Ut=ce.useCallback((Xr,Fr)=>{let{sensor:ar,options:Or}=Fr;if(ue.current==null)return;const Ln=V.get(ue.current);if(!Ln)return;const Jr=Xr.nativeEvent,ln=new ar({active:ue.current,activeNode:Ln,event:Jr,options:Or,context:se,onAbort(Gt){if(!V.get(Gt))return;const{onDragAbort:wr}=ne.current,Dr={id:Gt};wr?.(Dr),O({type:"onDragAbort",event:Dr})},onPending(Gt,yn,wr,Dr){if(!V.get(Gt))return;const{onDragPending:Qr}=ne.current,X={id:Gt,constraint:yn,initialCoordinates:wr,offset:Dr};Qr?.(X),O({type:"onDragPending",event:X})},onStart(Gt){const yn=ue.current;if(yn==null)return;const wr=V.get(yn);if(!wr)return;const{onDragStart:Dr}=ne.current,nn={activatorEvent:Jr,active:{id:yn,data:wr.data,rect:D}};g0.unstable_batchedUpdates(()=>{Dr?.(nn),te(Mc.Initializing),N({type:Ha.DragStart,initialCoordinates:Gt,active:yn}),O({type:"onDragStart",event:nn}),Fe(Ur.current),me(Jr)})},onMove(Gt){N({type:Ha.DragMove,coordinates:Gt})},onEnd:Sn(Ha.DragEnd),onCancel:Sn(Ha.DragCancel)});Ur.current=ln;function Sn(Gt){return async function(){const{active:wr,collisions:Dr,over:nn,scrollAdjustedTranslate:Qr}=se.current;let X=null;if(wr&&Qr){const{cancelDrop:be}=ne.current;X={activatorEvent:Jr,active:wr,collisions:Dr,delta:Qr,over:nn},Gt===Ha.DragEnd&&typeof be=="function"&&await Promise.resolve(be(X))&&(Gt=Ha.DragCancel)}ue.current=null,g0.unstable_batchedUpdates(()=>{N({type:Gt}),te(Mc.Uninitialized),Vr(null),Fe(null),me(null),Ur.current=null;const be=Gt===Ha.DragEnd?"onDragEnd":"onDragCancel";if(X){const fe=ne.current[be];fe?.(X),O({type:be,event:X})}})}}},[V]),Zn=ce.useCallback((Xr,Fr)=>(ar,Or)=>{const Ln=ar.nativeEvent,Jr=V.get(Or);if(ue.current!==null||!Jr||Ln.dndKit||Ln.defaultPrevented)return;const ln={active:Jr};Xr(ar,Fr.options,ln)===!0&&(Ln.dndKit={capturedBy:Fr.sensor},ue.current=Or,Ut(ar,Fr))},[V,Ut]),Lr=Q6(h,Zn);sN(h),cc(()=>{Me&&K===Mc.Initializing&&te(Mc.Initialized)},[Me,K]),ce.useEffect(()=>{const{onDragMove:Xr}=ne.current,{active:Fr,activatorEvent:ar,collisions:Or,over:Ln}=se.current;if(!Fr||!ar)return;const Jr={active:Fr,activatorEvent:ar,collisions:Or,delta:{x:yr.x,y:yr.y},over:Ln};g0.unstable_batchedUpdates(()=>{Xr?.(Jr),O({type:"onDragMove",event:Jr})})},[yr.x,yr.y]),ce.useEffect(()=>{const{active:Xr,activatorEvent:Fr,collisions:ar,droppableContainers:Or,scrollAdjustedTranslate:Ln}=se.current;if(!Xr||ue.current==null||!Fr||!Ln)return;const{onDragOver:Jr}=ne.current,ln=Or.get($t),Sn=ln&&ln.rect.current?{id:ln.id,rect:ln.rect.current,data:ln.data,disabled:ln.disabled}:null,Gt={active:Xr,activatorEvent:Fr,collisions:ar,delta:{x:Ln.x,y:Ln.y},over:Sn};g0.unstable_batchedUpdates(()=>{Vr(Sn),Jr?.(Gt),O({type:"onDragOver",event:Gt})})},[$t]),cc(()=>{se.current={activatorEvent:Le,active:le,activeNode:ie,collisionRect:mr,collisions:Qt,droppableRects:M,draggableNodes:V,draggingNode:Je,draggingNodeRect:we,droppableContainers:ye,over:wt,scrollableAncestors:_t,scrollAdjustedTranslate:yr},D.current={initial:we,translated:mr}},[le,ie,Qt,mr,V,Je,we,M,ye,wt,_t,yr]),G6({...Ae,delta:Y,draggingRect:mr,pointerCoordinates:Jt,scrollableAncestors:_t,scrollableAncestorRects:Et});const ga=ce.useMemo(()=>({active:le,activeNode:ie,activeNodeRect:Me,activatorEvent:Le,collisions:Qt,containerNodeRect:ct,dragOverlay:Dt,draggableNodes:V,droppableContainers:ye,droppableRects:M,over:wt,measureDroppableContainers:z,scrollableAncestors:_t,scrollableAncestorRects:Et,measuringConfiguration:C,measuringScheduled:H,windowRect:xt}),[le,ie,Me,Le,Qt,ct,Dt,V,ye,M,wt,z,_t,Et,C,H,xt]),At=ce.useMemo(()=>({activatorEvent:Le,activators:Lr,active:le,activeNodeRect:Me,ariaDescribedById:{draggable:Ee},dispatch:N,draggableNodes:V,over:wt,measureDroppableContainers:z}),[Le,Lr,le,Me,N,Ee,V,wt,z]);return ra.createElement(Vw.Provider,{value:F},ra.createElement(hh.Provider,{value:At},ra.createElement(s5.Provider,{value:ga},ra.createElement(wp.Provider,{value:Tn},f)),ra.createElement(gN,{disabled:l?.restoreFocus===!1})),ra.createElement(y6,{...l,hiddenTextDescribedById:Ee}));function Bn(){const Xr=Te?.autoScrollEnabled===!1,Fr=typeof u=="object"?u.enabled===!1:u===!1,ar=re&&!Xr&&!Fr;return typeof u=="object"?{...u,enabled:ar}:{enabled:ar}}}),yN=ce.createContext(null),xx="button",wN="Draggable";function bN(e){let{id:t,data:r,disabled:n=!1,attributes:a}=e;const i=xp(wN),{activators:o,activatorEvent:l,active:u,activeNodeRect:f,ariaDescribedById:h,draggableNodes:g,over:x}=ce.useContext(hh),{role:m=xx,roleDescription:k="draggable",tabIndex:b=0}=a??{},E=u?.id===t,N=ce.useContext(E?wp:yN),[O,F]=qd(),[K,te]=qd(),re=oN(o,t),B=K0(r);cc(()=>(g.set(t,{id:t,key:i,node:O,activatorNode:K,data:B}),()=>{const Y=g.get(t);Y&&Y.key===i&&g.delete(t)}),[g,t]);const V=ce.useMemo(()=>({role:m,tabIndex:b,"aria-disabled":n,"aria-pressed":E&&m===xx?!0:void 0,"aria-roledescription":k,"aria-describedby":h.draggable}),[n,m,b,E,k,h.draggable]);return{active:u,activatorEvent:l,activeNodeRect:f,attributes:V,isDragging:E,listeners:n?void 0:re,node:O,over:x,setNodeRef:F,setActivatorNodeRef:te,transform:N}}function _N(){return ce.useContext(s5)}const kN="Droppable",SN={timeout:25};function l5(e){let{data:t,disabled:r=!1,id:n,resizeObserverConfig:a}=e;const i=xp(kN),{active:o,dispatch:l,over:u,measureDroppableContainers:f}=ce.useContext(hh),h=ce.useRef({disabled:r}),g=ce.useRef(!1),x=ce.useRef(null),m=ce.useRef(null),{disabled:k,updateMeasurementsFor:b,timeout:E}={...SN,...a},N=K0(b??n),O=ce.useCallback(()=>{if(!g.current){g.current=!0;return}m.current!=null&&clearTimeout(m.current),m.current=setTimeout(()=>{f(Array.isArray(N.current)?N.current:[N.current]),m.current=null},E)},[E]),F=yp({callback:O,disabled:k||!o}),K=ce.useCallback((V,Y)=>{F&&(Y&&(F.unobserve(Y),g.current=!1),V&&F.observe(V))},[F]),[te,re]=qd(K),B=K0(t);return ce.useEffect(()=>{!F||!te.current||(F.disconnect(),g.current=!1,F.observe(te.current))},[te,F]),ce.useEffect(()=>(l({type:Ha.RegisterDroppable,element:{id:n,key:i,disabled:r,node:te,rect:x,data:B}}),()=>l({type:Ha.UnregisterDroppable,key:i,id:n})),[n]),ce.useEffect(()=>{r!==h.current.disabled&&(l({type:Ha.SetDroppableDisabled,id:n,key:i,disabled:r}),h.current.disabled=r)},[n,i,r,l]),{active:o,rect:x,isOver:u?.id===n,node:te,over:u,setNodeRef:re}}function EN(e){let{animation:t,children:r}=e;const[n,a]=ce.useState(null),[i,o]=ce.useState(null),l=$d(r);return!r&&!n&&l&&a(l),cc(()=>{if(!i)return;const u=n?.key,f=n?.props.id;if(u==null||f==null){a(null);return}Promise.resolve(t(f,i)).then(()=>{a(null)})},[t,n,i]),ra.createElement(ra.Fragment,null,r,n?ce.cloneElement(n,{ref:o}):null)}const AN={x:0,y:0,scaleX:1,scaleY:1};function NN(e){let{children:t}=e;return ra.createElement(hh.Provider,{value:i5},ra.createElement(wp.Provider,{value:AN},t))}const TN={position:"fixed",touchAction:"none"},CN=e=>hm(e)?"transform 250ms ease":void 0,PN=ce.forwardRef((e,t)=>{let{as:r,activatorEvent:n,adjustScale:a,children:i,className:o,rect:l,style:u,transform:f,transition:h=CN}=e;if(!l)return null;const g=a?f:{...f,scaleX:1,scaleY:1},x={...TN,width:l.width,height:l.height,top:l.top,left:l.left,transform:G0.Transform.toString(g),transformOrigin:a&&n?_6(n,l):void 0,transition:typeof h=="function"?h(n):h,...u};return ra.createElement(r,{className:o,style:x,ref:t},i)}),LN=e=>t=>{let{active:r,dragOverlay:n}=t;const a={},{styles:i,className:o}=e;if(i!=null&&i.active)for(const[l,u]of Object.entries(i.active))u!==void 0&&(a[l]=r.node.style.getPropertyValue(l),r.node.style.setProperty(l,u));if(i!=null&&i.dragOverlay)for(const[l,u]of Object.entries(i.dragOverlay))u!==void 0&&n.node.style.setProperty(l,u);return o!=null&&o.active&&r.node.classList.add(o.active),o!=null&&o.dragOverlay&&n.node.classList.add(o.dragOverlay),function(){for(const[u,f]of Object.entries(a))r.node.style.setProperty(u,f);o!=null&&o.active&&r.node.classList.remove(o.active)}},FN=e=>{let{transform:{initial:t,final:r}}=e;return[{transform:G0.Transform.toString(t)},{transform:G0.Transform.toString(r)}]},ON={duration:250,easing:"ease",keyframes:FN,sideEffects:LN({styles:{active:{opacity:"0"}}})};function IN(e){let{config:t,draggableNodes:r,droppableContainers:n,measuringConfiguration:a}=e;return vp((i,o)=>{if(t===null)return;const l=r.get(i);if(!l)return;const u=l.node.current;if(!u)return;const f=a5(o);if(!f)return;const{transform:h}=ys(o).getComputedStyle(o),g=Kw(h);if(!g)return;const x=typeof t=="function"?t:RN(t);return e5(u,a.draggable.measure),x({active:{id:i,data:l.data,node:u,rect:a.draggable.measure(u)},draggableNodes:r,dragOverlay:{node:o,rect:a.dragOverlay.measure(f)},droppableContainers:n,measuringConfiguration:a,transform:g})})}function RN(e){const{duration:t,easing:r,sideEffects:n,keyframes:a}={...ON,...e};return i=>{let{active:o,dragOverlay:l,transform:u,...f}=i;if(!t)return;const h={x:l.rect.left-o.rect.left,y:l.rect.top-o.rect.top},g={scaleX:u.scaleX!==1?o.rect.width*u.scaleX/l.rect.width:1,scaleY:u.scaleY!==1?o.rect.height*u.scaleY/l.rect.height:1},x={x:u.x-h.x,y:u.y-h.y,...g},m=a({...f,active:o,dragOverlay:l,transform:{initial:u,final:x}}),[k]=m,b=m[m.length-1];if(JSON.stringify(k)===JSON.stringify(b))return;const E=n?.({active:o,dragOverlay:l,...f}),N=l.node.animate(m,{duration:t,easing:r,fill:"forwards"});return new Promise(O=>{N.onfinish=()=>{E?.(),O()}})}}let yx=0;function DN(e){return ce.useMemo(()=>{if(e!=null)return yx++,yx},[e])}const jN=ra.memo(e=>{let{adjustScale:t=!1,children:r,dropAnimation:n,style:a,transition:i,modifiers:o,wrapperElement:l="div",className:u,zIndex:f=999}=e;const{activatorEvent:h,active:g,activeNodeRect:x,containerNodeRect:m,draggableNodes:k,droppableContainers:b,dragOverlay:E,over:N,measuringConfiguration:O,scrollableAncestors:F,scrollableAncestorRects:K,windowRect:te}=_N(),re=ce.useContext(wp),B=DN(g?.id),V=o5(o,{activatorEvent:h,active:g,activeNodeRect:x,containerNodeRect:m,draggingNodeRect:E.rect,over:N,overlayNodeRect:E.rect,scrollableAncestors:F,scrollableAncestorRects:K,transform:re,windowRect:te}),Y=vm(x),ye=IN({config:n,draggableNodes:k,droppableContainers:b,measuringConfiguration:O}),U=Y?E.setRef:void 0;return ra.createElement(NN,null,ra.createElement(EN,{animation:ye},g&&B?ra.createElement(PN,{key:B,id:g.id,ref:U,as:l,activatorEvent:h,adjustScale:t,className:u,transition:i,rect:Y,style:{zIndex:f,...a},transform:V},r):null))}),Pg=({client:e})=>{const{attributes:t,listeners:r,setNodeRef:n,transform:a,isDragging:i}=bN({id:`client-${e.id}`,data:{type:"client",client:e}}),o=a?{transform:`translate3d(${a.x}px, ${a.y}px, 0)`,zIndex:i?1e3:void 0}:void 0;return A.jsxs("div",{ref:n,style:o,...r,...t,className:`
        p-3 rounded-lg border shadow-sm flex items-center gap-3 cursor-grab active:cursor-grabbing
        transition-colors duration-200 touch-none mb-2
        ${i?"bg-blue-50 border-blue-300 shadow-lg opacity-80":"bg-white hover:bg-gray-50 border-gray-200"}
      `,children:[A.jsx("div",{className:"text-gray-400",children:A.jsx(Hy,{size:16})}),A.jsxs("div",{className:"flex-1",children:[A.jsx("div",{className:"font-medium text-sm text-gray-900",children:e.name}),A.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[A.jsx(Tu,{size:12}),e.passportNumber||"No Passport Info"]})]}),A.jsx("div",{className:`
        text-xs font-semibold px-2 py-1 rounded
        ${e.gender==="Male"?"bg-blue-100 text-blue-700":"bg-pink-100 text-pink-700"}
      `,children:e.gender==="Male"?"M":"F"})]})},MN=({room:e,clients:t,onDelete:r})=>{const{isOver:n,setNodeRef:a}=l5({id:`room-${e.id}`,data:{type:"room",room:e}}),i=()=>{switch(e.capacity){case 2:return A.jsx(t3,{size:20,className:"text-gray-600"});default:return A.jsx(zy,{size:20,className:"text-gray-600"})}},o=()=>Math.round(t.length/e.capacity*100);return A.jsxs("div",{ref:a,className:`
        relative rounded-xl border-2 transition-all duration-200
        ${n?"border-primary-500 bg-primary-50 ring-2 ring-primary-200":"border-gray-200 bg-white hover:border-gray-300"}
        ${t.length>=e.capacity?"border-red-200 bg-red-50":""}
      `,children:[A.jsxs("div",{className:"p-4 border-b border-gray-100 flex items-start justify-between",children:[A.jsxs("div",{children:[A.jsxs("h3",{className:"font-semibold text-lg text-gray-900 flex items-center gap-2",children:[i(),"Room ",e.roomNumber]}),A.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:[e.type,"  Floor ",e.floorNumber]})]}),A.jsxs("div",{className:"flex items-center gap-2",children:[A.jsxs("div",{className:`
              px-3 py-1 rounded-full text-sm font-medium flex items-center gap-1
              ${t.length>=e.capacity?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}
            `,children:[A.jsx(Gy,{size:14}),t.length,"/",e.capacity]}),r&&A.jsx("button",{onClick:l=>{l.stopPropagation(),window.confirm("      ")&&r(e.id)},className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors",title:" ",children:A.jsx(Rd,{size:16})})]})]}),A.jsx("div",{className:"h-1 bg-gray-100 w-full overflow-hidden",children:A.jsx("div",{className:`h-full transition-all duration-500 ${t.length>=e.capacity?"bg-red-500":"bg-green-500"}`,style:{width:`${o()}%`}})}),A.jsx("div",{className:"p-4 min-h-[120px] space-y-2",children:t.length===0?A.jsx("div",{className:"h-full flex flex-col items-center justify-center text-gray-400 text-sm py-4 border-2 border-dashed border-gray-100 rounded-lg",children:A.jsx("span",{children:"Drop clients here"})}):t.map(l=>A.jsx(Pg,{client:l},l.id))})]})},BN=({onSave:e,onCancel:t})=>{const[r,n]=ce.useState({hotelName:"",city:"Makkah",type:"Double",capacity:2,floorNumber:0,roomNumber:""}),a=o=>{if(o.preventDefault(),!r.hotelName||!r.roomNumber){alert("Please fill in required fields");return}e(r)},i=o=>{let l=2;o==="Triple"&&(l=3),o==="Quad"&&(l=4),o==="Quint"&&(l=5),n({...r,type:o,capacity:l})};return A.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-[100]",children:A.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full overflow-hidden border border-gray-100 dark:border-gray-700 animate-in fade-in zoom-in duration-200",children:[A.jsxs("div",{className:"p-6 border-b border-gray-100 dark:border-gray-700 flex justify-between items-center bg-gray-50/50",children:[A.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[A.jsx(c2,{className:"text-blue-600"}),"  "]}),A.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:A.jsx(em,{size:24})})]}),A.jsxs("form",{onSubmit:a,className:"p-6 space-y-5",children:[A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:" "}),A.jsxs("div",{className:"relative",children:[A.jsx(c2,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),A.jsx("input",{required:!0,type:"text",className:"w-full pl-10 pr-4 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-500 outline-none bg-white dark:bg-gray-900 text-gray-900 dark:text-white",placeholder:":   ",value:r.hotelName,onChange:o=>n({...r,hotelName:o.target.value})})]})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:""}),A.jsxs("div",{className:"flex bg-gray-100 dark:bg-gray-900 p-1 rounded-xl",children:[A.jsx("button",{type:"button",onClick:()=>n({...r,city:"Makkah"}),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${r.city==="Makkah"?"bg-white dark:bg-gray-800 shadow-sm text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:" "}),A.jsx("button",{type:"button",onClick:()=>n({...r,city:"Madinah"}),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${r.city==="Madinah"?"bg-white dark:bg-gray-800 shadow-sm text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:" "})]})]}),A.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:" "}),A.jsxs("div",{className:"relative",children:[A.jsx(s3,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),A.jsx("input",{required:!0,type:"text",className:"w-full pl-10 pr-4 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-500 outline-none bg-white dark:bg-gray-900 text-gray-900 dark:text-white",placeholder:" ",value:r.roomNumber,onChange:o=>n({...r,roomNumber:o.target.value})})]})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:""}),A.jsxs("div",{className:"relative",children:[A.jsx(o3,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),A.jsx("input",{type:"number",className:"w-full pl-10 pr-4 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-500 outline-none bg-white dark:bg-gray-900 text-gray-900 dark:text-white",placeholder:"",value:r.floorNumber,onChange:o=>n({...r,floorNumber:parseInt(o.target.value)||0})})]})]})]}),A.jsxs("div",{children:[A.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:" "}),A.jsx("div",{className:"grid grid-cols-2 gap-2",children:["Double","Triple","Quad","Quint"].map(o=>A.jsx("button",{type:"button",onClick:()=>i(o),className:`px-3 py-2 rounded-lg border text-sm font-medium transition-all ${r.type===o?"bg-blue-600 text-white border-blue-600":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border-gray-200 dark:border-gray-700 hover:border-blue-400"}`,children:o},o))})]}),A.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-xl flex items-center justify-between",children:[A.jsxs("div",{className:"flex items-center gap-2 text-blue-700 dark:text-blue-400 font-medium",children:[A.jsx(Gy,{size:20})," "]}),A.jsx("span",{className:"text-2xl font-bold text-blue-800 dark:text-blue-300",children:r.capacity})]}),A.jsxs("div",{className:"pt-4 flex gap-3",children:[A.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-3 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-700 dark:text-gray-300 font-medium hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:""}),A.jsxs("button",{type:"submit",className:"flex-1 px-4 py-3 bg-blue-600 text-white rounded-xl font-bold shadow-lg shadow-blue-200 dark:shadow-none hover:bg-blue-700 transition-all flex items-center justify-center gap-2",children:[A.jsx(Qg,{size:20})," "]})]})]})]})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var c5=1252,UN=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],xm={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},ym=function(e){UN.indexOf(e)!=-1&&(c5=xm[0]=e)};function zN(){ym(1252)}var al=function(e){ym(e)};function u5(){al(1200),zN()}function wx(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function qN(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function f5(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var v0=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?qN(e.slice(2)):t==254&&r==255?f5(e.slice(2)):t==65279?e.slice(1):e},dd=function(t){return String.fromCharCode(t)},bx=function(t){return String.fromCharCode(t)},X0,$c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function _x(e){for(var t="",r=0,n=0,a=0,i=0,o=0,l=0,u=0,f=0;f<e.length;)r=e.charCodeAt(f++),i=r>>2,n=e.charCodeAt(f++),o=(r&3)<<4|n>>4,a=e.charCodeAt(f++),l=(n&15)<<2|a>>6,u=a&63,isNaN(n)?l=u=64:isNaN(a)&&(u=64),t+=$c.charAt(i)+$c.charAt(o)+$c.charAt(l)+$c.charAt(u);return t}function ao(e){var t="",r=0,n=0,a=0,i=0,o=0,l=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)i=$c.indexOf(e.charAt(f++)),o=$c.indexOf(e.charAt(f++)),r=i<<2|o>>4,t+=String.fromCharCode(r),l=$c.indexOf(e.charAt(f++)),n=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),u=$c.indexOf(e.charAt(f++)),a=(l&3)<<6|u,u!==64&&(t+=String.fromCharCode(a));return t}var on=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ou=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Yc(e){return on?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function kx(e){return on?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var nl=function(t){return on?Ou(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Iu(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function wm(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return wm(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var zc=on?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Ou(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function $N(e){for(var t=[],r=0,n=e.length+250,a=Yc(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)a[r++]=o;else if(o<2048)a[r++]=192|o>>6&31,a[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++i)&1023;a[r++]=240|o>>8&7,a[r++]=128|o>>2&63,a[r++]=128|l>>6&15|(o&3)<<4,a[r++]=128|l&63}else a[r++]=224|o>>12&15,a[r++]=128|o>>6&63,a[r++]=128|o&63;r>n&&(t.push(a.slice(0,r)),r=0,a=Yc(65535),n=65530)}return t.push(a.slice(0,r)),zc(t)}var vs=/\u0000/g,x0=/[\u0001-\u0006]/g;function Ff(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function il(e,t){var r=""+e;return r.length>=t?r:da("0",t-r.length)+r}function bm(e,t){var r=""+e;return r.length>=t?r:da(" ",t-r.length)+r}function Gd(e,t){var r=""+e;return r.length>=t?r:r+da(" ",t-r.length)}function HN(e,t){var r=""+Math.round(e);return r.length>=t?r:da("0",t-r.length)+r}function VN(e,t){var r=""+e;return r.length>=t?r:da("0",t-r.length)+r}var Sx=Math.pow(2,32);function pf(e,t){if(e>Sx||e<-Sx)return HN(e,t);var r=Math.round(e);return VN(r,t)}function Yd(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Ex=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],z1=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function WN(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Wr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Ax={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},KN={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Xd(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,o=1,l=0,u=1,f=0,h=0,g=Math.floor(a);f<t&&(g=Math.floor(a),l=g*o+i,h=g*f+u,!(a-g<5e-8));)a=1/(a-g),i=o,o=l,u=f,f=h;if(h>t&&(f>t?(h=u,l=i):(h=f,l=o)),!r)return[0,n*l,h];var x=Math.floor(n*l/h);return[x,n*l-x*h,h]}function Su(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,o=[],l={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var u=new Date(1900,0,1);u.setDate(u.getDate()+n-1),o=[u.getFullYear(),u.getMonth()+1,u.getDate()],i=u.getDay(),n<60&&(i=(i+6)%7),r&&(i=ZN(u,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=i,l}var h5=new Date(1899,11,31,0,0,0),GN=h5.getTime(),YN=new Date(1900,2,1,0,0,0);function d5(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=YN&&(r+=24*60*60*1e3),(r-(GN+(e.getTimezoneOffset()-h5.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function _m(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function XN(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function JN(e){var t=e<0?12:11,r=_m(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function QN(e){var t=_m(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function J0(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=JN(e):t===10?r=e.toFixed(10).substr(0,12):r=QN(e),_m(XN(r.toUpperCase()))}function Cu(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):J0(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return No(14,d5(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function ZN(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function eT(e,t,r,n){var a="",i=0,o=0,l=r.y,u,f=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:u=l%100,f=2;break;default:u=l%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:u=r.m,f=t.length;break;case 3:return z1[r.m-1][1];case 5:return z1[r.m-1][0];default:return z1[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:u=r.d,f=t.length;break;case 3:return Ex[r.q][0];default:return Ex[r.q][1]}break;case 104:switch(t.length){case 1:case 2:u=1+(r.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:u=r.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:u=r.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?il(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),t==="s"?i===0?"0":""+i/o:(a=il(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":u=r.D*24+r.H;break;case"[m]":case"[mm]":u=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":u=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:u=l,f=1;break}var h=f>0?il(u,f):"";return h}function Hc(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var p5=/%/g;function tT(e,t,r){var n=t.replace(p5,""),a=t.length-n.length;return ic(e,n,r*Math.pow(10,2*a))+da("%",a)}function rT(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ic(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function g5(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+g5(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,f,h){return u+f+h.substr(0,(a+i)%a)+"."+h.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var m5=/# (\?+)( ?)\/( ?)(\d+)/;function nT(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),o=a-i*n,l=n;return r+(i===0?"":""+i)+" "+(o===0?da(" ",e[1].length+1+e[4].length):bm(o,e[1].length)+e[2]+"/"+e[3]+il(l,e[4].length))}function aT(e,t,r){return r+(t===0?"":""+t)+da(" ",e[1].length+2+e[4].length)}var v5=/^#*0*\.([0#]+)/,x5=/\).*[0#]/,y5=/\(###\) ###\\?-####/;function ps(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Nx(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Tx(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function iT(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function sT(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function So(e,t,r){if(e.charCodeAt(0)===40&&!t.match(x5)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?So("n",n,r):"("+So("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return rT(e,t,r);if(t.indexOf("%")!==-1)return tT(e,t,r);if(t.indexOf("E")!==-1)return g5(t,r);if(t.charCodeAt(0)===36)return"$"+So(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,o,l,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+pf(u,t.length);if(t.match(/^[#?]+$/))return a=pf(r,0),a==="0"&&(a=""),a.length>t.length?a:ps(t.substr(0,t.length-a.length))+a;if(i=t.match(m5))return nT(i,u,f);if(t.match(/^#+0+$/))return f+pf(u,t.length-t.indexOf("0"));if(i=t.match(v5))return a=Nx(r,i[1].length).replace(/^([^\.]+)$/,"$1."+ps(i[1])).replace(/\.$/,"."+ps(i[1])).replace(/\.(\d*)$/,function(k,b){return"."+b+da("0",ps(i[1]).length-b.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return f+Nx(u,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return f+Hc(pf(u,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+So(e,t,-r):Hc(""+(Math.floor(r)+iT(r,i[1].length)))+"."+il(Tx(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return So(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Ff(So(e,t.replace(/[\\-]/g,""),r)),o=0,Ff(Ff(t.replace(/\\/g,"")).replace(/[0#]/g,function(k){return o<a.length?a.charAt(o++):k==="0"?"0":""}));if(t.match(y5))return a=So(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var h="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=Xd(u,Math.pow(10,o)-1,!1),a=""+f,h=ic("n",i[1],l[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),a+=h+i[2]+"/"+i[3],h=Gd(l[2],o),h.length<i[4].length&&(h=ps(i[4].substr(i[4].length-h.length))+h),a+=h,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=Xd(u,Math.pow(10,o)-1,!0),f+(l[0]||(l[1]?"":"0"))+" "+(l[1]?bm(l[1],o)+i[2]+"/"+i[3]+Gd(l[2],o):da(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=pf(r,0),t.length<=a.length?a:ps(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var g=t.indexOf(".")-o,x=t.length-a.length-g;return ps(t.substr(0,g)+a+t.substr(t.length-x))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=Tx(r,i[1].length),r<0?"-"+So(e,t,-r):Hc(sT(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?il(0,3-k.length):"")+k})+"."+il(o,i[1].length);switch(t){case"###,##0.00":return So(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Hc(pf(u,0));return m!=="0"?f+m:"";case"###,###.00":return So(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return So(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function oT(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ic(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function lT(e,t,r){var n=t.replace(p5,""),a=t.length-n.length;return ic(e,n,r*Math.pow(10,2*a))+da("%",a)}function w5(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+w5(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,f,h){return u+f+h.substr(0,(a+i)%a)+"."+h.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Pl(e,t,r){if(e.charCodeAt(0)===40&&!t.match(x5)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Pl("n",n,r):"("+Pl("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return oT(e,t,r);if(t.indexOf("%")!==-1)return lT(e,t,r);if(t.indexOf("E")!==-1)return w5(t,r);if(t.charCodeAt(0)===36)return"$"+Pl(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,o,l,u=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+il(u,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:ps(t.substr(0,t.length-a.length))+a;if(i=t.match(m5))return aT(i,u,f);if(t.match(/^#+0+$/))return f+il(u,t.length-t.indexOf("0"));if(i=t.match(v5))return a=(""+r).replace(/^([^\.]+)$/,"$1."+ps(i[1])).replace(/\.$/,"."+ps(i[1])),a=a.replace(/\.(\d*)$/,function(k,b){return"."+b+da("0",ps(i[1]).length-b.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return f+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return f+Hc(""+u);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Pl(e,t,-r):Hc(""+r)+"."+da("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Pl(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Ff(Pl(e,t.replace(/[\\-]/g,""),r)),o=0,Ff(Ff(t.replace(/\\/g,"")).replace(/[0#]/g,function(k){return o<a.length?a.charAt(o++):k==="0"?"0":""}));if(t.match(y5))return a=Pl(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var h="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=Xd(u,Math.pow(10,o)-1,!1),a=""+f,h=ic("n",i[1],l[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),a+=h+i[2]+"/"+i[3],h=Gd(l[2],o),h.length<i[4].length&&(h=ps(i[4].substr(i[4].length-h.length))+h),a+=h,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=Xd(u,Math.pow(10,o)-1,!0),f+(l[0]||(l[1]?"":"0"))+" "+(l[1]?bm(l[1],o)+i[2]+"/"+i[3]+Gd(l[2],o):da(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:ps(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var g=t.indexOf(".")-o,x=t.length-a.length-g;return ps(t.substr(0,g)+a+t.substr(t.length-x))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Pl(e,t,-r):Hc(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?il(0,3-k.length):"")+k})+"."+il(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=Hc(""+u);return m!=="0"?f+m:"";default:if(t.match(/\.[0#?]*$/))return Pl(e,t.slice(0,t.lastIndexOf(".")),r)+ps(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ic(e,t,r){return(r|0)===r?Pl(e,t,r):So(e,t,r)}function cT(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var b5=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function $f(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Yd(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(b5))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function uT(e,t,r,n){for(var a=[],i="",o=0,l="",u="t",f,h,g,x="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!Yd(e,o))throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(g=e.charCodeAt(++o))!==34&&o<e.length;)i+=String.fromCharCode(g);a[a.length]={t:"t",v:i},++o;break;case"\\":var m=e.charAt(++o),k=m==="("||m===")"?m:"t";a[a.length]={t:k,v:m},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(f==null&&(f=Su(t,r,e.charAt(o+1)==="2"),f==null))return"";a[a.length]={t:"X",v:e.substr(o,2)},u=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=Su(t,r),f==null))return"";for(i=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)i+=l;l==="m"&&u.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=x),a[a.length]={t:l,v:i},u=l;break;case"A":case"a":case"":var b={t:l,v:l};if(f==null&&(f=Su(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(f!=null&&(b.v=f.H>=12?"P":"A"),b.t="T",x="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(f!=null&&(b.v=f.H>=12?"PM":"AM"),b.t="T",o+=5,x="h"):e.substr(o,5).toUpperCase()==="/"?(f!=null&&(b.v=f.H>=12?"":""),b.t="T",o+=5,x="h"):(b.t="t",++o),f==null&&b.t==="T")return"";a[a.length]=b,u=l;break;case"[":for(i=l;e.charAt(o++)!=="]"&&o<e.length;)i+=e.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(b5)){if(f==null&&(f=Su(t,r),f==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},u=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",$f(e)||(a[a.length]={t:"t",v:i}));break;case".":if(f!=null){for(i=l;++o<e.length&&(l=e.charAt(o))==="0";)i+=l;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)i+=l;a[a.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++o)===l;)i+=l;a[a.length]={t:l,v:i},u=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)i+=e.charAt(o);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:l,v:l},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"t",v:l},++o;break}var E=0,N=0,O;for(o=a.length-1,u="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=x,u="h",E<1&&(E=1);break;case"s":(O=a[o].v.match(/\.0+$/))&&(N=Math.max(N,O[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":u=a[o].t;break;case"m":u==="s"&&(a[o].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&a[o].v.match(/[Hh]/)&&(E=1),E<2&&a[o].v.match(/[Mm]/)&&(E=2),E<3&&a[o].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var F="",K;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=eT(a[o].t.charCodeAt(0),a[o].v,f,N),a[o].t="t";break;case"n":case"?":for(K=o+1;a[K]!=null&&((l=a[K].t)==="?"||l==="D"||(l===" "||l==="t")&&a[K+1]!=null&&(a[K+1].t==="?"||a[K+1].t==="t"&&a[K+1].v==="/")||a[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[K].v==="/"||a[K].v===" "&&a[K+1]!=null&&a[K+1].t=="?"));)a[o].v+=a[K].v,a[K]={v:"",t:";"},++K;F+=a[o].v,o=K-1;break;case"G":a[o].t="t",a[o].v=Cu(t,r);break}var te="",re,B;if(F.length>0){F.charCodeAt(0)==40?(re=t<0&&F.charCodeAt(0)===45?-t:t,B=ic("n",F,re)):(re=t<0&&n>1?-t:t,B=ic("n",F,re),re<0&&a[0]&&a[0].t=="t"&&(B=B.substr(1),a[0].v="-"+a[0].v)),K=B.length-1;var V=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){V=o;break}var Y=a.length;if(V===a.length&&B.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(K>=a[o].v.length-1?(K-=a[o].v.length,a[o].v=B.substr(K+1,a[o].v.length)):K<0?a[o].v="":(a[o].v=B.substr(0,K+1),K=-1),a[o].t="t",Y=o);K>=0&&Y<a.length&&(a[Y].v=B.substr(0,K+1)+a[Y].v)}else if(V!==a.length&&B.indexOf("E")===-1){for(K=B.indexOf(".")-1,o=V;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(h=a[o].v.indexOf(".")>-1&&o===V?a[o].v.indexOf(".")-1:a[o].v.length-1,te=a[o].v.substr(h+1);h>=0;--h)K>=0&&(a[o].v.charAt(h)==="0"||a[o].v.charAt(h)==="#")&&(te=B.charAt(K--)+te);a[o].v=te,a[o].t="t",Y=o}for(K>=0&&Y<a.length&&(a[Y].v=B.substr(0,K+1)+a[Y].v),K=B.indexOf(".")+1,o=V;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==V)){for(h=a[o].v.indexOf(".")>-1&&o===V?a[o].v.indexOf(".")+1:0,te=a[o].v.substr(0,h);h<a[o].v.length;++h)K<B.length&&(te+=B.charAt(K++));a[o].v=te,a[o].t="t",Y=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(re=n>1&&t<0&&o>0&&a[o-1].v==="-"?-t:t,a[o].v=ic(a[o].t,a[o].v,re),a[o].t="t");var ye="";for(o=0;o!==a.length;++o)a[o]!=null&&(ye+=a[o].v);return ye}var Cx=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Px(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function fT(e,t){var r=cT(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Cx),l=r[1].match(Cx);return Px(t,o)?[n,r[0]]:Px(t,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,i]}function No(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Wr)[e],n==null&&(n=r.table&&r.table[Ax[e]]||Wr[Ax[e]]),n==null&&(n=KN[e]||"General");break}if(Yd(n,0))return Cu(t,r);t instanceof Date&&(t=d5(t,r.date1904));var a=fT(n,t);if(Yd(a[1]))return Cu(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return uT(a[1],t,r,a[0])}function Au(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Wr[r]==null){t<0&&(t=r);continue}if(Wr[r]==e){t=r;break}}t<0&&(t=391)}return Wr[t]=e,t}function _5(){Wr=WN()}var hT={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},k5=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function dT(e){var t=typeof e=="number"?Wr[e]:e;return t=t.replace(k5,"(\\d+)"),new RegExp("^"+t+"$")}function pT(e,t,r){var n=-1,a=-1,i=-1,o=-1,l=-1,u=-1;(t.match(k5)||[]).forEach(function(g,x){var m=parseInt(r[x+1],10);switch(g.toLowerCase().charAt(0)){case"y":n=m;break;case"d":i=m;break;case"h":o=m;break;case"s":u=m;break;case"m":o>=0?l=m:a=m;break}}),u>=0&&l==-1&&a>=0&&(l=a,a=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var h=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return o==-1&&l==-1&&u==-1?f:n==-1&&a==-1&&i==-1?h:f+"T"+h}var gT=function(){var e={};e.version="1.2.0";function t(){for(var B=0,V=new Array(256),Y=0;Y!=256;++Y)B=Y,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,V[Y]=B;return typeof Int32Array<"u"?new Int32Array(V):V}var r=t();function n(B){var V=0,Y=0,ye=0,U=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ye=0;ye!=256;++ye)U[ye]=B[ye];for(ye=0;ye!=256;++ye)for(Y=B[ye],V=256+ye;V<4096;V+=256)Y=U[V]=Y>>>8^B[Y&255];var D=[];for(ye=1;ye!=16;++ye)D[ye-1]=typeof Int32Array<"u"?U.subarray(ye*256,ye*256+256):U.slice(ye*256,ye*256+256);return D}var a=n(r),i=a[0],o=a[1],l=a[2],u=a[3],f=a[4],h=a[5],g=a[6],x=a[7],m=a[8],k=a[9],b=a[10],E=a[11],N=a[12],O=a[13],F=a[14];function K(B,V){for(var Y=V^-1,ye=0,U=B.length;ye<U;)Y=Y>>>8^r[(Y^B.charCodeAt(ye++))&255];return~Y}function te(B,V){for(var Y=V^-1,ye=B.length-15,U=0;U<ye;)Y=F[B[U++]^Y&255]^O[B[U++]^Y>>8&255]^N[B[U++]^Y>>16&255]^E[B[U++]^Y>>>24]^b[B[U++]]^k[B[U++]]^m[B[U++]]^x[B[U++]]^g[B[U++]]^h[B[U++]]^f[B[U++]]^u[B[U++]]^l[B[U++]]^o[B[U++]]^i[B[U++]]^r[B[U++]];for(ye+=15;U<ye;)Y=Y>>>8^r[(Y^B[U++])&255];return~Y}function re(B,V){for(var Y=V^-1,ye=0,U=B.length,D=0,le=0;ye<U;)D=B.charCodeAt(ye++),D<128?Y=Y>>>8^r[(Y^D)&255]:D<2048?(Y=Y>>>8^r[(Y^(192|D>>6&31))&255],Y=Y>>>8^r[(Y^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,le=B.charCodeAt(ye++)&1023,Y=Y>>>8^r[(Y^(240|D>>8&7))&255],Y=Y>>>8^r[(Y^(128|D>>2&63))&255],Y=Y>>>8^r[(Y^(128|le>>6&15|(D&3)<<4))&255],Y=Y>>>8^r[(Y^(128|le&63))&255]):(Y=Y>>>8^r[(Y^(224|D>>12&15))&255],Y=Y>>>8^r[(Y^(128|D>>6&63))&255],Y=Y>>>8^r[(Y^(128|D&63))&255]);return~Y}return e.table=r,e.bstr=K,e.buf=te,e.str=re,e}(),fn=function(){var t={};t.version="1.2.1";function r(X,be){for(var fe=X.split("/"),he=be.split("/"),_e=0,ke=0,Qe=Math.min(fe.length,he.length);_e<Qe;++_e){if(ke=fe[_e].length-he[_e].length)return ke;if(fe[_e]!=he[_e])return fe[_e]<he[_e]?-1:1}return fe.length-he.length}function n(X){if(X.charAt(X.length-1)=="/")return X.slice(0,-1).indexOf("/")===-1?X:n(X.slice(0,-1));var be=X.lastIndexOf("/");return be===-1?X:X.slice(0,be+1)}function a(X){if(X.charAt(X.length-1)=="/")return a(X.slice(0,-1));var be=X.lastIndexOf("/");return be===-1?X:X.slice(be+1)}function i(X,be){typeof be=="string"&&(be=new Date(be));var fe=be.getHours();fe=fe<<6|be.getMinutes(),fe=fe<<5|be.getSeconds()>>>1,X.write_shift(2,fe);var he=be.getFullYear()-1980;he=he<<4|be.getMonth()+1,he=he<<5|be.getDate(),X.write_shift(2,he)}function o(X){var be=X.read_shift(2)&65535,fe=X.read_shift(2)&65535,he=new Date,_e=fe&31;fe>>>=5;var ke=fe&15;fe>>>=4,he.setMilliseconds(0),he.setFullYear(fe+1980),he.setMonth(ke-1),he.setDate(_e);var Qe=be&31;be>>>=5;var ut=be&63;return be>>>=6,he.setHours(be),he.setMinutes(ut),he.setSeconds(Qe<<1),he}function l(X){yi(X,0);for(var be={},fe=0;X.l<=X.length-4;){var he=X.read_shift(2),_e=X.read_shift(2),ke=X.l+_e,Qe={};switch(he){case 21589:fe=X.read_shift(1),fe&1&&(Qe.mtime=X.read_shift(4)),_e>5&&(fe&2&&(Qe.atime=X.read_shift(4)),fe&4&&(Qe.ctime=X.read_shift(4))),Qe.mtime&&(Qe.mt=new Date(Qe.mtime*1e3));break}X.l=ke,be[he]=Qe}return be}var u;function f(){return u||(u={})}function h(X,be){if(X[0]==80&&X[1]==75)return At(X,be);if((X[0]|32)==109&&(X[1]|32)==105)return Sn(X,be);if(X.length<512)throw new Error("CFB file size "+X.length+" < 512");var fe=3,he=512,_e=0,ke=0,Qe=0,ut=0,Xe=0,rt=[],nt=X.slice(0,512);yi(nt,0);var St=g(nt);switch(fe=St[0],fe){case 3:he=512;break;case 4:he=4096;break;case 0:if(St[1]==0)return At(X,be);default:throw new Error("Major Version: Expected 3 or 4 saw "+fe)}he!==512&&(nt=X.slice(0,he),yi(nt,28));var zt=X.slice(0,he);x(nt,fe);var It=nt.read_shift(4,"i");if(fe===3&&It!==0)throw new Error("# Directory Sectors: Expected 0 saw "+It);nt.l+=4,Qe=nt.read_shift(4,"i"),nt.l+=4,nt.chk("00100000","Mini Stream Cutoff Size: "),ut=nt.read_shift(4,"i"),_e=nt.read_shift(4,"i"),Xe=nt.read_shift(4,"i"),ke=nt.read_shift(4,"i");for(var Lt=-1,kt=0;kt<109&&(Lt=nt.read_shift(4,"i"),!(Lt<0));++kt)rt[kt]=Lt;var kr=m(X,he);E(Xe,ke,kr,he,rt);var Kr=O(kr,Qe,rt,he);Kr[Qe].name="!Directory",_e>0&&ut!==le&&(Kr[ut].name="!MiniFAT"),Kr[rt[0]].name="!FAT",Kr.fat_addrs=rt,Kr.ssz=he;var en={},En=[],ci=[],Ca=[];F(Qe,Kr,kr,En,_e,en,ci,ut),k(ci,Ca,En),En.shift();var Ga={FileIndex:ci,FullPaths:Ca};return be&&be.raw&&(Ga.raw={header:zt,sectors:kr}),Ga}function g(X){if(X[X.l]==80&&X[X.l+1]==75)return[0,0];X.chk(ue,"Header Signature: "),X.l+=16;var be=X.read_shift(2,"u");return[X.read_shift(2,"u"),be]}function x(X,be){var fe=9;switch(X.l+=2,fe=X.read_shift(2)){case 9:if(be!=3)throw new Error("Sector Shift: Expected 9 saw "+fe);break;case 12:if(be!=4)throw new Error("Sector Shift: Expected 12 saw "+fe);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+fe)}X.chk("0600","Mini Sector Shift: "),X.chk("000000000000","Reserved: ")}function m(X,be){for(var fe=Math.ceil(X.length/be)-1,he=[],_e=1;_e<fe;++_e)he[_e-1]=X.slice(_e*be,(_e+1)*be);return he[fe-1]=X.slice(fe*be),he}function k(X,be,fe){for(var he=0,_e=0,ke=0,Qe=0,ut=0,Xe=fe.length,rt=[],nt=[];he<Xe;++he)rt[he]=nt[he]=he,be[he]=fe[he];for(;ut<nt.length;++ut)he=nt[ut],_e=X[he].L,ke=X[he].R,Qe=X[he].C,rt[he]===he&&(_e!==-1&&rt[_e]!==_e&&(rt[he]=rt[_e]),ke!==-1&&rt[ke]!==ke&&(rt[he]=rt[ke])),Qe!==-1&&(rt[Qe]=he),_e!==-1&&he!=rt[he]&&(rt[_e]=rt[he],nt.lastIndexOf(_e)<ut&&nt.push(_e)),ke!==-1&&he!=rt[he]&&(rt[ke]=rt[he],nt.lastIndexOf(ke)<ut&&nt.push(ke));for(he=1;he<Xe;++he)rt[he]===he&&(ke!==-1&&rt[ke]!==ke?rt[he]=rt[ke]:_e!==-1&&rt[_e]!==_e&&(rt[he]=rt[_e]));for(he=1;he<Xe;++he)if(X[he].type!==0){if(ut=he,ut!=rt[ut])do ut=rt[ut],be[he]=be[ut]+"/"+be[he];while(ut!==0&&rt[ut]!==-1&&ut!=rt[ut]);rt[he]=-1}for(be[0]+="/",he=1;he<Xe;++he)X[he].type!==2&&(be[he]+="/")}function b(X,be,fe){for(var he=X.start,_e=X.size,ke=[],Qe=he;fe&&_e>0&&Qe>=0;)ke.push(be.slice(Qe*D,Qe*D+D)),_e-=D,Qe=_u(fe,Qe*4);return ke.length===0?$a(0):zc(ke).slice(0,X.size)}function E(X,be,fe,he,_e){var ke=le;if(X===le){if(be!==0)throw new Error("DIFAT chain shorter than expected")}else if(X!==-1){var Qe=fe[X],ut=(he>>>2)-1;if(!Qe)return;for(var Xe=0;Xe<ut&&(ke=_u(Qe,Xe*4))!==le;++Xe)_e.push(ke);E(_u(Qe,he-4),be-1,fe,he,_e)}}function N(X,be,fe,he,_e){var ke=[],Qe=[];_e||(_e=[]);var ut=he-1,Xe=0,rt=0;for(Xe=be;Xe>=0;){_e[Xe]=!0,ke[ke.length]=Xe,Qe.push(X[Xe]);var nt=fe[Math.floor(Xe*4/he)];if(rt=Xe*4&ut,he<4+rt)throw new Error("FAT boundary crossed: "+Xe+" 4 "+he);if(!X[nt])break;Xe=_u(X[nt],rt)}return{nodes:ke,data:Ux([Qe])}}function O(X,be,fe,he){var _e=X.length,ke=[],Qe=[],ut=[],Xe=[],rt=he-1,nt=0,St=0,zt=0,It=0;for(nt=0;nt<_e;++nt)if(ut=[],zt=nt+be,zt>=_e&&(zt-=_e),!Qe[zt]){Xe=[];var Lt=[];for(St=zt;St>=0;){Lt[St]=!0,Qe[St]=!0,ut[ut.length]=St,Xe.push(X[St]);var kt=fe[Math.floor(St*4/he)];if(It=St*4&rt,he<4+It)throw new Error("FAT boundary crossed: "+St+" 4 "+he);if(!X[kt]||(St=_u(X[kt],It),Lt[St]))break}ke[zt]={nodes:ut,data:Ux([Xe])}}return ke}function F(X,be,fe,he,_e,ke,Qe,ut){for(var Xe=0,rt=he.length?2:0,nt=be[X].data,St=0,zt=0,It;St<nt.length;St+=128){var Lt=nt.slice(St,St+128);yi(Lt,64),zt=Lt.read_shift(2),It=Nm(Lt,0,zt-rt),he.push(It);var kt={name:It,type:Lt.read_shift(1),color:Lt.read_shift(1),L:Lt.read_shift(4,"i"),R:Lt.read_shift(4,"i"),C:Lt.read_shift(4,"i"),clsid:Lt.read_shift(16),state:Lt.read_shift(4,"i"),start:0,size:0},kr=Lt.read_shift(2)+Lt.read_shift(2)+Lt.read_shift(2)+Lt.read_shift(2);kr!==0&&(kt.ct=K(Lt,Lt.l-8));var Kr=Lt.read_shift(2)+Lt.read_shift(2)+Lt.read_shift(2)+Lt.read_shift(2);Kr!==0&&(kt.mt=K(Lt,Lt.l-8)),kt.start=Lt.read_shift(4,"i"),kt.size=Lt.read_shift(4,"i"),kt.size<0&&kt.start<0&&(kt.size=kt.type=0,kt.start=le,kt.name=""),kt.type===5?(Xe=kt.start,_e>0&&Xe!==le&&(be[Xe].name="!StreamData")):kt.size>=4096?(kt.storage="fat",be[kt.start]===void 0&&(be[kt.start]=N(fe,kt.start,be.fat_addrs,be.ssz)),be[kt.start].name=kt.name,kt.content=be[kt.start].data.slice(0,kt.size)):(kt.storage="minifat",kt.size<0?kt.size=0:Xe!==le&&kt.start!==le&&be[Xe]&&(kt.content=b(kt,be[Xe].data,(be[ut]||{}).data))),kt.content&&yi(kt.content,0),ke[It]=kt,Qe.push(kt)}}function K(X,be){return new Date((eo(X,be+4)/1e7*Math.pow(2,32)+eo(X,be)/1e7-11644473600)*1e3)}function te(X,be){return f(),h(u.readFileSync(X),be)}function re(X,be){var fe=be&&be.type;switch(fe||on&&Buffer.isBuffer(X)&&(fe="buffer"),fe||"base64"){case"file":return te(X,be);case"base64":return h(nl(ao(X)),be);case"binary":return h(nl(X),be)}return h(X,be)}function B(X,be){var fe=be||{},he=fe.root||"Root Entry";if(X.FullPaths||(X.FullPaths=[]),X.FileIndex||(X.FileIndex=[]),X.FullPaths.length!==X.FileIndex.length)throw new Error("inconsistent CFB structure");X.FullPaths.length===0&&(X.FullPaths[0]=he+"/",X.FileIndex[0]={name:he,type:5}),fe.CLSID&&(X.FileIndex[0].clsid=fe.CLSID),V(X)}function V(X){var be="Sh33tJ5";if(!fn.find(X,"/"+be)){var fe=$a(4);fe[0]=55,fe[1]=fe[3]=50,fe[2]=54,X.FileIndex.push({name:be,type:2,content:fe,size:4,L:69,R:69,C:69}),X.FullPaths.push(X.FullPaths[0]+be),Y(X)}}function Y(X,be){B(X);for(var fe=!1,he=!1,_e=X.FullPaths.length-1;_e>=0;--_e){var ke=X.FileIndex[_e];switch(ke.type){case 0:he?fe=!0:(X.FileIndex.pop(),X.FullPaths.pop());break;case 1:case 2:case 5:he=!0,isNaN(ke.R*ke.L*ke.C)&&(fe=!0),ke.R>-1&&ke.L>-1&&ke.R==ke.L&&(fe=!0);break;default:fe=!0;break}}if(!(!fe&&!be)){var Qe=new Date(1987,1,19),ut=0,Xe=Object.create?Object.create(null):{},rt=[];for(_e=0;_e<X.FullPaths.length;++_e)Xe[X.FullPaths[_e]]=!0,X.FileIndex[_e].type!==0&&rt.push([X.FullPaths[_e],X.FileIndex[_e]]);for(_e=0;_e<rt.length;++_e){var nt=n(rt[_e][0]);he=Xe[nt],he||(rt.push([nt,{name:a(nt).replace("/",""),type:1,clsid:Fe,ct:Qe,mt:Qe,content:null}]),Xe[nt]=!0)}for(rt.sort(function(It,Lt){return r(It[0],Lt[0])}),X.FullPaths=[],X.FileIndex=[],_e=0;_e<rt.length;++_e)X.FullPaths[_e]=rt[_e][0],X.FileIndex[_e]=rt[_e][1];for(_e=0;_e<rt.length;++_e){var St=X.FileIndex[_e],zt=X.FullPaths[_e];if(St.name=a(zt).replace("/",""),St.L=St.R=St.C=-(St.color=1),St.size=St.content?St.content.length:0,St.start=0,St.clsid=St.clsid||Fe,_e===0)St.C=rt.length>1?1:-1,St.size=0,St.type=5;else if(zt.slice(-1)=="/"){for(ut=_e+1;ut<rt.length&&n(X.FullPaths[ut])!=zt;++ut);for(St.C=ut>=rt.length?-1:ut,ut=_e+1;ut<rt.length&&n(X.FullPaths[ut])!=n(zt);++ut);St.R=ut>=rt.length?-1:ut,St.type=1}else n(X.FullPaths[_e+1]||"")==n(zt)&&(St.R=_e+1),St.type=2}}}function ye(X,be){var fe=be||{};if(fe.fileType=="mad")return Gt(X,fe);switch(Y(X),fe.fileType){case"zip":return Xr(X,fe)}var he=function(It){for(var Lt=0,kt=0,kr=0;kr<It.FileIndex.length;++kr){var Kr=It.FileIndex[kr];if(Kr.content){var en=Kr.content.length;en>0&&(en<4096?Lt+=en+63>>6:kt+=en+511>>9)}}for(var En=It.FullPaths.length+3>>2,ci=Lt+7>>3,Ca=Lt+127>>7,Ga=ci+kt+En+Ca,Fn=Ga+127>>7,Ji=Fn<=109?0:Math.ceil((Fn-109)/127);Ga+Fn+Ji+127>>7>Fn;)Ji=++Fn<=109?0:Math.ceil((Fn-109)/127);var pr=[1,Ji,Fn,Ca,En,kt,Lt,0];return It.FileIndex[0].size=Lt<<6,pr[7]=(It.FileIndex[0].start=pr[0]+pr[1]+pr[2]+pr[3]+pr[4]+pr[5])+(pr[6]+7>>3),pr}(X),_e=$a(he[7]<<9),ke=0,Qe=0;{for(ke=0;ke<8;++ke)_e.write_shift(1,Te[ke]);for(ke=0;ke<8;++ke)_e.write_shift(2,0);for(_e.write_shift(2,62),_e.write_shift(2,3),_e.write_shift(2,65534),_e.write_shift(2,9),_e.write_shift(2,6),ke=0;ke<3;++ke)_e.write_shift(2,0);for(_e.write_shift(4,0),_e.write_shift(4,he[2]),_e.write_shift(4,he[0]+he[1]+he[2]+he[3]-1),_e.write_shift(4,0),_e.write_shift(4,4096),_e.write_shift(4,he[3]?he[0]+he[1]+he[2]-1:le),_e.write_shift(4,he[3]),_e.write_shift(-4,he[1]?he[0]-1:le),_e.write_shift(4,he[1]),ke=0;ke<109;++ke)_e.write_shift(-4,ke<he[2]?he[1]+ke:-1)}if(he[1])for(Qe=0;Qe<he[1];++Qe){for(;ke<236+Qe*127;++ke)_e.write_shift(-4,ke<he[2]?he[1]+ke:-1);_e.write_shift(-4,Qe===he[1]-1?le:Qe+1)}var ut=function(It){for(Qe+=It;ke<Qe-1;++ke)_e.write_shift(-4,ke+1);It&&(++ke,_e.write_shift(-4,le))};for(Qe=ke=0,Qe+=he[1];ke<Qe;++ke)_e.write_shift(-4,Le.DIFSECT);for(Qe+=he[2];ke<Qe;++ke)_e.write_shift(-4,Le.FATSECT);ut(he[3]),ut(he[4]);for(var Xe=0,rt=0,nt=X.FileIndex[0];Xe<X.FileIndex.length;++Xe)nt=X.FileIndex[Xe],nt.content&&(rt=nt.content.length,!(rt<4096)&&(nt.start=Qe,ut(rt+511>>9)));for(ut(he[6]+7>>3);_e.l&511;)_e.write_shift(-4,Le.ENDOFCHAIN);for(Qe=ke=0,Xe=0;Xe<X.FileIndex.length;++Xe)nt=X.FileIndex[Xe],nt.content&&(rt=nt.content.length,!(!rt||rt>=4096)&&(nt.start=Qe,ut(rt+63>>6)));for(;_e.l&511;)_e.write_shift(-4,Le.ENDOFCHAIN);for(ke=0;ke<he[4]<<2;++ke){var St=X.FullPaths[ke];if(!St||St.length===0){for(Xe=0;Xe<17;++Xe)_e.write_shift(4,0);for(Xe=0;Xe<3;++Xe)_e.write_shift(4,-1);for(Xe=0;Xe<12;++Xe)_e.write_shift(4,0);continue}nt=X.FileIndex[ke],ke===0&&(nt.start=nt.size?nt.start-1:le);var zt=ke===0&&fe.root||nt.name;if(rt=2*(zt.length+1),_e.write_shift(64,zt,"utf16le"),_e.write_shift(2,rt),_e.write_shift(1,nt.type),_e.write_shift(1,nt.color),_e.write_shift(-4,nt.L),_e.write_shift(-4,nt.R),_e.write_shift(-4,nt.C),nt.clsid)_e.write_shift(16,nt.clsid,"hex");else for(Xe=0;Xe<4;++Xe)_e.write_shift(4,0);_e.write_shift(4,nt.state||0),_e.write_shift(4,0),_e.write_shift(4,0),_e.write_shift(4,0),_e.write_shift(4,0),_e.write_shift(4,nt.start),_e.write_shift(4,nt.size),_e.write_shift(4,0)}for(ke=1;ke<X.FileIndex.length;++ke)if(nt=X.FileIndex[ke],nt.size>=4096)if(_e.l=nt.start+1<<9,on&&Buffer.isBuffer(nt.content))nt.content.copy(_e,_e.l,0,nt.size),_e.l+=nt.size+511&-512;else{for(Xe=0;Xe<nt.size;++Xe)_e.write_shift(1,nt.content[Xe]);for(;Xe&511;++Xe)_e.write_shift(1,0)}for(ke=1;ke<X.FileIndex.length;++ke)if(nt=X.FileIndex[ke],nt.size>0&&nt.size<4096)if(on&&Buffer.isBuffer(nt.content))nt.content.copy(_e,_e.l,0,nt.size),_e.l+=nt.size+63&-64;else{for(Xe=0;Xe<nt.size;++Xe)_e.write_shift(1,nt.content[Xe]);for(;Xe&63;++Xe)_e.write_shift(1,0)}if(on)_e.l=_e.length;else for(;_e.l<_e.length;)_e.write_shift(1,0);return _e}function U(X,be){var fe=X.FullPaths.map(function(Xe){return Xe.toUpperCase()}),he=fe.map(function(Xe){var rt=Xe.split("/");return rt[rt.length-(Xe.slice(-1)=="/"?2:1)]}),_e=!1;be.charCodeAt(0)===47?(_e=!0,be=fe[0].slice(0,-1)+be):_e=be.indexOf("/")!==-1;var ke=be.toUpperCase(),Qe=_e===!0?fe.indexOf(ke):he.indexOf(ke);if(Qe!==-1)return X.FileIndex[Qe];var ut=!ke.match(x0);for(ke=ke.replace(vs,""),ut&&(ke=ke.replace(x0,"!")),Qe=0;Qe<fe.length;++Qe)if((ut?fe[Qe].replace(x0,"!"):fe[Qe]).replace(vs,"")==ke||(ut?he[Qe].replace(x0,"!"):he[Qe]).replace(vs,"")==ke)return X.FileIndex[Qe];return null}var D=64,le=-2,ue="d0cf11e0a1b11ae1",Te=[208,207,17,224,161,177,26,225],Fe="00000000000000000000000000000000",Le={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:le,FREESECT:-1,HEADER_SIGNATURE:ue,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Fe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function me(X,be,fe){f();var he=ye(X,fe);u.writeFileSync(be,he)}function ne(X){for(var be=new Array(X.length),fe=0;fe<X.length;++fe)be[fe]=String.fromCharCode(X[fe]);return be.join("")}function Ee(X,be){var fe=ye(X,be);switch(be&&be.type||"buffer"){case"file":return f(),u.writeFileSync(be.filename,fe),fe;case"binary":return typeof fe=="string"?fe:ne(fe);case"base64":return _x(typeof fe=="string"?fe:ne(fe));case"buffer":if(on)return Buffer.isBuffer(fe)?fe:Ou(fe);case"array":return typeof fe=="string"?nl(fe):fe}return fe}var pe;function C(X){try{var be=X.InflateRaw,fe=new be;if(fe._processChunk(new Uint8Array([3,0]),fe._finishFlushFlag),fe.bytesRead)pe=X;else throw new Error("zlib does not expose bytesRead")}catch(he){console.error("cannot use native zlib: "+(he.message||he))}}function M(X,be){if(!pe)return Lr(X,be);var fe=pe.InflateRaw,he=new fe,_e=he._processChunk(X.slice(X.l),he._finishFlushFlag);return X.l+=he.bytesRead,_e}function z(X){return pe?pe.deflateRawSync(X):$t(X)}var H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ie=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],xe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ae(X){var be=(X<<1|X<<11)&139536|(X<<5|X<<15)&558144;return(be>>16|be>>8|be)&255}for(var de=typeof Uint8Array<"u",Me=de?new Uint8Array(256):[],ct=0;ct<256;++ct)Me[ct]=Ae(ct);function se(X,be){var fe=Me[X&255];return be<=8?fe>>>8-be:(fe=fe<<8|Me[X>>8&255],be<=16?fe>>>16-be:(fe=fe<<8|Me[X>>16&255],fe>>>24-be))}function bt(X,be){var fe=be&7,he=be>>>3;return(X[he]|(fe<=6?0:X[he+1]<<8))>>>fe&3}function Dt(X,be){var fe=be&7,he=be>>>3;return(X[he]|(fe<=5?0:X[he+1]<<8))>>>fe&7}function Je(X,be){var fe=be&7,he=be>>>3;return(X[he]|(fe<=4?0:X[he+1]<<8))>>>fe&15}function we(X,be){var fe=be&7,he=be>>>3;return(X[he]|(fe<=3?0:X[he+1]<<8))>>>fe&31}function mt(X,be){var fe=be&7,he=be>>>3;return(X[he]|(fe<=1?0:X[he+1]<<8))>>>fe&127}function qt(X,be,fe){var he=be&7,_e=be>>>3,ke=(1<<fe)-1,Qe=X[_e]>>>he;return fe<8-he||(Qe|=X[_e+1]<<8-he,fe<16-he)||(Qe|=X[_e+2]<<16-he,fe<24-he)||(Qe|=X[_e+3]<<24-he),Qe&ke}function xt(X,be,fe){var he=be&7,_e=be>>>3;return he<=5?X[_e]|=(fe&7)<<he:(X[_e]|=fe<<he&255,X[_e+1]=(fe&7)>>8-he),be+3}function _t(X,be,fe){var he=be&7,_e=be>>>3;return fe=(fe&1)<<he,X[_e]|=fe,be+1}function Et(X,be,fe){var he=be&7,_e=be>>>3;return fe<<=he,X[_e]|=fe&255,fe>>>=8,X[_e+1]=fe,be+8}function Bt(X,be,fe){var he=be&7,_e=be>>>3;return fe<<=he,X[_e]|=fe&255,fe>>>=8,X[_e+1]=fe&255,X[_e+2]=fe>>>8,be+16}function Jt(X,be){var fe=X.length,he=2*fe>be?2*fe:be+5,_e=0;if(fe>=be)return X;if(on){var ke=kx(he);if(X.copy)X.copy(ke);else for(;_e<X.length;++_e)ke[_e]=X[_e];return ke}else if(de){var Qe=new Uint8Array(he);if(Qe.set)Qe.set(X);else for(;_e<fe;++_e)Qe[_e]=X[_e];return Qe}return X.length=he,X}function nr(X){for(var be=new Array(X),fe=0;fe<X;++fe)be[fe]=0;return be}function cr(X,be,fe){var he=1,_e=0,ke=0,Qe=0,ut=0,Xe=X.length,rt=de?new Uint16Array(32):nr(32);for(ke=0;ke<32;++ke)rt[ke]=0;for(ke=Xe;ke<fe;++ke)X[ke]=0;Xe=X.length;var nt=de?new Uint16Array(Xe):nr(Xe);for(ke=0;ke<Xe;++ke)rt[_e=X[ke]]++,he<_e&&(he=_e),nt[ke]=0;for(rt[0]=0,ke=1;ke<=he;++ke)rt[ke+16]=ut=ut+rt[ke-1]<<1;for(ke=0;ke<Xe;++ke)ut=X[ke],ut!=0&&(nt[ke]=rt[ut+16]++);var St=0;for(ke=0;ke<Xe;++ke)if(St=X[ke],St!=0)for(ut=se(nt[ke],he)>>he-St,Qe=(1<<he+4-St)-1;Qe>=0;--Qe)be[ut|Qe<<St]=St&15|ke<<4;return he}var gr=de?new Uint16Array(512):nr(512),yr=de?new Uint16Array(32):nr(32);if(!de){for(var mr=0;mr<512;++mr)gr[mr]=0;for(mr=0;mr<32;++mr)yr[mr]=0}(function(){for(var X=[],be=0;be<32;be++)X.push(5);cr(X,yr,32);var fe=[];for(be=0;be<=143;be++)fe.push(8);for(;be<=255;be++)fe.push(9);for(;be<=279;be++)fe.push(7);for(;be<=287;be++)fe.push(8);cr(fe,gr,288)})();var Qt=function(){for(var be=de?new Uint8Array(32768):[],fe=0,he=0;fe<xe.length-1;++fe)for(;he<xe[fe+1];++he)be[he]=fe;for(;he<32768;++he)be[he]=29;var _e=de?new Uint8Array(259):[];for(fe=0,he=0;fe<ie.length-1;++fe)for(;he<ie[fe+1];++he)_e[he]=fe;function ke(ut,Xe){for(var rt=0;rt<ut.length;){var nt=Math.min(65535,ut.length-rt),St=rt+nt==ut.length;for(Xe.write_shift(1,+St),Xe.write_shift(2,nt),Xe.write_shift(2,~nt&65535);nt-- >0;)Xe[Xe.l++]=ut[rt++]}return Xe.l}function Qe(ut,Xe){for(var rt=0,nt=0,St=de?new Uint16Array(32768):[];nt<ut.length;){var zt=Math.min(65535,ut.length-nt);if(zt<10){for(rt=xt(Xe,rt,+(nt+zt==ut.length)),rt&7&&(rt+=8-(rt&7)),Xe.l=rt/8|0,Xe.write_shift(2,zt),Xe.write_shift(2,~zt&65535);zt-- >0;)Xe[Xe.l++]=ut[nt++];rt=Xe.l*8;continue}rt=xt(Xe,rt,+(nt+zt==ut.length)+2);for(var It=0;zt-- >0;){var Lt=ut[nt];It=(It<<5^Lt)&32767;var kt=-1,kr=0;if((kt=St[It])&&(kt|=nt&-32768,kt>nt&&(kt-=32768),kt<nt))for(;ut[kt+kr]==ut[nt+kr]&&kr<250;)++kr;if(kr>2){Lt=_e[kr],Lt<=22?rt=Et(Xe,rt,Me[Lt+1]>>1)-1:(Et(Xe,rt,3),rt+=5,Et(Xe,rt,Me[Lt-23]>>5),rt+=3);var Kr=Lt<8?0:Lt-4>>2;Kr>0&&(Bt(Xe,rt,kr-ie[Lt]),rt+=Kr),Lt=be[nt-kt],rt=Et(Xe,rt,Me[Lt]>>3),rt-=3;var en=Lt<4?0:Lt-2>>1;en>0&&(Bt(Xe,rt,nt-kt-xe[Lt]),rt+=en);for(var En=0;En<kr;++En)St[It]=nt&32767,It=(It<<5^ut[nt])&32767,++nt;zt-=kr-1}else Lt<=143?Lt=Lt+48:rt=_t(Xe,rt,1),rt=Et(Xe,rt,Me[Lt]),St[It]=nt&32767,++nt}rt=Et(Xe,rt,0)-1}return Xe.l=(rt+7)/8|0,Xe.l}return function(Xe,rt){return Xe.length<8?ke(Xe,rt):Qe(Xe,rt)}}();function $t(X){var be=$a(50+Math.floor(X.length*1.1)),fe=Qt(X,be);return be.slice(0,fe)}var wt=de?new Uint16Array(32768):nr(32768),Vr=de?new Uint16Array(32768):nr(32768),ur=de?new Uint16Array(128):nr(128),Tn=1,Ur=1;function Ut(X,be){var fe=we(X,be)+257;be+=5;var he=we(X,be)+1;be+=5;var _e=Je(X,be)+4;be+=4;for(var ke=0,Qe=de?new Uint8Array(19):nr(19),ut=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Xe=1,rt=de?new Uint8Array(8):nr(8),nt=de?new Uint8Array(8):nr(8),St=Qe.length,zt=0;zt<_e;++zt)Qe[H[zt]]=ke=Dt(X,be),Xe<ke&&(Xe=ke),rt[ke]++,be+=3;var It=0;for(rt[0]=0,zt=1;zt<=Xe;++zt)nt[zt]=It=It+rt[zt-1]<<1;for(zt=0;zt<St;++zt)(It=Qe[zt])!=0&&(ut[zt]=nt[It]++);var Lt=0;for(zt=0;zt<St;++zt)if(Lt=Qe[zt],Lt!=0){It=Me[ut[zt]]>>8-Lt;for(var kt=(1<<7-Lt)-1;kt>=0;--kt)ur[It|kt<<Lt]=Lt&7|zt<<3}var kr=[];for(Xe=1;kr.length<fe+he;)switch(It=ur[mt(X,be)],be+=It&7,It>>>=3){case 16:for(ke=3+bt(X,be),be+=2,It=kr[kr.length-1];ke-- >0;)kr.push(It);break;case 17:for(ke=3+Dt(X,be),be+=3;ke-- >0;)kr.push(0);break;case 18:for(ke=11+mt(X,be),be+=7;ke-- >0;)kr.push(0);break;default:kr.push(It),Xe<It&&(Xe=It);break}var Kr=kr.slice(0,fe),en=kr.slice(fe);for(zt=fe;zt<286;++zt)Kr[zt]=0;for(zt=he;zt<30;++zt)en[zt]=0;return Tn=cr(Kr,wt,286),Ur=cr(en,Vr,30),be}function Zn(X,be){if(X[0]==3&&!(X[1]&3))return[Yc(be),2];for(var fe=0,he=0,_e=kx(be||1<<18),ke=0,Qe=_e.length>>>0,ut=0,Xe=0;(he&1)==0;){if(he=Dt(X,fe),fe+=3,he>>>1)he>>1==1?(ut=9,Xe=5):(fe=Ut(X,fe),ut=Tn,Xe=Ur);else{fe&7&&(fe+=8-(fe&7));var rt=X[fe>>>3]|X[(fe>>>3)+1]<<8;if(fe+=32,rt>0)for(!be&&Qe<ke+rt&&(_e=Jt(_e,ke+rt),Qe=_e.length);rt-- >0;)_e[ke++]=X[fe>>>3],fe+=8;continue}for(;;){!be&&Qe<ke+32767&&(_e=Jt(_e,ke+32767),Qe=_e.length);var nt=qt(X,fe,ut),St=he>>>1==1?gr[nt]:wt[nt];if(fe+=St&15,St>>>=4,(St>>>8&255)===0)_e[ke++]=St;else{if(St==256)break;St-=257;var zt=St<8?0:St-4>>2;zt>5&&(zt=0);var It=ke+ie[St];zt>0&&(It+=qt(X,fe,zt),fe+=zt),nt=qt(X,fe,Xe),St=he>>>1==1?yr[nt]:Vr[nt],fe+=St&15,St>>>=4;var Lt=St<4?0:St-2>>1,kt=xe[St];for(Lt>0&&(kt+=qt(X,fe,Lt),fe+=Lt),!be&&Qe<It&&(_e=Jt(_e,It+100),Qe=_e.length);ke<It;)_e[ke]=_e[ke-kt],++ke}}}return be?[_e,fe+7>>>3]:[_e.slice(0,ke),fe+7>>>3]}function Lr(X,be){var fe=X.slice(X.l||0),he=Zn(fe,be);return X.l+=he[1],he[0]}function ga(X,be){if(X)typeof console<"u"&&console.error(be);else throw new Error(be)}function At(X,be){var fe=X;yi(fe,0);var he=[],_e=[],ke={FileIndex:he,FullPaths:_e};B(ke,{root:be.root});for(var Qe=fe.length-4;(fe[Qe]!=80||fe[Qe+1]!=75||fe[Qe+2]!=5||fe[Qe+3]!=6)&&Qe>=0;)--Qe;fe.l=Qe+4,fe.l+=4;var ut=fe.read_shift(2);fe.l+=6;var Xe=fe.read_shift(4);for(fe.l=Xe,Qe=0;Qe<ut;++Qe){fe.l+=20;var rt=fe.read_shift(4),nt=fe.read_shift(4),St=fe.read_shift(2),zt=fe.read_shift(2),It=fe.read_shift(2);fe.l+=8;var Lt=fe.read_shift(4),kt=l(fe.slice(fe.l+St,fe.l+St+zt));fe.l+=St+zt+It;var kr=fe.l;fe.l=Lt+4,Bn(fe,rt,nt,ke,kt),fe.l=kr}return ke}function Bn(X,be,fe,he,_e){X.l+=2;var ke=X.read_shift(2),Qe=X.read_shift(2),ut=o(X);if(ke&8257)throw new Error("Unsupported ZIP encryption");for(var Xe=X.read_shift(4),rt=X.read_shift(4),nt=X.read_shift(4),St=X.read_shift(2),zt=X.read_shift(2),It="",Lt=0;Lt<St;++Lt)It+=String.fromCharCode(X[X.l++]);if(zt){var kt=l(X.slice(X.l,X.l+zt));(kt[21589]||{}).mt&&(ut=kt[21589].mt),((_e||{})[21589]||{}).mt&&(ut=_e[21589].mt)}X.l+=zt;var kr=X.slice(X.l,X.l+rt);switch(Qe){case 8:kr=M(X,nt);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Qe)}var Kr=!1;ke&8&&(Xe=X.read_shift(4),Xe==134695760&&(Xe=X.read_shift(4),Kr=!0),rt=X.read_shift(4),nt=X.read_shift(4)),rt!=be&&ga(Kr,"Bad compressed size: "+be+" != "+rt),nt!=fe&&ga(Kr,"Bad uncompressed size: "+fe+" != "+nt),wr(he,It,kr,{unsafe:!0,mt:ut})}function Xr(X,be){var fe=be||{},he=[],_e=[],ke=$a(1),Qe=fe.compression?8:0,ut=0,Xe=0,rt=0,nt=0,St=0,zt=X.FullPaths[0],It=zt,Lt=X.FileIndex[0],kt=[],kr=0;for(Xe=1;Xe<X.FullPaths.length;++Xe)if(It=X.FullPaths[Xe].slice(zt.length),Lt=X.FileIndex[Xe],!(!Lt.size||!Lt.content||It=="Sh33tJ5")){var Kr=nt,en=$a(It.length);for(rt=0;rt<It.length;++rt)en.write_shift(1,It.charCodeAt(rt)&127);en=en.slice(0,en.l),kt[St]=gT.buf(Lt.content,0);var En=Lt.content;Qe==8&&(En=z(En)),ke=$a(30),ke.write_shift(4,67324752),ke.write_shift(2,20),ke.write_shift(2,ut),ke.write_shift(2,Qe),Lt.mt?i(ke,Lt.mt):ke.write_shift(4,0),ke.write_shift(-4,kt[St]),ke.write_shift(4,En.length),ke.write_shift(4,Lt.content.length),ke.write_shift(2,en.length),ke.write_shift(2,0),nt+=ke.length,he.push(ke),nt+=en.length,he.push(en),nt+=En.length,he.push(En),ke=$a(46),ke.write_shift(4,33639248),ke.write_shift(2,0),ke.write_shift(2,20),ke.write_shift(2,ut),ke.write_shift(2,Qe),ke.write_shift(4,0),ke.write_shift(-4,kt[St]),ke.write_shift(4,En.length),ke.write_shift(4,Lt.content.length),ke.write_shift(2,en.length),ke.write_shift(2,0),ke.write_shift(2,0),ke.write_shift(2,0),ke.write_shift(2,0),ke.write_shift(4,0),ke.write_shift(4,Kr),kr+=ke.l,_e.push(ke),kr+=en.length,_e.push(en),++St}return ke=$a(22),ke.write_shift(4,101010256),ke.write_shift(2,0),ke.write_shift(2,0),ke.write_shift(2,St),ke.write_shift(2,St),ke.write_shift(4,kr),ke.write_shift(4,nt),ke.write_shift(2,0),zc([zc(he),zc(_e),ke])}var Fr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ar(X,be){if(X.ctype)return X.ctype;var fe=X.name||"",he=fe.match(/\.([^\.]+)$/);return he&&Fr[he[1]]||be&&(he=(fe=be).match(/[\.\\]([^\.\\])+$/),he&&Fr[he[1]])?Fr[he[1]]:"application/octet-stream"}function Or(X){for(var be=_x(X),fe=[],he=0;he<be.length;he+=76)fe.push(be.slice(he,he+76));return fe.join(`\r
`)+`\r
`}function Ln(X){var be=X.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(rt){var nt=rt.charCodeAt(0).toString(16).toUpperCase();return"="+(nt.length==1?"0"+nt:nt)});be=be.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),be.charAt(0)==`
`&&(be="=0D"+be.slice(1)),be=be.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var fe=[],he=be.split(`\r
`),_e=0;_e<he.length;++_e){var ke=he[_e];if(ke.length==0){fe.push("");continue}for(var Qe=0;Qe<ke.length;){var ut=76,Xe=ke.slice(Qe,Qe+ut);Xe.charAt(ut-1)=="="?ut--:Xe.charAt(ut-2)=="="?ut-=2:Xe.charAt(ut-3)=="="&&(ut-=3),Xe=ke.slice(Qe,Qe+ut),Qe+=ut,Qe<ke.length&&(Xe+="="),fe.push(Xe)}}return fe.join(`\r
`)}function Jr(X){for(var be=[],fe=0;fe<X.length;++fe){for(var he=X[fe];fe<=X.length&&he.charAt(he.length-1)=="=";)he=he.slice(0,he.length-1)+X[++fe];be.push(he)}for(var _e=0;_e<be.length;++_e)be[_e]=be[_e].replace(/[=][0-9A-Fa-f]{2}/g,function(ke){return String.fromCharCode(parseInt(ke.slice(1),16))});return nl(be.join(`\r
`))}function ln(X,be,fe){for(var he="",_e="",ke="",Qe,ut=0;ut<10;++ut){var Xe=be[ut];if(!Xe||Xe.match(/^\s*$/))break;var rt=Xe.match(/^(.*?):\s*([^\s].*)$/);if(rt)switch(rt[1].toLowerCase()){case"content-location":he=rt[2].trim();break;case"content-type":ke=rt[2].trim();break;case"content-transfer-encoding":_e=rt[2].trim();break}}switch(++ut,_e.toLowerCase()){case"base64":Qe=nl(ao(be.slice(ut).join("")));break;case"quoted-printable":Qe=Jr(be.slice(ut));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+_e)}var nt=wr(X,he.slice(fe.length),Qe,{unsafe:!0});ke&&(nt.ctype=ke)}function Sn(X,be){if(ne(X.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var fe=be&&be.root||"",he=(on&&Buffer.isBuffer(X)?X.toString("binary"):ne(X)).split(`\r
`),_e=0,ke="";for(_e=0;_e<he.length;++_e)if(ke=he[_e],!!/^Content-Location:/i.test(ke)&&(ke=ke.slice(ke.indexOf("file")),fe||(fe=ke.slice(0,ke.lastIndexOf("/")+1)),ke.slice(0,fe.length)!=fe))for(;fe.length>0&&(fe=fe.slice(0,fe.length-1),fe=fe.slice(0,fe.lastIndexOf("/")+1),ke.slice(0,fe.length)!=fe););var Qe=(he[1]||"").match(/boundary="(.*?)"/);if(!Qe)throw new Error("MAD cannot find boundary");var ut="--"+(Qe[1]||""),Xe=[],rt=[],nt={FileIndex:Xe,FullPaths:rt};B(nt);var St,zt=0;for(_e=0;_e<he.length;++_e){var It=he[_e];It!==ut&&It!==ut+"--"||(zt++&&ln(nt,he.slice(St,_e),fe),St=_e)}return nt}function Gt(X,be){var fe=be||{},he=fe.boundary||"SheetJS";he="------="+he;for(var _e=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+he.slice(2)+'"',"","",""],ke=X.FullPaths[0],Qe=ke,ut=X.FileIndex[0],Xe=1;Xe<X.FullPaths.length;++Xe)if(Qe=X.FullPaths[Xe].slice(ke.length),ut=X.FileIndex[Xe],!(!ut.size||!ut.content||Qe=="Sh33tJ5")){Qe=Qe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(kr){return"_x"+kr.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(kr){return"_u"+kr.charCodeAt(0).toString(16)+"_"});for(var rt=ut.content,nt=on&&Buffer.isBuffer(rt)?rt.toString("binary"):ne(rt),St=0,zt=Math.min(1024,nt.length),It=0,Lt=0;Lt<=zt;++Lt)(It=nt.charCodeAt(Lt))>=32&&It<128&&++St;var kt=St>=zt*4/5;_e.push(he),_e.push("Content-Location: "+(fe.root||"file:///C:/SheetJS/")+Qe),_e.push("Content-Transfer-Encoding: "+(kt?"quoted-printable":"base64")),_e.push("Content-Type: "+ar(ut,Qe)),_e.push(""),_e.push(kt?Ln(nt):Or(nt))}return _e.push(he+`--\r
`),_e.join(`\r
`)}function yn(X){var be={};return B(be,X),be}function wr(X,be,fe,he){var _e=he&&he.unsafe;_e||B(X);var ke=!_e&&fn.find(X,be);if(!ke){var Qe=X.FullPaths[0];be.slice(0,Qe.length)==Qe?Qe=be:(Qe.slice(-1)!="/"&&(Qe+="/"),Qe=(Qe+be).replace("//","/")),ke={name:a(be),type:2},X.FileIndex.push(ke),X.FullPaths.push(Qe),_e||fn.utils.cfb_gc(X)}return ke.content=fe,ke.size=fe?fe.length:0,he&&(he.CLSID&&(ke.clsid=he.CLSID),he.mt&&(ke.mt=he.mt),he.ct&&(ke.ct=he.ct)),ke}function Dr(X,be){B(X);var fe=fn.find(X,be);if(fe){for(var he=0;he<X.FileIndex.length;++he)if(X.FileIndex[he]==fe)return X.FileIndex.splice(he,1),X.FullPaths.splice(he,1),!0}return!1}function nn(X,be,fe){B(X);var he=fn.find(X,be);if(he){for(var _e=0;_e<X.FileIndex.length;++_e)if(X.FileIndex[_e]==he)return X.FileIndex[_e].name=a(fe),X.FullPaths[_e]=fe,!0}return!1}function Qr(X){Y(X,!0)}return t.find=U,t.read=re,t.parse=h,t.write=Ee,t.writeFile=me,t.utils={cfb_new:yn,cfb_add:wr,cfb_del:Dr,cfb_mov:nn,cfb_gc:Qr,ReadShift:N0,CheckField:V5,prep_blob:yi,bconcat:zc,use_zlib:C,_deflateRaw:$t,_inflateRaw:Lr,consts:Le},t}();function mT(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Ol(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function km(e){for(var t=[],r=Ol(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var Jd=new Date(1899,11,30,0,0,0);function xs(e,t){var r=e.getTime(),n=Jd.getTime()+(e.getTimezoneOffset()-Jd.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var S5=new Date,vT=Jd.getTime()+(S5.getTimezoneOffset()-Jd.getTimezoneOffset())*6e4,Lx=S5.getTimezoneOffset();function bp(e){var t=new Date;return t.setTime(e*24*60*60*1e3+vT),t.getTimezoneOffset()!==Lx&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Lx)*6e4),t}function xT(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[i],10)}return t}var Fx=new Date("2017-02-19T19:06:09.000Z"),E5=isNaN(Fx.getFullYear())?new Date("2/19/17"):Fx,yT=E5.getFullYear()==2017;function li(e,t){var r=new Date(e);if(yT)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(E5.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Pu(e,t){if(on&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return w0(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return w0(f5(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return w0(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return w0(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function wi(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=wi(e[r]));return t}function da(e,t){for(var r="";r.length<t;)r+=e;return r}function sl(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var wT=["january","february","march","april","may","june","july","august","september","october","november","december"];function Rf(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&wT.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var bT=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),o=[i[0]],l=1;l<i.length;++l)o.push(a),o.push(i[l]);return o}}();function A5(e){return e?e.content&&e.type?Pu(e.content,!0):e.data?v0(e.data):e.asNodeBuffer&&on?v0(e.asNodeBuffer().toString("binary")):e.asBinary?v0(e.asBinary()):e._data&&e._data.getContent?v0(Pu(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function N5(e){if(!e)return null;if(e.data)return wx(e.data);if(e.asNodeBuffer&&on)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?wx(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function _T(e){return e&&e.name.slice(-4)===".bin"?N5(e):A5(e)}function Eo(e,t){for(var r=e.FullPaths||Ol(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||a==o)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function Sm(e,t){var r=Eo(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Ia(e,t,r){if(!r)return _T(Sm(e,t));if(!t)return null;try{return Ia(e,t)}catch{return null}}function ro(e,t,r){if(!r)return A5(Sm(e,t));if(!t)return null;try{return ro(e,t)}catch{return null}}function kT(e,t,r){return N5(Sm(e,t))}function Ox(e){for(var t=e.FullPaths||Ol(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function ST(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return on?n=Ou(r):n=$N(r),fn.utils.cfb_add(e,t,n)}fn.utils.cfb_add(e,t,r)}else e.file(t,r)}function T5(e,t){switch(t.type){case"base64":return fn.read(e,{type:"base64"});case"binary":return fn.read(e,{type:"binary"});case"buffer":case"array":return fn.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function y0(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var C5=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,ET=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Ix=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,AT=/<[^>]*>/g,Xi=C5.match(Ix)?Ix:AT,NT=/<\w*:/,TT=/<(\/?)\w+:/;function Rr(e,t,r){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var o=e.match(ET),l=0,u="",f=0,h="",g="",x=1;if(o)for(f=0;f!=o.length;++f){for(g=o[f],i=0;i!=g.length&&g.charCodeAt(i)!==61;++i);for(h=g.slice(0,i).trim();g.charCodeAt(i+1)==32;)++i;for(x=(a=g.charCodeAt(i+1))==34||a==39?1:0,u=g.slice(i+1+x,g.length-x),l=0;l!=h.length&&h.charCodeAt(l)!==58;++l);if(l===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),n[h]=u,n[h.toLowerCase()]=u;else{var m=(l===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(l+1);if(n[m]&&h.slice(l-3,l)=="ext")continue;n[m]=u,n[m.toLowerCase()]=u}}return n}function Dl(e){return e.replace(TT,"<$1")}var P5={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},CT=km(P5),pn=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(e,function(l,u){return P5[l]||String.fromCharCode(parseInt(u,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,u){return String.fromCharCode(parseInt(u,16))});var o=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,o)+r(a.slice(o+3))}}(),PT=/[&<>'"]/g,LT=/[\u0000-\u001f]/g;function Em(e){var t=e+"";return t.replace(PT,function(r){return CT[r]}).replace(/\n/g,"<br/>").replace(LT,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var Rx=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function ta(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function q1(e){for(var t="",r=0,n=0,a=0,i=0,o=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=a&63,t+=String.fromCharCode(o);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}o=e.charCodeAt(r++),l=((n&7)<<18|(a&63)<<12|(i&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function Dx(e){var t=Yc(2*e.length),r,n,a=1,i=0,o=0,l;for(n=0;n<e.length;n+=a)a=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),a=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[i++]=o&255,t[i++]=o>>>8,o=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function jx(e){return Ou(e,"binary").toString("utf8")}var pd="foo bar baz",Kn=on&&(jx(pd)==q1(pd)&&jx||Dx(pd)==q1(pd)&&Dx)||q1,w0=on?function(e){return Ou(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Q0=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),L5=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),FT=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),OT=/<\/?(?:vt:)?variant>/g,IT=/<(?:vt:)([^>]*)>([\s\S]*)</;function Mx(e,t){var r=Rr(e),n=e.match(FT(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var o=i.replace(OT,"").match(IT);o&&a.push({v:Kn(o[2]),t:o[1]})}),a}var RT=/(^\s|\s$|\n)/;function DT(e){return Ol(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function jT(e,t,r){return"<"+e+(r!=null?DT(r):"")+(t!=null?(t.match(RT)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Am(e){if(on&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Kn(Iu(wm(e)));throw new Error("Bad input format: expected Buffer or string")}var Z0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,MT={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},BT=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function UT(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function zT(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,o=n?-t:t;isFinite(o)?o==0?a=i=0:(a=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var l=0;l<=5;++l,i/=256)e[r+l]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var Bx=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},Ux=on?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Ou(t)})):Bx(e)}:Bx,zx=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(nc(e,a)));return n.join("").replace(vs,"")},Nm=on?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(vs,""):zx(e,t,r)}:zx,qx=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},F5=on?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):qx(e,t,r)}:qx,$x=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(wf(e,a)));return n.join("")},dh=on?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):$x(t,r,n)}:$x,O5=function(e,t){var r=eo(e,t);return r>0?dh(e,t+4,t+4+r-1):""},I5=O5,R5=function(e,t){var r=eo(e,t);return r>0?dh(e,t+4,t+4+r-1):""},D5=R5,j5=function(e,t){var r=2*eo(e,t);return r>0?dh(e,t+4,t+4+r-1):""},M5=j5,B5=function(t,r){var n=eo(t,r);return n>0?Nm(t,r+4,r+4+n):""},U5=B5,z5=function(e,t){var r=eo(e,t);return r>0?dh(e,t+4,t+4+r):""},q5=z5,$5=function(e,t){return UT(e,t)},Qd=$5,H5=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};on&&(I5=function(t,r){if(!Buffer.isBuffer(t))return O5(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},D5=function(t,r){if(!Buffer.isBuffer(t))return R5(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},M5=function(t,r){if(!Buffer.isBuffer(t))return j5(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},U5=function(t,r){if(!Buffer.isBuffer(t))return B5(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},q5=function(t,r){if(!Buffer.isBuffer(t))return z5(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Qd=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):$5(t,r)},H5=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var wf=function(e,t){return e[t]},nc=function(e,t){return e[t+1]*256+e[t]},qT=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},eo=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},_u=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},$T=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function N0(e,t){var r="",n,a,i=[],o,l,u,f;switch(t){case"dbcs":if(f=this.l,on&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(u=0;u<e;++u)r+=String.fromCharCode(nc(this,f)),f+=2;e*=2;break;case"utf8":r=dh(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Nm(this,this.l,this.l+e);break;case"wstr":return N0.call(this,e,"dbcs");case"lpstr-ansi":r=I5(this,this.l),e=4+eo(this,this.l);break;case"lpstr-cp":r=D5(this,this.l),e=4+eo(this,this.l);break;case"lpwstr":r=M5(this,this.l),e=4+2*eo(this,this.l);break;case"lpp4":e=4+eo(this,this.l),r=U5(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+eo(this,this.l),r=q5(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=wf(this,this.l+e++))!==0;)i.push(dd(o));r=i.join("");break;case"_wstr":for(e=0,r="";(o=nc(this,this.l+e))!==0;)i.push(dd(o)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",f=this.l,u=0;u<e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return o=wf(this,f),this.l=f+1,l=N0.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(dd(nc(this,f))),f+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",f=this.l,u=0;u!=e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return o=wf(this,f),this.l=f+1,l=N0.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(dd(wf(this,f))),f+=1}r=i.join("");break;default:switch(e){case 1:return n=wf(this,this.l),this.l++,n;case 2:return n=(t==="i"?qT:nc)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?_u:$T)(this,this.l),this.l+=4,n):(a=eo(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=Qd(this,this.l):a=Qd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=F5(this,this.l,e);break}}return this.l+=e,r}var HT=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},VT=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},WT=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function KT(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)WT(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var o=t.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,HT(this,t,this.l);break;case 8:if(n=8,r==="f"){zT(this,t,this.l);break}case 16:break;case-4:n=4,VT(this,t,this.l);break}return this.l+=n,this}function V5(e,t){var r=F5(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function yi(e,t){e.l=t,e.read_shift=N0,e.chk=V5,e.write_shift=KT}function Yi(e,t){e.l+=t}function $a(e){var t=Yc(e);return yi(t,0),t}function dc(e,t,r){if(e){var n,a,i;yi(e,e.l||0);for(var o=e.length,l=0,u=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var f=ap[l]||ap[65535];for(n=e.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=e.read_shift(1))&127)<<7*a;u=e.l+i;var h=f.f&&f.f(e,i,r);if(e.l=u,t(h,f,l))return}}}function Lg(){var e=[],t=on?256:2048,r=function(f){var h=$a(f);return yi(h,0),h},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(f){return n&&f<n.length-n.l?n:(a(),n=r(Math.max(f+1,t)))},o=function(){return a(),zc(e)},l=function(f){a(),n=f,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:l,end:o,_bufs:e}}function T0(e,t,r){var n=wi(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Hx(e,t,r){var n=wi(e);return n.s=T0(n.s,t.s,r),n.e=T0(n.e,t.s,r),n}function C0(e,t){if(e.cRel&&e.c<0)for(e=wi(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=wi(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=qr(e);return!e.cRel&&e.cRel!=null&&(r=XT(r)),!e.rRel&&e.rRel!=null&&(r=GT(r)),r}function $1(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Wa(e.s.c)+":"+(e.e.cRel?"":"$")+Wa(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+bi(e.s.r)+":"+(e.e.rRel?"":"$")+bi(e.e.r):C0(e.s,t.biff)+":"+C0(e.e,t.biff)}function Tm(e){return parseInt(YT(e),10)-1}function bi(e){return""+(e+1)}function GT(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function YT(e){return e.replace(/\$(\d+)$/,"$1")}function Cm(e){for(var t=JT(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Wa(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function XT(e){return e.replace(/^([A-Z])/,"$$$1")}function JT(e){return e.replace(/^\$([A-Z])/,"$1")}function QT(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ms(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function qr(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Hf(e){var t=e.indexOf(":");return t==-1?{s:ms(e),e:ms(e)}:{s:ms(e.slice(0,t)),e:ms(e.slice(t+1))}}function hn(e,t){return typeof t>"u"||typeof t=="number"?hn(e.s,e.e):(typeof e!="string"&&(e=qr(e)),typeof t!="string"&&(t=qr(t)),e==t?e:e+":"+t)}function pa(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function Vx(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=No(e.z,r?xs(t):t)}catch{}try{return e.w=No((e.XF||{}).numFmtId||(r?14:0),r?xs(t):t)}catch{return""+t}}function uc(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?ju[e.v]||e.v:t==null?Vx(e,e.v):Vx(e,t))}function Qc(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function W5(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),o=0,l=0;if(i&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?ms(n.origin):n.origin;o=u.r,l=u.c}i["!ref"]||(i["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var h=pa(i["!ref"]);f.s.c=h.s.c,f.s.r=h.s.r,f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),o==-1&&(f.e.r=o=h.e.r+1)}for(var g=0;g!=t.length;++g)if(t[g]){if(!Array.isArray(t[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=t[g].length;++x)if(!(typeof t[g][x]>"u")){var m={v:t[g][x]},k=o+g,b=l+x;if(f.s.r>k&&(f.s.r=k),f.s.c>b&&(f.s.c=b),f.e.r<k&&(f.e.r=k),f.e.c<b&&(f.e.c=b),t[g][x]&&typeof t[g][x]=="object"&&!Array.isArray(t[g][x])&&!(t[g][x]instanceof Date))m=t[g][x];else if(Array.isArray(m.v)&&(m.f=t[g][x][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||Wr[14],n.cellDates?(m.t="d",m.w=No(m.z,xs(m.v))):(m.t="n",m.v=xs(m.v),m.w=No(m.z,m.v))):m.t="s";if(a)i[k]||(i[k]=[]),i[k][b]&&i[k][b].z&&(m.z=i[k][b].z),i[k][b]=m;else{var E=qr({c:b,r:k});i[E]&&i[E].z&&(m.z=i[E].z),i[E]=m}}}return f.s.c<1e7&&(i["!ref"]=hn(f)),i}function Vf(e,t){return W5(null,e,t)}function ZT(e){return e.read_shift(4,"i")}function Gi(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function e8(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Pm(e,t){var r=e.l,n=e.read_shift(1),a=Gi(e),i=[],o={t:a,h:a};if((n&1)!==0){for(var l=e.read_shift(4),u=0;u!=l;++u)i.push(e8(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}var t8=Pm;function To(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ru(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var r8=Gi;function Lm(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var n8=Gi,Fg=Lm;function Fm(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?Qd([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):_u(t,0)>>2;return r?a/100:a}function K5(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Du=K5;function Wi(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function a8(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),u=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var f=Nu[a];f&&(t.rgb=th(f));break;case 2:t.rgb=th([o,l,u]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function i8(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function G5(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function s8(e){return G5(e,1)}function o8(e){return G5(e,2)}var Om=2,Ds=3,gd=11,Wx=12,Zd=19,md=64,l8=65,c8=71,u8=4108,f8=4126,ii=80,Y5=81,h8=[ii,Y5],d8={1:{n:"CodePage",t:Om},2:{n:"Category",t:ii},3:{n:"PresentationFormat",t:ii},4:{n:"ByteCount",t:Ds},5:{n:"LineCount",t:Ds},6:{n:"ParagraphCount",t:Ds},7:{n:"SlideCount",t:Ds},8:{n:"NoteCount",t:Ds},9:{n:"HiddenCount",t:Ds},10:{n:"MultimediaClipCount",t:Ds},11:{n:"ScaleCrop",t:gd},12:{n:"HeadingPairs",t:u8},13:{n:"TitlesOfParts",t:f8},14:{n:"Manager",t:ii},15:{n:"Company",t:ii},16:{n:"LinksUpToDate",t:gd},17:{n:"CharacterCount",t:Ds},19:{n:"SharedDoc",t:gd},22:{n:"HyperlinksChanged",t:gd},23:{n:"AppVersion",t:Ds,p:"version"},24:{n:"DigSig",t:l8},26:{n:"ContentType",t:ii},27:{n:"ContentStatus",t:ii},28:{n:"Language",t:ii},29:{n:"Version",t:ii},255:{},2147483648:{n:"Locale",t:Zd},2147483651:{n:"Behavior",t:Zd},1919054434:{}},p8={1:{n:"CodePage",t:Om},2:{n:"Title",t:ii},3:{n:"Subject",t:ii},4:{n:"Author",t:ii},5:{n:"Keywords",t:ii},6:{n:"Comments",t:ii},7:{n:"Template",t:ii},8:{n:"LastAuthor",t:ii},9:{n:"RevNumber",t:ii},10:{n:"EditTime",t:md},11:{n:"LastPrinted",t:md},12:{n:"CreatedDate",t:md},13:{n:"ModifiedDate",t:md},14:{n:"PageCount",t:Ds},15:{n:"WordCount",t:Ds},16:{n:"CharCount",t:Ds},17:{n:"Thumbnail",t:c8},18:{n:"Application",t:ii},19:{n:"DocSecurity",t:Ds},255:{},2147483648:{n:"Locale",t:Zd},2147483651:{n:"Behavior",t:Zd},1919054434:{}},Kx={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},g8=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function m8(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var v8=m8([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Nu=wi(v8),ju={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},X5={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Gx={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function x8(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function y8(e){var t=x8();if(!e||!e.match)return t;var r={};if((e.match(Xi)||[]).forEach(function(n){var a=Rr(n);switch(a[0].replace(NT,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[Gx[a.ContentType]]!==void 0&&t[Gx[a.ContentType]].push(a.PartName);break}}),t.xmlns!==MT.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var Sf={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Og(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function P0(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Xi)||[]).forEach(function(a){var i=Rr(a);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var l=i.TargetMode==="External"?i.Target:y0(i.Target,t);r[l]=o,n[i.Id]=o}}),r["!id"]=n,r}var w8="application/vnd.oasis.opendocument.spreadsheet";function b8(e,t){for(var r=Am(e),n,a;n=Z0.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Rr(n[0],!1),a.path=="/"&&a.type!==w8)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var L0=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],_8=function(){for(var e=new Array(L0.length),t=0;t<L0.length;++t){var r=L0[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function J5(e){var t={};e=Kn(e);for(var r=0;r<L0.length;++r){var n=L0[r],a=e.match(_8[r]);a!=null&&a.length>0&&(t[n[1]]=pn(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=li(t[n[1]]))}return t}var k8=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Q5(e,t,r,n){var a=[];if(typeof e=="string")a=Mx(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(h){return{v:h}}));var o=typeof t=="string"?Mx(t,n).map(function(h){return h.v}):t,l=0,u=0;if(o.length>0)for(var f=0;f!==a.length;f+=2){switch(u=+a[f+1].v,a[f].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=u,r.SheetNames=o.slice(l,l+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=u,r.DefinedNames=o.slice(l,l+u);break;case"Charts":case"Diagramme":r.Chartsheets=u,r.ChartNames=o.slice(l,l+u);break}l+=u}}function S8(e,t,r){var n={};return t||(t={}),e=Kn(e),k8.forEach(function(a){var i=(e.match(Q0(a[0]))||[])[1];switch(a[2]){case"string":i&&(t[a[1]]=pn(i));break;case"bool":t[a[1]]=i==="true";break;case"raw":var o=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));o&&o.length>0&&(n[a[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Q5(n.HeadingPairs,n.TitlesOfParts,t,r),t}var E8=/<[^>]+>[^<]*/g;function A8(e,t){var r={},n="",a=e.match(E8);if(a)for(var i=0;i!=a.length;++i){var o=a[i],l=Rr(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=pn(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var u=o.split(">"),f=u[0].slice(4),h=u[1];switch(f){case"lpstr":case"bstr":case"lpwstr":r[n]=pn(h);break;case"bool":r[n]=ta(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(h,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(h);break;case"filetime":case"date":r[n]=li(h);break;case"cy":case"error":r[n]=pn(h);break;default:if(f.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,f,u)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}var N8={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},H1;function T8(e,t,r){H1||(H1=km(N8)),t=H1[t]||t,e[t]=r}function Im(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Z5(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function eb(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function tb(e,t,r){return t===31?eb(e):Z5(e,t,r)}function Ig(e,t,r){return tb(e,t,r===!1?0:4)}function C8(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return tb(e,t,0)}function P8(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(vs,""),e.l-a&2&&(e.l+=2)}return r}function L8(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(vs,"");return r}function F8(e){var t=e.l,r=ep(e,Y5);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=ep(e,Ds);return[r,n]}function O8(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(F8(e));return r}function Yx(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var i=e.read_shift(4),o=e.read_shift(4);n[i]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(vs,"").replace(x0,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function rb(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function I8(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function ep(e,t,r){var n=e.read_shift(2),a,i=r||{};if(e.l+=2,t!==Wx&&n!==t&&h8.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Wx?n:t){case 2:return a=e.read_shift(2,"i"),i.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return Z5(e,n,4).replace(vs,"");case 31:return eb(e);case 64:return Im(e);case 65:return rb(e);case 71:return I8(e);case 80:return Ig(e,n,!i.raw).replace(vs,"");case 81:return C8(e,n).replace(vs,"");case 4108:return O8(e);case 4126:case 4127:return n==4127?P8(e):L8(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Xx(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],o=0,l=0,u=-1,f={};for(o=0;o!=a;++o){var h=e.read_shift(4),g=e.read_shift(4);i[o]=[h,g+r]}i.sort(function(O,F){return O[1]-F[1]});var x={};for(o=0;o!=a;++o){if(e.l!==i[o][1]){var m=!0;if(o>0&&t)switch(t[i[o-1][0]].t){case 2:e.l+2===i[o][1]&&(e.l+=2,m=!1);break;case 80:e.l<=i[o][1]&&(e.l=i[o][1],m=!1);break;case 4108:e.l<=i[o][1]&&(e.l=i[o][1],m=!1);break}if((!t||o==0)&&e.l<=i[o][1]&&(m=!1,e.l=i[o][1]),m)throw new Error("Read Error: Expected address "+i[o][1]+" at "+e.l+" :"+o)}if(t){var k=t[i[o][0]];if(x[k.n]=ep(e,k.t,{raw:!0}),k.p==="version"&&(x[k.n]=String(x[k.n]>>16)+"."+("0000"+String(x[k.n]&65535)).slice(-4)),k.n=="CodePage")switch(x[k.n]){case 0:x[k.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:al(l=x[k.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+x[k.n])}}else if(i[o][0]===1){if(l=x.CodePage=ep(e,Om),al(l),u!==-1){var b=e.l;e.l=i[u][1],f=Yx(e,l),e.l=b}}else if(i[o][0]===0){if(l===0){u=o,e.l=i[o+1][1];continue}f=Yx(e,l)}else{var E=f[i[o][0]],N;switch(e[e.l]){case 65:e.l+=4,N=rb(e);break;case 30:e.l+=4,N=Ig(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,N=Ig(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,N=e.read_shift(4,"i");break;case 19:e.l+=4,N=e.read_shift(4);break;case 5:e.l+=4,N=e.read_shift(8,"f");break;case 11:e.l+=4,N=Ea(e,4);break;case 64:e.l+=4,N=li(Im(e));break;default:throw new Error("unparsed value: "+e[e.l])}x[E]=N}}return e.l=r+n,x}function Jx(e,t,r){var n=e.content;if(!n)return{};yi(n,0);var a,i,o,l,u=0;n.chk("feff","Byte Order: "),n.read_shift(2);var f=n.read_shift(4),h=n.read_shift(16);if(h!==fn.utils.consts.HEADER_CLSID&&h!==r)throw new Error("Bad PropertySet CLSID "+h);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),l=n.read_shift(4),a===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);a===2&&(o=n.read_shift(16),u=n.read_shift(4));var g=Xx(n,t),x={SystemIdentifier:f};for(var m in g)x[m]=g[m];if(x.FMTID=i,a===1)return x;if(u-n.l==2&&(n.l+=2),n.l!==u)throw new Error("Length mismatch 2: "+n.l+" !== "+u);var k;try{k=Xx(n,null)}catch{}for(m in k)x[m]=k[m];return x.FMTID=[i,o],x}function Dc(e,t){return e.read_shift(t),null}function R8(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Ea(e,t){return e.read_shift(t)===1}function Ra(e){return e.read_shift(2,"u")}function nb(e,t){return R8(e,t,Ra)}function D8(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function ph(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var o=n?e.read_shift(n,a):"";return o}function j8(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,i=1+(r&1),o=0,l,u={};a&&(o=e.read_shift(2)),n&&(l=e.read_shift(4));var f=i==2?"dbcs-cont":"sbcs-cont",h=t===0?"":e.read_shift(t,f);return a&&(e.l+=4*o),n&&(e.l+=l),u.t=h,a||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function Lu(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function gh(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Lu(e,n,r)}function Mu(e,t,r){if(r.biff>5)return gh(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function M8(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function B8(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(vs,"");return n&&(e.l+=24),a}function U8(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(i>>1,"utf16le").replace(vs,"");return r+o}function z8(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return B8(e);case"0303000000000000c000000000000046":return U8(e);default:throw new Error("Unsupported Moniker "+r)}}function vd(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(vs,""):"";return r}function q8(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,o,l,u,f="",h,g;a&16&&(i=vd(e,r-e.l)),a&128&&(o=vd(e,r-e.l)),(a&257)===257&&(l=vd(e,r-e.l)),(a&257)===1&&(u=z8(e,r-e.l)),a&8&&(f=vd(e,r-e.l)),a&32&&(h=e.read_shift(16)),a&64&&(g=Im(e)),e.l=r;var x=o||l||u||"";x&&f&&(x+="#"+f),x||(x="#"+f),a&2&&x.charAt(0)=="/"&&x.charAt(1)!="/"&&(x="file://"+x);var m={Target:x};return h&&(m.guid=h),g&&(m.time=g),i&&(m.Tooltip=i),m}function ab(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function ib(e,t){var r=ab(e);return r[3]=0,r}function jl(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function $8(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function H8(e,t,r){return t===0?"":Mu(e,t,r)}function V8(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[a,i,o]}function sb(e){var t=e.read_shift(2),r=Fm(e);return[t,r]}function W8(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=ph(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}function _p(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function ob(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var K8=ob;function lb(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function G8(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function Y8(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function qi(e){e.l+=2,e.l+=e.read_shift(2)}var X8={0:qi,4:qi,5:qi,6:qi,7:Y8,8:qi,9:qi,10:qi,11:qi,12:qi,13:G8,14:qi,15:qi,16:qi,17:qi,18:qi,19:qi,20:qi,21:lb};function J8(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(X8[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function xd(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Q8(e,t){return t===0||e.read_shift(2),1200}function Z8(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=Mu(e,0,r);return e.read_shift(t+n-e.l),a}function eC(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function tC(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=ph(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:a,dt:i,name:o}}function rC(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),i=[],o=0;o!=a&&e.l<r;++o)i.push(j8(e));return i.Count=n,i.Unique=a,i}function nC(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function aC(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function iC(e){var t=$8(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function sC(e){return e.read_shift(2),e.read_shift(4)}function Qx(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function oC(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2),f=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:i,CurTab:o,FirstTab:l,Selected:u,TabRatio:f}}function lC(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function cC(){}function uC(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=ph(e,0,r),n}function fC(e){var t=jl(e);return t.isst=e.read_shift(4),t}function hC(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=jl(e);r.biff==2&&e.l++;var i=gh(e,n-e.l,r);return a.val=i,a}function dC(e,t,r){var n=e.read_shift(2),a=Mu(e,0,r);return[n,a]}var pC=Mu;function Zx(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,i=e.read_shift(a),o=e.read_shift(a),l=e.read_shift(2),u=e.read_shift(2);return e.l=n,{s:{r:i,c:l},e:{r:o,c:u}}}function gC(e){var t=e.read_shift(2),r=e.read_shift(2),n=sb(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function mC(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(sb(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(i.length!=o-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:o,rkrec:i}}function vC(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(i.length!=o-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:o,ixfe:i}}function xC(e,t,r,n){var a={},i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),u=e.read_shift(2);return a.patternType=g8[l>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=o&15,a.dgRight=o>>4&15,a.dgTop=o>>8&15,a.dgBottom=o>>12&15,a.icvLeft=o>>16&127,a.icvRight=o>>23&127,a.grbitDiag=o>>30&3,a.icvTop=l&127,a.icvBottom=l>>7&127,a.icvDiag=l>>14&127,a.dgDiag=l>>21&15,a.icvFore=u&127,a.icvBack=u>>7&127,a.fsxButton=u>>14&1),a}function yC(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=xC(e,t,n.fStyle,r),n}function wC(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function ey(e,t,r){var n=jl(e);(r.biff==2||t==9)&&++e.l;var a=D8(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function bC(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=jl(e),a=Wi(e);return n.val=a,n}var ty=H8;function _C(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=Lu(e,i),l=[];n>e.l;)l.push(gh(e));return[i,a,o,l]}function ry(e,t,r){var n=e.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=W8(e,t-2,r)),i.body=a||e.read_shift(t-2),typeof a=="string"&&(i.Name=a),i}var kC=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function ny(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),u=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),u=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var f=Lu(e,o,r);a&32&&(f=kC[f.charCodeAt(0)]);var h=n-e.l;r&&r.biff==2&&--h;var g=n==e.l||l===0||!(h>0)?[]:aF(e,h,r,l);return{chKey:i,Name:f,itab:u,rgce:g}}function cb(e,t,r){if(r.biff<8)return SC(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(V8(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function SC(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=ph(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function EC(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),i=Lu(e,n,r),o=Lu(e,a,r);return[i,o]}function AC(e,t,r){var n=ob(e);e.l++;var a=e.read_shift(1);return t-=8,[iF(e,t,r),a,n]}function ay(e,t,r){var n=K8(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,rF(e,t,r)]}function NC(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function TC(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=Mu(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},l,o,i]}}function CC(e,t,r){return TC(e,t,r)}function PC(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(_p(e));return r}function LC(e,t,r){if(r&&r.biff<8)return OC(e,t,r);var n=lb(e),a=J8(e,t-22,n[1]);return{cmo:n,ft:a}}var FC={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function OC(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((FC[n]||Yi)(e,t,r)),{cmo:[a,n,i],ft:o}}function IC(e,t,r){var n=e.l,a="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:o=M8(e,6,r);var l=e.read_shift(2);e.read_shift(2),Ra(e,2);var u=e.read_shift(2);e.l+=u;for(var f=1;f<e.lens.length-1;++f){if(e.l-n!=e.lens[f])throw new Error("TxO: bad continue record");var h=e[e.l],g=Lu(e,e.lens[f+1]-e.lens[f]-1);if(a+=g,a.length>=(h?l:2*l))break}if(a.length!==l&&a.length!==l*2)throw new Error("cchText: "+l+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function RC(e,t){var r=_p(e);e.l+=16;var n=q8(e,t-24);return[r,n]}function DC(e,t){e.read_shift(2);var r=_p(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(vs,""),[r,n]}function jC(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Kx[r]||r,r=e.read_shift(2),t[1]=Kx[r]||r,t}function MC(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(ib(e));return r}function BC(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(ib(e));return r}function UC(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function ub(e,t,r){if(!r.cellStyles)return Yi(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),u=e.read_shift(2);n==2&&(e.l+=2);var f={s:a,e:i,w:o,ixfe:l,flags:u};return(r.biff>=5||!r.biff)&&(f.level=u>>8&7),f}function zC(e,t){var r={};return t<32||(e.l+=16,r.header=Wi(e),r.footer=Wi(e),e.l+=2),r}function qC(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}var $C=jl,HC=nb,VC=gh;function WC(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function KC(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=jl(e);++e.l;var a=Mu(e,t-7,r);return n.t="str",n.val=a,n}function GC(e){var t=jl(e);++e.l;var r=Wi(e);return t.t="n",t.val=r,t}function YC(e){var t=jl(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function XC(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function JC(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function QC(e,t,r){var n=e.l+t,a=jl(e),i=e.read_shift(2),o=Lu(e,i,r);return e.l=n,a.t="str",a.val=o,a}var ZC=[2,3,48,49,131,139,140,245],iy=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=km({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,u){var f=[],h=Yc(1);switch(u.type){case"base64":h=nl(ao(l));break;case"binary":h=nl(l);break;case"buffer":case"array":h=l;break}yi(h,0);var g=h.read_shift(1),x=!!(g&136),m=!1,k=!1;switch(g){case 2:break;case 3:break;case 48:m=!0,x=!0;break;case 49:m=!0,x=!0;break;case 131:break;case 139:break;case 140:k=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var b=0,E=521;g==2&&(b=h.read_shift(2)),h.l+=3,g!=2&&(b=h.read_shift(4)),b>1048576&&(b=1e6),g!=2&&(E=h.read_shift(2));var N=h.read_shift(2),O=u.codepage||1252;g!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(O=e[h[h.l]]),h.l+=1,h.l+=2),k&&(h.l+=36);for(var F=[],K={},te=Math.min(h.length,g==2?521:E-10-(m?264:0)),re=k?32:11;h.l<te&&h[h.l]!=13;)switch(K={},K.name=X0.utils.decode(O,h.slice(h.l,h.l+re)).replace(/[\u0000\r\n].*$/g,""),h.l+=re,K.type=String.fromCharCode(h.read_shift(1)),g!=2&&!k&&(K.offset=h.read_shift(4)),K.len=h.read_shift(1),g==2&&(K.offset=h.read_shift(2)),K.dec=h.read_shift(1),K.name.length&&F.push(K),g!=2&&(h.l+=k?13:14),K.type){case"B":(!m||K.len!=8)&&u.WTF&&console.log("Skipping "+K.name+":"+K.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+K.name+":"+K.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+K.type)}if(h[h.l]!==13&&(h.l=E-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=E;var B=0,V=0;for(f[0]=[],V=0;V!=F.length;++V)f[0][V]=F[V].name;for(;b-- >0;){if(h[h.l]===42){h.l+=N;continue}for(++h.l,f[++B]=[],V=0,V=0;V!=F.length;++V){var Y=h.slice(h.l,h.l+F[V].len);h.l+=F[V].len,yi(Y,0);var ye=X0.utils.decode(O,Y);switch(F[V].type){case"C":ye.trim().length&&(f[B][V]=ye.replace(/\s+$/,""));break;case"D":ye.length===8?f[B][V]=new Date(+ye.slice(0,4),+ye.slice(4,6)-1,+ye.slice(6,8)):f[B][V]=ye;break;case"F":f[B][V]=parseFloat(ye.trim());break;case"+":case"I":f[B][V]=k?Y.read_shift(-4,"i")^2147483648:Y.read_shift(4,"i");break;case"L":switch(ye.trim().toUpperCase()){case"Y":case"T":f[B][V]=!0;break;case"N":case"F":f[B][V]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ye+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));f[B][V]="##MEMO##"+(k?parseInt(ye.trim(),10):Y.read_shift(4));break;case"N":ye=ye.replace(/\u0000/g,"").trim(),ye&&ye!="."&&(f[B][V]=+ye||0);break;case"@":f[B][V]=new Date(Y.read_shift(-8,"f")-621356832e5);break;case"T":f[B][V]=new Date((Y.read_shift(4)-2440588)*864e5+Y.read_shift(4));break;case"Y":f[B][V]=Y.read_shift(4,"i")/1e4+Y.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[B][V]=-Y.read_shift(-8,"f");break;case"B":if(m&&F[V].len==8){f[B][V]=Y.read_shift(8,"f");break}case"G":case"P":Y.l+=F[V].len;break;case"0":if(F[V].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+F[V].type)}}}if(g!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return u&&u.sheetRows&&(f=f.slice(0,u.sheetRows)),u.DBF=F,f}function n(l,u){var f=u||{};f.dateNF||(f.dateNF="yyyymmdd");var h=Vf(r(l,f),f);return h["!cols"]=f.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete f.DBF,h}function a(l,u){try{return Qc(n(l,u),u)}catch(f){if(u&&u.WTF)throw f}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,u){var f=u||{};if(+f.codepage>=0&&al(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var h=Lg(),g=zg(l,{header:1,raw:!0,cellDates:!0}),x=g[0],m=g.slice(1),k=l["!cols"]||[],b=0,E=0,N=0,O=1;for(b=0;b<x.length;++b){if(((k[b]||{}).DBF||{}).name){x[b]=k[b].DBF.name,++N;continue}if(x[b]!=null){if(++N,typeof x[b]=="number"&&(x[b]=x[b].toString(10)),typeof x[b]!="string")throw new Error("DBF Invalid column name "+x[b]+" |"+typeof x[b]+"|");if(x.indexOf(x[b])!==b){for(E=0;E<1024;++E)if(x.indexOf(x[b]+"_"+E)==-1){x[b]+="_"+E;break}}}}var F=pa(l["!ref"]),K=[],te=[],re=[];for(b=0;b<=F.e.c-F.s.c;++b){var B="",V="",Y=0,ye=[];for(E=0;E<m.length;++E)m[E][b]!=null&&ye.push(m[E][b]);if(ye.length==0||x[b]==null){K[b]="?";continue}for(E=0;E<ye.length;++E){switch(typeof ye[E]){case"number":V="B";break;case"string":V="C";break;case"boolean":V="L";break;case"object":V=ye[E]instanceof Date?"D":"C";break;default:V="C"}Y=Math.max(Y,String(ye[E]).length),B=B&&B!=V?"C":V}Y>250&&(Y=250),V=((k[b]||{}).DBF||{}).type,V=="C"&&k[b].DBF.len>Y&&(Y=k[b].DBF.len),B=="B"&&V=="N"&&(B="N",re[b]=k[b].DBF.dec,Y=k[b].DBF.len),te[b]=B=="C"||V=="N"?Y:i[B]||0,O+=te[b],K[b]=B}var U=h.next(32);for(U.write_shift(4,318902576),U.write_shift(4,m.length),U.write_shift(2,296+32*N),U.write_shift(2,O),b=0;b<4;++b)U.write_shift(4,0);for(U.write_shift(4,0|(+t[c5]||3)<<8),b=0,E=0;b<x.length;++b)if(x[b]!=null){var D=h.next(32),le=(x[b].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,le,"sbcs"),D.write_shift(1,K[b]=="?"?"C":K[b],"sbcs"),D.write_shift(4,E),D.write_shift(1,te[b]||i[K[b]]||0),D.write_shift(1,re[b]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),E+=te[b]||i[K[b]]||0}var ue=h.next(264);for(ue.write_shift(4,13),b=0;b<65;++b)ue.write_shift(4,0);for(b=0;b<m.length;++b){var Te=h.next(O);for(Te.write_shift(1,0),E=0;E<x.length;++E)if(x[E]!=null)switch(K[E]){case"L":Te.write_shift(1,m[b][E]==null?63:m[b][E]?84:70);break;case"B":Te.write_shift(8,m[b][E]||0,"f");break;case"N":var Fe="0";for(typeof m[b][E]=="number"&&(Fe=m[b][E].toFixed(re[E]||0)),N=0;N<te[E]-Fe.length;++N)Te.write_shift(1,32);Te.write_shift(1,Fe,"sbcs");break;case"D":m[b][E]?(Te.write_shift(4,("0000"+m[b][E].getFullYear()).slice(-4),"sbcs"),Te.write_shift(2,("00"+(m[b][E].getMonth()+1)).slice(-2),"sbcs"),Te.write_shift(2,("00"+m[b][E].getDate()).slice(-2),"sbcs")):Te.write_shift(8,"00000000","sbcs");break;case"C":var Le=String(m[b][E]!=null?m[b][E]:"").slice(0,te[E]);for(Te.write_shift(1,Le,"sbcs"),N=0;N<te[E]-Le.length;++N)Te.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:a,to_sheet:n,from_sheet:o}}(),eP=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Ol(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(x,m){var k=e[m];return typeof k=="number"?bx(k):k},n=function(x,m,k){var b=m.charCodeAt(0)-32<<4|k.charCodeAt(0)-48;return b==59?x:bx(b)};e["|"]=254;function a(x,m){switch(m.type){case"base64":return i(ao(x),m);case"binary":return i(x,m);case"buffer":return i(on&&Buffer.isBuffer(x)?x.toString("binary"):Iu(x),m);case"array":return i(Pu(x),m)}throw new Error("Unrecognized type "+m.type)}function i(x,m){var k=x.split(/[\n\r]+/),b=-1,E=-1,N=0,O=0,F=[],K=[],te=null,re={},B=[],V=[],Y=[],ye=0,U;for(+m.codepage>=0&&al(+m.codepage);N!==k.length;++N){ye=0;var D=k[N].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),le=D.replace(/;;/g,"\0").split(";").map(function(H){return H.replace(/\u0000/g,";")}),ue=le[0],Te;if(D.length>0)switch(ue){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":le[1].charAt(0)=="P"&&K.push(D.slice(3).replace(/;;/g,";"));break;case"C":var Fe=!1,Le=!1,me=!1,ne=!1,Ee=-1,pe=-1;for(O=1;O<le.length;++O)switch(le[O].charAt(0)){case"A":break;case"X":E=parseInt(le[O].slice(1))-1,Le=!0;break;case"Y":for(b=parseInt(le[O].slice(1))-1,Le||(E=0),U=F.length;U<=b;++U)F[U]=[];break;case"K":Te=le[O].slice(1),Te.charAt(0)==='"'?Te=Te.slice(1,Te.length-1):Te==="TRUE"?Te=!0:Te==="FALSE"?Te=!1:isNaN(sl(Te))?isNaN(Rf(Te).getDate())||(Te=li(Te)):(Te=sl(Te),te!==null&&$f(te)&&(Te=bp(Te))),Fe=!0;break;case"E":ne=!0;var C=Of(le[O].slice(1),{r:b,c:E});F[b][E]=[F[b][E],C];break;case"S":me=!0,F[b][E]=[F[b][E],"S5S"];break;case"G":break;case"R":Ee=parseInt(le[O].slice(1))-1;break;case"C":pe=parseInt(le[O].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}if(Fe&&(F[b][E]&&F[b][E].length==2?F[b][E][0]=Te:F[b][E]=Te,te=null),me){if(ne)throw new Error("SYLK shared formula cannot have own formula");var M=Ee>-1&&F[Ee][pe];if(!M||!M[1])throw new Error("SYLK shared formula cannot find base");F[b][E][1]=wb(M[1],{r:b-Ee,c:E-pe})}break;case"F":var z=0;for(O=1;O<le.length;++O)switch(le[O].charAt(0)){case"X":E=parseInt(le[O].slice(1))-1,++z;break;case"Y":for(b=parseInt(le[O].slice(1))-1,U=F.length;U<=b;++U)F[U]=[];break;case"M":ye=parseInt(le[O].slice(1))/20;break;case"F":break;case"G":break;case"P":te=K[parseInt(le[O].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(Y=le[O].slice(1).split(" "),U=parseInt(Y[0],10);U<=parseInt(Y[1],10);++U)ye=parseInt(Y[2],10),V[U-1]=ye===0?{hidden:!0}:{wch:ye},Df(V[U-1]);break;case"C":E=parseInt(le[O].slice(1))-1,V[E]||(V[E]={});break;case"R":b=parseInt(le[O].slice(1))-1,B[b]||(B[b]={}),ye>0?(B[b].hpt=ye,B[b].hpx=rh(ye)):ye===0&&(B[b].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}z<1&&(te=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}}return B.length>0&&(re["!rows"]=B),V.length>0&&(re["!cols"]=V),m&&m.sheetRows&&(F=F.slice(0,m.sheetRows)),[F,re]}function o(x,m){var k=a(x,m),b=k[0],E=k[1],N=Vf(b,m);return Ol(E).forEach(function(O){N[O]=E[O]}),N}function l(x,m){return Qc(o(x,m),m)}function u(x,m,k,b){var E="C;Y"+(k+1)+";X"+(b+1)+";K";switch(x.t){case"n":E+=x.v||0,x.f&&!x.F&&(E+=";E"+U7(x.f,{r:k,c:b}));break;case"b":E+=x.v?"TRUE":"FALSE";break;case"e":E+=x.w||x.v;break;case"d":E+='"'+(x.w||x.v)+'"';break;case"s":E+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function f(x,m){m.forEach(function(k,b){var E="F;W"+(b+1)+" "+(b+1)+" ";k.hidden?E+="0":(typeof k.width=="number"&&!k.wpx&&(k.wpx=rp(k.width)),typeof k.wpx=="number"&&!k.wch&&(k.wch=np(k.wpx)),typeof k.wch=="number"&&(E+=Math.round(k.wch))),E.charAt(E.length-1)!=" "&&x.push(E)})}function h(x,m){m.forEach(function(k,b){var E="F;";k.hidden?E+="M0;":k.hpt?E+="M"+20*k.hpt+";":k.hpx&&(E+="M"+20*vb(k.hpx)+";"),E.length>2&&x.push(E+"R"+(b+1))})}function g(x,m){var k=["ID;PWXL;N;E"],b=[],E=pa(x["!ref"]),N,O=Array.isArray(x),F=`\r
`;k.push("P;PGeneral"),k.push("F;P0;DG0G8;M255"),x["!cols"]&&f(k,x["!cols"]),x["!rows"]&&h(k,x["!rows"]),k.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var K=E.s.r;K<=E.e.r;++K)for(var te=E.s.c;te<=E.e.c;++te){var re=qr({r:K,c:te});N=O?(x[K]||[])[te]:x[re],!(!N||N.v==null&&(!N.f||N.F))&&b.push(u(N,x,K,te))}return k.join(F)+F+b.join(F)+F+"E"+F}return{to_workbook:l,to_sheet:o,from_sheet:g}}(),tP=function(){function e(i,o){switch(o.type){case"base64":return t(ao(i),o);case"binary":return t(i,o);case"buffer":return t(on&&Buffer.isBuffer(i)?i.toString("binary"):Iu(i),o);case"array":return t(Pu(i),o)}throw new Error("Unrecognized type "+o.type)}function t(i,o){for(var l=i.split(`
`),u=-1,f=-1,h=0,g=[];h!==l.length;++h){if(l[h].trim()==="BOT"){g[++u]=[],f=0;continue}if(!(u<0)){var x=l[h].trim().split(","),m=x[0],k=x[1];++h;for(var b=l[h]||"";(b.match(/["]/g)||[]).length&1&&h<l.length-1;)b+=`
`+l[++h];switch(b=b.trim(),+m){case-1:if(b==="BOT"){g[++u]=[],f=0;continue}else if(b!=="EOD")throw new Error("Unrecognized DIF special command "+b);break;case 0:b==="TRUE"?g[u][f]=!0:b==="FALSE"?g[u][f]=!1:isNaN(sl(k))?isNaN(Rf(k).getDate())?g[u][f]=k:g[u][f]=li(k):g[u][f]=sl(k),++f;break;case 1:b=b.slice(1,b.length-1),b=b.replace(/""/g,'"'),b&&b.match(/^=".*"$/)&&(b=b.slice(2,-1)),g[u][f++]=b!==""?b:null;break}if(b==="EOD")break}}return o&&o.sheetRows&&(g=g.slice(0,o.sheetRows)),g}function r(i,o){return Vf(e(i,o),o)}function n(i,o){return Qc(r(i,o),o)}var a=function(){var i=function(u,f,h,g,x){u.push(f),u.push(h+","+g),u.push('"'+x.replace(/"/g,'""')+'"')},o=function(u,f,h,g){u.push(f+","+h),u.push(f==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(u){var f=[],h=pa(u["!ref"]),g,x=Array.isArray(u);i(f,"TABLE",0,1,"sheetjs"),i(f,"VECTORS",0,h.e.r-h.s.r+1,""),i(f,"TUPLES",0,h.e.c-h.s.c+1,""),i(f,"DATA",0,0,"");for(var m=h.s.r;m<=h.e.r;++m){o(f,-1,0,"BOT");for(var k=h.s.c;k<=h.e.c;++k){var b=qr({r:m,c:k});if(g=x?(u[m]||[])[k]:u[b],!g){o(f,1,0,"");continue}switch(g.t){case"n":var E=g.w;!E&&g.v!=null&&(E=g.v),E==null?g.f&&!g.F?o(f,1,0,"="+g.f):o(f,1,0,""):o(f,0,E,"V");break;case"b":o(f,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":o(f,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=No(g.z||Wr[14],xs(li(g.v)))),o(f,0,g.w,"V");break;default:o(f,1,0,"")}}}o(f,-1,0,"EOD");var N=`\r
`,O=f.join(N);return O}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),rP=function(){function e(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(g,x){for(var m=g.split(`
`),k=-1,b=-1,E=0,N=[];E!==m.length;++E){var O=m[E].trim().split(":");if(O[0]==="cell"){var F=ms(O[1]);if(N.length<=F.r)for(k=N.length;k<=F.r;++k)N[k]||(N[k]=[]);switch(k=F.r,b=F.c,O[2]){case"t":N[k][b]=e(O[3]);break;case"v":N[k][b]=+O[3];break;case"vtf":var K=O[O.length-1];case"vtc":switch(O[3]){case"nl":N[k][b]=!!+O[4];break;default:N[k][b]=+O[4];break}O[2]=="vtf"&&(N[k][b]=[N[k][b],K])}}}return x&&x.sheetRows&&(N=N.slice(0,x.sheetRows)),N}function n(g,x){return Vf(r(g,x),x)}function a(g,x){return Qc(n(g,x),x)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function f(g){if(!g||!g["!ref"])return"";for(var x=[],m=[],k,b="",E=Hf(g["!ref"]),N=Array.isArray(g),O=E.s.r;O<=E.e.r;++O)for(var F=E.s.c;F<=E.e.c;++F)if(b=qr({r:O,c:F}),k=N?(g[O]||[])[F]:g[b],!(!k||k.v==null||k.t==="z")){switch(m=["cell",b,"t"],k.t){case"s":case"str":m.push(t(k.v));break;case"n":k.f?(m[2]="vtf",m[3]="n",m[4]=k.v,m[5]=t(k.f)):(m[2]="v",m[3]=k.v);break;case"b":m[2]="vt"+(k.f?"f":"c"),m[3]="nl",m[4]=k.v?"1":"0",m[5]=t(k.f||(k.v?"TRUE":"FALSE"));break;case"d":var K=xs(li(k.v));m[2]="vtc",m[3]="nd",m[4]=""+K,m[5]=k.w||No(k.z||Wr[14],K);break;case"e":continue}x.push(m.join(":"))}return x.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function h(g){return[i,o,l,o,f(g),u].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:h}}(),eh=function(){function e(h,g,x,m,k){k.raw?g[x][m]=h:h===""||(h==="TRUE"?g[x][m]=!0:h==="FALSE"?g[x][m]=!1:isNaN(sl(h))?isNaN(Rf(h).getDate())?g[x][m]=h:g[x][m]=li(h):g[x][m]=sl(h))}function t(h,g){var x=g||{},m=[];if(!h||h.length===0)return m;for(var k=h.split(/[\r\n]/),b=k.length-1;b>=0&&k[b].length===0;)--b;for(var E=10,N=0,O=0;O<=b;++O)N=k[O].indexOf(" "),N==-1?N=k[O].length:N++,E=Math.max(E,N);for(O=0;O<=b;++O){m[O]=[];var F=0;for(e(k[O].slice(0,E).trim(),m,O,F,x),F=1;F<=(k[O].length-E)/10+1;++F)e(k[O].slice(E+(F-1)*10,E+F*10).trim(),m,O,F,x)}return x.sheetRows&&(m=m.slice(0,x.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(h){for(var g={},x=!1,m=0,k=0;m<h.length;++m)(k=h.charCodeAt(m))==34?x=!x:!x&&k in r&&(g[k]=(g[k]||0)+1);k=[];for(m in g)Object.prototype.hasOwnProperty.call(g,m)&&k.push([g[m],m]);if(!k.length){g=n;for(m in g)Object.prototype.hasOwnProperty.call(g,m)&&k.push([g[m],m])}return k.sort(function(b,E){return b[0]-E[0]||n[b[1]]-n[E[1]]}),r[k.pop()[1]]||44}function i(h,g){var x=g||{},m="",k=x.dense?[]:{},b={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(m=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(m=h.charAt(4),h=h.slice(6)):m=a(h.slice(0,1024)):x&&x.FS?m=x.FS:m=a(h.slice(0,1024));var E=0,N=0,O=0,F=0,K=0,te=m.charCodeAt(0),re=!1,B=0,V=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var Y=x.dateNF!=null?dT(x.dateNF):null;function ye(){var U=h.slice(F,K),D={};if(U.charAt(0)=='"'&&U.charAt(U.length-1)=='"'&&(U=U.slice(1,-1).replace(/""/g,'"')),U.length===0)D.t="z";else if(x.raw)D.t="s",D.v=U;else if(U.trim().length===0)D.t="s",D.v=U;else if(U.charCodeAt(0)==61)U.charCodeAt(1)==34&&U.charCodeAt(U.length-1)==34?(D.t="s",D.v=U.slice(2,-1).replace(/""/g,'"')):q7(U)?(D.t="n",D.f=U.slice(1)):(D.t="s",D.v=U);else if(U=="TRUE")D.t="b",D.v=!0;else if(U=="FALSE")D.t="b",D.v=!1;else if(!isNaN(O=sl(U)))D.t="n",x.cellText!==!1&&(D.w=U),D.v=O;else if(!isNaN(Rf(U).getDate())||Y&&U.match(Y)){D.z=x.dateNF||Wr[14];var le=0;Y&&U.match(Y)&&(U=pT(U,x.dateNF,U.match(Y)||[]),le=1),x.cellDates?(D.t="d",D.v=li(U,le)):(D.t="n",D.v=xs(li(U,le))),x.cellText!==!1&&(D.w=No(D.z,D.v instanceof Date?xs(D.v):D.v)),x.cellNF||delete D.z}else D.t="s",D.v=U;if(D.t=="z"||(x.dense?(k[E]||(k[E]=[]),k[E][N]=D):k[qr({c:N,r:E})]=D),F=K+1,V=h.charCodeAt(F),b.e.c<N&&(b.e.c=N),b.e.r<E&&(b.e.r=E),B==te)++N;else if(N=0,++E,x.sheetRows&&x.sheetRows<=E)return!0}e:for(;K<h.length;++K)switch(B=h.charCodeAt(K)){case 34:V===34&&(re=!re);break;case te:case 10:case 13:if(!re&&ye())break e;break}return K-F>0&&ye(),k["!ref"]=hn(b),k}function o(h,g){return!(g&&g.PRN)||g.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?i(h,g):Vf(t(h,g),g)}function l(h,g){var x="",m=g.type=="string"?[0,0,0,0]:qm(h,g);switch(g.type){case"base64":x=ao(h);break;case"binary":x=h;break;case"buffer":g.codepage==65001?x=h.toString("utf8"):g.codepage&&typeof X0<"u"||(x=on&&Buffer.isBuffer(h)?h.toString("binary"):Iu(h));break;case"array":x=Pu(h);break;case"string":x=h;break;default:throw new Error("Unrecognized type "+g.type)}return m[0]==239&&m[1]==187&&m[2]==191?x=Kn(x.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?x=Kn(x):g.type=="binary"&&typeof X0<"u",x.slice(0,19)=="socialcalc:version:"?rP.to_sheet(g.type=="string"?x:Kn(x),g):o(x,g)}function u(h,g){return Qc(l(h,g),g)}function f(h){for(var g=[],x=pa(h["!ref"]),m,k=Array.isArray(h),b=x.s.r;b<=x.e.r;++b){for(var E=[],N=x.s.c;N<=x.e.c;++N){var O=qr({r:b,c:N});if(m=k?(h[b]||[])[N]:h[O],!m||m.v==null){E.push("          ");continue}for(var F=(m.w||(uc(m),m.w)||"").slice(0,10);F.length<10;)F+=" ";E.push(F+(N===0?" ":""))}g.push(E.join(""))}return g.join(`
`)}return{to_workbook:u,to_sheet:l,from_sheet:f}}();function nP(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=eP.to_workbook(e,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return eh.to_workbook(e,t)}}var F0=function(){function e(C,M,z){if(C){yi(C,C.l||0);for(var H=z.Enum||Ee;C.l<C.length;){var ie=C.read_shift(2),xe=H[ie]||H[65535],Ae=C.read_shift(2),de=C.l+Ae,Me=xe.f&&xe.f(C,Ae,z);if(C.l=de,M(Me,xe,ie))return}}}function t(C,M){switch(M.type){case"base64":return r(nl(ao(C)),M);case"binary":return r(nl(C),M);case"buffer":case"array":return r(C,M)}throw"Unsupported type "+M.type}function r(C,M){if(!C)return C;var z=M||{},H=z.dense?[]:{},ie="Sheet1",xe="",Ae=0,de={},Me=[],ct=[],se={s:{r:0,c:0},e:{r:0,c:0}},bt=z.sheetRows||0;if(C[2]==0&&(C[3]==8||C[3]==9)&&C.length>=16&&C[14]==5&&C[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(C[2]==2)z.Enum=Ee,e(C,function(mt,qt,xt){switch(xt){case 0:z.vers=mt,mt>=4096&&(z.qpro=!0);break;case 6:se=mt;break;case 204:mt&&(xe=mt);break;case 222:xe=mt;break;case 15:case 51:z.qpro||(mt[1].v=mt[1].v.slice(1));case 13:case 14:case 16:xt==14&&(mt[2]&112)==112&&(mt[2]&15)>1&&(mt[2]&15)<15&&(mt[1].z=z.dateNF||Wr[14],z.cellDates&&(mt[1].t="d",mt[1].v=bp(mt[1].v))),z.qpro&&mt[3]>Ae&&(H["!ref"]=hn(se),de[ie]=H,Me.push(ie),H=z.dense?[]:{},se={s:{r:0,c:0},e:{r:0,c:0}},Ae=mt[3],ie=xe||"Sheet"+(Ae+1),xe="");var _t=z.dense?(H[mt[0].r]||[])[mt[0].c]:H[qr(mt[0])];if(_t){_t.t=mt[1].t,_t.v=mt[1].v,mt[1].z!=null&&(_t.z=mt[1].z),mt[1].f!=null&&(_t.f=mt[1].f);break}z.dense?(H[mt[0].r]||(H[mt[0].r]=[]),H[mt[0].r][mt[0].c]=mt[1]):H[qr(mt[0])]=mt[1];break}},z);else if(C[2]==26||C[2]==14)z.Enum=pe,C[2]==14&&(z.qpro=!0,C.l=0),e(C,function(mt,qt,xt){switch(xt){case 204:ie=mt;break;case 22:mt[1].v=mt[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(mt[3]>Ae&&(H["!ref"]=hn(se),de[ie]=H,Me.push(ie),H=z.dense?[]:{},se={s:{r:0,c:0},e:{r:0,c:0}},Ae=mt[3],ie="Sheet"+(Ae+1)),bt>0&&mt[0].r>=bt)break;z.dense?(H[mt[0].r]||(H[mt[0].r]=[]),H[mt[0].r][mt[0].c]=mt[1]):H[qr(mt[0])]=mt[1],se.e.c<mt[0].c&&(se.e.c=mt[0].c),se.e.r<mt[0].r&&(se.e.r=mt[0].r);break;case 27:mt[14e3]&&(ct[mt[14e3][0]]=mt[14e3][1]);break;case 1537:ct[mt[0]]=mt[1],mt[0]==Ae&&(ie=mt[1]);break}},z);else throw new Error("Unrecognized LOTUS BOF "+C[2]);if(H["!ref"]=hn(se),de[xe||ie]=H,Me.push(xe||ie),!ct.length)return{SheetNames:Me,Sheets:de};for(var Dt={},Je=[],we=0;we<ct.length;++we)de[Me[we]]?(Je.push(ct[we]||Me[we]),Dt[ct[we]]=de[ct[we]]||de[Me[we]]):(Je.push(ct[we]),Dt[ct[we]]={"!ref":"A1"});return{SheetNames:Je,Sheets:Dt}}function n(C,M){var z=M||{};if(+z.codepage>=0&&al(+z.codepage),z.type=="string")throw new Error("Cannot write WK1 to JS string");var H=Lg(),ie=pa(C["!ref"]),xe=Array.isArray(C),Ae=[];Qo(H,0,i(1030)),Qo(H,6,u(ie));for(var de=Math.min(ie.e.r,8191),Me=ie.s.r;Me<=de;++Me)for(var ct=bi(Me),se=ie.s.c;se<=ie.e.c;++se){Me===ie.s.r&&(Ae[se]=Wa(se));var bt=Ae[se]+ct,Dt=xe?(C[Me]||[])[se]:C[bt];if(!(!Dt||Dt.t=="z"))if(Dt.t=="n")(Dt.v|0)==Dt.v&&Dt.v>=-32768&&Dt.v<=32767?Qo(H,13,m(Me,se,Dt.v)):Qo(H,14,b(Me,se,Dt.v));else{var Je=uc(Dt);Qo(H,15,g(Me,se,Je.slice(0,239)))}}return Qo(H,1),H.end()}function a(C,M){var z=M||{};if(+z.codepage>=0&&al(+z.codepage),z.type=="string")throw new Error("Cannot write WK3 to JS string");var H=Lg();Qo(H,0,o(C));for(var ie=0,xe=0;ie<C.SheetNames.length;++ie)(C.Sheets[C.SheetNames[ie]]||{})["!ref"]&&Qo(H,27,ne(C.SheetNames[ie],xe++));var Ae=0;for(ie=0;ie<C.SheetNames.length;++ie){var de=C.Sheets[C.SheetNames[ie]];if(!(!de||!de["!ref"])){for(var Me=pa(de["!ref"]),ct=Array.isArray(de),se=[],bt=Math.min(Me.e.r,8191),Dt=Me.s.r;Dt<=bt;++Dt)for(var Je=bi(Dt),we=Me.s.c;we<=Me.e.c;++we){Dt===Me.s.r&&(se[we]=Wa(we));var mt=se[we]+Je,qt=ct?(de[Dt]||[])[we]:de[mt];if(!(!qt||qt.t=="z"))if(qt.t=="n")Qo(H,23,ye(Dt,we,Ae,qt.v));else{var xt=uc(qt);Qo(H,22,B(Dt,we,Ae,xt.slice(0,239)))}}++Ae}}return Qo(H,1),H.end()}function i(C){var M=$a(2);return M.write_shift(2,C),M}function o(C){var M=$a(26);M.write_shift(2,4096),M.write_shift(2,4),M.write_shift(4,0);for(var z=0,H=0,ie=0,xe=0;xe<C.SheetNames.length;++xe){var Ae=C.SheetNames[xe],de=C.Sheets[Ae];if(!(!de||!de["!ref"])){++ie;var Me=Hf(de["!ref"]);z<Me.e.r&&(z=Me.e.r),H<Me.e.c&&(H=Me.e.c)}}return z>8191&&(z=8191),M.write_shift(2,z),M.write_shift(1,ie),M.write_shift(1,H),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(1,1),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(4,0),M}function l(C,M,z){var H={s:{c:0,r:0},e:{c:0,r:0}};return M==8&&z.qpro?(H.s.c=C.read_shift(1),C.l++,H.s.r=C.read_shift(2),H.e.c=C.read_shift(1),C.l++,H.e.r=C.read_shift(2),H):(H.s.c=C.read_shift(2),H.s.r=C.read_shift(2),M==12&&z.qpro&&(C.l+=2),H.e.c=C.read_shift(2),H.e.r=C.read_shift(2),M==12&&z.qpro&&(C.l+=2),H.s.c==65535&&(H.s.c=H.e.c=H.s.r=H.e.r=0),H)}function u(C){var M=$a(8);return M.write_shift(2,C.s.c),M.write_shift(2,C.s.r),M.write_shift(2,C.e.c),M.write_shift(2,C.e.r),M}function f(C,M,z){var H=[{c:0,r:0},{t:"n",v:0},0,0];return z.qpro&&z.vers!=20768?(H[0].c=C.read_shift(1),H[3]=C.read_shift(1),H[0].r=C.read_shift(2),C.l+=2):(H[2]=C.read_shift(1),H[0].c=C.read_shift(2),H[0].r=C.read_shift(2)),H}function h(C,M,z){var H=C.l+M,ie=f(C,M,z);if(ie[1].t="s",z.vers==20768){C.l++;var xe=C.read_shift(1);return ie[1].v=C.read_shift(xe,"utf8"),ie}return z.qpro&&C.l++,ie[1].v=C.read_shift(H-C.l,"cstr"),ie}function g(C,M,z){var H=$a(7+z.length);H.write_shift(1,255),H.write_shift(2,M),H.write_shift(2,C),H.write_shift(1,39);for(var ie=0;ie<H.length;++ie){var xe=z.charCodeAt(ie);H.write_shift(1,xe>=128?95:xe)}return H.write_shift(1,0),H}function x(C,M,z){var H=f(C,M,z);return H[1].v=C.read_shift(2,"i"),H}function m(C,M,z){var H=$a(7);return H.write_shift(1,255),H.write_shift(2,M),H.write_shift(2,C),H.write_shift(2,z,"i"),H}function k(C,M,z){var H=f(C,M,z);return H[1].v=C.read_shift(8,"f"),H}function b(C,M,z){var H=$a(13);return H.write_shift(1,255),H.write_shift(2,M),H.write_shift(2,C),H.write_shift(8,z,"f"),H}function E(C,M,z){var H=C.l+M,ie=f(C,M,z);if(ie[1].v=C.read_shift(8,"f"),z.qpro)C.l=H;else{var xe=C.read_shift(2);K(C.slice(C.l,C.l+xe),ie),C.l+=xe}return ie}function N(C,M,z){var H=M&32768;return M&=-32769,M=(H?C:0)+(M>=8192?M-16384:M),(H?"":"$")+(z?Wa(M):bi(M))}var O={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},F=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function K(C,M){yi(C,0);for(var z=[],H=0,ie="",xe="",Ae="",de="";C.l<C.length;){var Me=C[C.l++];switch(Me){case 0:z.push(C.read_shift(8,"f"));break;case 1:xe=N(M[0].c,C.read_shift(2),!0),ie=N(M[0].r,C.read_shift(2),!1),z.push(xe+ie);break;case 2:{var ct=N(M[0].c,C.read_shift(2),!0),se=N(M[0].r,C.read_shift(2),!1);xe=N(M[0].c,C.read_shift(2),!0),ie=N(M[0].r,C.read_shift(2),!1),z.push(ct+se+":"+xe+ie)}break;case 3:if(C.l<C.length){console.error("WK1 premature formula end");return}break;case 4:z.push("("+z.pop()+")");break;case 5:z.push(C.read_shift(2));break;case 6:{for(var bt="";Me=C[C.l++];)bt+=String.fromCharCode(Me);z.push('"'+bt.replace(/"/g,'""')+'"')}break;case 8:z.push("-"+z.pop());break;case 23:z.push("+"+z.pop());break;case 22:z.push("NOT("+z.pop()+")");break;case 20:case 21:de=z.pop(),Ae=z.pop(),z.push(["AND","OR"][Me-20]+"("+Ae+","+de+")");break;default:if(Me<32&&F[Me])de=z.pop(),Ae=z.pop(),z.push(Ae+F[Me]+de);else if(O[Me]){if(H=O[Me][1],H==69&&(H=C[C.l++]),H>z.length){console.error("WK1 bad formula parse 0x"+Me.toString(16)+":|"+z.join("|")+"|");return}var Dt=z.slice(-H);z.length-=H,z.push(O[Me][0]+"("+Dt.join(",")+")")}else return Me<=7?console.error("WK1 invalid opcode "+Me.toString(16)):Me<=24?console.error("WK1 unsupported op "+Me.toString(16)):Me<=30?console.error("WK1 invalid opcode "+Me.toString(16)):Me<=115?console.error("WK1 unsupported function opcode "+Me.toString(16)):console.error("WK1 unrecognized opcode "+Me.toString(16))}}z.length==1?M[1].f=""+z[0]:console.error("WK1 bad formula parse |"+z.join("|")+"|")}function te(C){var M=[{c:0,r:0},{t:"n",v:0},0];return M[0].r=C.read_shift(2),M[3]=C[C.l++],M[0].c=C[C.l++],M}function re(C,M){var z=te(C);return z[1].t="s",z[1].v=C.read_shift(M-4,"cstr"),z}function B(C,M,z,H){var ie=$a(6+H.length);ie.write_shift(2,C),ie.write_shift(1,z),ie.write_shift(1,M),ie.write_shift(1,39);for(var xe=0;xe<H.length;++xe){var Ae=H.charCodeAt(xe);ie.write_shift(1,Ae>=128?95:Ae)}return ie.write_shift(1,0),ie}function V(C,M){var z=te(C);z[1].v=C.read_shift(2);var H=z[1].v>>1;if(z[1].v&1)switch(H&7){case 0:H=(H>>3)*5e3;break;case 1:H=(H>>3)*500;break;case 2:H=(H>>3)/20;break;case 3:H=(H>>3)/200;break;case 4:H=(H>>3)/2e3;break;case 5:H=(H>>3)/2e4;break;case 6:H=(H>>3)/16;break;case 7:H=(H>>3)/64;break}return z[1].v=H,z}function Y(C,M){var z=te(C),H=C.read_shift(4),ie=C.read_shift(4),xe=C.read_shift(2);if(xe==65535)return H===0&&ie===3221225472?(z[1].t="e",z[1].v=15):H===0&&ie===3489660928?(z[1].t="e",z[1].v=42):z[1].v=0,z;var Ae=xe&32768;return xe=(xe&32767)-16446,z[1].v=(1-Ae*2)*(ie*Math.pow(2,xe+32)+H*Math.pow(2,xe)),z}function ye(C,M,z,H){var ie=$a(14);if(ie.write_shift(2,C),ie.write_shift(1,z),ie.write_shift(1,M),H==0)return ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(2,65535),ie;var xe=0,Ae=0,de=0,Me=0;return H<0&&(xe=1,H=-H),Ae=Math.log2(H)|0,H/=Math.pow(2,Ae-31),Me=H>>>0,(Me&2147483648)==0&&(H/=2,++Ae,Me=H>>>0),H-=Me,Me|=2147483648,Me>>>=0,H*=Math.pow(2,32),de=H>>>0,ie.write_shift(4,de),ie.write_shift(4,Me),Ae+=16383+(xe?32768:0),ie.write_shift(2,Ae),ie}function U(C,M){var z=Y(C);return C.l+=M-14,z}function D(C,M){var z=te(C),H=C.read_shift(4);return z[1].v=H>>6,z}function le(C,M){var z=te(C),H=C.read_shift(8,"f");return z[1].v=H,z}function ue(C,M){var z=le(C);return C.l+=M-10,z}function Te(C,M){return C[C.l+M-1]==0?C.read_shift(M,"cstr"):""}function Fe(C,M){var z=C[C.l++];z>M-1&&(z=M-1);for(var H="";H.length<z;)H+=String.fromCharCode(C[C.l++]);return H}function Le(C,M,z){if(!(!z.qpro||M<21)){var H=C.read_shift(1);C.l+=17,C.l+=1,C.l+=2;var ie=C.read_shift(M-21,"cstr");return[H,ie]}}function me(C,M){for(var z={},H=C.l+M;C.l<H;){var ie=C.read_shift(2);if(ie==14e3){for(z[ie]=[0,""],z[ie][0]=C.read_shift(2);C[C.l];)z[ie][1]+=String.fromCharCode(C[C.l]),C.l++;C.l++}}return z}function ne(C,M){var z=$a(5+C.length);z.write_shift(2,14e3),z.write_shift(2,M);for(var H=0;H<C.length;++H){var ie=C.charCodeAt(H);z[z.l++]=ie>127?95:ie}return z[z.l++]=0,z}var Ee={0:{n:"BOF",f:Ra},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:k},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Te},222:{n:"SHEETNAMELP",f:Fe},65535:{n:""}},pe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:re},23:{n:"NUMBER17",f:Y},24:{n:"NUMBER18",f:V},25:{n:"FORMULA19",f:U},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:me},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:le},40:{n:"FORMULA28",f:ue},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Te},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Le},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function aP(e){var t={},r=e.match(Xi),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=Rr(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=xm[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}var iP=function(){var e=Q0("t"),t=Q0("rPr");function r(i){var o=i.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:pn(o[1])},u=i.match(t);return u&&(l.s=aP(u[1])),l}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(a).map(r).filter(function(l){return l.v})}}(),sP=function(){var t=/(\r\n|\n)/g;function r(a,i,o){var l=[];a.u&&l.push("text-decoration: underline;"),a.uval&&l.push("text-underline-style:"+a.uval+";"),a.sz&&l.push("font-size:"+a.sz+"pt;"),a.outline&&l.push("text-effect: outline;"),a.shadow&&l.push("text-shadow: auto;"),i.push('<span style="'+l.join("")+'">'),a.b&&(i.push("<b>"),o.push("</b>")),a.i&&(i.push("<i>"),o.push("</i>")),a.strike&&(i.push("<s>"),o.push("</s>"));var u=a.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(i.push("<"+u+">"),o.push("</"+u+">")),o.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),oP=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,lP=/<(?:\w+:)?r>/,cP=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Rm(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=pn(Kn(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Kn(e),r&&(n.h=Em(n.t))):e.match(lP)&&(n.r=Kn(e),n.t=pn(Kn((e.replace(cP,"").match(oP)||[]).join("").replace(Xi,""))),r&&(n.h=sP(iP(n.r)))),n):{t:""}}var uP=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,fP=/<(?:\w+:)?(?:si|sstItem)>/g,hP=/<\/(?:\w+:)?(?:si|sstItem)>/;function dP(e,t){var r=[],n="";if(!e)return r;var a=e.match(uP);if(a){n=a[2].replace(fP,"").split(hP);for(var i=0;i!=n.length;++i){var o=Rm(n[i].trim(),t);o!=null&&(r[r.length]=o)}a=Rr(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}function pP(e){return[e.read_shift(4),e.read_shift(4)]}function gP(e,t){var r=[],n=!1;return dc(e,function(i,o,l){switch(l){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function fb(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function sc(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function mP(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=sc(e,4),t.U=sc(e,4),t.W=sc(e,4),t}function vP(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function xP(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(vP(e));return t}function yP(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function wP(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=sc(e,4),t.U=sc(e,4),t.W=sc(e,4),t}function bP(e){var t=wP(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function hb(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function db(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function _P(e){var t=sc(e);switch(t.Minor){case 2:return[t.Minor,kP(e)];case 3:return[t.Minor,SP()];case 4:return[t.Minor,EP(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function kP(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=hb(e,r),a=db(e,e.length-e.l);return{t:"Std",h:n,v:a}}function SP(){throw new Error("File is password-protected: ECMA-376 Extensible")}function EP(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Xi,function(i){var o=Rr(i);switch(Dl(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function AP(e,t){var r={},n=r.EncryptionVersionInfo=sc(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=hb(e,a),t-=a,r.EncryptionVerifier=db(e,t),r}function NP(e){var t={},r=t.EncryptionVersionInfo=sc(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function TP(e){var t=0,r,n=fb(e),a=n.length+1,i,o,l,u,f;for(r=Yc(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)o=r[i],l=(t&16384)===0?0:1,u=t<<1&32767,f=l|u,t=f^o;return t^52811}var pb=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},a=function(o,l){return n(o^l)},i=function(o){for(var l=t[o.length-1],u=104,f=o.length-1;f>=0;--f)for(var h=o[f],g=0;g!=7;++g)h&64&&(l^=r[u]),h*=2,--u;return l};return function(o){for(var l=fb(o),u=i(l),f=l.length,h=Yc(16),g=0;g!=16;++g)h[g]=0;var x,m,k;for((f&1)===1&&(x=u>>8,h[f]=a(e[0],x),--f,x=u&255,m=l[l.length-1],h[f]=a(m,x));f>0;)--f,x=u>>8,h[f]=a(l[f],x),--f,x=u&255,h[f]=a(l[f],x);for(f=15,k=15-l.length;k>0;)x=u>>8,h[f]=a(e[k],x),--f,--k,x=u&255,h[f]=a(l[f],x),--f,--k;return h}}(),CP=function(e,t,r,n,a){a||(a=t),n||(n=pb(e));var i,o;for(i=0;i!=t.length;++i)o=t[i],o^=n[r],o=(o>>5|o<<3)&255,a[i]=o,++r;return[a,r,n]},PP=function(e){var t=0,r=pb(e);return function(n){var a=CP("",n,t,r);return t=a[1],a[0]}};function LP(e,t,r,n){var a={key:Ra(e),verificationBytes:Ra(e)};return r.password&&(a.verifier=TP(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=PP(r.password)),a}function FP(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=NP(e):n.Data=AP(e,t),n}function OP(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?FP(e,t-2,n):LP(e,r.biff>=8?t:t-2,r,n),n}var IP=function(){function e(a,i){switch(i.type){case"base64":return t(ao(a),i);case"binary":return t(a,i);case"buffer":return t(on&&Buffer.isBuffer(a)?a.toString("binary"):Iu(a),i);case"array":return t(Pu(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var o=i||{},l=o.dense?[]:{},u=a.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(h,g){Array.isArray(l)&&(l[g]=[]);for(var x=/\\\w+\b/g,m=0,k,b=-1;k=x.exec(h);){switch(k[0]){case"\\cell":var E=h.slice(m,x.lastIndex-k[0].length);if(E[0]==" "&&(E=E.slice(1)),++b,E.length){var N={v:E,t:"s"};Array.isArray(l)?l[g][b]=N:l[qr({r:g,c:b})]=N}break}m=x.lastIndex}b>f.e.c&&(f.e.c=b)}),l["!ref"]=hn(f),l}function r(a,i){return Qc(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],o=pa(a["!ref"]),l,u=Array.isArray(a),f=o.s.r;f<=o.e.r;++f){i.push("\\trowd\\trautofit1");for(var h=o.s.c;h<=o.e.c;++h)i.push("\\cellx"+(h+1));for(i.push("\\pard\\intbl"),h=o.s.c;h<=o.e.c;++h){var g=qr({r:f,c:h});l=u?(a[f]||[])[h]:a[g],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(uc(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function RP(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function th(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function DP(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),i=Math.min(t,r,n),o=a-i;if(o===0)return[0,0,t];var l=0,u=0,f=a+i;switch(u=o/(f>1?2-f:f),a){case t:l=((r-n)/o+6)%6;break;case r:l=(n-t)/o+2;break;case n:l=(t-r)/o+4;break}return[l/6,u,f/2]}function jP(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),i=n-a/2,o=[i,i,i],l=6*t,u;if(r!==0)switch(l|0){case 0:case 6:u=a*l,o[0]+=a,o[1]+=u;break;case 1:u=a*(2-l),o[0]+=u,o[1]+=a;break;case 2:u=a*(l-2),o[1]+=a,o[2]+=u;break;case 3:u=a*(4-l),o[1]+=u,o[2]+=a;break;case 4:u=a*(l-4),o[2]+=a,o[0]+=u;break;case 5:u=a*(6-l),o[2]+=u,o[0]+=a;break}for(var f=0;f!=3;++f)o[f]=Math.round(o[f]*255);return o}function tp(e,t){if(t===0)return e;var r=DP(RP(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),th(jP(r))}var gb=6,MP=15,BP=1,gs=gb;function rp(e){return Math.floor((e+Math.round(128/gs)/256)*gs)}function np(e){return Math.floor((e-5)/gs*100+.5)/100}function Rg(e){return Math.round((e*gs+5)/gs*256)/256}function V1(e){return Rg(np(rp(e)))}function Dm(e){var t=Math.abs(e-V1(e)),r=gs;if(t>.005)for(gs=BP;gs<MP;++gs)Math.abs(e-V1(e))<=t&&(t=Math.abs(e-V1(e)),r=gs);gs=r}function Df(e){e.width?(e.wpx=rp(e.width),e.wch=np(e.wpx),e.MDW=gs):e.wpx?(e.wch=np(e.wpx),e.width=Rg(e.wch),e.MDW=gs):typeof e.wch=="number"&&(e.width=Rg(e.wch),e.wpx=rp(e.width),e.MDW=gs),e.customWidth&&delete e.customWidth}var UP=96,mb=UP;function vb(e){return e*96/mb}function rh(e){return e*mb/96}var zP={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function qP(e,t,r,n){t.Borders=[];var a={},i=!1;(e[0].match(Xi)||[]).forEach(function(o){var l=Rr(o);switch(Dl(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},l.diagonalUp&&(a.diagonalUp=ta(l.diagonalUp)),l.diagonalDown&&(a.diagonalDown=ta(l.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in borders")}})}function $P(e,t,r,n){t.Fills=[];var a={},i=!1;(e[0].match(Xi)||[]).forEach(function(o){var l=Rr(o);switch(Dl(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":l.patternType&&(a.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),l.indexed&&(a.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(a.bgColor.theme=parseInt(l.theme,10)),l.tint&&(a.bgColor.tint=parseFloat(l.tint)),l.rgb&&(a.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),l.theme&&(a.fgColor.theme=parseInt(l.theme,10)),l.tint&&(a.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(a.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fills")}})}function HP(e,t,r,n){t.Fonts=[];var a={},i=!1;(e[0].match(Xi)||[]).forEach(function(o){var l=Rr(o);switch(Dl(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":l.val&&(a.name=Kn(l.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=l.val?ta(l.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=l.val?ta(l.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(l.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=l.val?ta(l.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=l.val?ta(l.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=l.val?ta(l.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=l.val?ta(l.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=l.val?ta(l.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":l.val&&(a.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(a.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(a.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(a.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=xm[parseInt(l.val,10)];break;case"<color":if(a.color||(a.color={}),l.auto&&(a.color.auto=ta(l.auto)),l.rgb)a.color.rgb=l.rgb.slice(-6);else if(l.indexed){a.color.index=parseInt(l.indexed,10);var u=Nu[a.color.index];a.color.index==81&&(u=Nu[1]),u||(u=Nu[1]),a.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else l.theme&&(a.color.theme=parseInt(l.theme,10),l.tint&&(a.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=tp(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fonts")}})}function VP(e,t,r){t.NumberFmt=[];for(var n=Ol(Wr),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Wr[n[a]];var i=e[0].match(Xi);if(i)for(a=0;a<i.length;++a){var o=Rr(i[a]);switch(Dl(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=pn(Kn(o.formatCode)),u=parseInt(o.numFmtId,10);if(t.NumberFmt[u]=l,u>0){if(u>392){for(u=392;u>60&&t.NumberFmt[u]!=null;--u);t.NumberFmt[u]=l}Au(l,u)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var yd=["numFmtId","fillId","fontId","borderId","xfId"],wd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function WP(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Xi)||[]).forEach(function(i){var o=Rr(i),l=0;switch(Dl(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<yd.length;++l)n[yd[l]]&&(n[yd[l]]=parseInt(n[yd[l]],10));for(l=0;l<wd.length;++l)n[wd[l]]&&(n[wd[l]]=ta(n[wd[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};o.vertical&&(u.vertical=o.vertical),o.horizontal&&(u.horizontal=o.horizontal),o.textRotation!=null&&(u.textRotation=o.textRotation),o.indent&&(u.indent=o.indent),o.wrapText&&(u.wrapText=ta(o.wrapText)),n.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var KP=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,u,f){var h={};if(!l)return h;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var g;return(g=l.match(t))&&VP(g,h,f),(g=l.match(a))&&HP(g,h,u,f),(g=l.match(n))&&$P(g,h,u,f),(g=l.match(i))&&qP(g,h,u,f),(g=l.match(r))&&WP(g,h,f),h}}();function GP(e,t){var r=e.read_shift(2),n=Gi(e);return[r,n]}function YP(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=i8(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var l=e.read_shift(1);l>0&&(n.family=l);var u=e.read_shift(1);switch(u>0&&(n.charset=u),e.l++,n.color=a8(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Gi(e),n}var XP=Yi;function JP(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}var QP=Yi;function ZP(e,t,r){var n={};n.NumberFmt=[];for(var a in Wr)n.NumberFmt[a]=Wr[a];n.CellXf=[],n.Fonts=[];var i=[],o=!1;return dc(e,function(u,f,h){switch(h){case 44:n.NumberFmt[u[0]]=u[1],Au(u[1],u[0]);break;case 43:n.Fonts.push(u),u.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(u.color.rgb=tp(t.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(h),o=!0;break;case 38:i.pop(),o=!1;break;default:if(f.T>0)i.push(h);else if(f.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),n}var e7=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function t7(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Xi)||[]).forEach(function(a){var i=Rr(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[e7.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function r7(){}function n7(){}var a7=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,i7=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,s7=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function o7(e,t,r){t.themeElements={};var n;[["clrScheme",a7,t7],["fontScheme",i7,r7],["fmtScheme",s7,n7]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var l7=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function xb(e,t){(!e||e.length===0)&&(e=c7());var r,n={};if(!(r=e.match(l7)))throw new Error("themeElements not found in theme");return o7(r[0],n,t),n.raw=e,n}function c7(e,t){var r=[C5];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function u7(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var o;try{o=T5(i,{type:"array"})}catch{return}var l=ro(o,"theme/theme/theme1.xml",!0);if(l)return xb(l,r)}}function f7(e){return e.read_shift(4)}function h7(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=d7(e,4);break;case 2:t.xclrValue=ab(e);break;case 3:t.xclrValue=f7(e);break;case 4:e.l+=4;break}return e.l+=8,t}function d7(e,t){return Yi(e,t)}function p7(e,t){return Yi(e,t)}function g7(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=h7(e);break;case 6:n[1]=p7(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function m7(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),i=[];a-- >0;)i.push(g7(e,r-e.l));return{ixfe:n,ext:i}}function v7(e,t){t.forEach(function(r){r[0]})}function x7(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Gi(e)}}function y7(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function w7(e){return e.l+=4,e.read_shift(4)!=0}function b7(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],o=!1,l=2;return dc(e,function(u,f,h){switch(h){case 335:n.Types.push({name:u.name});break;case 51:u.forEach(function(g){l==1?n.Cell.push({type:n.Types[g[0]-1].name,index:g[1]}):l==0&&n.Value.push({type:n.Types[g[0]-1].name,index:g[1]})});break;case 337:l=u?1:0;break;case 338:l=2;break;case 35:i.push(h),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!f.T){if(!o||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}function _7(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,i=2,o;return e.replace(Xi,function(l){var u=Rr(l);switch(Dl(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<n.Types.length;++f)n.Types[f].name==u.name&&(o=n.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[u.t-1].name,index:+u.v}):i==0&&n.Value.push({type:n.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+u.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return l}),n}function k7(e){var t=[];if(!e)return t;var r=1;return(e.match(Xi)||[]).forEach(function(n){var a=Rr(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function S7(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=qr(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function E7(e,t,r){var n=[];return dc(e,function(i,o,l){switch(l){case 63:n.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function A7(e,t,r,n){if(!e)return e;var a=n||{},i=!1;dc(e,function(l,u,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!u.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},a)}function N7(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function sy(e,t,r,n){var a=Array.isArray(e),i;t.forEach(function(o){var l=ms(o.ref);if(a?(e[l.r]||(e[l.r]=[]),i=e[l.r][l.c]):i=e[o.ref],!i){i={t:"z"},a?e[l.r][l.c]=i:e[o.ref]=i;var u=pa(e["!ref"]||"BDWGO1000001:A1");u.s.r>l.r&&(u.s.r=l.r),u.e.r<l.r&&(u.e.r=l.r),u.s.c>l.c&&(u.s.c=l.c),u.e.c<l.c&&(u.e.c=l.c);var f=hn(u);f!==e["!ref"]&&(e["!ref"]=f)}i.c||(i.c=[]);var h={a:o.author,t:o.t,r:o.r,T:r};o.h&&(h.h=o.h);for(var g=i.c.length-1;g>=0;--g){if(!r&&i.c[g].T)return;r&&!i.c[g].T&&i.c.splice(g,1)}if(r&&n){for(g=0;g<n.length;++g)if(h.a==n[g].id){h.a=n[g].name||h.a;break}}i.c.push(h)})}function T7(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var u=Rr(l[0]),f={author:u.authorId&&r[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},h=ms(u.ref);if(!(t.sheetRows&&t.sheetRows<=h.r)){var g=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),x=!!g&&!!g[1]&&Rm(g[1])||{r:"",t:"",h:""};f.r=x.r,x.r=="<t></t>"&&(x.t=x.h=""),f.t=(x.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(f.h=x.h),n.push(f)}}}}),n}function C7(e,t){var r=[],n=!1,a={},i=0;return e.replace(Xi,function(l,u){var f=Rr(l);switch(Dl(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=u+l.length;break;case"</text>":a.t=e.slice(i,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return l}),r}function P7(e,t){var r=[],n=!1;return e.replace(Xi,function(i){var o=Rr(i);switch(Dl(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function L7(e){var t={};t.iauthor=e.read_shift(4);var r=Du(e);return t.rfx=r.s,t.ref=qr(r.s),e.l+=16,t}var F7=Gi;function O7(e,t){var r=[],n=[],a={},i=!1;return dc(e,function(l,u,f){switch(f){case 632:n.push(l);break;case 635:a=l;break;case 637:a.t=l.t,a.h=l.h,a.r=l.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),r}var I7="application/vnd.ms-office.vbaProject";function R7(e){var t=fn.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");fn.utils.cfb_add(t,a,e.FileIndex[n].content)}}),fn.write(t)}function D7(){return{"!type":"dialog"}}function j7(){return{"!type":"dialog"}}function M7(){return{"!type":"macro"}}function B7(){return{"!type":"macro"}}var Of=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,o){var l=!1,u=!1;i.length==0?u=!0:i.charAt(0)=="["&&(u=!0,i=i.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var f=i.length>0?parseInt(i,10)|0:0,h=o.length>0?parseInt(o,10)|0:0;return l?h+=t.c:--h,u?f+=t.r:--f,a+(l?"":"$")+Wa(h)+(u?"":"$")+bi(f)}return function(a,i){return t=i,a.replace(e,r)}}(),yb=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,U7=function(){return function(t,r){return t.replace(yb,function(n,a,i,o,l,u){var f=Cm(o)-(i?0:r.c),h=Tm(u)-(l?0:r.r),g=h==0?"":l?h+1:"["+h+"]",x=f==0?"":i?f+1:"["+f+"]";return a+"R"+g+"C"+x})}}();function wb(e,t){return e.replace(yb,function(r,n,a,i,o,l){return n+(a=="$"?a+i:Wa(Cm(i)+t.c))+(o=="$"?o+l:bi(Tm(l)+t.r))})}function z7(e,t,r){var n=Hf(t),a=n.s,i=ms(r),o={r:i.r-a.r,c:i.c-a.c};return wb(e,o)}function q7(e){return e.length!=1}function oy(e){return e.replace(/_xlfn\./g,"")}function Oa(e){e.l+=1}function Xc(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function bb(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return _b(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),o=Xc(e),l=Xc(e);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function _b(e){var t=Xc(e),r=Xc(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function $7(e,t,r){if(r.biff<8)return _b(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=Xc(e),o=Xc(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function kb(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return H7(e);var n=e.read_shift(r&&r.biff==12?4:2),a=Xc(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function H7(e){var t=Xc(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function V7(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function W7(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return K7(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),o=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;a>524287;)a-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:o,rRel:l}}function K7(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function G7(e,t,r){var n=(e[e.l++]&96)>>5,a=bb(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function Y7(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var o=bb(e,i,r);return[n,a,o]}function X7(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function J7(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function Q7(e,t,r){var n=(e[e.l++]&96)>>5,a=$7(e,t-1,r);return[n,a]}function Z7(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function ly(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function eL(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function tL(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function rL(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function nL(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function aL(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function Sb(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function iL(e){return e.read_shift(2),Sb(e)}function sL(e){return e.read_shift(2),Sb(e)}function oL(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=kb(e,0,r);return[n,a]}function lL(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=W7(e,0,r);return[n,a]}function cL(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=kb(e,0,r);return[n,a,i]}function uL(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[fF[a],Nb[a],n]}function fL(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:hL(e);return[a,(i[0]===0?Nb:uF)[i[1]]]}function hL(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function dL(e,t,r){e.l+=r&&r.biff==2?3:4}function pL(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function gL(e){return e.l++,ju[e.read_shift(1)]}function mL(e){return e.l++,e.read_shift(2)}function vL(e){return e.l++,e.read_shift(1)!==0}function xL(e){return e.l++,Wi(e)}function yL(e,t,r){return e.l++,ph(e,t-1,r)}function wL(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Ea(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=ju[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Wi(e);break;case 2:r[1]=Mu(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function bL(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?Du:_p)(e));return a}function _L(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,o=[];i!=n&&(o[i]=[]);++i)for(var l=0;l!=a;++l)o[i][l]=wL(e,r.biff);return o}function kL(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function SL(e,t,r){if(r.biff==5)return EL(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function EL(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function AL(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function NL(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function TL(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function CL(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var PL=Yi,LL=Yi,FL=Yi;function mh(e,t,r){return e.l+=2,[V7(e)]}function jm(e){return e.l+=6,[]}var OL=mh,IL=jm,RL=jm,DL=mh;function Eb(e){return e.l+=2,[Ra(e),e.read_shift(2)&1]}var jL=mh,ML=Eb,BL=jm,UL=mh,zL=mh,qL=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function $L(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),o=qL[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:a,C:i}}function HL(e){return e.l+=2,[e.read_shift(4)]}function VL(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function WL(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function KL(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function GL(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function YL(e){return e.l+=4,[0,0]}var cy={1:{n:"PtgExp",f:pL},2:{n:"PtgTbl",f:FL},3:{n:"PtgAdd",f:Oa},4:{n:"PtgSub",f:Oa},5:{n:"PtgMul",f:Oa},6:{n:"PtgDiv",f:Oa},7:{n:"PtgPower",f:Oa},8:{n:"PtgConcat",f:Oa},9:{n:"PtgLt",f:Oa},10:{n:"PtgLe",f:Oa},11:{n:"PtgEq",f:Oa},12:{n:"PtgGe",f:Oa},13:{n:"PtgGt",f:Oa},14:{n:"PtgNe",f:Oa},15:{n:"PtgIsect",f:Oa},16:{n:"PtgUnion",f:Oa},17:{n:"PtgRange",f:Oa},18:{n:"PtgUplus",f:Oa},19:{n:"PtgUminus",f:Oa},20:{n:"PtgPercent",f:Oa},21:{n:"PtgParen",f:Oa},22:{n:"PtgMissArg",f:Oa},23:{n:"PtgStr",f:yL},26:{n:"PtgSheet",f:VL},27:{n:"PtgEndSheet",f:WL},28:{n:"PtgErr",f:gL},29:{n:"PtgBool",f:vL},30:{n:"PtgInt",f:mL},31:{n:"PtgNum",f:xL},32:{n:"PtgArray",f:Z7},33:{n:"PtgFunc",f:uL},34:{n:"PtgFuncVar",f:fL},35:{n:"PtgName",f:kL},36:{n:"PtgRef",f:oL},37:{n:"PtgArea",f:G7},38:{n:"PtgMemArea",f:AL},39:{n:"PtgMemErr",f:PL},40:{n:"PtgMemNoMem",f:LL},41:{n:"PtgMemFunc",f:NL},42:{n:"PtgRefErr",f:TL},43:{n:"PtgAreaErr",f:X7},44:{n:"PtgRefN",f:lL},45:{n:"PtgAreaN",f:Q7},46:{n:"PtgMemAreaN",f:KL},47:{n:"PtgMemNoMemN",f:GL},57:{n:"PtgNameX",f:SL},58:{n:"PtgRef3d",f:cL},59:{n:"PtgArea3d",f:Y7},60:{n:"PtgRefErr3d",f:CL},61:{n:"PtgAreaErr3d",f:J7},255:{}},XL={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},JL={1:{n:"PtgElfLel",f:Eb},2:{n:"PtgElfRw",f:UL},3:{n:"PtgElfCol",f:OL},6:{n:"PtgElfRwV",f:zL},7:{n:"PtgElfColV",f:DL},10:{n:"PtgElfRadical",f:jL},11:{n:"PtgElfRadicalS",f:BL},13:{n:"PtgElfColS",f:IL},15:{n:"PtgElfColSV",f:RL},16:{n:"PtgElfRadicalLel",f:ML},25:{n:"PtgList",f:$L},29:{n:"PtgSxName",f:HL},255:{}},QL={0:{n:"PtgAttrNoop",f:YL},1:{n:"PtgAttrSemi",f:aL},2:{n:"PtgAttrIf",f:rL},4:{n:"PtgAttrChoose",f:eL},8:{n:"PtgAttrGoto",f:tL},16:{n:"PtgAttrSum",f:dL},32:{n:"PtgAttrBaxcel",f:ly},33:{n:"PtgAttrBaxcel",f:ly},64:{n:"PtgAttrSpace",f:iL},65:{n:"PtgAttrSpaceSemi",f:sL},128:{n:"PtgAttrIfError",f:nL},255:{}};function vh(e,t,r,n){if(n.biff<8)return Yi(e,t);for(var a=e.l+t,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=_L(e,0,n),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=bL(e,r[o][1],n),i.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=a-e.l,t!==0&&i.push(Yi(e,t)),i}function xh(e,t,r){for(var n=e.l+t,a,i,o=[];n!=e.l;)t=n-e.l,i=e[e.l],a=cy[i]||cy[XL[i]],(i===24||i===25)&&(a=(i===24?JL:QL)[e[e.l+1]]),!a||!a.f?Yi(e,t):o.push([a.n,a.f(e,t,r)]);return o}function ZL(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var o=n[i];if(o)switch(o[0]){case 2:a.push('"'+o[1].replace(/"/g,'""')+'"');break;default:a.push(o[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var eF={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function tF(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Ab(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function uy(e,t,r){var n=Ab(e,t,r);return n=="#REF"?n:tF(n,r)}function Hi(e,t,r,n,a){var i=a&&a.biff||8,o={s:{c:0,r:0}},l=[],u,f,h,g=0,x=0,m,k="";if(!e[0]||!e[0][0])return"";for(var b=-1,E="",N=0,O=e[0].length;N<O;++N){var F=e[0][N];switch(F[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=l.pop(),f=l.pop(),b>=0){switch(e[0][b][1][0]){case 0:E=da(" ",e[0][b][1][1]);break;case 1:E=da("\r",e[0][b][1][1]);break;default:if(E="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][b][1][0])}f=f+E,b=-1}l.push(f+eF[F[0]]+u);break;case"PtgIsect":u=l.pop(),f=l.pop(),l.push(f+" "+u);break;case"PtgUnion":u=l.pop(),f=l.pop(),l.push(f+","+u);break;case"PtgRange":u=l.pop(),f=l.pop(),l.push(f+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=T0(F[1][1],o,a),l.push(C0(h,i));break;case"PtgRefN":h=r?T0(F[1][1],r,a):F[1][1],l.push(C0(h,i));break;case"PtgRef3d":g=F[1][1],h=T0(F[1][2],o,a),k=uy(n,g,a),l.push(k+"!"+C0(h,i));break;case"PtgFunc":case"PtgFuncVar":var K=F[1][0],te=F[1][1];K||(K=0),K&=127;var re=K==0?[]:l.slice(-K);l.length-=K,te==="User"&&(te=re.shift()),l.push(te+"("+re.join(",")+")");break;case"PtgBool":l.push(F[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(F[1]);break;case"PtgNum":l.push(String(F[1]));break;case"PtgStr":l.push('"'+F[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(F[1]);break;case"PtgAreaN":m=Hx(F[1][1],r?{s:r}:o,a),l.push($1(m,a));break;case"PtgArea":m=Hx(F[1][1],o,a),l.push($1(m,a));break;case"PtgArea3d":g=F[1][1],m=F[1][2],k=uy(n,g,a),l.push(k+"!"+$1(m,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=F[1][2];var B=(n.names||[])[x-1]||(n[0]||[])[x],V=B?B.Name:"SH33TJSNAME"+String(x);V&&V.slice(0,6)=="_xlfn."&&!a.xlfn&&(V=V.slice(6)),l.push(V);break;case"PtgNameX":var Y=F[1][1];x=F[1][2];var ye;if(a.biff<=5)Y<0&&(Y=-Y),n[Y]&&(ye=n[Y][x]);else{var U="";if(((n[Y]||[])[0]||[])[0]==14849||(((n[Y]||[])[0]||[])[0]==1025?n[Y][x]&&n[Y][x].itab>0&&(U=n.SheetNames[n[Y][x].itab-1]+"!"):U=n.SheetNames[x-1]+"!"),n[Y]&&n[Y][x])U+=n[Y][x].Name;else if(n[0]&&n[0][x])U+=n[0][x].Name;else{var D=(Ab(n,Y,a)||"").split(";;");D[x-1]?U=D[x-1]:U+="SH33TJSERRX"}l.push(U);break}ye||(ye={Name:"SH33TJSERRY"}),l.push(ye.Name);break;case"PtgParen":var le="(",ue=")";if(b>=0){switch(E="",e[0][b][1][0]){case 2:le=da(" ",e[0][b][1][1])+le;break;case 3:le=da("\r",e[0][b][1][1])+le;break;case 4:ue=da(" ",e[0][b][1][1])+ue;break;case 5:ue=da("\r",e[0][b][1][1])+ue;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][b][1][0])}b=-1}l.push(le+l.pop()+ue);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":h={c:F[1][1],r:F[1][0]};var Te={c:r.c,r:r.r};if(n.sharedf[qr(h)]){var Fe=n.sharedf[qr(h)];l.push(Hi(Fe,o,Te,n,a))}else{var Le=!1;for(u=0;u!=n.arrayf.length;++u)if(f=n.arrayf[u],!(h.c<f[0].s.c||h.c>f[0].e.c)&&!(h.r<f[0].s.r||h.r>f[0].e.r)){l.push(Hi(f[1],o,Te,n,a)),Le=!0;break}Le||l.push(F[1])}break;case"PtgArray":l.push("{"+ZL(F[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":b=N;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+F[1].idx+"[#"+F[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(F));default:throw new Error("Unrecognized Formula Token: "+String(F))}var me=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&b>=0&&me.indexOf(e[0][N][0])==-1){F=e[0][b];var ne=!0;switch(F[1][0]){case 4:ne=!1;case 0:E=da(" ",F[1][1]);break;case 5:ne=!1;case 1:E=da("\r",F[1][1]);break;default:if(E="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+F[1][0])}l.push((ne?E:"")+l.pop()+(ne?"":E)),b=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]}function rF(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,o=e.read_shift(a);if(o==65535)return[[],Yi(e,t-2)];var l=xh(e,o,r);return t!==o+a&&(i=vh(e,t-o-a,l,r)),e.l=n,[l,i]}function nF(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,o=e.read_shift(a);if(o==65535)return[[],Yi(e,t-2)];var l=xh(e,o,r);return t!==o+a&&(i=vh(e,t-o-a,l,r)),e.l=n,[l,i]}function aF(e,t,r,n){var a=e.l+t,i=xh(e,n,r),o;return a!==e.l&&(o=vh(e,a-e.l,i,r)),[i,o]}function iF(e,t,r){var n=e.l+t,a,i=e.read_shift(2),o=xh(e,i,r);return i==65535?[[],Yi(e,t-2)]:(t!==i+2&&(a=vh(e,n-i-2,o,r)),[o,a])}function sF(e){var t;if(nc(e,e.l+6)!==65535)return[Wi(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function W1(e,t,r){var n=e.l+t,a=jl(e);r.biff==2&&++e.l;var i=sF(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=nF(e,n-e.l,r);return{cell:a,val:i[0],formula:l,shared:o>>3&1,tt:i[1]}}function kp(e,t,r){var n=e.read_shift(4),a=xh(e,n,r),i=e.read_shift(4),o=i>0?vh(e,i,a,r):null;return[a,o]}var oF=kp,Sp=kp,lF=kp,cF=kp,uF={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Nb={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},fF={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function fy(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function K1(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var O0={},If={};function I0(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Tb(e,t,r,n,a,i){try{n.cellNF&&(e.z=Wr[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=li(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Wr[t]==null&&Au(hT[t]||"General",t),e.t==="e")e.w=e.w||ju[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=J0(e.v);else if(e.t==="d"){var o=xs(e.v);(o|0)===o?e.w=o.toString(10):e.w=J0(o)}else{if(e.v===void 0)return"";e.w=Cu(e.v,If)}else e.t==="d"?e.w=No(t,xs(e.v),If):e.w=No(t,e.v,If)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=tp(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=tp(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&i.Fills)throw l}}}function hF(e,t){var r=pa(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=hn(r))}var dF=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,pF=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,gF=/<(?:\w:)?hyperlink [^>]*>/mg,mF=/"(\w*:\w*)"/,vF=/<(?:\w:)?col\b[^>]*[\/]?>/g,xF=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,yF=/<(?:\w:)?pageMargins[^>]*\/>/g,Cb=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,wF=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,bF=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function _F(e,t,r,n,a,i,o){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",h="",g=e.match(pF);g?(f=e.slice(0,g.index),h=e.slice(g.index+g[0].length)):f=h=e;var x=f.match(Cb);x?Mm(x[0],l,a,r):(x=f.match(wF))&&kF(x[0],x[1]||"",l,a,r);var m=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var k=f.slice(m,m+50).match(mF);k&&hF(l,k[1])}var b=f.match(bF);b&&b[1]&&CF(b[1],a);var E=[];if(t.cellStyles){var N=f.match(vF);N&&AF(E,N)}g&&PF(g[1],l,t,u,i,o);var O=h.match(xF);O&&(l["!autofilter"]=NF(O[0]));var F=[],K=h.match(dF);if(K)for(m=0;m!=K.length;++m)F[m]=pa(K[m].slice(K[m].indexOf('"')+1));var te=h.match(gF);te&&SF(l,te,n);var re=h.match(yF);if(re&&(l["!margins"]=EF(Rr(re[0]))),!l["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(l["!ref"]=hn(u)),t.sheetRows>0&&l["!ref"]){var B=pa(l["!ref"]);t.sheetRows<=+B.e.r&&(B.e.r=t.sheetRows-1,B.e.r>u.e.r&&(B.e.r=u.e.r),B.e.r<B.s.r&&(B.s.r=B.e.r),B.e.c>u.e.c&&(B.e.c=u.e.c),B.e.c<B.s.c&&(B.s.c=B.e.c),l["!fullref"]=l["!ref"],l["!ref"]=hn(B))}return E.length>0&&(l["!cols"]=E),F.length>0&&(l["!merges"]=F),l}function Mm(e,t,r,n){var a=Rr(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=pn(Kn(a.codeName)))}function kF(e,t,r,n,a){Mm(e.slice(0,e.indexOf(">")),r,n,a)}function SF(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var i=Rr(Kn(t[a]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+pn(i.location))):(i.Target="#"+pn(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var l=pa(i.ref),u=l.s.r;u<=l.e.r;++u)for(var f=l.s.c;f<=l.e.c;++f){var h=qr({c:f,r:u});n?(e[u]||(e[u]=[]),e[u][f]||(e[u][f]={t:"z",v:void 0}),e[u][f].l=i):(e[h]||(e[h]={t:"z",v:void 0}),e[h].l=i)}}}function EF(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function AF(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=Rr(t[n],!0);a.hidden&&(a.hidden=ta(a.hidden));var i=parseInt(a.min,10)-1,o=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,Dm(a.width)),Df(a);i<=o;)e[i++]=wi(a)}}function NF(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var TF=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function CF(e,t){t.Views||(t.Views=[{}]),(e.match(TF)||[]).forEach(function(r,n){var a=Rr(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),ta(a.rightToLeft)&&(t.Views[n].RTL=!0)})}var PF=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=Q0("v"),o=Q0("f");return function(u,f,h,g,x,m){for(var k=0,b="",E=[],N=[],O=0,F=0,K=0,te="",re,B,V=0,Y=0,ye,U,D=0,le=0,ue=Array.isArray(m.CellXf),Te,Fe=[],Le=[],me=Array.isArray(f),ne=[],Ee={},pe=!1,C=!!h.sheetStubs,M=u.split(t),z=0,H=M.length;z!=H;++z){b=M[z].trim();var ie=b.length;if(ie!==0){var xe=0;e:for(k=0;k<ie;++k)switch(b[k]){case">":if(b[k-1]!="/"){++k;break e}if(h&&h.cellStyles){if(B=Rr(b.slice(xe,k),!0),V=B.r!=null?parseInt(B.r,10):V+1,Y=-1,h.sheetRows&&h.sheetRows<V)continue;Ee={},pe=!1,B.ht&&(pe=!0,Ee.hpt=parseFloat(B.ht),Ee.hpx=rh(Ee.hpt)),B.hidden=="1"&&(pe=!0,Ee.hidden=!0),B.outlineLevel!=null&&(pe=!0,Ee.level=+B.outlineLevel),pe&&(ne[V-1]=Ee)}break;case"<":xe=k;break}if(xe>=k)break;if(B=Rr(b.slice(xe,k),!0),V=B.r!=null?parseInt(B.r,10):V+1,Y=-1,!(h.sheetRows&&h.sheetRows<V)){g.s.r>V-1&&(g.s.r=V-1),g.e.r<V-1&&(g.e.r=V-1),h&&h.cellStyles&&(Ee={},pe=!1,B.ht&&(pe=!0,Ee.hpt=parseFloat(B.ht),Ee.hpx=rh(Ee.hpt)),B.hidden=="1"&&(pe=!0,Ee.hidden=!0),B.outlineLevel!=null&&(pe=!0,Ee.level=+B.outlineLevel),pe&&(ne[V-1]=Ee)),E=b.slice(k).split(e);for(var Ae=0;Ae!=E.length&&E[Ae].trim().charAt(0)=="<";++Ae);for(E=E.slice(Ae),k=0;k!=E.length;++k)if(b=E[k].trim(),b.length!==0){if(N=b.match(r),O=k,F=0,K=0,b="<c "+(b.slice(0,1)=="<"?">":"")+b,N!=null&&N.length===2){for(O=0,te=N[1],F=0;F!=te.length&&!((K=te.charCodeAt(F)-64)<1||K>26);++F)O=26*O+K;--O,Y=O}else++Y;for(F=0;F!=b.length&&b.charCodeAt(F)!==62;++F);if(++F,B=Rr(b.slice(0,F),!0),B.r||(B.r=qr({r:V-1,c:Y})),te=b.slice(F),re={t:""},(N=te.match(i))!=null&&N[1]!==""&&(re.v=pn(N[1])),h.cellFormula){if((N=te.match(o))!=null&&N[1]!==""){if(re.f=pn(Kn(N[1])).replace(/\r\n/g,`
`),h.xlfn||(re.f=oy(re.f)),N[0].indexOf('t="array"')>-1)re.F=(te.match(a)||[])[1],re.F.indexOf(":")>-1&&Fe.push([pa(re.F),re.F]);else if(N[0].indexOf('t="shared"')>-1){U=Rr(N[0]);var de=pn(Kn(N[1]));h.xlfn||(de=oy(de)),Le[parseInt(U.si,10)]=[U,de,B.r]}}else(N=te.match(/<f[^>]*\/>/))&&(U=Rr(N[0]),Le[U.si]&&(re.f=z7(Le[U.si][1],Le[U.si][2],B.r)));var Me=ms(B.r);for(F=0;F<Fe.length;++F)Me.r>=Fe[F][0].s.r&&Me.r<=Fe[F][0].e.r&&Me.c>=Fe[F][0].s.c&&Me.c<=Fe[F][0].e.c&&(re.F=Fe[F][1])}if(B.t==null&&re.v===void 0)if(re.f||re.F)re.v=0,re.t="n";else if(C)re.t="z";else continue;else re.t=B.t||"n";switch(g.s.c>Y&&(g.s.c=Y),g.e.c<Y&&(g.e.c=Y),re.t){case"n":if(re.v==""||re.v==null){if(!C)continue;re.t="z"}else re.v=parseFloat(re.v);break;case"s":if(typeof re.v>"u"){if(!C)continue;re.t="z"}else ye=O0[parseInt(re.v,10)],re.v=ye.t,re.r=ye.r,h.cellHTML&&(re.h=ye.h);break;case"str":re.t="s",re.v=re.v!=null?Kn(re.v):"",h.cellHTML&&(re.h=Em(re.v));break;case"inlineStr":N=te.match(n),re.t="s",N!=null&&(ye=Rm(N[1]))?(re.v=ye.t,h.cellHTML&&(re.h=ye.h)):re.v="";break;case"b":re.v=ta(re.v);break;case"d":h.cellDates?re.v=li(re.v,1):(re.v=xs(li(re.v,1)),re.t="n");break;case"e":(!h||h.cellText!==!1)&&(re.w=re.v),re.v=X5[re.v];break}if(D=le=0,Te=null,ue&&B.s!==void 0&&(Te=m.CellXf[B.s],Te!=null&&(Te.numFmtId!=null&&(D=Te.numFmtId),h.cellStyles&&Te.fillId!=null&&(le=Te.fillId))),Tb(re,D,le,h,x,m),h.cellDates&&ue&&re.t=="n"&&$f(Wr[D])&&(re.t="d",re.v=bp(re.v)),B.cm&&h.xlmeta){var ct=(h.xlmeta.Cell||[])[+B.cm-1];ct&&ct.type=="XLDAPR"&&(re.D=!0)}if(me){var se=ms(B.r);f[se.r]||(f[se.r]=[]),f[se.r][se.c]=re}else f[B.r]=re}}}}ne.length>0&&(f["!rows"]=ne)}}();function LF(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}var FF=Du;function OF(){}function IF(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=r8(e),r}function RF(e){var t=To(e);return[t]}function DF(e){var t=Ru(e);return[t]}function jF(e){var t=To(e),r=e.read_shift(1);return[t,r,"b"]}function MF(e){var t=Ru(e),r=e.read_shift(1);return[t,r,"b"]}function BF(e){var t=To(e),r=e.read_shift(1);return[t,r,"e"]}function UF(e){var t=Ru(e),r=e.read_shift(1);return[t,r,"e"]}function zF(e){var t=To(e),r=e.read_shift(4);return[t,r,"s"]}function qF(e){var t=Ru(e),r=e.read_shift(4);return[t,r,"s"]}function $F(e){var t=To(e),r=Wi(e);return[t,r,"n"]}function Pb(e){var t=Ru(e),r=Wi(e);return[t,r,"n"]}function HF(e){var t=To(e),r=Fm(e);return[t,r,"n"]}function VF(e){var t=Ru(e),r=Fm(e);return[t,r,"n"]}function WF(e){var t=To(e),r=Pm(e);return[t,r,"is"]}function KF(e){var t=To(e),r=Gi(e);return[t,r,"str"]}function GF(e){var t=Ru(e),r=Gi(e);return[t,r,"str"]}function YF(e,t,r){var n=e.l+t,a=To(e);a.r=r["!row"];var i=e.read_shift(1),o=[a,i,"b"];if(r.cellFormula){e.l+=2;var l=Sp(e,n-e.l,r);o[3]=Hi(l,null,a,r.supbooks,r)}else e.l=n;return o}function XF(e,t,r){var n=e.l+t,a=To(e);a.r=r["!row"];var i=e.read_shift(1),o=[a,i,"e"];if(r.cellFormula){e.l+=2;var l=Sp(e,n-e.l,r);o[3]=Hi(l,null,a,r.supbooks,r)}else e.l=n;return o}function JF(e,t,r){var n=e.l+t,a=To(e);a.r=r["!row"];var i=Wi(e),o=[a,i,"n"];if(r.cellFormula){e.l+=2;var l=Sp(e,n-e.l,r);o[3]=Hi(l,null,a,r.supbooks,r)}else e.l=n;return o}function QF(e,t,r){var n=e.l+t,a=To(e);a.r=r["!row"];var i=Gi(e),o=[a,i,"str"];if(r.cellFormula){e.l+=2;var l=Sp(e,n-e.l,r);o[3]=Hi(l,null,a,r.supbooks,r)}else e.l=n;return o}var ZF=Du;function eO(e,t){var r=e.l+t,n=Du(e),a=Lm(e),i=Gi(e),o=Gi(e),l=Gi(e);e.l=r;var u={rfx:n,relId:a,loc:i,display:l};return o&&(u.Tooltip=o),u}function tO(){}function rO(e,t,r){var n=e.l+t,a=K5(e),i=e.read_shift(1),o=[a];if(o[2]=i,r.cellFormula){var l=oF(e,n-e.l,r);o[1]=l}else e.l=n;return o}function nO(e,t,r){var n=e.l+t,a=Du(e),i=[a];if(r.cellFormula){var o=cF(e,n-e.l,r);i[1]=o,e.l=n}else e.l=n;return i}var aO=["left","right","top","bottom","header","footer"];function iO(e){var t={};return aO.forEach(function(r){t[r]=Wi(e)}),t}function sO(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function oO(){}function lO(){}function cO(e,t,r,n,a,i,o){if(!e)return e;var l=t||{};n||(n={"!id":{}});var u=l.dense?[]:{},f,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=!1,x=!1,m,k,b,E,N,O,F,K,te,re=[];l.biff=12,l["!row"]=0;var B=0,V=!1,Y=[],ye={},U=l.supbooks||a.supbooks||[[]];if(U.sharedf=ye,U.arrayf=Y,U.SheetNames=a.SheetNames||a.Sheets.map(function(me){return me.name}),!l.supbooks&&(l.supbooks=U,a.Names))for(var D=0;D<a.Names.length;++D)U[0][D+1]=a.Names[D];var le=[],ue=[],Te=!1;ap[16]={n:"BrtShortReal",f:Pb};var Fe;if(dc(e,function(ne,Ee,pe){if(!x)switch(pe){case 148:f=ne;break;case 0:m=ne,l.sheetRows&&l.sheetRows<=m.r&&(x=!0),K=bi(E=m.r),l["!row"]=m.r,(ne.hidden||ne.hpt||ne.level!=null)&&(ne.hpt&&(ne.hpx=rh(ne.hpt)),ue[ne.r]=ne);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(k={t:ne[2]},ne[2]){case"n":k.v=ne[1];break;case"s":F=O0[ne[1]],k.v=F.t,k.r=F.r;break;case"b":k.v=!!ne[1];break;case"e":k.v=ne[1],l.cellText!==!1&&(k.w=ju[k.v]);break;case"str":k.t="s",k.v=ne[1];break;case"is":k.t="s",k.v=ne[1].t;break}if((b=o.CellXf[ne[0].iStyleRef])&&Tb(k,b.numFmtId,null,l,i,o),N=ne[0].c==-1?N+1:ne[0].c,l.dense?(u[E]||(u[E]=[]),u[E][N]=k):u[Wa(N)+K]=k,l.cellFormula){for(V=!1,B=0;B<Y.length;++B){var C=Y[B];m.r>=C[0].s.r&&m.r<=C[0].e.r&&N>=C[0].s.c&&N<=C[0].e.c&&(k.F=hn(C[0]),V=!0)}!V&&ne.length>3&&(k.f=ne[3])}if(h.s.r>m.r&&(h.s.r=m.r),h.s.c>N&&(h.s.c=N),h.e.r<m.r&&(h.e.r=m.r),h.e.c<N&&(h.e.c=N),l.cellDates&&b&&k.t=="n"&&$f(Wr[b.numFmtId])){var M=Su(k.v);M&&(k.t="d",k.v=new Date(M.y,M.m-1,M.d,M.H,M.M,M.S,M.u))}Fe&&(Fe.type=="XLDAPR"&&(k.D=!0),Fe=void 0);break;case 1:case 12:if(!l.sheetStubs||g)break;k={t:"z",v:void 0},N=ne[0].c==-1?N+1:ne[0].c,l.dense?(u[E]||(u[E]=[]),u[E][N]=k):u[Wa(N)+K]=k,h.s.r>m.r&&(h.s.r=m.r),h.s.c>N&&(h.s.c=N),h.e.r<m.r&&(h.e.r=m.r),h.e.c<N&&(h.e.c=N),Fe&&(Fe.type=="XLDAPR"&&(k.D=!0),Fe=void 0);break;case 176:re.push(ne);break;case 49:Fe=((l.xlmeta||{}).Cell||[])[ne-1];break;case 494:var z=n["!id"][ne.relId];for(z?(ne.Target=z.Target,ne.loc&&(ne.Target+="#"+ne.loc),ne.Rel=z):ne.relId==""&&(ne.Target="#"+ne.loc),E=ne.rfx.s.r;E<=ne.rfx.e.r;++E)for(N=ne.rfx.s.c;N<=ne.rfx.e.c;++N)l.dense?(u[E]||(u[E]=[]),u[E][N]||(u[E][N]={t:"z",v:void 0}),u[E][N].l=ne):(O=qr({c:N,r:E}),u[O]||(u[O]={t:"z",v:void 0}),u[O].l=ne);break;case 426:if(!l.cellFormula)break;Y.push(ne),te=l.dense?u[E][N]:u[Wa(N)+K],te.f=Hi(ne[1],h,{r:m.r,c:N},U,l),te.F=hn(ne[0]);break;case 427:if(!l.cellFormula)break;ye[qr(ne[0].s)]=ne[1],te=l.dense?u[E][N]:u[Wa(N)+K],te.f=Hi(ne[1],h,{r:m.r,c:N},U,l);break;case 60:if(!l.cellStyles)break;for(;ne.e>=ne.s;)le[ne.e--]={width:ne.w/256,hidden:!!(ne.flags&1),level:ne.level},Te||(Te=!0,Dm(ne.w/256)),Df(le[ne.e+1]);break;case 161:u["!autofilter"]={ref:hn(ne)};break;case 476:u["!margins"]=ne;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),ne.name&&(a.Sheets[r].CodeName=ne.name),(ne.above||ne.left)&&(u["!outline"]={above:ne.above,left:ne.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),ne.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:g=!0;break;case 36:g=!1;break;case 37:g=!0;break;case 38:g=!1;break;default:if(!Ee.T){if(!g||l.WTF)throw new Error("Unexpected record 0x"+pe.toString(16))}}},l),delete l.supbooks,delete l["!row"],!u["!ref"]&&(h.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(u["!ref"]=hn(f||h)),l.sheetRows&&u["!ref"]){var Le=pa(u["!ref"]);l.sheetRows<=+Le.e.r&&(Le.e.r=l.sheetRows-1,Le.e.r>h.e.r&&(Le.e.r=h.e.r),Le.e.r<Le.s.r&&(Le.s.r=Le.e.r),Le.e.c>h.e.c&&(Le.e.c=h.e.c),Le.e.c<Le.s.c&&(Le.s.c=Le.e.c),u["!fullref"]=u["!ref"],u["!ref"]=hn(Le))}return re.length>0&&(u["!merges"]=re),le.length>0&&(u["!cols"]=le),ue.length>0&&(u["!rows"]=ue),u}function uO(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var a=pn((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,a,n]}function fO(e,t,r,n,a,i){var o=i||{"!type":"chart"};if(!e)return i;var l=0,u=0,f="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(g){var x=uO(g);h.s.r=h.s.c=0,h.e.c=l,f=Wa(l),x[0].forEach(function(m,k){o[f+bi(k)]={t:"n",v:m,z:x[1]},u=k}),h.e.r<u&&(h.e.r=u),++l}),l>0&&(o["!ref"]=hn(h)),o}function hO(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(Cb);return l&&Mm(l[0],i,a,r),(o=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function dO(e,t){e.l+=10;var r=Gi(e);return{name:r}}function pO(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return dc(e,function(u,f,h){switch(h){case 550:i["!rel"]=u;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),u.name&&(a.Sheets[r].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var Lb=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],gO=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],mO=[],vO=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function hy(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var i=t[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=ta(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function dy(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=ta(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function Fb(e){dy(e.WBProps,Lb),dy(e.CalcPr,vO),hy(e.WBView,gO),hy(e.Sheets,mO),If.date1904=ta(e.WBProps.date1904)}var xO="][*?/\\".split("");function yO(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return xO.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var wO=/<\w+:workbook/;function bO(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},o=0;if(e.replace(Xi,function(u,f){var h=Rr(u);switch(Dl(h[0])){case"<?xml":break;case"<workbook":u.match(wO)&&(a="xmlns"+u.match(/<(\w+):/)[1]),r.xmlns=h[a];break;case"</workbook>":break;case"<fileVersion":delete h[0],r.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Lb.forEach(function(g){if(h[g[0]]!=null)switch(g[2]){case"bool":r.WBProps[g[0]]=ta(h[g[0]]);break;case"int":r.WBProps[g[0]]=parseInt(h[g[0]],10);break;default:r.WBProps[g[0]]=h[g[0]]}}),h.codeName&&(r.WBProps.CodeName=Kn(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],r.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=pn(Kn(h.name)),delete h[0],r.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=Kn(h.name),h.comment&&(i.Comment=h.comment),h.localSheetId&&(i.Sheet=+h.localSheetId),ta(h.hidden||"0")&&(i.Hidden=!0),o=f+u.length;break;case"</definedName>":i.Ref=pn(Kn(e.slice(o,f))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete h[0],r.CalcPr=h;break;case"<calcPr/>":delete h[0],r.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return u}),BT.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Fb(r),r}function _O(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Fg(e),r.name=Gi(e),r}function kO(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Gi(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function SO(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function EO(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=n8(e),o=lF(e,0,r),l=Lm(e);e.l=n;var u={Name:i,Ptg:o};return a<268435455&&(u.Sheet=a),l&&(u.Comment=l),u}function AO(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],ap[16]={n:"BrtFRTArchID$",f:SO},dc(e,function(u,f,h){switch(h){case 156:o.SheetNames.push(u.name),r.Sheets.push(u);break;case 153:r.WBProps=u;break;case 39:u.Sheet!=null&&(t.SID=u.Sheet),u.Ref=Hi(u.Ptg,null,null,o,t),delete t.SID,delete u.Ptg,i.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([h,u]):o[0]=[h,u],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(u),o.XTI=o.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(h),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(h),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!f.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},t),Fb(r),r.Names=i,r.supbooks=o,r}function NO(e,t,r){return t.slice(-4)===".bin"?AO(e,r):bO(e,r)}function TO(e,t,r,n,a,i,o,l){return t.slice(-4)===".bin"?cO(e,n,r,a,i,o,l):_F(e,n,r,a,i,o,l)}function CO(e,t,r,n,a,i,o,l){return t.slice(-4)===".bin"?pO(e,n,r,a,i):hO(e,n,r,a,i)}function PO(e,t,r,n,a,i,o,l){return t.slice(-4)===".bin"?M7():B7()}function LO(e,t,r,n,a,i,o,l){return t.slice(-4)===".bin"?D7():j7()}function FO(e,t,r,n){return t.slice(-4)===".bin"?ZP(e,r,n):KP(e,r,n)}function OO(e,t,r){return xb(e,r)}function IO(e,t,r){return t.slice(-4)===".bin"?gP(e,r):dP(e,r)}function RO(e,t,r){return t.slice(-4)===".bin"?O7(e,r):T7(e,r)}function DO(e,t,r){return t.slice(-4)===".bin"?E7(e):k7(e)}function jO(e,t,r,n){return r.slice(-4)===".bin"?A7(e,t,r,n):void 0}function MO(e,t,r){return t.slice(-4)===".bin"?b7(e,t,r):_7(e,t,r)}var Ob=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Ib=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Jo(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(Ob),i,o,l,u;if(a)for(u=0;u!=a.length;++u)i=a[u].match(Ib),(o=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(o+1),n[l]=i[2].slice(1,i[2].length-1));return n}function BO(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(Ob),a,i,o,l;if(n)for(l=0;l!=n.length;++l)a=n[l].match(Ib),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),r[o]=a[2].slice(1,a[2].length-1));return r}var R0;function UO(e,t){var r=R0[e]||pn(e);return r==="General"?Cu(t):No(r,t)}function zO(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=ta(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=li(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[pn(t)]=a}function qO(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||ju[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=J0(e.v):e.w=Cu(e.v):e.w=UO(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=R0[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&$f(n)){var a=Su(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function $O(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=zP[n.Pattern]||n.Pattern)}e[t.ID]=t}function HO(e,t,r,n,a,i,o,l,u,f){var h="General",g=n.StyleID,x={};f=f||{};var m=[],k=0;for(g===void 0&&l&&(g=l.StyleID),g===void 0&&o&&(g=o.StyleID);i[g]!==void 0&&(i[g].nf&&(h=i[g].nf),i[g].Interior&&m.push(i[g].Interior),!!i[g].Parent);)g=i[g].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=ta(e);break;case"String":n.t="s",n.r=Rx(pn(e)),n.v=e.indexOf("<")>-1?pn(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(li(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=pn(e):n.v<60&&(n.v=n.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=X5[e],f.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Rx(t||e));break}if(qO(n,h,f),f.cellFormula!==!1)if(n.Formula){var b=pn(n.Formula);b.charCodeAt(0)==61&&(b=b.slice(1)),n.f=Of(b,a),delete n.Formula,n.ArrayRange=="RC"?n.F=Of("RC:RC",a):n.ArrayRange&&(n.F=Of(n.ArrayRange,a),u.push([pa(n.F),n.F]))}else for(k=0;k<u.length;++k)a.r>=u[k][0].s.r&&a.r<=u[k][0].e.r&&a.c>=u[k][0].s.c&&a.c<=u[k][0].e.c&&(n.F=u[k][1]);f.cellStyles&&(m.forEach(function(E){!x.patternType&&E.patternType&&(x.patternType=E.patternType)}),n.s=x),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function VO(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function G1(e,t){var r=t||{};_5();var n=v0(Am(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Kn(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var o=wi(r);return o.type="string",eh.to_workbook(n,o)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(qt){a.indexOf("<"+qt)>=0&&(i=!0)}),i)return eI(n,r);R0={"General Number":"General","General Date":Wr[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Wr[15],"Short Date":Wr[14],"Long Time":Wr[19],"Medium Time":Wr[18],"Short Time":Wr[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Wr[2],Standard:Wr[4],Percent:Wr[10],Scientific:Wr[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,u=[],f,h={},g=[],x=r.dense?[]:{},m="",k={},b={},E=Jo('<Data ss:Type="String">'),N=0,O=0,F=0,K={s:{r:2e6,c:2e6},e:{r:0,c:0}},te={},re={},B="",V=0,Y=[],ye={},U={},D=0,le=[],ue=[],Te={},Fe=[],Le,me=!1,ne=[],Ee=[],pe={},C=0,M=0,z={Sheets:[],WBProps:{date1904:!1}},H={};Z0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ie="";l=Z0.exec(n);)switch(l[3]=(ie=l[3]).toLowerCase()){case"data":if(ie=="data"){if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break}if(u[u.length-1][1])break;l[1]==="/"?HO(n.slice(N,l.index),B,E,u[u.length-1][0]=="comment"?Te:k,{c:O,r:F},te,Fe[O],b,ne,r):(B="",E=Jo(l[0]),N=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(ue.length>0&&(k.c=ue),(!r.sheetRows||r.sheetRows>F)&&k.v!==void 0&&(r.dense?(x[F]||(x[F]=[]),x[F][O]=k):x[Wa(O)+bi(F)]=k),k.HRef&&(k.l={Target:pn(k.HRef)},k.HRefScreenTip&&(k.l.Tooltip=k.HRefScreenTip),delete k.HRef,delete k.HRefScreenTip),(k.MergeAcross||k.MergeDown)&&(C=O+(parseInt(k.MergeAcross,10)|0),M=F+(parseInt(k.MergeDown,10)|0),Y.push({s:{c:O,r:F},e:{c:C,r:M}})),!r.sheetStubs)k.MergeAcross?O=C+1:++O;else if(k.MergeAcross||k.MergeDown){for(var xe=O;xe<=C;++xe)for(var Ae=F;Ae<=M;++Ae)(xe>O||Ae>F)&&(r.dense?(x[Ae]||(x[Ae]=[]),x[Ae][xe]={t:"z"}):x[Wa(xe)+bi(Ae)]={t:"z"});O=C+1}else++O;else k=BO(l[0]),k.Index&&(O=+k.Index-1),O<K.s.c&&(K.s.c=O),O>K.e.c&&(K.e.c=O),l[0].slice(-2)==="/>"&&++O,ue=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(F<K.s.r&&(K.s.r=F),F>K.e.r&&(K.e.r=F),l[0].slice(-2)==="/>"&&(b=Jo(l[0]),b.Index&&(F=+b.Index-1)),O=0,++F):(b=Jo(l[0]),b.Index&&(F=+b.Index-1),pe={},(b.AutoFitHeight=="0"||b.Height)&&(pe.hpx=parseInt(b.Height,10),pe.hpt=vb(pe.hpx),Ee[F]=pe),b.Hidden=="1"&&(pe.hidden=!0,Ee[F]=pe));break;case"worksheet":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"));g.push(m),K.s.r<=K.e.r&&K.s.c<=K.e.c&&(x["!ref"]=hn(K),r.sheetRows&&r.sheetRows<=K.e.r&&(x["!fullref"]=x["!ref"],K.e.r=r.sheetRows-1,x["!ref"]=hn(K))),Y.length&&(x["!merges"]=Y),Fe.length>0&&(x["!cols"]=Fe),Ee.length>0&&(x["!rows"]=Ee),h[m]=x}else K={s:{r:2e6,c:2e6},e:{r:0,c:0}},F=O=0,u.push([l[3],!1]),f=Jo(l[0]),m=pn(f.Name),x=r.dense?[]:{},Y=[],ne=[],Ee=[],H={name:m,Hidden:0},z.Sheets.push(H);break;case"table":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else{if(l[0].slice(-2)=="/>")break;u.push([l[3],!1]),Fe=[],me=!1}break;case"style":l[1]==="/"?$O(te,re,r):re=Jo(l[0]);break;case"numberformat":re.nf=pn(Jo(l[0]).Format||"General"),R0[re.nf]&&(re.nf=R0[re.nf]);for(var de=0;de!=392&&Wr[de]!=re.nf;++de);if(de==392){for(de=57;de!=392;++de)if(Wr[de]==null){Au(re.nf,de);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(Le=Jo(l[0]),Le.Hidden&&(Le.hidden=!0,delete Le.Hidden),Le.Width&&(Le.wpx=parseInt(Le.Width,10)),!me&&Le.wpx>10){me=!0,gs=gb;for(var Me=0;Me<Fe.length;++Me)Fe[Me]&&Df(Fe[Me])}me&&Df(Le),Fe[Le.Index-1||Fe.length]=Le;for(var ct=0;ct<+Le.Span;++ct)Fe[Fe.length]=wi(Le);break;case"namedrange":if(l[1]==="/")break;z.Names||(z.Names=[]);var se=Rr(l[0]),bt={Name:se.Name,Ref:Of(se.RefersTo.slice(1),{r:0,c:0})};z.Sheets.length>0&&(bt.Sheet=z.Sheets.length-1),z.Names.push(bt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?B+=n.slice(V,l.index):V=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;re.Interior=Jo(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?T8(ye,ie,n.slice(D,l.index)):D=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else u.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"));VO(Te),ue.push(Te)}else u.push([l[3],!1]),f=Jo(l[0]),Te={a:f.Author};break;case"autofilter":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var Dt=Jo(l[0]);x["!autofilter"]={ref:Of(Dt.Range).replace(/\$/g,"")},u.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((f=u.pop())[0]!==l[3])throw new Error("Bad state: "+f.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break;case"null":break;default:if(u.length==0&&l[3]=="document"||u.length==0&&l[3]=="uof")return yy(n,r);var Je=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Je=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Je=!1}break;case"excelworkbook":switch(l[3]){case"date1904":z.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Je=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:Je=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(D,l.index)){case"SheetHidden":H.Hidden=1;break;case"SheetVeryHidden":H.Hidden=2;break}else D=l.index+l[0].length;break;case"header":x["!margins"]||I0(x["!margins"]={},"xlml"),isNaN(+Rr(l[0]).Margin)||(x["!margins"].header=+Rr(l[0]).Margin);break;case"footer":x["!margins"]||I0(x["!margins"]={},"xlml"),isNaN(+Rr(l[0]).Margin)||(x["!margins"].footer=+Rr(l[0]).Margin);break;case"pagemargins":var we=Rr(l[0]);x["!margins"]||I0(x["!margins"]={},"xlml"),isNaN(+we.Top)||(x["!margins"].top=+we.Top),isNaN(+we.Left)||(x["!margins"].left=+we.Left),isNaN(+we.Right)||(x["!margins"].right=+we.Right),isNaN(+we.Bottom)||(x["!margins"].bottom=+we.Bottom);break;case"displayrighttoleft":z.Views||(z.Views=[]),z.Views[0]||(z.Views[0]={}),z.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Je=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Je=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Je=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Je=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Je=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Je=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Je=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Je=!1}break;case"smarttags":break;default:Je=!1;break}if(Je||l[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?zO(U,ie,le,n.slice(D,l.index)):(le=l,D=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+u.join("|")}var mt={};return!r.bookSheets&&!r.bookProps&&(mt.Sheets=h),mt.SheetNames=g,mt.Workbook=z,mt.SSF=wi(Wr),mt.Props=ye,mt.Custprops=U,mt}function Dg(e,t){switch(zm(t=t||{}),t.type||"base64"){case"base64":return G1(ao(e),t);case"binary":case"buffer":case"file":return G1(e,t);case"array":return G1(Iu(e),t)}}function WO(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=s8(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=o8(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var KO=[60,1084,2066,2165,2175];function GO(e,t,r,n,a){var i=n,o=[],l=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(l)}o.push(l),r.l+=i;for(var u=nc(r,r.l),f=jg[u],h=0;f!=null&&KO.indexOf(u)>-1;)i=nc(r,r.l+2),h=r.l+4,u==2066?h+=4:(u==2165||u==2175)&&(h+=12),l=r.slice(h,r.l+4+i),o.push(l),r.l+=4+i,f=jg[u=nc(r,r.l)];var g=zc(o);yi(g,0);var x=0;g.lens=[];for(var m=0;m<o.length;++m)g.lens.push(x),x+=o[m].length;if(g.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+g.length+" < "+n;return t.f(g,g.length,a)}function Tl(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Wr[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||ju[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=J0(e.v):e.w=Cu(e.v):e.w=No(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&$f(Wr[n]||String(n))){var a=Su(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function bd(e,t,r){return{v:e,ixfe:t,t:r}}function YO(e,t){var r={opts:{}},n={},a=t.dense?[]:{},i={},o={},l=null,u=[],f="",h={},g,x="",m,k,b,E,N={},O=[],F,K,te=[],re=[],B={Sheets:[],WBProps:{date1904:!1},Views:[{}]},V={},Y=function($t){return $t<8?Nu[$t]:$t<64&&re[$t-8]||Nu[$t]},ye=function($t,wt,Vr){var ur=wt.XF.data;if(!(!ur||!ur.patternType||!Vr||!Vr.cellStyles)){wt.s={},wt.s.patternType=ur.patternType;var Tn;(Tn=th(Y(ur.icvFore)))&&(wt.s.fgColor={rgb:Tn}),(Tn=th(Y(ur.icvBack)))&&(wt.s.bgColor={rgb:Tn})}},U=function($t,wt,Vr){if(!(pe>1)&&!(Vr.sheetRows&&$t.r>=Vr.sheetRows)){if(Vr.cellStyles&&wt.XF&&wt.XF.data&&ye($t,wt,Vr),delete wt.ixfe,delete wt.XF,g=$t,x=qr($t),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),$t.r<o.s.r&&(o.s.r=$t.r),$t.c<o.s.c&&(o.s.c=$t.c),$t.r+1>o.e.r&&(o.e.r=$t.r+1),$t.c+1>o.e.c&&(o.e.c=$t.c+1),Vr.cellFormula&&wt.f){for(var ur=0;ur<O.length;++ur)if(!(O[ur][0].s.c>$t.c||O[ur][0].s.r>$t.r)&&!(O[ur][0].e.c<$t.c||O[ur][0].e.r<$t.r)){wt.F=hn(O[ur][0]),(O[ur][0].s.c!=$t.c||O[ur][0].s.r!=$t.r)&&delete wt.f,wt.f&&(wt.f=""+Hi(O[ur][1],o,$t,ne,D));break}}Vr.dense?(a[$t.r]||(a[$t.r]=[]),a[$t.r][$t.c]=wt):a[x]=wt}},D={enc:!1,sbcch:0,snames:[],sharedf:N,arrayf:O,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(D.password=t.password);var le,ue=[],Te=[],Fe=[],Le=[],me=!1,ne=[];ne.SheetNames=D.snames,ne.sharedf=D.sharedf,ne.arrayf=D.arrayf,ne.names=[],ne.XTI=[];var Ee=0,pe=0,C=0,M=[],z=[],H;D.codepage=1200,al(1200);for(var ie=!1;e.l<e.length-1;){var xe=e.l,Ae=e.read_shift(2);if(Ae===0&&Ee===10)break;var de=e.l===e.length?0:e.read_shift(2),Me=jg[Ae];if(Me&&Me.f){if(t.bookSheets&&Ee===133&&Ae!==133)break;if(Ee=Ae,Me.r===2||Me.r==12){var ct=e.read_shift(2);if(de-=2,!D.enc&&ct!==Ae&&((ct&255)<<8|ct>>8)!==Ae)throw new Error("rt mismatch: "+ct+"!="+Ae);Me.r==12&&(e.l+=10,de-=10)}var se={};if(Ae===10?se=Me.f(e,de,D):se=GO(Ae,Me,e,de,D),pe==0&&[9,521,1033,2057].indexOf(Ee)===-1)continue;switch(Ae){case 34:r.opts.Date1904=B.WBProps.date1904=se;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(D.enc||(e.l=0),D.enc=se,!t.password)throw new Error("File is password-protected");if(se.valid==null)throw new Error("Encryption scheme unsupported");if(!se.valid)throw new Error("Password is incorrect");break;case 92:D.lastuser=se;break;case 66:var bt=Number(se);switch(bt){case 21010:bt=1200;break;case 32768:bt=1e4;break;case 32769:bt=1252;break}al(D.codepage=bt),ie=!0;break;case 317:D.rrtabid=se;break;case 25:D.winlocked=se;break;case 439:r.opts.RefreshAll=se;break;case 12:r.opts.CalcCount=se;break;case 16:r.opts.CalcDelta=se;break;case 17:r.opts.CalcIter=se;break;case 13:r.opts.CalcMode=se;break;case 14:r.opts.CalcPrecision=se;break;case 95:r.opts.CalcSaveRecalc=se;break;case 15:D.CalcRefMode=se;break;case 2211:r.opts.FullCalc=se;break;case 129:se.fDialog&&(a["!type"]="dialog"),se.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),se.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:te.push(se);break;case 430:ne.push([se]),ne[ne.length-1].XTI=[];break;case 35:case 547:ne[ne.length-1].push(se);break;case 24:case 536:H={Name:se.Name,Ref:Hi(se.rgce,o,null,ne,D)},se.itab>0&&(H.Sheet=se.itab-1),ne.names.push(H),ne[0]||(ne[0]=[],ne[0].XTI=[]),ne[ne.length-1].push(se),se.Name=="_xlnm._FilterDatabase"&&se.itab>0&&se.rgce&&se.rgce[0]&&se.rgce[0][0]&&se.rgce[0][0][0]=="PtgArea3d"&&(z[se.itab-1]={ref:hn(se.rgce[0][0][1][2])});break;case 22:D.ExternCount=se;break;case 23:ne.length==0&&(ne[0]=[],ne[0].XTI=[]),ne[ne.length-1].XTI=ne[ne.length-1].XTI.concat(se),ne.XTI=ne.XTI.concat(se);break;case 2196:if(D.biff<8)break;H!=null&&(H.Comment=se[1]);break;case 18:a["!protect"]=se;break;case 19:se!==0&&D.WTF&&console.error("Password verifier: "+se);break;case 133:i[se.pos]=se,D.snames.push(se.name);break;case 10:{if(--pe)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,a["!ref"]=hn(o),t.sheetRows&&t.sheetRows<=o.e.r){var Dt=o.e.r;o.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=hn(o),o.e.r=Dt}o.e.r++,o.e.c++}ue.length>0&&(a["!merges"]=ue),Te.length>0&&(a["!objects"]=Te),Fe.length>0&&(a["!cols"]=Fe),Le.length>0&&(a["!rows"]=Le),B.Sheets.push(V)}f===""?h=a:n[f]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(D.biff===8&&(D.biff={9:2,521:3,1033:4}[Ae]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[se.BIFFVer]||8),D.biffguess=se.BIFFVer==0,se.BIFFVer==0&&se.dt==4096&&(D.biff=5,ie=!0,al(D.codepage=28591)),D.biff==8&&se.BIFFVer==0&&se.dt==16&&(D.biff=2),pe++)break;if(a=t.dense?[]:{},D.biff<8&&!ie&&(ie=!0,al(D.codepage=t.codepage||1252)),D.biff<5||se.BIFFVer==0&&se.dt==4096){f===""&&(f="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var Je={pos:e.l-de,name:f};i[Je.pos]=Je,D.snames.push(f)}else f=(i[xe]||{name:""}).name;se.dt==32&&(a["!type"]="chart"),se.dt==64&&(a["!type"]="macro"),ue=[],Te=[],D.arrayf=O=[],Fe=[],Le=[],me=!1,V={Hidden:(i[xe]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[se.r]||[])[se.c]:a[qr({c:se.c,r:se.r})])&&++se.c,F={ixfe:se.ixfe,XF:te[se.ixfe]||{},v:se.val,t:"n"},C>0&&(F.z=M[F.ixfe>>8&63]),Tl(F,t,r.opts.Date1904),U({c:se.c,r:se.r},F,t);break;case 5:case 517:F={ixfe:se.ixfe,XF:te[se.ixfe],v:se.val,t:se.t},C>0&&(F.z=M[F.ixfe>>8&63]),Tl(F,t,r.opts.Date1904),U({c:se.c,r:se.r},F,t);break;case 638:F={ixfe:se.ixfe,XF:te[se.ixfe],v:se.rknum,t:"n"},C>0&&(F.z=M[F.ixfe>>8&63]),Tl(F,t,r.opts.Date1904),U({c:se.c,r:se.r},F,t);break;case 189:for(var we=se.c;we<=se.C;++we){var mt=se.rkrec[we-se.c][0];F={ixfe:mt,XF:te[mt],v:se.rkrec[we-se.c][1],t:"n"},C>0&&(F.z=M[F.ixfe>>8&63]),Tl(F,t,r.opts.Date1904),U({c:we,r:se.r},F,t)}break;case 6:case 518:case 1030:{if(se.val=="String"){l=se;break}if(F=bd(se.val,se.cell.ixfe,se.tt),F.XF=te[F.ixfe],t.cellFormula){var qt=se.formula;if(qt&&qt[0]&&qt[0][0]&&qt[0][0][0]=="PtgExp"){var xt=qt[0][0][1][0],_t=qt[0][0][1][1],Et=qr({r:xt,c:_t});N[Et]?F.f=""+Hi(se.formula,o,se.cell,ne,D):F.F=((t.dense?(a[xt]||[])[_t]:a[Et])||{}).F}else F.f=""+Hi(se.formula,o,se.cell,ne,D)}C>0&&(F.z=M[F.ixfe>>8&63]),Tl(F,t,r.opts.Date1904),U(se.cell,F,t),l=se}break;case 7:case 519:if(l)l.val=se,F=bd(se,l.cell.ixfe,"s"),F.XF=te[F.ixfe],t.cellFormula&&(F.f=""+Hi(l.formula,o,l.cell,ne,D)),C>0&&(F.z=M[F.ixfe>>8&63]),Tl(F,t,r.opts.Date1904),U(l.cell,F,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{O.push(se);var Bt=qr(se[0].s);if(m=t.dense?(a[se[0].s.r]||[])[se[0].s.c]:a[Bt],t.cellFormula&&m){if(!l||!Bt||!m)break;m.f=""+Hi(se[1],o,se[0],ne,D),m.F=hn(se[0])}}break;case 1212:{if(!t.cellFormula)break;if(x){if(!l)break;N[qr(l.cell)]=se[0],m=t.dense?(a[l.cell.r]||[])[l.cell.c]:a[qr(l.cell)],(m||{}).f=""+Hi(se[0],o,g,ne,D)}}break;case 253:F=bd(u[se.isst].t,se.ixfe,"s"),u[se.isst].h&&(F.h=u[se.isst].h),F.XF=te[F.ixfe],C>0&&(F.z=M[F.ixfe>>8&63]),Tl(F,t,r.opts.Date1904),U({c:se.c,r:se.r},F,t);break;case 513:t.sheetStubs&&(F={ixfe:se.ixfe,XF:te[se.ixfe],t:"z"},C>0&&(F.z=M[F.ixfe>>8&63]),Tl(F,t,r.opts.Date1904),U({c:se.c,r:se.r},F,t));break;case 190:if(t.sheetStubs)for(var Jt=se.c;Jt<=se.C;++Jt){var nr=se.ixfe[Jt-se.c];F={ixfe:nr,XF:te[nr],t:"z"},C>0&&(F.z=M[F.ixfe>>8&63]),Tl(F,t,r.opts.Date1904),U({c:Jt,r:se.r},F,t)}break;case 214:case 516:case 4:F=bd(se.val,se.ixfe,"s"),F.XF=te[F.ixfe],C>0&&(F.z=M[F.ixfe>>8&63]),Tl(F,t,r.opts.Date1904),U({c:se.c,r:se.r},F,t);break;case 0:case 512:pe===1&&(o=se);break;case 252:u=se;break;case 1054:if(D.biff==4){M[C++]=se[1];for(var cr=0;cr<C+163&&Wr[cr]!=se[1];++cr);cr>=163&&Au(se[1],C+163)}else Au(se[1],se[0]);break;case 30:{M[C++]=se;for(var gr=0;gr<C+163&&Wr[gr]!=se;++gr);gr>=163&&Au(se,C+163)}break;case 229:ue=ue.concat(se);break;case 93:Te[se.cmo[0]]=D.lastobj=se;break;case 438:D.lastobj.TxO=se;break;case 127:D.lastobj.ImData=se;break;case 440:for(E=se[0].s.r;E<=se[0].e.r;++E)for(b=se[0].s.c;b<=se[0].e.c;++b)m=t.dense?(a[E]||[])[b]:a[qr({c:b,r:E})],m&&(m.l=se[1]);break;case 2048:for(E=se[0].s.r;E<=se[0].e.r;++E)for(b=se[0].s.c;b<=se[0].e.c;++b)m=t.dense?(a[E]||[])[b]:a[qr({c:b,r:E})],m&&m.l&&(m.l.Tooltip=se[1]);break;case 28:{if(D.biff<=5&&D.biff>=2)break;m=t.dense?(a[se[0].r]||[])[se[0].c]:a[qr(se[0])];var yr=Te[se[2]];m||(t.dense?(a[se[0].r]||(a[se[0].r]=[]),m=a[se[0].r][se[0].c]={t:"z"}):m=a[qr(se[0])]={t:"z"},o.e.r=Math.max(o.e.r,se[0].r),o.s.r=Math.min(o.s.r,se[0].r),o.e.c=Math.max(o.e.c,se[0].c),o.s.c=Math.min(o.s.c,se[0].c)),m.c||(m.c=[]),k={a:se[1],t:yr.TxO.t},m.c.push(k)}break;case 2173:v7(te[se.ixfe],se.ext);break;case 125:{if(!D.cellStyles)break;for(;se.e>=se.s;)Fe[se.e--]={width:se.w/256,level:se.level||0,hidden:!!(se.flags&1)},me||(me=!0,Dm(se.w/256)),Df(Fe[se.e+1])}break;case 520:{var mr={};se.level!=null&&(Le[se.r]=mr,mr.level=se.level),se.hidden&&(Le[se.r]=mr,mr.hidden=!0),se.hpt&&(Le[se.r]=mr,mr.hpt=se.hpt,mr.hpx=rh(se.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||I0(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ae]]=se;break;case 161:a["!margins"]||I0(a["!margins"]={}),a["!margins"].header=se.header,a["!margins"].footer=se.footer;break;case 574:se.RTL&&(B.Views[0].RTL=!0);break;case 146:re=se;break;case 2198:le=se;break;case 140:K=se;break;case 442:f?V.CodeName=se||V.name:B.WBProps.CodeName=se||"ThisWorkbook";break}}else Me||console.error("Missing Info for XLS Record 0x"+Ae.toString(16)),e.l+=de}return r.SheetNames=Ol(i).sort(function(Qt,$t){return Number(Qt)-Number($t)}).map(function(Qt){return i[Qt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&h["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=h)):r.Preamble=h,r.Sheets&&z.forEach(function(Qt,$t){r.Sheets[r.SheetNames[$t]]["!autofilter"]=Qt}),r.Strings=u,r.SSF=wi(Wr),D.enc&&(r.Encryption=D.enc),le&&(r.Themes=le),r.Metadata={},K!==void 0&&(r.Metadata.Country=K),ne.names.length>0&&(B.Names=ne.names),r.Workbook=B,r}var py={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function XO(e,t,r){var n=fn.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=Jx(n,d8,py.DSI);for(var i in a)t[i]=a[i]}catch(f){if(r.WTF)throw f}var o=fn.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=Jx(o,p8,py.SI);for(var u in l)t[u]==null&&(t[u]=l[u])}catch(f){if(r.WTF)throw f}t.HeadingPairs&&t.TitlesOfParts&&(Q5(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Rb(e,t){t||(t={}),zm(t),u5(),t.codepage&&ym(t.codepage);var r,n;if(e.FullPaths){if(fn.find(e,"/encryption"))throw new Error("File is password-protected");r=fn.find(e,"!CompObj"),n=fn.find(e,"/Workbook")||fn.find(e,"/Book")}else{switch(t.type){case"base64":e=nl(ao(e));break;case"binary":e=nl(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}yi(e,0),n={content:e}}var a,i;if(r&&WO(r),t.bookProps&&!t.bookSheets)a={};else{var o=on?"buffer":"array";if(n&&n.content)a=YO(n.content,t);else if((i=fn.find(e,"PerfectOffice_MAIN"))&&i.content)a=F0.to_workbook(i.content,(t.type=o,t));else if((i=fn.find(e,"NativeContent_MAIN"))&&i.content)a=F0.to_workbook(i.content,(t.type=o,t));else throw(i=fn.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&fn.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=R7(e))}var l={};return e.FullPaths&&XO(e,l,t),a.Props=a.Custprops=l,t.bookFiles&&(a.cfb=e),a}var ap={0:{f:LF},1:{f:RF},2:{f:HF},3:{f:BF},4:{f:jF},5:{f:$F},6:{f:KF},7:{f:zF},8:{f:QF},9:{f:JF},10:{f:YF},11:{f:XF},12:{f:DF},13:{f:VF},14:{f:UF},15:{f:MF},16:{f:Pb},17:{f:GF},18:{f:qF},19:{f:Pm},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:EO},40:{},42:{},43:{f:YP},44:{f:GP},45:{f:XP},46:{f:QP},47:{f:JP},48:{},49:{f:ZT},50:{},51:{f:y7},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:ub},62:{f:WF},63:{f:S7},64:{f:oO},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Yi,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:sO},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:IF},148:{f:FF,p:16},151:{f:tO},152:{},153:{f:kO},154:{},155:{},156:{f:_O},157:{},158:{},159:{T:1,f:pP},160:{T:-1},161:{T:1,f:Du},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:ZF},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:x7},336:{T:-1},337:{f:w7,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Fg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:cb},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:rO},427:{f:nO},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:iO},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:OF},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:eO},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Fg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:F7},633:{T:1},634:{T:-1},635:{T:1,f:L7},636:{T:-1},637:{f:t8},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:dO},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:lO},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},jg={6:{f:W1},10:{f:Dc},12:{f:Ra},13:{f:Ra},14:{f:Ea},15:{f:Ea},16:{f:Wi},17:{f:Ea},18:{f:Ea},19:{f:Ra},20:{f:ty},21:{f:ty},23:{f:cb},24:{f:ny},25:{f:Ea},26:{},27:{},28:{f:CC},29:{},34:{f:Ea},35:{f:ry},38:{f:Wi},39:{f:Wi},40:{f:Wi},41:{f:Wi},42:{f:Ea},43:{f:Ea},47:{f:OP},49:{f:uC},51:{f:Ra},60:{},61:{f:oC},64:{f:Ea},65:{f:cC},66:{f:Ra},77:{},80:{},81:{},82:{},85:{f:Ra},89:{},90:{},91:{},92:{f:Z8},93:{f:LC},94:{},95:{f:Ea},96:{},97:{},99:{f:Ea},125:{f:ub},128:{f:wC},129:{f:eC},130:{f:Ra},131:{f:Ea},132:{f:Ea},133:{f:tC},134:{},140:{f:jC},141:{f:Ra},144:{},146:{f:BC},151:{},152:{},153:{},154:{},155:{},156:{f:Ra},157:{},158:{},160:{f:HC},161:{f:zC},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:mC},190:{f:vC},193:{f:Dc},197:{},198:{},199:{},200:{},201:{},202:{f:Ea},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ra},220:{},221:{f:Ea},222:{},224:{f:yC},225:{f:Q8},226:{f:Dc},227:{},229:{f:PC},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:rC},253:{f:fC},255:{f:nC},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:nb},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ea},353:{f:Dc},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:_C},431:{f:Ea},432:{},433:{},434:{},437:{},438:{f:IC},439:{f:Ea},440:{f:RC},441:{},442:{f:gh},443:{},444:{f:Ra},445:{},446:{},448:{f:Dc},449:{f:sC,r:2},450:{f:Dc},512:{f:Zx},513:{f:$C},515:{f:bC},516:{f:hC},517:{f:ey},519:{f:VC},520:{f:aC},523:{},545:{f:ay},549:{f:Qx},566:{},574:{f:lC},638:{f:gC},659:{},1048:{},1054:{f:dC},1084:{},1212:{f:AC},2048:{f:DC},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:xd},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Dc},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:UC,r:12},2173:{f:m7,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ea,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:EC,r:12},2197:{},2198:{f:u7,r:12},2199:{},2200:{},2201:{},2202:{f:NC,r:12},2203:{f:Dc},2204:{},2205:{},2206:{},2207:{},2211:{f:iC},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ra},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:qC},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:MC},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Zx},1:{},2:{f:YC},3:{f:GC},4:{f:KC},5:{f:ey},7:{f:XC},8:{},9:{f:xd},11:{},22:{f:Ra},30:{f:pC},31:{},32:{},33:{f:ay},36:{},37:{f:Qx},50:{f:JC},62:{},52:{},67:{},68:{f:Ra},69:{},86:{},126:{},127:{f:WC},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:QC},223:{},234:{},354:{},421:{},518:{f:W1},521:{f:xd},536:{f:ny},547:{f:ry},561:{},579:{},1030:{f:W1},1033:{f:xd},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Qo(e,t,r,n){var a=t;if(!isNaN(a)){var i=(r||[]).length||0,o=e.next(4);o.write_shift(2,a),o.write_shift(2,i),i>0&&H5(r)&&e.push(r)}}function gy(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),o=a.index,l=i&&i.index||e.length,u=bT(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,h=0,g=0,x=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},k=[];for(o=0;o<u.length;++o){var b=u[o].trim(),E=b.slice(0,3).toLowerCase();if(E=="<tr"){if(++f,r.sheetRows&&r.sheetRows<=f){--f;break}h=0;continue}if(!(E!="<td"&&E!="<th")){var N=b.split(/<\/t[dh]>/i);for(l=0;l<N.length;++l){var O=N[l].trim();if(O.match(/<t[dh]/i)){for(var F=O,K=0;F.charAt(0)=="<"&&(K=F.indexOf(">"))>-1;)F=F.slice(K+1);for(var te=0;te<k.length;++te){var re=k[te];re.s.c==h&&re.s.r<f&&f<=re.e.r&&(h=re.e.c+1,te=-1)}var B=Rr(O.slice(0,O.indexOf(">")));x=B.colspan?+B.colspan:1,((g=+B.rowspan)>1||x>1)&&k.push({s:{r:f,c:h},e:{r:f+(g||1)-1,c:h+x-1}});var V=B.t||B["data-t"]||"";if(!F.length){h+=x;continue}if(F=L5(F),m.s.r>f&&(m.s.r=f),m.e.r<f&&(m.e.r=f),m.s.c>h&&(m.s.c=h),m.e.c<h&&(m.e.c=h),!F.length){h+=x;continue}var Y={t:"s",v:F};r.raw||!F.trim().length||V=="s"||(F==="TRUE"?Y={t:"b",v:!0}:F==="FALSE"?Y={t:"b",v:!1}:isNaN(sl(F))?isNaN(Rf(F).getDate())||(Y={t:"d",v:li(F)},r.cellDates||(Y={t:"n",v:xs(Y.v)}),Y.z=r.dateNF||Wr[14]):Y={t:"n",v:sl(F)}),r.dense?(n[f]||(n[f]=[]),n[f][h]=Y):n[qr({r:f,c:h})]=Y,h+=x}}}}return n["!ref"]=hn(m),k.length&&(n["!merges"]=k),n}function JO(e,t,r,n){for(var a=e["!merges"]||[],i=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,u=0,f=0;f<a.length;++f)if(!(a[f].s.r>r||a[f].s.c>o)&&!(a[f].e.r<r||a[f].e.c<o)){if(a[f].s.r<r||a[f].s.c<o){l=-1;break}l=a[f].e.r-a[f].s.r+1,u=a[f].e.c-a[f].s.c+1;break}if(!(l<0)){var h=qr({r,c:o}),g=n.dense?(e[r]||[])[o]:e[h],x=g&&g.v!=null&&(g.h||Em(g.w||(uc(g),g.w)||""))||"",m={};l>1&&(m.rowspan=l),u>1&&(m.colspan=u),n.editable?x='<span contenteditable="true">'+x+"</span>":g&&(m["data-t"]=g&&g.t||"z",g.v!=null&&(m["data-v"]=g.v),g.z!=null&&(m["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+g.l.Target+'">'+x+"</a>")),m.id=(n.id||"sjs")+"-"+h,i.push(jT("td",x,m))}}var k="<tr>";return k+i.join("")+"</tr>"}var QO='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',ZO="</body></html>";function eI(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Qc(gy(r[0],t),t);var n=$m();return r.forEach(function(a,i){Hm(n,gy(a,t),"Sheet"+(i+1))}),n}function tI(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function rI(e,t){var r=t||{},n=r.header!=null?r.header:QO,a=r.footer!=null?r.footer:ZO,i=[n],o=Hf(e["!ref"]);r.dense=Array.isArray(e),i.push(tI(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)i.push(JO(e,o,l,r));return i.push("</table>"+a),i.join("")}function Db(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var o=typeof n.origin=="string"?ms(n.origin):n.origin;a=o.r,i=o.c}var l=t.getElementsByTagName("tr"),u=Math.min(n.sheetRows||1e7,l.length),f={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var h=Hf(e["!ref"]);f.s.r=Math.min(f.s.r,h.s.r),f.s.c=Math.min(f.s.c,h.s.c),f.e.r=Math.max(f.e.r,h.e.r),f.e.c=Math.max(f.e.c,h.e.c),a==-1&&(f.e.r=a=h.e.r+1)}var g=[],x=0,m=e["!rows"]||(e["!rows"]=[]),k=0,b=0,E=0,N=0,O=0,F=0;for(e["!cols"]||(e["!cols"]=[]);k<l.length&&b<u;++k){var K=l[k];if(my(K)){if(n.display)continue;m[b]={hidden:!0}}var te=K.children;for(E=N=0;E<te.length;++E){var re=te[E];if(!(n.display&&my(re))){var B=re.hasAttribute("data-v")?re.getAttribute("data-v"):re.hasAttribute("v")?re.getAttribute("v"):L5(re.innerHTML),V=re.getAttribute("data-z")||re.getAttribute("z");for(x=0;x<g.length;++x){var Y=g[x];Y.s.c==N+i&&Y.s.r<b+a&&b+a<=Y.e.r&&(N=Y.e.c+1-i,x=-1)}F=+re.getAttribute("colspan")||1,((O=+re.getAttribute("rowspan")||1)>1||F>1)&&g.push({s:{r:b+a,c:N+i},e:{r:b+a+(O||1)-1,c:N+i+(F||1)-1}});var ye={t:"s",v:B},U=re.getAttribute("data-t")||re.getAttribute("t")||"";B!=null&&(B.length==0?ye.t=U||"z":n.raw||B.trim().length==0||U=="s"||(B==="TRUE"?ye={t:"b",v:!0}:B==="FALSE"?ye={t:"b",v:!1}:isNaN(sl(B))?isNaN(Rf(B).getDate())||(ye={t:"d",v:li(B)},n.cellDates||(ye={t:"n",v:xs(ye.v)}),ye.z=n.dateNF||Wr[14]):ye={t:"n",v:sl(B)})),ye.z===void 0&&V!=null&&(ye.z=V);var D="",le=re.getElementsByTagName("A");if(le&&le.length)for(var ue=0;ue<le.length&&!(le[ue].hasAttribute("href")&&(D=le[ue].getAttribute("href"),D.charAt(0)!="#"));++ue);D&&D.charAt(0)!="#"&&(ye.l={Target:D}),n.dense?(e[b+a]||(e[b+a]=[]),e[b+a][N+i]=ye):e[qr({c:N+i,r:b+a})]=ye,f.e.c<N+i&&(f.e.c=N+i),N+=F}}++b}return g.length&&(e["!merges"]=(e["!merges"]||[]).concat(g)),f.e.r=Math.max(f.e.r,b-1+a),e["!ref"]=hn(f),b>=u&&(e["!fullref"]=hn((f.e.r=l.length-k+b-1+a,f))),e}function jb(e,t){var r=t||{},n=r.dense?[]:{};return Db(n,e,t)}function nI(e,t){return Qc(jb(e,t),t)}function my(e){var t="",r=aI(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function aI(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function iI(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=pn(t.replace(/<[^>]*>/g,""));return[r]}var vy={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Mb(e,t){var r=t||{},n=Am(e),a=[],i,o,l={name:""},u="",f=0,h,g,x={},m=[],k=r.dense?[]:{},b,E,N={value:""},O="",F=0,K=[],te=-1,re=-1,B={s:{r:1e6,c:1e7},e:{r:0,c:0}},V=0,Y={},ye=[],U={},D=0,le=0,ue=[],Te=1,Fe=1,Le=[],me={Names:[]},ne={},Ee=["",""],pe=[],C={},M="",z=0,H=!1,ie=!1,xe=0;for(Z0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");b=Z0.exec(n);)switch(b[3]=b[3].replace(/_.*$/,"")){case"table":case"":b[1]==="/"?(B.e.c>=B.s.c&&B.e.r>=B.s.r?k["!ref"]=hn(B):k["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=B.e.r&&(k["!fullref"]=k["!ref"],B.e.r=r.sheetRows-1,k["!ref"]=hn(B)),ye.length&&(k["!merges"]=ye),ue.length&&(k["!rows"]=ue),h.name=h.||h.name,typeof JSON<"u"&&JSON.stringify(h),m.push(h.name),x[h.name]=k,ie=!1):b[0].charAt(b[0].length-2)!=="/"&&(h=Rr(b[0],!1),te=re=-1,B.s.r=B.s.c=1e7,B.e.r=B.e.c=0,k=r.dense?[]:{},ye=[],ue=[],ie=!0);break;case"table-row-group":b[1]==="/"?--V:++V;break;case"table-row":case"":if(b[1]==="/"){te+=Te,Te=1;break}if(g=Rr(b[0],!1),g.?te=g.-1:te==-1&&(te=0),Te=+g["number-rows-repeated"]||1,Te<10)for(xe=0;xe<Te;++xe)V>0&&(ue[te+xe]={level:V});re=-1;break;case"covered-table-cell":b[1]!=="/"&&++re,r.sheetStubs&&(r.dense?(k[te]||(k[te]=[]),k[te][re]={t:"z"}):k[qr({r:te,c:re})]={t:"z"}),O="",K=[];break;case"table-cell":case"":if(b[0].charAt(b[0].length-2)==="/")++re,N=Rr(b[0],!1),Fe=parseInt(N["number-columns-repeated"]||"1",10),E={t:"z",v:null},N.formula&&r.cellFormula!=!1&&(E.f=fy(pn(N.formula))),(N.||N["value-type"])=="string"&&(E.t="s",E.v=pn(N["string-value"]||""),r.dense?(k[te]||(k[te]=[]),k[te][re]=E):k[qr({r:te,c:re})]=E),re+=Fe-1;else if(b[1]!=="/"){++re,O="",F=0,K=[],Fe=1;var Ae=Te?te+Te-1:te;if(re>B.e.c&&(B.e.c=re),re<B.s.c&&(B.s.c=re),te<B.s.r&&(B.s.r=te),Ae>B.e.r&&(B.e.r=Ae),N=Rr(b[0],!1),pe=[],C={},E={t:N.||N["value-type"],v:null},r.cellFormula)if(N.formula&&(N.formula=pn(N.formula)),N["number-matrix-columns-spanned"]&&N["number-matrix-rows-spanned"]&&(D=parseInt(N["number-matrix-rows-spanned"],10)||0,le=parseInt(N["number-matrix-columns-spanned"],10)||0,U={s:{r:te,c:re},e:{r:te+D-1,c:re+le-1}},E.F=hn(U),Le.push([U,E.F])),N.formula)E.f=fy(N.formula);else for(xe=0;xe<Le.length;++xe)te>=Le[xe][0].s.r&&te<=Le[xe][0].e.r&&re>=Le[xe][0].s.c&&re<=Le[xe][0].e.c&&(E.F=Le[xe][1]);switch((N["number-columns-spanned"]||N["number-rows-spanned"])&&(D=parseInt(N["number-rows-spanned"],10)||0,le=parseInt(N["number-columns-spanned"],10)||0,U={s:{r:te,c:re},e:{r:te+D-1,c:re+le-1}},ye.push(U)),N["number-columns-repeated"]&&(Fe=parseInt(N["number-columns-repeated"],10)),E.t){case"boolean":E.t="b",E.v=ta(N["boolean-value"]);break;case"float":E.t="n",E.v=parseFloat(N.value);break;case"percentage":E.t="n",E.v=parseFloat(N.value);break;case"currency":E.t="n",E.v=parseFloat(N.value);break;case"date":E.t="d",E.v=li(N["date-value"]),r.cellDates||(E.t="n",E.v=xs(E.v)),E.z="m/d/yy";break;case"time":E.t="n",E.v=xT(N["time-value"])/86400,r.cellDates&&(E.t="d",E.v=bp(E.v)),E.z="HH:MM:SS";break;case"number":E.t="n",E.v=parseFloat(N.);break;default:if(E.t==="string"||E.t==="text"||!E.t)E.t="s",N["string-value"]!=null&&(O=pn(N["string-value"]),K=[]);else throw new Error("Unsupported value type "+E.t)}}else{if(H=!1,E.t==="s"&&(E.v=O||"",K.length&&(E.R=K),H=F==0),ne.Target&&(E.l=ne),pe.length>0&&(E.c=pe,pe=[]),O&&r.cellText!==!1&&(E.w=O),H&&(E.t="z",delete E.v),(!H||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=te))for(var de=0;de<Te;++de){if(Fe=parseInt(N["number-columns-repeated"]||"1",10),r.dense)for(k[te+de]||(k[te+de]=[]),k[te+de][re]=de==0?E:wi(E);--Fe>0;)k[te+de][re+Fe]=wi(E);else for(k[qr({r:te+de,c:re})]=E;--Fe>0;)k[qr({r:te+de,c:re+Fe})]=wi(E);B.e.c<=re&&(B.e.c=re)}Fe=parseInt(N["number-columns-repeated"]||"1",10),re+=Fe-1,Fe=0,E={},O="",K=[]}ne={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(b[1]==="/"){if((i=a.pop())[0]!==b[3])throw"Bad state: "+i}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!0]);break;case"annotation":if(b[1]==="/"){if((i=a.pop())[0]!==b[3])throw"Bad state: "+i;C.t=O,K.length&&(C.R=K),C.a=M,pe.push(C)}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!1]);M="",z=0,O="",F=0,K=[];break;case"creator":b[1]==="/"?M=n.slice(z,b.index):z=b.index+b[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(b[1]==="/"){if((i=a.pop())[0]!==b[3])throw"Bad state: "+i}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!1]);O="",F=0,K=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(b[1]==="/"){if(Y[l.name]=u,(i=a.pop())[0]!==b[3])throw"Bad state: "+i}else b[0].charAt(b[0].length-2)!=="/"&&(u="",l=Rr(b[0],!1),a.push([b[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":o=Rr(b[0],!1),u+=vy[b[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":o=Rr(b[0],!1),u+=vy[b[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(b[0].slice(-2)==="/>")break;if(b[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":u+=n.slice(f,b.index);break}else f=b.index+b[0].length;break;case"named-range":o=Rr(b[0],!1),Ee=K1(o["cell-range-address"]);var Me={Name:o.name,Ref:Ee[0]+"!"+Ee[1]};ie&&(Me.Sheet=m.length),me.Names.push(Me);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(b[1]==="/"&&(!N||!N["string-value"])){var ct=iI(n.slice(F,b.index));O=(O.length>0?O+`
`:"")+ct[0]}else Rr(b[0],!1),F=b.index+b[0].length;break;case"s":break;case"database-range":if(b[1]==="/")break;try{Ee=K1(Rr(b[0])["target-range-address"]),x[Ee[0]]["!autofilter"]={ref:Ee[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(b[1]!=="/"){if(ne=Rr(b[0],!1),!ne.href)break;ne.Target=pn(ne.href),delete ne.href,ne.Target.charAt(0)=="#"&&ne.Target.indexOf(".")>-1?(Ee=K1(ne.Target.slice(1)),ne.Target="#"+Ee[0]+"!"+Ee[1]):ne.Target.match(/^\.\.[\\\/]/)&&(ne.Target=ne.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(b[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(b)}}var se={Sheets:x,SheetNames:m,Workbook:me};return r.bookSheets&&delete se.Sheets,se}function xy(e,t){t=t||{},Eo(e,"META-INF/manifest.xml")&&b8(Ia(e,"META-INF/manifest.xml"),t);var r=ro(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=Mb(Kn(r),t);return Eo(e,"meta.xml")&&(n.Props=J5(Ia(e,"meta.xml"))),n}function yy(e,t){return Mb(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Bm(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Mg(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Kn(Iu(e))}function Bg(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function wy(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function sI(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function nh(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Ka(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Ki(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=nh(e,r),i=a&7;a=Math.floor(a/8);var o=0,l;if(a==0)break;switch(i){case 0:{for(var u=r[0];e[r[0]++]>=128;);l=e.slice(u,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=nh(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var f={data:l,type:i};t[a]==null?t[a]=[f]:t[a].push(f)}return t}function Um(e,t){return e?.map(function(r){return t(r.data)})||[]}function oI(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=nh(e,n),i=Ki(e.slice(n[0],n[0]+a));n[0]+=a;var o={id:Ka(i[1][0].data),messages:[]};i[2].forEach(function(l){var u=Ki(l.data),f=Ka(u[3][0].data);o.messages.push({meta:u,data:e.slice(n[0],n[0]+f)}),n[0]+=f}),(t=i[3])!=null&&t[0]&&(o.merge=Ka(i[3][0].data)>>>0>0),r.push(o)}return r}function lI(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=nh(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}a.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var u=0,f=0;if(i==1?(f=(t[r[0]]>>2&7)+4,u=(t[r[0]++]&224)<<3,u|=t[r[0]++]):(f=(t[r[0]++]>>2)+1,i==2?(u=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(u=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Bg(a)],u==0)throw new Error("Invalid offset 0");if(u>a[0].length)throw new Error("Invalid offset beyond length");if(f>=u)for(a.push(a[0].slice(-u)),f-=u;f>=a[a.length-1].length;)a.push(a[a.length-1]),f-=a[a.length-1].length;a.push(a[0].slice(-u,-u+f))}}var h=Bg(a);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function cI(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(lI(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Bg(t)}function uI(e,t,r,n){var a=Bm(e),i=a.getUint32(4,!0),o=(n>1?12:8)+wy(i&(n>1?3470:398))*4,l=-1,u=-1,f=NaN,h=new Date(2001,0,1);i&512&&(l=a.getUint32(o,!0),o+=4),o+=wy(i&(n>1?12288:4096))*4,i&16&&(u=a.getUint32(o,!0),o+=4),i&32&&(f=a.getFloat64(o,!0),o+=8),i&64&&(h.setTime(h.getTime()+a.getFloat64(o,!0)*1e3),o+=8);var g;switch(e[2]){case 0:break;case 2:g={t:"n",v:f};break;case 3:g={t:"s",v:t[u]};break;case 5:g={t:"d",v:h};break;case 6:g={t:"b",v:f>0};break;case 7:g={t:"n",v:f/86400};break;case 8:g={t:"e",v:0};break;case 9:if(l>-1)g={t:"s",v:r[l]};else if(u>-1)g={t:"s",v:t[u]};else if(!isNaN(f))g={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return g}function fI(e,t,r){var n=Bm(e),a=n.getUint32(8,!0),i=12,o=-1,l=-1,u=NaN,f=NaN,h=new Date(2001,0,1);a&1&&(u=sI(e,i),i+=16),a&2&&(f=n.getFloat64(i,!0),i+=8),a&4&&(h.setTime(h.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(l=n.getUint32(i,!0),i+=4),a&16&&(o=n.getUint32(i,!0),i+=4);var g;switch(e[1]){case 0:break;case 2:g={t:"n",v:u};break;case 3:g={t:"s",v:t[l]};break;case 5:g={t:"d",v:h};break;case 6:g={t:"b",v:f>0};break;case 7:g={t:"n",v:f/86400};break;case 8:g={t:"e",v:0};break;case 9:if(o>-1)g={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:g={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return g}function hI(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return uI(e,t,r,e[0]);case 5:return fI(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Wc(e){var t=Ki(e);return nh(t[1][0].data)}function by(e,t){var r=Ki(t.data),n=Ka(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(o){var l=Ki(o.data),u=Ka(l[1][0].data)>>>0;switch(n){case 1:i[u]=Mg(l[3][0].data);break;case 8:{var f=e[Wc(l[9][0].data)][0],h=Ki(f.data),g=e[Wc(h[1][0].data)][0],x=Ka(g.meta[1][0].data);if(x!=2001)throw new Error("2000 unexpected reference to ".concat(x));var m=Ki(g.data);i[u]=m[3].map(function(k){return Mg(k.data)}).join("")}break}}),i}function dI(e,t){var r,n,a,i,o,l,u,f,h,g,x,m,k,b,E=Ki(e),N=Ka(E[1][0].data)>>>0,O=Ka(E[2][0].data)>>>0,F=((n=(r=E[8])==null?void 0:r[0])==null?void 0:n.data)&&Ka(E[8][0].data)>0||!1,K,te;if((i=(a=E[7])==null?void 0:a[0])!=null&&i.data&&t!=0)K=(l=(o=E[7])==null?void 0:o[0])==null?void 0:l.data,te=(f=(u=E[6])==null?void 0:u[0])==null?void 0:f.data;else if((g=(h=E[4])==null?void 0:h[0])!=null&&g.data&&t!=1)K=(m=(x=E[4])==null?void 0:x[0])==null?void 0:m.data,te=(b=(k=E[3])==null?void 0:k[0])==null?void 0:b.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var re=F?4:1,B=Bm(K),V=[],Y=0;Y<K.length/2;++Y){var ye=B.getUint16(Y*2,!0);ye<65535&&V.push([Y,ye])}if(V.length!=O)throw"Expected ".concat(O," cells, found ").concat(V.length);var U=[];for(Y=0;Y<V.length-1;++Y)U[V[Y][0]]=te.subarray(V[Y][1]*re,V[Y+1][1]*re);return V.length>=1&&(U[V[V.length-1][0]]=te.subarray(V[V.length-1][1]*re)),{R:N,cells:U}}function pI(e,t){var r,n=Ki(t.data),a=(r=n?.[7])!=null&&r[0]?Ka(n[7][0].data)>>>0>0?1:0:-1,i=Um(n[5],function(o){return dI(o,a)});return{nrows:Ka(n[4][0].data)>>>0,data:i.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(u,f){if(o[l.R][f])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(f));o[l.R][f]=u}),o},[])}}function gI(e,t,r){var n,a=Ki(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Ka(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(Ka(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=hn(i);var o=Ki(a[4][0].data),l=by(e,e[Wc(o[4][0].data)][0]),u=(n=o[17])!=null&&n[0]?by(e,e[Wc(o[17][0].data)][0]):[],f=Ki(o[3][0].data),h=0;f[1].forEach(function(g){var x=Ki(g.data),m=e[Wc(x[2][0].data)][0],k=Ka(m.meta[1][0].data);if(k!=6002)throw new Error("6001 unexpected reference to ".concat(k));var b=pI(e,m);b.data.forEach(function(E,N){E.forEach(function(O,F){var K=qr({r:h+N,c:F}),te=hI(O,l,u);te&&(r[K]=te)})}),h+=b.nrows})}function mI(e,t){var r=Ki(t.data),n={"!ref":"A1"},a=e[Wc(r[2][0].data)],i=Ka(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return gI(e,a[0],n),n}function vI(e,t){var r,n=Ki(t.data),a={name:(r=n[1])!=null&&r[0]?Mg(n[1][0].data):"",sheets:[]},i=Um(n[2],Wc);return i.forEach(function(o){e[o].forEach(function(l){var u=Ka(l.meta[1][0].data);u==6e3&&a.sheets.push(mI(e,l))})}),a}function xI(e,t){var r=$m(),n=Ki(t.data),a=Um(n[1],Wc);if(a.forEach(function(i){e[i].forEach(function(o){var l=Ka(o.meta[1][0].data);if(l==2){var u=vI(e,o);u.sheets.forEach(function(f,h){Hm(r,f,h==0?u.name:u.name+"_"+h,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Y1(e){var t,r,n,a,i={},o=[];if(e.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var f;try{f=cI(u.content)}catch(g){return console.log("?? "+u.content.length+" "+(g.message||g))}var h;try{h=oI(f)}catch(g){return console.log("## "+(g.message||g))}h.forEach(function(g){i[g.id]=g.messages,o.push(g.id)})}}),!o.length)throw new Error("File has no messages");var l=((a=(n=(r=(t=i?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Ka(i[1][0].meta[1][0].data)==1&&i[1][0];if(l||o.forEach(function(u){i[u].forEach(function(f){var h=Ka(f.meta[1][0].data)>>>0;if(h==1)if(!l)l=f;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return xI(i,l)}function yI(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function zm(e){yI([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function wI(e){return Sf.WS.indexOf(e)>-1?"sheet":e==Sf.CS?"chart":e==Sf.DS?"dialog":e==Sf.MS?"macro":e&&e.length?e:"sheet"}function bI(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,wI(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function _I(e,t,r,n,a,i,o,l,u,f,h,g){try{i[n]=P0(ro(e,r,!0),t);var x=Ia(e,t),m;switch(l){case"sheet":m=TO(x,t,a,u,i[n],f,h,g);break;case"chart":if(m=CO(x,t,a,u,i[n],f,h,g),!m||!m["!drawel"])break;var k=y0(m["!drawel"].Target,t),b=Og(k),E=N7(ro(e,k,!0),P0(ro(e,b,!0),k)),N=y0(E,k),O=Og(N);m=fO(ro(e,N,!0),N,u,P0(ro(e,O,!0),N),f,m);break;case"macro":m=PO(x,t,a,u,i[n],f,h,g);break;case"dialog":m=LO(x,t,a,u,i[n],f,h,g);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=m;var F=[];i&&i[n]&&Ol(i[n]).forEach(function(K){var te="";if(i[n][K].Type==Sf.CMNT){te=y0(i[n][K].Target,t);var re=RO(Ia(e,te,!0),te,u);if(!re||!re.length)return;sy(m,re,!1)}i[n][K].Type==Sf.TCMNT&&(te=y0(i[n][K].Target,t),F=F.concat(C7(Ia(e,te,!0),u)))}),F&&F.length&&sy(m,F,!0,u.people||[])}catch(K){if(u.WTF)throw K}}function ko(e){return e.charAt(0)=="/"?e.slice(1):e}function kI(e,t){if(_5(),t=t||{},zm(t),Eo(e,"META-INF/manifest.xml")||Eo(e,"objectdata.xml"))return xy(e,t);if(Eo(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Y1<"u"){if(e.FileIndex)return Y1(e);var r=fn.utils.cfb_new();return Ox(e).forEach(function(ue){ST(r,ue,kT(e,ue))}),Y1(r)}throw new Error("Unsupported NUMBERS file")}if(!Eo(e,"[Content_Types].xml"))throw Eo(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Eo(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Ox(e),a=y8(ro(e,"[Content_Types].xml")),i=!1,o,l;if(a.workbooks.length===0&&(l="xl/workbook.xml",Ia(e,l,!0)&&a.workbooks.push(l)),a.workbooks.length===0){if(l="xl/workbook.bin",!Ia(e,l,!0))throw new Error("Could not find workbook");a.workbooks.push(l),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var u={},f={};if(!t.bookSheets&&!t.bookProps){if(O0=[],a.sst)try{O0=IO(Ia(e,ko(a.sst)),a.sst,t)}catch(ue){if(t.WTF)throw ue}t.cellStyles&&a.themes.length&&(u=OO(ro(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(f=FO(Ia(e,ko(a.style)),a.style,u,t))}a.links.map(function(ue){try{var Te=P0(ro(e,Og(ko(ue))),ue);return jO(Ia(e,ko(ue)),Te,ue,t)}catch{}});var h=NO(Ia(e,ko(a.workbooks[0])),a.workbooks[0],t),g={},x="";a.coreprops.length&&(x=Ia(e,ko(a.coreprops[0]),!0),x&&(g=J5(x)),a.extprops.length!==0&&(x=Ia(e,ko(a.extprops[0]),!0),x&&S8(x,g,t)));var m={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(x=ro(e,ko(a.custprops[0]),!0),x&&(m=A8(x,t)));var k={};if((t.bookSheets||t.bookProps)&&(h.Sheets?o=h.Sheets.map(function(Te){return Te.name}):g.Worksheets&&g.SheetNames.length>0&&(o=g.SheetNames),t.bookProps&&(k.Props=g,k.Custprops=m),t.bookSheets&&typeof o<"u"&&(k.SheetNames=o),t.bookSheets?k.SheetNames:t.bookProps))return k;o={};var b={};t.bookDeps&&a.calcchain&&(b=DO(Ia(e,ko(a.calcchain)),a.calcchain));var E=0,N={},O,F;{var K=h.Sheets;g.Worksheets=K.length,g.SheetNames=[];for(var te=0;te!=K.length;++te)g.SheetNames[te]=K[te].name}var re=i?"bin":"xml",B=a.workbooks[0].lastIndexOf("/"),V=(a.workbooks[0].slice(0,B+1)+"_rels/"+a.workbooks[0].slice(B+1)+".rels").replace(/^\//,"");Eo(e,V)||(V="xl/_rels/workbook."+re+".rels");var Y=P0(ro(e,V,!0),V.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=MO(Ia(e,ko(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=P7(Ia(e,ko(a.people[0])),t)),Y&&(Y=bI(Y,h.Sheets));var ye=Ia(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(E=0;E!=g.Worksheets;++E){var U="sheet";if(Y&&Y[E]?(O="xl/"+Y[E][1].replace(/[\/]?xl\//,""),Eo(e,O)||(O=Y[E][1]),Eo(e,O)||(O=V.replace(/_rels\/.*$/,"")+Y[E][1]),U=Y[E][2]):(O="xl/worksheets/sheet"+(E+1-ye)+"."+re,O=O.replace(/sheet0\./,"sheet.")),F=O.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(E!=t.sheets)continue e;break;case"string":if(g.SheetNames[E].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var D=!1,le=0;le!=t.sheets.length;++le)typeof t.sheets[le]=="number"&&t.sheets[le]==E&&(D=1),typeof t.sheets[le]=="string"&&t.sheets[le].toLowerCase()==g.SheetNames[E].toLowerCase()&&(D=1);if(!D)continue e}}_I(e,O,F,g.SheetNames[E],E,N,o,U,t,h,u,f)}return k={Directory:a,Workbook:h,Props:g,Custprops:m,Deps:b,Sheets:o,SheetNames:g.SheetNames,Strings:O0,Styles:f,Themes:u,SSF:wi(Wr)},t&&t.bookFiles&&(e.files?(k.keys=n,k.files=e.files):(k.keys=[],k.files={},e.FullPaths.forEach(function(ue,Te){ue=ue.replace(/^Root Entry[\/]/,""),k.keys.push(ue),k.files[ue]=e.FileIndex[Te]}))),t&&t.bookVBA&&(a.vba.length>0?k.vbaraw=Ia(e,ko(a.vba[0]),!0):a.defaults&&a.defaults.bin===I7&&(k.vbaraw=Ia(e,"xl/vbaProject.bin",!0))),k}function SI(e,t){var r=t||{},n="Workbook",a=fn.find(e,n);try{if(n="/!DataSpaces/Version",a=fn.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(mP(a.content),n="/!DataSpaces/DataSpaceMap",a=fn.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=xP(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=fn.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=yP(a.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=fn.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);bP(a.content)}catch{}if(n="/EncryptionInfo",a=fn.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=_P(a.content);if(n="/EncryptedPackage",a=fn.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],a.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function qm(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ao(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function EI(e,t){return fn.find(e,"EncryptedPackage")?SI(e,t):Rb(e,t)}function AI(e,t){var r,n=e,a=t||{};return a.type||(a.type=on&&Buffer.isBuffer(e)?"buffer":"base64"),r=T5(n,a),kI(r,a)}function Bb(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Dg(e.slice(r),t);default:break e}return eh.to_workbook(e,t)}function NI(e,t){var r="",n=qm(e,t);switch(t.type){case"base64":r=ao(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Pu(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Kn(r)),t.type="binary",Bb(r,t)}function TI(e,t){var r=e;return t.type=="base64"&&(r=ao(r)),r=X0.utils.decode(1200,r.slice(2),"str"),t.type="binary",Bb(r,t)}function CI(e){return e.match(/[^\x00-\x7F]/)?w0(e):e}function X1(e,t,r,n){return n?(r.type="string",eh.to_workbook(e,r)):eh.to_workbook(t,r)}function Ug(e,t){u5();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Ug(new Uint8Array(e),(r=wi(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),If={},r.dateNF&&(If.dateNF=r.dateNF),r.type||(r.type=on&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=on?"buffer":"binary",n=mT(e),typeof Uint8Array<"u"&&!on&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=CI(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=wi(r),r.type="array",Ug(wm(n),r)}switch((a=qm(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return EI(fn.read(n,r),r);break;case 9:if(a[1]<=8)return Rb(n,r);break;case 60:return Dg(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return nP(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return tP.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?AI(n,r):X1(e,n,r,i);case 239:return a[3]===60?Dg(n,r):X1(e,n,r,i);case 255:if(a[1]===254)return TI(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return F0.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return F0.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return iy.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return IP.to_workbook(n,r);break;case 10:case 13:case 32:return NI(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return ZC.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?iy.to_workbook(n,r):X1(e,n,r,i)}function PI(e,t,r,n,a,i,o,l){var u=bi(r),f=l.defval,h=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),g=!0,x=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:r,enumerable:!1})}catch{x.__rowNum__=r}else x.__rowNum__=r;if(!o||e[r])for(var m=t.s.c;m<=t.e.c;++m){var k=o?e[r][m]:e[n[m]+u];if(k===void 0||k.t===void 0){if(f===void 0)continue;i[m]!=null&&(x[i[m]]=f);continue}var b=k.v;switch(k.t){case"z":if(b==null)break;continue;case"e":b=b==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+k.t)}if(i[m]!=null){if(b==null)if(k.t=="e"&&b===null)x[i[m]]=null;else if(f!==void 0)x[i[m]]=f;else if(h&&b===null)x[i[m]]=null;else continue;else x[i[m]]=h&&(k.t!=="n"||k.t==="n"&&l.rawNumbers!==!1)?b:uc(k,b,l);b!=null&&(g=!1)}}return{row:x,isempty:g}}function zg(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],o=0,l="",u={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},h=f.range!=null?f.range:e["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof h){case"string":u=pa(h);break;case"number":u=pa(e["!ref"]),u.s.r=h;break;default:u=h}n>0&&(a=0);var g=bi(u.s.r),x=[],m=[],k=0,b=0,E=Array.isArray(e),N=u.s.r,O=0,F={};E&&!e[N]&&(e[N]=[]);var K=f.skipHidden&&e["!cols"]||[],te=f.skipHidden&&e["!rows"]||[];for(O=u.s.c;O<=u.e.c;++O)if(!(K[O]||{}).hidden)switch(x[O]=Wa(O),r=E?e[N][O]:e[x[O]+g],n){case 1:i[O]=O-u.s.c;break;case 2:i[O]=x[O];break;case 3:i[O]=f.header[O-u.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=uc(r,null,f),b=F[o]||0,!b)F[o]=1;else{do l=o+"_"+b++;while(F[l]);F[o]=b,F[l]=1}i[O]=l}for(N=u.s.r+a;N<=u.e.r;++N)if(!(te[N]||{}).hidden){var re=PI(e,u,N,x,n,i,E,f);(re.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(m[k++]=re.row)}return m.length=k,m}var _y=/"/g;function LI(e,t,r,n,a,i,o,l){for(var u=!0,f=[],h="",g=bi(r),x=t.s.c;x<=t.e.c;++x)if(n[x]){var m=l.dense?(e[r]||[])[x]:e[n[x]+g];if(m==null)h="";else if(m.v!=null){u=!1,h=""+(l.rawNumbers&&m.t=="n"?m.v:uc(m,null,l));for(var k=0,b=0;k!==h.length;++k)if((b=h.charCodeAt(k))===a||b===i||b===34||l.forceQuotes){h='"'+h.replace(_y,'""')+'"';break}h=="ID"&&(h='"ID"')}else m.f!=null&&!m.F?(u=!1,h="="+m.f,h.indexOf(",")>=0&&(h='"'+h.replace(_y,'""')+'"')):h="";f.push(h)}return l.blankrows===!1&&u?null:f.join(o)}function Ub(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=pa(e["!ref"]),i=n.FS!==void 0?n.FS:",",o=i.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,u=l.charCodeAt(0),f=new RegExp((i=="|"?"\\|":i)+"+$"),h="",g=[];n.dense=Array.isArray(e);for(var x=n.skipHidden&&e["!cols"]||[],m=n.skipHidden&&e["!rows"]||[],k=a.s.c;k<=a.e.c;++k)(x[k]||{}).hidden||(g[k]=Wa(k));for(var b=0,E=a.s.r;E<=a.e.r;++E)(m[E]||{}).hidden||(h=LI(e,a,E,g,o,u,i,n),h!=null&&(n.strip&&(h=h.replace(f,"")),(h||n.blankrows!==!1)&&r.push((b++?l:"")+h)));return delete n.dense,r.join("")}function FI(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Ub(e,t);return r}function OI(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=pa(e["!ref"]),i="",o=[],l,u=[],f=Array.isArray(e);for(l=a.s.c;l<=a.e.c;++l)o[l]=Wa(l);for(var h=a.s.r;h<=a.e.r;++h)for(i=bi(h),l=a.s.c;l<=a.e.c;++l)if(t=o[l]+i,r=f?(e[h]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}u[u.length]=t+"="+n}return u}function zb(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},o=0,l=0;if(i&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?ms(n.origin):n.origin;o=u.r,l=u.c}var f,h={s:{c:0,r:0},e:{c:l,r:o+t.length-1+a}};if(i["!ref"]){var g=pa(i["!ref"]);h.e.c=Math.max(h.e.c,g.e.c),h.e.r=Math.max(h.e.r,g.e.r),o==-1&&(o=g.e.r+1,h.e.r=o+t.length-1+a)}else o==-1&&(o=0,h.e.r=t.length-1+a);var x=n.header||[],m=0;t.forEach(function(b,E){Ol(b).forEach(function(N){(m=x.indexOf(N))==-1&&(x[m=x.length]=N);var O=b[N],F="z",K="",te=qr({c:l+m,r:o+E+a});f=ah(i,te),O&&typeof O=="object"&&!(O instanceof Date)?i[te]=O:(typeof O=="number"?F="n":typeof O=="boolean"?F="b":typeof O=="string"?F="s":O instanceof Date?(F="d",n.cellDates||(F="n",O=xs(O)),K=n.dateNF||Wr[14]):O===null&&n.nullError&&(F="e",O=0),f?(f.t=F,f.v=O,delete f.w,delete f.R,K&&(f.z=K)):i[te]=f={t:F,v:O},K&&(f.z=K))})}),h.e.c=Math.max(h.e.c,l+x.length-1);var k=bi(o);if(a)for(m=0;m<x.length;++m)i[Wa(m+l)+k]={t:"s",v:x[m]};return i["!ref"]=hn(h),i}function II(e,t){return zb(null,e,t)}function ah(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=ms(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?ah(e,qr(t)):ah(e,qr({r:t,c:r||0}))}function RI(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function $m(){return{SheetNames:[],Sheets:{}}}function Hm(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var o=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=o+a)!=-1;++a);}if(yO(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function DI(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=RI(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function jI(e,t){return e.z=t,e}function qb(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function MI(e,t,r){return qb(e,"#"+t,r)}function BI(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function UI(e,t,r,n){for(var a=typeof t!="string"?t:pa(t),i=typeof t=="string"?t:hn(t),o=a.s.r;o<=a.e.r;++o)for(var l=a.s.c;l<=a.e.c;++l){var u=ah(e,o,l);u.t="n",u.F=i,delete u.v,o==a.s.r&&l==a.s.c&&(u.f=r,n&&(u.D=!0))}return e}var zI={encode_col:Wa,encode_row:bi,encode_cell:qr,encode_range:hn,decode_col:Cm,decode_row:Tm,split_cell:QT,decode_cell:ms,decode_range:Hf,format_cell:uc,sheet_add_aoa:W5,sheet_add_json:zb,sheet_add_dom:Db,aoa_to_sheet:Vf,json_to_sheet:II,table_to_sheet:jb,table_to_book:nI,sheet_to_csv:Ub,sheet_to_txt:FI,sheet_to_json:zg,sheet_to_html:rI,sheet_to_formulae:OI,sheet_to_row_object_array:zg,sheet_get_cell:ah,book_new:$m,book_append_sheet:Hm,book_set_sheet_visibility:DI,cell_set_number_format:jI,cell_set_hyperlink:qb,cell_set_internal_link:MI,cell_add_comment:BI,sheet_set_array_formula:UI,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const qI={name:"name","full name":"name",nom:"name","nom complet":"name",:"name"," ":"name",passport:"passportNumber","passport number":"passportNumber","numro de passeport":"passportNumber","n passeport":"passportNumber"," ":"passportNumber"," ":"passportNumber",gender:"gender",sexe:"gender",:"gender",:"gender",email:"email","e-mail":"email"," ":"email",phone:"phone",telephone:"phone",tl:"phone",:"phone"," ":"phone"},$I=e=>{if(!e)return;const t=String(e).toLowerCase().trim();if(["m","male","homme","","man"].includes(t))return"Male";if(["f","female","femme","","woman"].includes(t))return"Female"},HI=async e=>new Promise((t,r)=>{const n=new FileReader;n.onload=a=>{try{const i=new Uint8Array(a.target?.result),o=Ug(i,{type:"array"}),l=o.SheetNames[0],u=o.Sheets[l],f=zI.sheet_to_json(u);if(f.length===0){t([]);return}const h=f.map(g=>{const x={};return x.name="Unknown",x.email="",Object.keys(g).forEach(m=>{const k=m.toLowerCase().trim(),b=qI[k];b&&(b==="gender"?x.gender=$I(g[m]):(x.clientName=g[m],x[b]=String(g[m])))}),x.name==="Unknown"&&(g.Name||g.name)&&(x.name=g.Name||g.name),x});t(h)}catch(i){r(i)}},n.onerror=a=>r(a),n.readAsArrayBuffer(e)}),VI=({children:e})=>{const{isOver:t,setNodeRef:r}=l5({id:"unassign-zone",data:{type:"unassign"}});return A.jsx("div",{ref:r,className:`flex-1 overflow-y-auto services-scrollbar transition-colors ${t?"bg-red-50 ring-2 ring-red-200 ring-inset":""}`,children:e})},WI=()=>{const[e,t]=ce.useState([]),[r,n]=ce.useState([]),[a,i]=ce.useState(!0),[o,l]=ce.useState(!1),[u,f]=ce.useState(""),[h,g]=ce.useState(null),[x,m]=ce.useState(!1),[k,b]=ce.useState("Makkah"),[E,N]=ce.useState(!1),O=ra.useRef(null);ce.useEffect(()=>{F()},[]);const F=async()=>{try{const[D,le,ue]=await Promise.all([$i.getRooms(),$i.getClients(),$i.getInvoices()]),Te={};[...ue].sort((me,ne)=>new Date(ne.createdAt).getTime()-new Date(me.createdAt).getTime()).forEach(me=>{me.client?.id&&!Te[me.client.id]&&(me.passportNumber||me.gender)&&(Te[me.client.id]={passportNumber:me.passportNumber,gender:me.gender})});const Le=le.map(me=>{const ne=me.id?Te[me.id]:null;return{...me,passportNumber:me.passportNumber||ne?.passportNumber,gender:me.gender||ne?.gender}});t(D),n(Le)}catch(D){console.error("Failed to load rooming list:",D)}finally{i(!1)}},K=async D=>{l(!0);try{await $i.createRoom(D),await F(),m(!1)}catch(le){console.error("Failed to save room:",le),alert("Failed to save room. Please try again.")}finally{l(!1)}},te=async D=>{const le=D.target.files?.[0];if(!le)return;N(!0);const ue=bf.loading("Importing pilgrims from Excel...");try{const Te=await HI(le);if(Te.length===0){bf.error("No data found in the Excel file.",{id:ue});return}await $i.bulkCreateClients(Te),await F(),bf.success(`Successfully imported ${Te.length} pilgrims!`,{id:ue})}catch(Te){console.error("Excel Import Error:",Te),bf.error(Te.message||"Failed to import Excel file.",{id:ue})}finally{N(!1),O.current&&(O.current.value="")}},re=async D=>{try{await $i.deleteRoom(D),await F()}catch(le){console.error("Failed to delete room:",le),alert("   .      .")}},B=D=>{const{active:le}=D,ue=r.find(Te=>`client-${Te.id}`===le.id);ue&&g(ue)},V=async D=>{const{active:le,over:ue}=D;if(g(null),!ue)return;const Te=le.data.current.client.id;if(ue.id==="unassign-zone"){const me=e.map(ne=>({...ne,assignments:ne.assignments?.filter(Ee=>Ee.clientId!==Te)||[]}));t(me);try{await $i.removeClientFromRoom(Te)}catch(ne){console.error("Unassign failed:",ne),F()}return}const Fe=ue.data.current.room.id,Le=e.map(me=>{if(me.id===Fe){const ne=e.find(Ee=>Ee.assignments?.some(pe=>pe.clientId===Te));return ne&&(ne.assignments=ne.assignments?.filter(Ee=>Ee.clientId!==Te)),{...me,assignments:[...me.assignments||[],{id:"temp-"+Date.now(),roomId:Fe,clientId:Te,assignedAt:new Date().toISOString()}]}}return me});t(Le);try{await $i.assignClientToRoom(Fe,Te)}catch(me){console.error("Drag failed:",me),F()}},Y=b6(w6(mm,{activationConstraint:{distance:8}})),ye=new Set(e.flatMap(D=>D.assignments?.map(le=>le.clientId)||[])),U=r.filter(D=>!ye.has(D.id)&&(D.name.toLowerCase().includes(u.toLowerCase())||D.passportNumber?.includes(u)));return a?A.jsx(qw,{}):A.jsx(xN,{sensors:Y,onDragStart:B,onDragEnd:V,children:A.jsxs("div",{className:"h-screen flex flex-col bg-gray-50",children:[A.jsxs("header",{className:"bg-white border-b px-6 py-4 flex items-center justify-between shadow-sm sticky top-0 z-20",children:[A.jsxs("div",{children:[A.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[A.jsx(Vy,{className:"text-blue-600"}),"Unassigned Rooming List"]}),A.jsxs("p",{className:"text-gray-500 text-sm mt-1",children:[U.length," unassigned clients  ",e.length," rooms"]})]}),A.jsxs("div",{className:"flex items-center gap-4",children:[A.jsx("input",{type:"file",ref:O,onChange:te,accept:".xlsx,.xls,.csv",className:"hidden"}),A.jsxs("button",{onClick:()=>O.current?.click(),disabled:E,className:"flex items-center gap-2 px-4 py-2 bg-emerald-50 text-emerald-700 border border-emerald-200 rounded-lg hover:bg-emerald-100 font-medium transition-colors disabled:opacity-50",children:[E?A.jsx(Jg,{className:"animate-spin",size:18}):A.jsx(a3,{size:18}),"Import Excel"]}),A.jsxs("button",{onClick:()=>m(!0),className:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 text-gray-700 font-medium transition-colors",children:[A.jsx(Id,{size:18}),"Add Room"]}),A.jsxs("button",{className:"flex items-center gap-2 px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium shadow-sm transition-all active:scale-95",onClick:()=>window.print(),children:[A.jsx(Qg,{size:18}),"Export List"]})]})]}),A.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[A.jsxs("aside",{className:"w-80 bg-white border-r flex flex-col z-10 shadow-lg",children:[A.jsx("div",{className:"p-4 border-b bg-gray-50",children:A.jsxs("div",{className:"relative",children:[A.jsx(Z1,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),A.jsx("input",{type:"text",placeholder:"Search clients...",className:"w-full pl-10 pr-4 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all",value:u,onChange:D=>f(D.target.value)})]})}),A.jsx(VI,{children:A.jsxs("div",{className:"p-4 space-y-2",children:[A.jsxs("h3",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider mb-3",children:["Unassigned (",U.length,")"]}),U.map(D=>A.jsx(Pg,{client:D},D.id))]})})]}),A.jsxs("main",{className:"flex-1 overflow-y-auto p-8",children:[A.jsxs("div",{className:"flex bg-gray-100 dark:bg-gray-800 p-1.5 rounded-2xl mb-8 w-fit mx-auto shadow-inner",children:[A.jsx("button",{onClick:()=>b("Makkah"),className:`flex items-center gap-2 px-8 py-3 rounded-xl font-bold transition-all duration-300 ${k==="Makkah"?"bg-white dark:bg-gray-700 shadow-xl text-blue-600 scale-105":"text-gray-500 hover:text-gray-700"}`,children:"  "}),A.jsx("button",{onClick:()=>b("Madinah"),className:`flex items-center gap-2 px-8 py-3 rounded-xl font-bold transition-all duration-300 ${k==="Madinah"?"bg-white dark:bg-gray-700 shadow-xl text-blue-600 scale-105":"text-gray-500 hover:text-gray-700"}`,children:"  "})]}),A.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 pb-20",children:[e.filter(D=>D.city===k).map(D=>A.jsx(MN,{room:D,clients:r.filter(le=>D.assignments?.some(ue=>ue.clientId===le.id)),onDelete:re},D.id)),A.jsxs("button",{onClick:()=>m(!0),className:"h-full min-h-[300px] border-2 border-dashed border-gray-300 rounded-xl flex flex-col items-center justify-center text-gray-400 hover:border-blue-400 hover:text-blue-500 hover:bg-blue-50 transition-all group",children:[A.jsx("div",{className:"p-4 rounded-full bg-gray-100 group-hover:bg-blue-100 mb-4 transition-colors",children:A.jsx(Id,{size:32})}),A.jsx("span",{className:"font-medium",children:"Add New Room"})]})]})]})]}),A.jsx(jN,{children:h?A.jsx("div",{className:"opacity-90 scale-105 rotate-2 transform cursor-grabbing",children:A.jsx(Pg,{client:h})}):null}),x&&A.jsx(BN,{onSave:K,onCancel:()=>m(!1)}),A.jsxs("div",{id:"printable-rooming-report",className:"hidden print:block p-8 bg-white",dir:"rtl",children:[A.jsx("style",{children:`
                        @media print {
                            body * { visibility: hidden; }
                            #printable-rooming-report, #printable-rooming-report * { visibility: visible; }
                            #printable-rooming-report { 
                                position: absolute; 
                                left: 0; 
                                top: 0; 
                                width: 100%;
                                display: block !important;
                            }
                            @page { size: A4; margin: 1cm; }
                            .no-print { display: none !important; }
                        }
                    `}),A.jsxs("div",{className:"flex justify-between items-center border-b-4 border-blue-600 pb-4 mb-8",children:[A.jsxs("div",{children:[A.jsxs("h1",{className:"text-3xl font-bold text-gray-900",children:["   - ",k==="Makkah"?" ":" "]}),A.jsx("p",{className:"text-blue-600 font-medium mt-1",children:"Beausejour Voyage"})]}),A.jsx("div",{className:"text-left",dir:"ltr",children:A.jsxs("p",{className:"text-sm text-gray-500",children:[": ",new Date().toLocaleDateString("ar-MA")]})})]}),A.jsx("div",{className:"space-y-8",children:e.filter(D=>D.city===k).map(D=>{const le=r.filter(ue=>D.assignments?.some(Te=>Te.clientId===ue.id));return A.jsxs("div",{className:"border-2 border-gray-200 rounded-xl overflow-hidden break-inside-avoid",children:[A.jsxs("div",{className:"bg-gray-100 px-4 py-3 flex justify-between items-center border-b-2 border-gray-200",children:[A.jsxs("h3",{className:"text-lg font-bold",children:[" : ",A.jsx("span",{className:"text-blue-700",children:D.roomNumber||"---"}),A.jsxs("span",{className:"mr-2 text-sm text-gray-500 font-normal",children:["(",D.type==="Double"?"":D.type==="Triple"?"":D.type==="Quad"?"":"",")"]})]}),A.jsxs("span",{className:"text-sm font-medium",children:[": ",D.hotelName||"---"]})]}),A.jsxs("table",{className:"w-full text-inner",children:[A.jsx("thead",{children:A.jsxs("tr",{className:"bg-gray-50 border-b border-gray-200",children:[A.jsx("th",{className:"px-4 py-2 text-right text-sm text-gray-600",children:"  "}),A.jsx("th",{className:"px-4 py-2 text-right text-sm text-gray-600",children:" "}),A.jsx("th",{className:"px-4 py-2 text-right text-sm text-gray-600",children:""})]})}),A.jsx("tbody",{children:le.length===0?A.jsx("tr",{children:A.jsx("td",{colSpan:3,className:"px-4 py-6 text-center text-gray-400 italic",children:"   "})}):le.map(ue=>A.jsxs("tr",{className:"border-b border-gray-100",children:[A.jsx("td",{className:"px-4 py-3 font-semibold text-gray-900",children:ue.name}),A.jsx("td",{className:"px-4 py-3 text-gray-700",children:ue.passportNumber||"---"}),A.jsx("td",{className:"px-4 py-3 text-gray-700",children:ue.gender==="Male"?"":ue.gender==="Female"?"":"---"})]},ue.id))})]})]},D.id)})}),A.jsxs("div",{className:"mt-12 pt-4 border-t border-gray-200 text-center text-gray-400 text-xs",children:["      Beausejour Voyage  ",new Date().getFullYear()]})]})]})})},KI=()=>A.jsx(s6,{children:A.jsx(m3,{children:A.jsx(QA,{children:A.jsx(q4,{children:A.jsxs("div",{className:"relative",children:[A.jsx(i6,{}),A.jsxs(y4,{children:[A.jsx(p0,{path:"/",element:A.jsx(s2,{to:"/portal",replace:!0})}),A.jsx(p0,{path:"/portal",element:A.jsx(a6,{})}),A.jsx(p0,{path:"/portal/rooming",element:A.jsx(WI,{})}),A.jsx(p0,{path:"*",element:A.jsx(s2,{to:"/portal",replace:!0})})]})]})})})})});function GI(){return A.jsx(KI,{})}C_.createRoot(document.getElementById("root")).render(A.jsx(ce.StrictMode,{children:A.jsx(GI,{})}));export{Nn as _,b_ as c,ky as g};
